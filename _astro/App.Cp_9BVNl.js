import{r as P,g as rE,R as ep}from"./index.DeO6U63H.js";var Nu={exports:{}},js={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var np;function iE(){if(np)return js;np=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function n(r,i,s){var a=null;if(s!==void 0&&(a=""+s),i.key!==void 0&&(a=""+i.key),"key"in i){s={};for(var o in i)o!=="key"&&(s[o]=i[o])}else s=i;return i=s.ref,{$$typeof:e,type:r,key:a,ref:i!==void 0?i:null,props:s}}return js.Fragment=t,js.jsx=n,js.jsxs=n,js}var rp;function sE(){return rp||(rp=1,Nu.exports=iE()),Nu.exports}var m=sE();const Qy="tracksy-theme",Ko=["light","dark","system"],aE="dark",Jy="(prefers-color-scheme: dark)",oE=()=>window.matchMedia?.(Jy)?.matches??!1,Zy=e=>e==="system"?oE()?"dark":"light":e,ip=e=>{const t=Zy(e)==="dark";document.documentElement.classList.toggle(aE,t)},cE=()=>{const e=localStorage.getItem(Qy);return Ko.includes(e)?e:"system"};function lE(){const[e,t]=P.useState(cE);return P.useEffect(()=>{ip(e),localStorage.setItem(Qy,e)},[e]),P.useEffect(()=>{if(e!=="system")return;const n=window.matchMedia(Jy),r=()=>ip("system");return n.addEventListener("change",r),()=>n.removeEventListener("change",r)},[e]),{theme:e,setTheme:t,effectiveTheme:Zy(e)}}const Pd=P.createContext({theme:"light",setTheme:()=>{},effectiveTheme:"light"});function uE({children:e}){const t=lE();return m.jsx(Pd.Provider,{value:t,children:e})}function dt(e,t,n,r){function i(s){return s instanceof n?s:new n(function(a){a(s)})}return new(n||(n=Promise))(function(s,a){function o(u){try{l(r.next(u))}catch(f){a(f)}}function c(u){try{l(r.throw(u))}catch(f){a(f)}}function l(u){u.done?s(u.value):i(u.value).then(o,c)}l((r=r.apply(e,t||[])).next())})}function sp(e){var t=typeof Symbol=="function"&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function bt(e){return this instanceof bt?(this.v=e,this):new bt(e)}function On(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=n.apply(e,t||[]),i,s=[];return i=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),o("next"),o("throw"),o("return",a),i[Symbol.asyncIterator]=function(){return this},i;function a(h){return function(p){return Promise.resolve(p).then(h,f)}}function o(h,p){r[h]&&(i[h]=function(y){return new Promise(function(g,b){s.push([h,y,g,b])>1||c(h,y)})},p&&(i[h]=p(i[h])))}function c(h,p){try{l(r[h](p))}catch(y){d(s[0][3],y)}}function l(h){h.value instanceof bt?Promise.resolve(h.value.v).then(u,f):d(s[0][2],h)}function u(h){c("next",h)}function f(h){c("throw",h)}function d(h,p){h(p),s.shift(),s.length&&c(s[0][0],s[0][1])}}function Qo(e){var t,n;return t={},r("next"),r("throw",function(i){throw i}),r("return"),t[Symbol.iterator]=function(){return this},t;function r(i,s){t[i]=e[i]?function(a){return(n=!n)?{value:bt(e[i](a)),done:!1}:s?s(a):a}:s}}function ai(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=e[Symbol.asyncIterator],n;return t?t.call(e):(e=typeof sp=="function"?sp(e):e[Symbol.iterator](),n={},r("next"),r("throw"),r("return"),n[Symbol.asyncIterator]=function(){return this},n);function r(s){n[s]=e[s]&&function(a){return new Promise(function(o,c){a=e[s](a),i(o,c,a.done,a.value)})}}function i(s,a,o,c){Promise.resolve(c).then(function(l){s({value:l,done:o})},a)}}const fE=new TextDecoder("utf-8"),If=e=>fE.decode(e),dE=new TextEncoder,za=e=>dE.encode(e),hE=e=>typeof e=="number",tg=e=>typeof e=="boolean",Qt=e=>typeof e=="function",Ie=e=>e!=null&&Object(e)===e,fi=e=>Ie(e)&&Qt(e.then),Ya=e=>Ie(e)&&Qt(e[Symbol.iterator]),Ns=e=>Ie(e)&&Qt(e[Symbol.asyncIterator]),Nf=e=>Ie(e)&&Ie(e.schema),eg=e=>Ie(e)&&"done"in e&&"value"in e,ng=e=>Ie(e)&&Qt(e.stat)&&hE(e.fd),rg=e=>Ie(e)&&jd(e.body),Ml=e=>"_getDOMStream"in e&&"_getNodeStream"in e,pE=e=>Ie(e)&&Qt(e.abort)&&Qt(e.getWriter)&&!Ml(e),jd=e=>Ie(e)&&Qt(e.cancel)&&Qt(e.getReader)&&!Ml(e),mE=e=>Ie(e)&&Qt(e.end)&&Qt(e.write)&&tg(e.writable)&&!Ml(e),ig=e=>Ie(e)&&Qt(e.read)&&Qt(e.pipe)&&tg(e.readable)&&!Ml(e),yE=e=>Ie(e)&&Qt(e.clear)&&Qt(e.bytes)&&Qt(e.position)&&Qt(e.setPosition)&&Qt(e.capacity)&&Qt(e.getBufferIdentifier)&&Qt(e.createLong),Vd=typeof SharedArrayBuffer<"u"?SharedArrayBuffer:ArrayBuffer;function gE(e){const t=e[0]?[e[0]]:[];let n,r,i,s;for(let a,o,c=0,l=0,u=e.length;++c<u;){if(a=t[l],o=e[c],!a||!o||a.buffer!==o.buffer||o.byteOffset<a.byteOffset){o&&(t[++l]=o);continue}if({byteOffset:n,byteLength:i}=a,{byteOffset:r,byteLength:s}=o,n+i<r||r+s<n){o&&(t[++l]=o);continue}t[l]=new Uint8Array(a.buffer,n,r-n+s)}return t}function Mf(e,t,n=0,r=t.byteLength){const i=e.byteLength,s=new Uint8Array(e.buffer,e.byteOffset,i),a=new Uint8Array(t.buffer,t.byteOffset,Math.min(r,i));return s.set(a,n),e}function Cn(e,t){const n=gE(e),r=n.reduce((u,f)=>u+f.byteLength,0);let i,s,a,o=0,c=-1;const l=Math.min(t||Number.POSITIVE_INFINITY,r);for(const u=n.length;++c<u;){if(i=n[c],s=i.subarray(0,Math.min(i.length,l-o)),l<=o+s.length){s.length<i.length?n[c]=i.subarray(s.length):s.length===i.length&&c++,a?Mf(a,s,o):a=s;break}Mf(a||(a=new Uint8Array(l)),s,o),o+=s.length}return[a||new Uint8Array(0),n.slice(c),r-(a?a.byteLength:0)]}function Ft(e,t){let n=eg(t)?t.value:t;return n instanceof e?e===Uint8Array?new e(n.buffer,n.byteOffset,n.byteLength):n:n?(typeof n=="string"&&(n=za(n)),n instanceof ArrayBuffer?new e(n):n instanceof Vd?new e(n):yE(n)?Ft(e,n.bytes()):ArrayBuffer.isView(n)?n.byteLength<=0?new e(0):new e(n.buffer,n.byteOffset,n.byteLength/e.BYTES_PER_ELEMENT):e.from(n)):new e(0)}const Vs=e=>Ft(Int32Array,e),ap=e=>Ft(BigInt64Array,e),Et=e=>Ft(Uint8Array,e),Of=e=>(e.next(),e);function*bE(e,t){const n=function*(i){yield i},r=typeof t=="string"||ArrayBuffer.isView(t)||t instanceof ArrayBuffer||t instanceof Vd?n(t):Ya(t)?t:n(t);return yield*Of((function*(i){let s=null;do s=i.next(yield Ft(e,s));while(!s.done)})(r[Symbol.iterator]())),new e}const _E=e=>bE(Uint8Array,e);function sg(e,t){return On(this,arguments,function*(){if(fi(t))return yield bt(yield bt(yield*Qo(ai(sg(e,yield bt(t))))));const r=function(a){return On(this,arguments,function*(){yield yield bt(yield bt(a))})},i=function(a){return On(this,arguments,function*(){yield bt(yield*Qo(ai(Of((function*(o){let c=null;do c=o.next(yield c?.value);while(!c.done)})(a[Symbol.iterator]())))))})},s=typeof t=="string"||ArrayBuffer.isView(t)||t instanceof ArrayBuffer||t instanceof Vd?r(t):Ya(t)?i(t):Ns(t)?t:r(t);return yield bt(yield*Qo(ai(Of((function(a){return On(this,arguments,function*(){let o=null;do o=yield bt(a.next(yield yield bt(Ft(e,o))));while(!o.done)})})(s[Symbol.asyncIterator]()))))),yield bt(new e)})}const wE=e=>sg(Uint8Array,e);function ag(e,t,n){if(e!==0){n=n.slice(0,t);for(let r=-1,i=n.length;++r<i;)n[r]+=e}return n.subarray(0,t)}function vE(e,t){let n=0;const r=e.length;if(r!==t.length)return!1;if(r>0)do if(e[n]!==t[n])return!1;while(++n<r);return!0}const qe={fromIterable(e){return To(xE(e))},fromAsyncIterable(e){return To(SE(e))},fromDOMStream(e){return To(EE(e))},fromNodeStream(e){return To(AE(e))},toDOMStream(e,t){throw new Error('"toDOMStream" not available in this environment')},toNodeStream(e,t){throw new Error('"toNodeStream" not available in this environment')}},To=e=>(e.next(),e);function*xE(e){let t,n=!1,r=[],i,s,a,o=0;function c(){return s==="peek"?Cn(r,a)[0]:([i,r,o]=Cn(r,a),i)}({cmd:s,size:a}=(yield null)||{cmd:"read",size:0});const l=_E(e)[Symbol.iterator]();try{do if({done:t,value:i}=Number.isNaN(a-o)?l.next():l.next(a-o),!t&&i.byteLength>0&&(r.push(i),o+=i.byteLength),t||a<=o)do({cmd:s,size:a}=yield c());while(a<o);while(!t)}catch(u){(n=!0)&&typeof l.throw=="function"&&l.throw(u)}finally{n===!1&&typeof l.return=="function"&&l.return(null)}return null}function SE(e){return On(this,arguments,function*(){let n,r=!1,i=[],s,a,o,c=0;function l(){return a==="peek"?Cn(i,o)[0]:([s,i,c]=Cn(i,o),s)}({cmd:a,size:o}=(yield yield bt(null))||{cmd:"read",size:0});const u=wE(e)[Symbol.asyncIterator]();try{do if({done:n,value:s}=Number.isNaN(o-c)?yield bt(u.next()):yield bt(u.next(o-c)),!n&&s.byteLength>0&&(i.push(s),c+=s.byteLength),n||o<=c)do({cmd:a,size:o}=yield yield bt(l()));while(o<c);while(!n)}catch(f){(r=!0)&&typeof u.throw=="function"&&(yield bt(u.throw(f)))}finally{r===!1&&typeof u.return=="function"&&(yield bt(u.return(new Uint8Array(0))))}return yield bt(null)})}function EE(e){return On(this,arguments,function*(){let n=!1,r=!1,i=[],s,a,o,c=0;function l(){return a==="peek"?Cn(i,o)[0]:([s,i,c]=Cn(i,o),s)}({cmd:a,size:o}=(yield yield bt(null))||{cmd:"read",size:0});const u=new TE(e);try{do if({done:n,value:s}=Number.isNaN(o-c)?yield bt(u.read()):yield bt(u.read(o-c)),!n&&s.byteLength>0&&(i.push(Et(s)),c+=s.byteLength),n||o<=c)do({cmd:a,size:o}=yield yield bt(l()));while(o<c);while(!n)}catch(f){(r=!0)&&(yield bt(u.cancel(f)))}finally{r===!1?yield bt(u.cancel()):e.locked&&u.releaseLock()}return yield bt(null)})}class TE{constructor(t){this.source=t,this.reader=null,this.reader=this.source.getReader(),this.reader.closed.catch(()=>{})}get closed(){return this.reader?this.reader.closed.catch(()=>{}):Promise.resolve()}releaseLock(){this.reader&&this.reader.releaseLock(),this.reader=null}cancel(t){return dt(this,void 0,void 0,function*(){const{reader:n,source:r}=this;n&&(yield n.cancel(t).catch(()=>{})),r&&r.locked&&this.releaseLock()})}read(t){return dt(this,void 0,void 0,function*(){if(t===0)return{done:this.reader==null,value:new Uint8Array(0)};const n=yield this.reader.read();return!n.done&&(n.value=Et(n)),n})}}const Mu=(e,t)=>{const n=i=>r([t,i]);let r;return[t,n,new Promise(i=>(r=i)&&e.once(t,n))]};function AE(e){return On(this,arguments,function*(){const n=[];let r="error",i=!1,s=null,a,o,c=0,l=[],u;function f(){return a==="peek"?Cn(l,o)[0]:([u,l,c]=Cn(l,o),u)}if({cmd:a,size:o}=(yield yield bt(null))||{cmd:"read",size:0},e.isTTY)return yield yield bt(new Uint8Array(0)),yield bt(null);try{n[0]=Mu(e,"end"),n[1]=Mu(e,"error");do{if(n[2]=Mu(e,"readable"),[r,s]=yield bt(Promise.race(n.map(h=>h[2]))),r==="error")break;if((i=r==="end")||(Number.isFinite(o-c)?(u=Et(e.read(o-c)),u.byteLength<o-c&&(u=Et(e.read()))):u=Et(e.read()),u.byteLength>0&&(l.push(u),c+=u.byteLength)),i||o<=c)do({cmd:a,size:o}=yield yield bt(f()));while(o<c)}while(!i)}finally{yield bt(d(n,r==="error"?s:null))}return yield bt(null);function d(h,p){return u=l=null,new Promise((y,g)=>{for(const[b,_]of h)e.off(b,_);try{const b=e.destroy;b&&b.call(e,p),p=void 0}catch(b){p=b||p}finally{p!=null?g(p):y()}})}})}var qt;(function(e){e[e.V1=0]="V1",e[e.V2=1]="V2",e[e.V3=2]="V3",e[e.V4=3]="V4",e[e.V5=4]="V5"})(qt||(qt={}));var ye;(function(e){e[e.Sparse=0]="Sparse",e[e.Dense=1]="Dense"})(ye||(ye={}));var ie;(function(e){e[e.HALF=0]="HALF",e[e.SINGLE=1]="SINGLE",e[e.DOUBLE=2]="DOUBLE"})(ie||(ie={}));var nn;(function(e){e[e.DAY=0]="DAY",e[e.MILLISECOND=1]="MILLISECOND"})(nn||(nn={}));var Q;(function(e){e[e.SECOND=0]="SECOND",e[e.MILLISECOND=1]="MILLISECOND",e[e.MICROSECOND=2]="MICROSECOND",e[e.NANOSECOND=3]="NANOSECOND"})(Q||(Q={}));var Bn;(function(e){e[e.YEAR_MONTH=0]="YEAR_MONTH",e[e.DAY_TIME=1]="DAY_TIME",e[e.MONTH_DAY_NANO=2]="MONTH_DAY_NANO"})(Bn||(Bn={}));const Ou=2,Tn=4,er=4,Dt=4,Mr=new Int32Array(2),op=new Float32Array(Mr.buffer),cp=new Float64Array(Mr.buffer),Ao=new Uint16Array(new Uint8Array([1,0]).buffer)[0]===1;var Rf;(function(e){e[e.UTF8_BYTES=1]="UTF8_BYTES",e[e.UTF16_STRING=2]="UTF16_STRING"})(Rf||(Rf={}));let os=class og{constructor(t){this.bytes_=t,this.position_=0,this.text_decoder_=new TextDecoder}static allocate(t){return new og(new Uint8Array(t))}clear(){this.position_=0}bytes(){return this.bytes_}position(){return this.position_}setPosition(t){this.position_=t}capacity(){return this.bytes_.length}readInt8(t){return this.readUint8(t)<<24>>24}readUint8(t){return this.bytes_[t]}readInt16(t){return this.readUint16(t)<<16>>16}readUint16(t){return this.bytes_[t]|this.bytes_[t+1]<<8}readInt32(t){return this.bytes_[t]|this.bytes_[t+1]<<8|this.bytes_[t+2]<<16|this.bytes_[t+3]<<24}readUint32(t){return this.readInt32(t)>>>0}readInt64(t){return BigInt.asIntN(64,BigInt(this.readUint32(t))+(BigInt(this.readUint32(t+4))<<BigInt(32)))}readUint64(t){return BigInt.asUintN(64,BigInt(this.readUint32(t))+(BigInt(this.readUint32(t+4))<<BigInt(32)))}readFloat32(t){return Mr[0]=this.readInt32(t),op[0]}readFloat64(t){return Mr[Ao?0:1]=this.readInt32(t),Mr[Ao?1:0]=this.readInt32(t+4),cp[0]}writeInt8(t,n){this.bytes_[t]=n}writeUint8(t,n){this.bytes_[t]=n}writeInt16(t,n){this.bytes_[t]=n,this.bytes_[t+1]=n>>8}writeUint16(t,n){this.bytes_[t]=n,this.bytes_[t+1]=n>>8}writeInt32(t,n){this.bytes_[t]=n,this.bytes_[t+1]=n>>8,this.bytes_[t+2]=n>>16,this.bytes_[t+3]=n>>24}writeUint32(t,n){this.bytes_[t]=n,this.bytes_[t+1]=n>>8,this.bytes_[t+2]=n>>16,this.bytes_[t+3]=n>>24}writeInt64(t,n){this.writeInt32(t,Number(BigInt.asIntN(32,n))),this.writeInt32(t+4,Number(BigInt.asIntN(32,n>>BigInt(32))))}writeUint64(t,n){this.writeUint32(t,Number(BigInt.asUintN(32,n))),this.writeUint32(t+4,Number(BigInt.asUintN(32,n>>BigInt(32))))}writeFloat32(t,n){op[0]=n,this.writeInt32(t,Mr[0])}writeFloat64(t,n){cp[0]=n,this.writeInt32(t,Mr[Ao?0:1]),this.writeInt32(t+4,Mr[Ao?1:0])}getBufferIdentifier(){if(this.bytes_.length<this.position_+Tn+er)throw new Error("FlatBuffers: ByteBuffer is too short to contain an identifier.");let t="";for(let n=0;n<er;n++)t+=String.fromCharCode(this.readInt8(this.position_+Tn+n));return t}__offset(t,n){const r=t-this.readInt32(t);return n<this.readInt16(r)?this.readInt16(r+n):0}__union(t,n){return t.bb_pos=n+this.readInt32(n),t.bb=this,t}__string(t,n){t+=this.readInt32(t);const r=this.readInt32(t);t+=Tn;const i=this.bytes_.subarray(t,t+r);return n===Rf.UTF8_BYTES?i:this.text_decoder_.decode(i)}__union_with_string(t,n){return typeof t=="string"?this.__string(n):this.__union(t,n)}__indirect(t){return t+this.readInt32(t)}__vector(t){return t+this.readInt32(t)+Tn}__vector_len(t){return this.readInt32(t+this.readInt32(t))}__has_identifier(t){if(t.length!=er)throw new Error("FlatBuffers: file identifier must be length "+er);for(let n=0;n<er;n++)if(t.charCodeAt(n)!=this.readInt8(this.position()+Tn+n))return!1;return!0}createScalarList(t,n){const r=[];for(let i=0;i<n;++i){const s=t(i);s!==null&&r.push(s)}return r}createObjList(t,n){const r=[];for(let i=0;i<n;++i){const s=t(i);s!==null&&r.push(s.unpack())}return r}},cg=class lg{constructor(t){this.minalign=1,this.vtable=null,this.vtable_in_use=0,this.isNested=!1,this.object_start=0,this.vtables=[],this.vector_num_elems=0,this.force_defaults=!1,this.string_maps=null,this.text_encoder=new TextEncoder;let n;t?n=t:n=1024,this.bb=os.allocate(n),this.space=n}clear(){this.bb.clear(),this.space=this.bb.capacity(),this.minalign=1,this.vtable=null,this.vtable_in_use=0,this.isNested=!1,this.object_start=0,this.vtables=[],this.vector_num_elems=0,this.force_defaults=!1,this.string_maps=null}forceDefaults(t){this.force_defaults=t}dataBuffer(){return this.bb}asUint8Array(){return this.bb.bytes().subarray(this.bb.position(),this.bb.position()+this.offset())}prep(t,n){t>this.minalign&&(this.minalign=t);const r=~(this.bb.capacity()-this.space+n)+1&t-1;for(;this.space<r+t+n;){const i=this.bb.capacity();this.bb=lg.growByteBuffer(this.bb),this.space+=this.bb.capacity()-i}this.pad(r)}pad(t){for(let n=0;n<t;n++)this.bb.writeInt8(--this.space,0)}writeInt8(t){this.bb.writeInt8(this.space-=1,t)}writeInt16(t){this.bb.writeInt16(this.space-=2,t)}writeInt32(t){this.bb.writeInt32(this.space-=4,t)}writeInt64(t){this.bb.writeInt64(this.space-=8,t)}writeFloat32(t){this.bb.writeFloat32(this.space-=4,t)}writeFloat64(t){this.bb.writeFloat64(this.space-=8,t)}addInt8(t){this.prep(1,0),this.writeInt8(t)}addInt16(t){this.prep(2,0),this.writeInt16(t)}addInt32(t){this.prep(4,0),this.writeInt32(t)}addInt64(t){this.prep(8,0),this.writeInt64(t)}addFloat32(t){this.prep(4,0),this.writeFloat32(t)}addFloat64(t){this.prep(8,0),this.writeFloat64(t)}addFieldInt8(t,n,r){(this.force_defaults||n!=r)&&(this.addInt8(n),this.slot(t))}addFieldInt16(t,n,r){(this.force_defaults||n!=r)&&(this.addInt16(n),this.slot(t))}addFieldInt32(t,n,r){(this.force_defaults||n!=r)&&(this.addInt32(n),this.slot(t))}addFieldInt64(t,n,r){(this.force_defaults||n!==r)&&(this.addInt64(n),this.slot(t))}addFieldFloat32(t,n,r){(this.force_defaults||n!=r)&&(this.addFloat32(n),this.slot(t))}addFieldFloat64(t,n,r){(this.force_defaults||n!=r)&&(this.addFloat64(n),this.slot(t))}addFieldOffset(t,n,r){(this.force_defaults||n!=r)&&(this.addOffset(n),this.slot(t))}addFieldStruct(t,n,r){n!=r&&(this.nested(n),this.slot(t))}nested(t){if(t!=this.offset())throw new TypeError("FlatBuffers: struct must be serialized inline.")}notNested(){if(this.isNested)throw new TypeError("FlatBuffers: object serialization must not be nested.")}slot(t){this.vtable!==null&&(this.vtable[t]=this.offset())}offset(){return this.bb.capacity()-this.space}static growByteBuffer(t){const n=t.capacity();if(n&3221225472)throw new Error("FlatBuffers: cannot grow buffer beyond 2 gigabytes.");const r=n<<1,i=os.allocate(r);return i.setPosition(r-n),i.bytes().set(t.bytes(),r-n),i}addOffset(t){this.prep(Tn,0),this.writeInt32(this.offset()-t+Tn)}startObject(t){this.notNested(),this.vtable==null&&(this.vtable=[]),this.vtable_in_use=t;for(let n=0;n<t;n++)this.vtable[n]=0;this.isNested=!0,this.object_start=this.offset()}endObject(){if(this.vtable==null||!this.isNested)throw new Error("FlatBuffers: endObject called without startObject");this.addInt32(0);const t=this.offset();let n=this.vtable_in_use-1;for(;n>=0&&this.vtable[n]==0;n--);const r=n+1;for(;n>=0;n--)this.addInt16(this.vtable[n]!=0?t-this.vtable[n]:0);const i=2;this.addInt16(t-this.object_start);const s=(r+i)*Ou;this.addInt16(s);let a=0;const o=this.space;t:for(n=0;n<this.vtables.length;n++){const c=this.bb.capacity()-this.vtables[n];if(s==this.bb.readInt16(c)){for(let l=Ou;l<s;l+=Ou)if(this.bb.readInt16(o+l)!=this.bb.readInt16(c+l))continue t;a=this.vtables[n];break}}return a?(this.space=this.bb.capacity()-t,this.bb.writeInt32(this.space,a-t)):(this.vtables.push(this.offset()),this.bb.writeInt32(this.bb.capacity()-t,this.offset()-t)),this.isNested=!1,t}finish(t,n,r){const i=r?Dt:0;if(n){const s=n;if(this.prep(this.minalign,Tn+er+i),s.length!=er)throw new TypeError("FlatBuffers: file identifier must be length "+er);for(let a=er-1;a>=0;a--)this.writeInt8(s.charCodeAt(a))}this.prep(this.minalign,Tn+i),this.addOffset(t),i&&this.addInt32(this.bb.capacity()-this.space),this.bb.setPosition(this.space)}finishSizePrefixed(t,n){this.finish(t,n,!0)}requiredField(t,n){const r=this.bb.capacity()-t,i=r-this.bb.readInt32(r);if(!(n<this.bb.readInt16(i)&&this.bb.readInt16(i+n)!=0))throw new TypeError("FlatBuffers: field "+n+" must be set")}startVector(t,n,r){this.notNested(),this.vector_num_elems=n,this.prep(Tn,t*n),this.prep(r,t*n)}endVector(){return this.writeInt32(this.vector_num_elems),this.offset()}createSharedString(t){if(!t)return 0;if(this.string_maps||(this.string_maps=new Map),this.string_maps.has(t))return this.string_maps.get(t);const n=this.createString(t);return this.string_maps.set(t,n),n}createString(t){if(t==null)return 0;let n;return t instanceof Uint8Array?n=t:n=this.text_encoder.encode(t),this.addInt8(0),this.startVector(1,n.length,1),this.bb.setPosition(this.space-=n.length),this.bb.bytes().set(n,this.space),this.endVector()}createByteVector(t){return t==null?0:(this.startVector(1,t.length,1),this.bb.setPosition(this.space-=t.length),this.bb.bytes().set(t,this.space),this.endVector())}createObjectOffset(t){return t===null?0:typeof t=="string"?this.createString(t):t.pack(this)}createObjectOffsetList(t){const n=[];for(let r=0;r<t.length;++r){const i=t[r];if(i!==null)n.push(this.createObjectOffset(i));else throw new TypeError("FlatBuffers: Argument for createObjectOffsetList cannot contain null.")}return n}createStructOffsetList(t,n){return n(this,t.length),this.createObjectOffsetList(t.slice().reverse()),this.endVector()}};var gc;(function(e){e[e.BUFFER=0]="BUFFER"})(gc||(gc={}));var bc;(function(e){e[e.LZ4_FRAME=0]="LZ4_FRAME",e[e.ZSTD=1]="ZSTD"})(bc||(bc={}));class Or{constructor(){this.bb=null,this.bb_pos=0}__init(t,n){return this.bb_pos=t,this.bb=n,this}static getRootAsBodyCompression(t,n){return(n||new Or).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsBodyCompression(t,n){return t.setPosition(t.position()+Dt),(n||new Or).__init(t.readInt32(t.position())+t.position(),t)}codec(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt8(this.bb_pos+t):bc.LZ4_FRAME}method(){const t=this.bb.__offset(this.bb_pos,6);return t?this.bb.readInt8(this.bb_pos+t):gc.BUFFER}static startBodyCompression(t){t.startObject(2)}static addCodec(t,n){t.addFieldInt8(0,n,bc.LZ4_FRAME)}static addMethod(t,n){t.addFieldInt8(1,n,gc.BUFFER)}static endBodyCompression(t){return t.endObject()}static createBodyCompression(t,n,r){return Or.startBodyCompression(t),Or.addCodec(t,n),Or.addMethod(t,r),Or.endBodyCompression(t)}}class ug{constructor(){this.bb=null,this.bb_pos=0}__init(t,n){return this.bb_pos=t,this.bb=n,this}offset(){return this.bb.readInt64(this.bb_pos)}length(){return this.bb.readInt64(this.bb_pos+8)}static sizeOf(){return 16}static createBuffer(t,n,r){return t.prep(8,16),t.writeInt64(BigInt(r??0)),t.writeInt64(BigInt(n??0)),t.offset()}}let fg=class{constructor(){this.bb=null,this.bb_pos=0}__init(t,n){return this.bb_pos=t,this.bb=n,this}length(){return this.bb.readInt64(this.bb_pos)}nullCount(){return this.bb.readInt64(this.bb_pos+8)}static sizeOf(){return 16}static createFieldNode(t,n,r){return t.prep(8,16),t.writeInt64(BigInt(r??0)),t.writeInt64(BigInt(n??0)),t.offset()}},Jn=class Df{constructor(){this.bb=null,this.bb_pos=0}__init(t,n){return this.bb_pos=t,this.bb=n,this}static getRootAsRecordBatch(t,n){return(n||new Df).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsRecordBatch(t,n){return t.setPosition(t.position()+Dt),(n||new Df).__init(t.readInt32(t.position())+t.position(),t)}length(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt64(this.bb_pos+t):BigInt("0")}nodes(t,n){const r=this.bb.__offset(this.bb_pos,6);return r?(n||new fg).__init(this.bb.__vector(this.bb_pos+r)+t*16,this.bb):null}nodesLength(){const t=this.bb.__offset(this.bb_pos,6);return t?this.bb.__vector_len(this.bb_pos+t):0}buffers(t,n){const r=this.bb.__offset(this.bb_pos,8);return r?(n||new ug).__init(this.bb.__vector(this.bb_pos+r)+t*16,this.bb):null}buffersLength(){const t=this.bb.__offset(this.bb_pos,8);return t?this.bb.__vector_len(this.bb_pos+t):0}compression(t){const n=this.bb.__offset(this.bb_pos,10);return n?(t||new Or).__init(this.bb.__indirect(this.bb_pos+n),this.bb):null}static startRecordBatch(t){t.startObject(4)}static addLength(t,n){t.addFieldInt64(0,n,BigInt("0"))}static addNodes(t,n){t.addFieldOffset(1,n,0)}static startNodesVector(t,n){t.startVector(16,n,8)}static addBuffers(t,n){t.addFieldOffset(2,n,0)}static startBuffersVector(t,n){t.startVector(16,n,8)}static addCompression(t,n){t.addFieldOffset(3,n,0)}static endRecordBatch(t){return t.endObject()}},Ui=class Lf{constructor(){this.bb=null,this.bb_pos=0}__init(t,n){return this.bb_pos=t,this.bb=n,this}static getRootAsDictionaryBatch(t,n){return(n||new Lf).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsDictionaryBatch(t,n){return t.setPosition(t.position()+Dt),(n||new Lf).__init(t.readInt32(t.position())+t.position(),t)}id(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt64(this.bb_pos+t):BigInt("0")}data(t){const n=this.bb.__offset(this.bb_pos,6);return n?(t||new Jn).__init(this.bb.__indirect(this.bb_pos+n),this.bb):null}isDelta(){const t=this.bb.__offset(this.bb_pos,8);return t?!!this.bb.readInt8(this.bb_pos+t):!1}static startDictionaryBatch(t){t.startObject(3)}static addId(t,n){t.addFieldInt64(0,n,BigInt("0"))}static addData(t,n){t.addFieldOffset(1,n,0)}static addIsDelta(t,n){t.addFieldInt8(2,+n,0)}static endDictionaryBatch(t){return t.endObject()}};var cs;(function(e){e[e.Little=0]="Little",e[e.Big=1]="Big"})(cs||(cs={}));var _c;(function(e){e[e.DenseArray=0]="DenseArray"})(_c||(_c={}));class Be{constructor(){this.bb=null,this.bb_pos=0}__init(t,n){return this.bb_pos=t,this.bb=n,this}static getRootAsInt(t,n){return(n||new Be).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsInt(t,n){return t.setPosition(t.position()+Dt),(n||new Be).__init(t.readInt32(t.position())+t.position(),t)}bitWidth(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt32(this.bb_pos+t):0}isSigned(){const t=this.bb.__offset(this.bb_pos,6);return t?!!this.bb.readInt8(this.bb_pos+t):!1}static startInt(t){t.startObject(2)}static addBitWidth(t,n){t.addFieldInt32(0,n,0)}static addIsSigned(t,n){t.addFieldInt8(1,+n,0)}static endInt(t){return t.endObject()}static createInt(t,n,r){return Be.startInt(t),Be.addBitWidth(t,n),Be.addIsSigned(t,r),Be.endInt(t)}}class nr{constructor(){this.bb=null,this.bb_pos=0}__init(t,n){return this.bb_pos=t,this.bb=n,this}static getRootAsDictionaryEncoding(t,n){return(n||new nr).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsDictionaryEncoding(t,n){return t.setPosition(t.position()+Dt),(n||new nr).__init(t.readInt32(t.position())+t.position(),t)}id(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt64(this.bb_pos+t):BigInt("0")}indexType(t){const n=this.bb.__offset(this.bb_pos,6);return n?(t||new Be).__init(this.bb.__indirect(this.bb_pos+n),this.bb):null}isOrdered(){const t=this.bb.__offset(this.bb_pos,8);return t?!!this.bb.readInt8(this.bb_pos+t):!1}dictionaryKind(){const t=this.bb.__offset(this.bb_pos,10);return t?this.bb.readInt16(this.bb_pos+t):_c.DenseArray}static startDictionaryEncoding(t){t.startObject(4)}static addId(t,n){t.addFieldInt64(0,n,BigInt("0"))}static addIndexType(t,n){t.addFieldOffset(1,n,0)}static addIsOrdered(t,n){t.addFieldInt8(2,+n,0)}static addDictionaryKind(t,n){t.addFieldInt16(3,n,_c.DenseArray)}static endDictionaryEncoding(t){return t.endObject()}}class Jt{constructor(){this.bb=null,this.bb_pos=0}__init(t,n){return this.bb_pos=t,this.bb=n,this}static getRootAsKeyValue(t,n){return(n||new Jt).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsKeyValue(t,n){return t.setPosition(t.position()+Dt),(n||new Jt).__init(t.readInt32(t.position())+t.position(),t)}key(t){const n=this.bb.__offset(this.bb_pos,4);return n?this.bb.__string(this.bb_pos+n,t):null}value(t){const n=this.bb.__offset(this.bb_pos,6);return n?this.bb.__string(this.bb_pos+n,t):null}static startKeyValue(t){t.startObject(2)}static addKey(t,n){t.addFieldOffset(0,n,0)}static addValue(t,n){t.addFieldOffset(1,n,0)}static endKeyValue(t){return t.endObject()}static createKeyValue(t,n,r){return Jt.startKeyValue(t),Jt.addKey(t,n),Jt.addValue(t,r),Jt.endKeyValue(t)}}let lp=class Ks{constructor(){this.bb=null,this.bb_pos=0}__init(t,n){return this.bb_pos=t,this.bb=n,this}static getRootAsBinary(t,n){return(n||new Ks).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsBinary(t,n){return t.setPosition(t.position()+Dt),(n||new Ks).__init(t.readInt32(t.position())+t.position(),t)}static startBinary(t){t.startObject(0)}static endBinary(t){return t.endObject()}static createBinary(t){return Ks.startBinary(t),Ks.endBinary(t)}},up=class Qs{constructor(){this.bb=null,this.bb_pos=0}__init(t,n){return this.bb_pos=t,this.bb=n,this}static getRootAsBool(t,n){return(n||new Qs).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsBool(t,n){return t.setPosition(t.position()+Dt),(n||new Qs).__init(t.readInt32(t.position())+t.position(),t)}static startBool(t){t.startObject(0)}static endBool(t){return t.endObject()}static createBool(t){return Qs.startBool(t),Qs.endBool(t)}},Jo=class Pi{constructor(){this.bb=null,this.bb_pos=0}__init(t,n){return this.bb_pos=t,this.bb=n,this}static getRootAsDate(t,n){return(n||new Pi).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsDate(t,n){return t.setPosition(t.position()+Dt),(n||new Pi).__init(t.readInt32(t.position())+t.position(),t)}unit(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):nn.MILLISECOND}static startDate(t){t.startObject(1)}static addUnit(t,n){t.addFieldInt16(0,n,nn.MILLISECOND)}static endDate(t){return t.endObject()}static createDate(t,n){return Pi.startDate(t),Pi.addUnit(t,n),Pi.endDate(t)}},ji=class Ir{constructor(){this.bb=null,this.bb_pos=0}__init(t,n){return this.bb_pos=t,this.bb=n,this}static getRootAsDecimal(t,n){return(n||new Ir).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsDecimal(t,n){return t.setPosition(t.position()+Dt),(n||new Ir).__init(t.readInt32(t.position())+t.position(),t)}precision(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt32(this.bb_pos+t):0}scale(){const t=this.bb.__offset(this.bb_pos,6);return t?this.bb.readInt32(this.bb_pos+t):0}bitWidth(){const t=this.bb.__offset(this.bb_pos,8);return t?this.bb.readInt32(this.bb_pos+t):128}static startDecimal(t){t.startObject(3)}static addPrecision(t,n){t.addFieldInt32(0,n,0)}static addScale(t,n){t.addFieldInt32(1,n,0)}static addBitWidth(t,n){t.addFieldInt32(2,n,128)}static endDecimal(t){return t.endObject()}static createDecimal(t,n,r,i){return Ir.startDecimal(t),Ir.addPrecision(t,n),Ir.addScale(t,r),Ir.addBitWidth(t,i),Ir.endDecimal(t)}},Zo=class Vi{constructor(){this.bb=null,this.bb_pos=0}__init(t,n){return this.bb_pos=t,this.bb=n,this}static getRootAsDuration(t,n){return(n||new Vi).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsDuration(t,n){return t.setPosition(t.position()+Dt),(n||new Vi).__init(t.readInt32(t.position())+t.position(),t)}unit(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):Q.MILLISECOND}static startDuration(t){t.startObject(1)}static addUnit(t,n){t.addFieldInt16(0,n,Q.MILLISECOND)}static endDuration(t){return t.endObject()}static createDuration(t,n){return Vi.startDuration(t),Vi.addUnit(t,n),Vi.endDuration(t)}},tc=class zi{constructor(){this.bb=null,this.bb_pos=0}__init(t,n){return this.bb_pos=t,this.bb=n,this}static getRootAsFixedSizeBinary(t,n){return(n||new zi).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsFixedSizeBinary(t,n){return t.setPosition(t.position()+Dt),(n||new zi).__init(t.readInt32(t.position())+t.position(),t)}byteWidth(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt32(this.bb_pos+t):0}static startFixedSizeBinary(t){t.startObject(1)}static addByteWidth(t,n){t.addFieldInt32(0,n,0)}static endFixedSizeBinary(t){return t.endObject()}static createFixedSizeBinary(t,n){return zi.startFixedSizeBinary(t),zi.addByteWidth(t,n),zi.endFixedSizeBinary(t)}},ec=class Yi{constructor(){this.bb=null,this.bb_pos=0}__init(t,n){return this.bb_pos=t,this.bb=n,this}static getRootAsFixedSizeList(t,n){return(n||new Yi).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsFixedSizeList(t,n){return t.setPosition(t.position()+Dt),(n||new Yi).__init(t.readInt32(t.position())+t.position(),t)}listSize(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt32(this.bb_pos+t):0}static startFixedSizeList(t){t.startObject(1)}static addListSize(t,n){t.addFieldInt32(0,n,0)}static endFixedSizeList(t){return t.endObject()}static createFixedSizeList(t,n){return Yi.startFixedSizeList(t),Yi.addListSize(t,n),Yi.endFixedSizeList(t)}};class An{constructor(){this.bb=null,this.bb_pos=0}__init(t,n){return this.bb_pos=t,this.bb=n,this}static getRootAsFloatingPoint(t,n){return(n||new An).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsFloatingPoint(t,n){return t.setPosition(t.position()+Dt),(n||new An).__init(t.readInt32(t.position())+t.position(),t)}precision(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):ie.HALF}static startFloatingPoint(t){t.startObject(1)}static addPrecision(t,n){t.addFieldInt16(0,n,ie.HALF)}static endFloatingPoint(t){return t.endObject()}static createFloatingPoint(t,n){return An.startFloatingPoint(t),An.addPrecision(t,n),An.endFloatingPoint(t)}}class In{constructor(){this.bb=null,this.bb_pos=0}__init(t,n){return this.bb_pos=t,this.bb=n,this}static getRootAsInterval(t,n){return(n||new In).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsInterval(t,n){return t.setPosition(t.position()+Dt),(n||new In).__init(t.readInt32(t.position())+t.position(),t)}unit(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):Bn.YEAR_MONTH}static startInterval(t){t.startObject(1)}static addUnit(t,n){t.addFieldInt16(0,n,Bn.YEAR_MONTH)}static endInterval(t){return t.endObject()}static createInterval(t,n){return In.startInterval(t),In.addUnit(t,n),In.endInterval(t)}}let fp=class Js{constructor(){this.bb=null,this.bb_pos=0}__init(t,n){return this.bb_pos=t,this.bb=n,this}static getRootAsLargeBinary(t,n){return(n||new Js).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsLargeBinary(t,n){return t.setPosition(t.position()+Dt),(n||new Js).__init(t.readInt32(t.position())+t.position(),t)}static startLargeBinary(t){t.startObject(0)}static endLargeBinary(t){return t.endObject()}static createLargeBinary(t){return Js.startLargeBinary(t),Js.endLargeBinary(t)}},dp=class Zs{constructor(){this.bb=null,this.bb_pos=0}__init(t,n){return this.bb_pos=t,this.bb=n,this}static getRootAsLargeUtf8(t,n){return(n||new Zs).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsLargeUtf8(t,n){return t.setPosition(t.position()+Dt),(n||new Zs).__init(t.readInt32(t.position())+t.position(),t)}static startLargeUtf8(t){t.startObject(0)}static endLargeUtf8(t){return t.endObject()}static createLargeUtf8(t){return Zs.startLargeUtf8(t),Zs.endLargeUtf8(t)}},hp=class ta{constructor(){this.bb=null,this.bb_pos=0}__init(t,n){return this.bb_pos=t,this.bb=n,this}static getRootAsList(t,n){return(n||new ta).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsList(t,n){return t.setPosition(t.position()+Dt),(n||new ta).__init(t.readInt32(t.position())+t.position(),t)}static startList(t){t.startObject(0)}static endList(t){return t.endObject()}static createList(t){return ta.startList(t),ta.endList(t)}},nc=class Wi{constructor(){this.bb=null,this.bb_pos=0}__init(t,n){return this.bb_pos=t,this.bb=n,this}static getRootAsMap(t,n){return(n||new Wi).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsMap(t,n){return t.setPosition(t.position()+Dt),(n||new Wi).__init(t.readInt32(t.position())+t.position(),t)}keysSorted(){const t=this.bb.__offset(this.bb_pos,4);return t?!!this.bb.readInt8(this.bb_pos+t):!1}static startMap(t){t.startObject(1)}static addKeysSorted(t,n){t.addFieldInt8(0,+n,0)}static endMap(t){return t.endObject()}static createMap(t,n){return Wi.startMap(t),Wi.addKeysSorted(t,n),Wi.endMap(t)}},pp=class ea{constructor(){this.bb=null,this.bb_pos=0}__init(t,n){return this.bb_pos=t,this.bb=n,this}static getRootAsNull(t,n){return(n||new ea).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsNull(t,n){return t.setPosition(t.position()+Dt),(n||new ea).__init(t.readInt32(t.position())+t.position(),t)}static startNull(t){t.startObject(0)}static endNull(t){return t.endObject()}static createNull(t){return ea.startNull(t),ea.endNull(t)}};class ii{constructor(){this.bb=null,this.bb_pos=0}__init(t,n){return this.bb_pos=t,this.bb=n,this}static getRootAsStruct_(t,n){return(n||new ii).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsStruct_(t,n){return t.setPosition(t.position()+Dt),(n||new ii).__init(t.readInt32(t.position())+t.position(),t)}static startStruct_(t){t.startObject(0)}static endStruct_(t){return t.endObject()}static createStruct_(t){return ii.startStruct_(t),ii.endStruct_(t)}}class Ge{constructor(){this.bb=null,this.bb_pos=0}__init(t,n){return this.bb_pos=t,this.bb=n,this}static getRootAsTime(t,n){return(n||new Ge).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsTime(t,n){return t.setPosition(t.position()+Dt),(n||new Ge).__init(t.readInt32(t.position())+t.position(),t)}unit(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):Q.MILLISECOND}bitWidth(){const t=this.bb.__offset(this.bb_pos,6);return t?this.bb.readInt32(this.bb_pos+t):32}static startTime(t){t.startObject(2)}static addUnit(t,n){t.addFieldInt16(0,n,Q.MILLISECOND)}static addBitWidth(t,n){t.addFieldInt32(1,n,32)}static endTime(t){return t.endObject()}static createTime(t,n,r){return Ge.startTime(t),Ge.addUnit(t,n),Ge.addBitWidth(t,r),Ge.endTime(t)}}class Xe{constructor(){this.bb=null,this.bb_pos=0}__init(t,n){return this.bb_pos=t,this.bb=n,this}static getRootAsTimestamp(t,n){return(n||new Xe).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsTimestamp(t,n){return t.setPosition(t.position()+Dt),(n||new Xe).__init(t.readInt32(t.position())+t.position(),t)}unit(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):Q.SECOND}timezone(t){const n=this.bb.__offset(this.bb_pos,6);return n?this.bb.__string(this.bb_pos+n,t):null}static startTimestamp(t){t.startObject(2)}static addUnit(t,n){t.addFieldInt16(0,n,Q.SECOND)}static addTimezone(t,n){t.addFieldOffset(1,n,0)}static endTimestamp(t){return t.endObject()}static createTimestamp(t,n,r){return Xe.startTimestamp(t),Xe.addUnit(t,n),Xe.addTimezone(t,r),Xe.endTimestamp(t)}}class Ee{constructor(){this.bb=null,this.bb_pos=0}__init(t,n){return this.bb_pos=t,this.bb=n,this}static getRootAsUnion(t,n){return(n||new Ee).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsUnion(t,n){return t.setPosition(t.position()+Dt),(n||new Ee).__init(t.readInt32(t.position())+t.position(),t)}mode(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):ye.Sparse}typeIds(t){const n=this.bb.__offset(this.bb_pos,6);return n?this.bb.readInt32(this.bb.__vector(this.bb_pos+n)+t*4):0}typeIdsLength(){const t=this.bb.__offset(this.bb_pos,6);return t?this.bb.__vector_len(this.bb_pos+t):0}typeIdsArray(){const t=this.bb.__offset(this.bb_pos,6);return t?new Int32Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+t),this.bb.__vector_len(this.bb_pos+t)):null}static startUnion(t){t.startObject(2)}static addMode(t,n){t.addFieldInt16(0,n,ye.Sparse)}static addTypeIds(t,n){t.addFieldOffset(1,n,0)}static createTypeIdsVector(t,n){t.startVector(4,n.length,4);for(let r=n.length-1;r>=0;r--)t.addInt32(n[r]);return t.endVector()}static startTypeIdsVector(t,n){t.startVector(4,n,4)}static endUnion(t){return t.endObject()}static createUnion(t,n,r){return Ee.startUnion(t),Ee.addMode(t,n),Ee.addTypeIds(t,r),Ee.endUnion(t)}}let mp=class na{constructor(){this.bb=null,this.bb_pos=0}__init(t,n){return this.bb_pos=t,this.bb=n,this}static getRootAsUtf8(t,n){return(n||new na).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsUtf8(t,n){return t.setPosition(t.position()+Dt),(n||new na).__init(t.readInt32(t.position())+t.position(),t)}static startUtf8(t){t.startObject(0)}static endUtf8(t){return t.endObject()}static createUtf8(t){return na.startUtf8(t),na.endUtf8(t)}};var $t;(function(e){e[e.NONE=0]="NONE",e[e.Null=1]="Null",e[e.Int=2]="Int",e[e.FloatingPoint=3]="FloatingPoint",e[e.Binary=4]="Binary",e[e.Utf8=5]="Utf8",e[e.Bool=6]="Bool",e[e.Decimal=7]="Decimal",e[e.Date=8]="Date",e[e.Time=9]="Time",e[e.Timestamp=10]="Timestamp",e[e.Interval=11]="Interval",e[e.List=12]="List",e[e.Struct_=13]="Struct_",e[e.Union=14]="Union",e[e.FixedSizeBinary=15]="FixedSizeBinary",e[e.FixedSizeList=16]="FixedSizeList",e[e.Map=17]="Map",e[e.Duration=18]="Duration",e[e.LargeBinary=19]="LargeBinary",e[e.LargeUtf8=20]="LargeUtf8",e[e.LargeList=21]="LargeList",e[e.RunEndEncoded=22]="RunEndEncoded"})($t||($t={}));let He=class rc{constructor(){this.bb=null,this.bb_pos=0}__init(t,n){return this.bb_pos=t,this.bb=n,this}static getRootAsField(t,n){return(n||new rc).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsField(t,n){return t.setPosition(t.position()+Dt),(n||new rc).__init(t.readInt32(t.position())+t.position(),t)}name(t){const n=this.bb.__offset(this.bb_pos,4);return n?this.bb.__string(this.bb_pos+n,t):null}nullable(){const t=this.bb.__offset(this.bb_pos,6);return t?!!this.bb.readInt8(this.bb_pos+t):!1}typeType(){const t=this.bb.__offset(this.bb_pos,8);return t?this.bb.readUint8(this.bb_pos+t):$t.NONE}type(t){const n=this.bb.__offset(this.bb_pos,10);return n?this.bb.__union(t,this.bb_pos+n):null}dictionary(t){const n=this.bb.__offset(this.bb_pos,12);return n?(t||new nr).__init(this.bb.__indirect(this.bb_pos+n),this.bb):null}children(t,n){const r=this.bb.__offset(this.bb_pos,14);return r?(n||new rc).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+r)+t*4),this.bb):null}childrenLength(){const t=this.bb.__offset(this.bb_pos,14);return t?this.bb.__vector_len(this.bb_pos+t):0}customMetadata(t,n){const r=this.bb.__offset(this.bb_pos,16);return r?(n||new Jt).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+r)+t*4),this.bb):null}customMetadataLength(){const t=this.bb.__offset(this.bb_pos,16);return t?this.bb.__vector_len(this.bb_pos+t):0}static startField(t){t.startObject(7)}static addName(t,n){t.addFieldOffset(0,n,0)}static addNullable(t,n){t.addFieldInt8(1,+n,0)}static addTypeType(t,n){t.addFieldInt8(2,n,$t.NONE)}static addType(t,n){t.addFieldOffset(3,n,0)}static addDictionary(t,n){t.addFieldOffset(4,n,0)}static addChildren(t,n){t.addFieldOffset(5,n,0)}static createChildrenVector(t,n){t.startVector(4,n.length,4);for(let r=n.length-1;r>=0;r--)t.addOffset(n[r]);return t.endVector()}static startChildrenVector(t,n){t.startVector(4,n,4)}static addCustomMetadata(t,n){t.addFieldOffset(6,n,0)}static createCustomMetadataVector(t,n){t.startVector(4,n.length,4);for(let r=n.length-1;r>=0;r--)t.addOffset(n[r]);return t.endVector()}static startCustomMetadataVector(t,n){t.startVector(4,n,4)}static endField(t){return t.endObject()}},vn=class Xn{constructor(){this.bb=null,this.bb_pos=0}__init(t,n){return this.bb_pos=t,this.bb=n,this}static getRootAsSchema(t,n){return(n||new Xn).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsSchema(t,n){return t.setPosition(t.position()+Dt),(n||new Xn).__init(t.readInt32(t.position())+t.position(),t)}endianness(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):cs.Little}fields(t,n){const r=this.bb.__offset(this.bb_pos,6);return r?(n||new He).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+r)+t*4),this.bb):null}fieldsLength(){const t=this.bb.__offset(this.bb_pos,6);return t?this.bb.__vector_len(this.bb_pos+t):0}customMetadata(t,n){const r=this.bb.__offset(this.bb_pos,8);return r?(n||new Jt).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+r)+t*4),this.bb):null}customMetadataLength(){const t=this.bb.__offset(this.bb_pos,8);return t?this.bb.__vector_len(this.bb_pos+t):0}features(t){const n=this.bb.__offset(this.bb_pos,10);return n?this.bb.readInt64(this.bb.__vector(this.bb_pos+n)+t*8):BigInt(0)}featuresLength(){const t=this.bb.__offset(this.bb_pos,10);return t?this.bb.__vector_len(this.bb_pos+t):0}static startSchema(t){t.startObject(4)}static addEndianness(t,n){t.addFieldInt16(0,n,cs.Little)}static addFields(t,n){t.addFieldOffset(1,n,0)}static createFieldsVector(t,n){t.startVector(4,n.length,4);for(let r=n.length-1;r>=0;r--)t.addOffset(n[r]);return t.endVector()}static startFieldsVector(t,n){t.startVector(4,n,4)}static addCustomMetadata(t,n){t.addFieldOffset(2,n,0)}static createCustomMetadataVector(t,n){t.startVector(4,n.length,4);for(let r=n.length-1;r>=0;r--)t.addOffset(n[r]);return t.endVector()}static startCustomMetadataVector(t,n){t.startVector(4,n,4)}static addFeatures(t,n){t.addFieldOffset(3,n,0)}static createFeaturesVector(t,n){t.startVector(8,n.length,8);for(let r=n.length-1;r>=0;r--)t.addInt64(n[r]);return t.endVector()}static startFeaturesVector(t,n){t.startVector(8,n,8)}static endSchema(t){return t.endObject()}static finishSchemaBuffer(t,n){t.finish(n)}static finishSizePrefixedSchemaBuffer(t,n){t.finish(n,void 0,!0)}static createSchema(t,n,r,i,s){return Xn.startSchema(t),Xn.addEndianness(t,n),Xn.addFields(t,r),Xn.addCustomMetadata(t,i),Xn.addFeatures(t,s),Xn.endSchema(t)}};var It;(function(e){e[e.NONE=0]="NONE",e[e.Schema=1]="Schema",e[e.DictionaryBatch=2]="DictionaryBatch",e[e.RecordBatch=3]="RecordBatch",e[e.Tensor=4]="Tensor",e[e.SparseTensor=5]="SparseTensor"})(It||(It={}));var v;(function(e){e[e.NONE=0]="NONE",e[e.Null=1]="Null",e[e.Int=2]="Int",e[e.Float=3]="Float",e[e.Binary=4]="Binary",e[e.Utf8=5]="Utf8",e[e.Bool=6]="Bool",e[e.Decimal=7]="Decimal",e[e.Date=8]="Date",e[e.Time=9]="Time",e[e.Timestamp=10]="Timestamp",e[e.Interval=11]="Interval",e[e.List=12]="List",e[e.Struct=13]="Struct",e[e.Union=14]="Union",e[e.FixedSizeBinary=15]="FixedSizeBinary",e[e.FixedSizeList=16]="FixedSizeList",e[e.Map=17]="Map",e[e.Duration=18]="Duration",e[e.LargeBinary=19]="LargeBinary",e[e.LargeUtf8=20]="LargeUtf8",e[e.Dictionary=-1]="Dictionary",e[e.Int8=-2]="Int8",e[e.Int16=-3]="Int16",e[e.Int32=-4]="Int32",e[e.Int64=-5]="Int64",e[e.Uint8=-6]="Uint8",e[e.Uint16=-7]="Uint16",e[e.Uint32=-8]="Uint32",e[e.Uint64=-9]="Uint64",e[e.Float16=-10]="Float16",e[e.Float32=-11]="Float32",e[e.Float64=-12]="Float64",e[e.DateDay=-13]="DateDay",e[e.DateMillisecond=-14]="DateMillisecond",e[e.TimestampSecond=-15]="TimestampSecond",e[e.TimestampMillisecond=-16]="TimestampMillisecond",e[e.TimestampMicrosecond=-17]="TimestampMicrosecond",e[e.TimestampNanosecond=-18]="TimestampNanosecond",e[e.TimeSecond=-19]="TimeSecond",e[e.TimeMillisecond=-20]="TimeMillisecond",e[e.TimeMicrosecond=-21]="TimeMicrosecond",e[e.TimeNanosecond=-22]="TimeNanosecond",e[e.DenseUnion=-23]="DenseUnion",e[e.SparseUnion=-24]="SparseUnion",e[e.IntervalDayTime=-25]="IntervalDayTime",e[e.IntervalYearMonth=-26]="IntervalYearMonth",e[e.DurationSecond=-27]="DurationSecond",e[e.DurationMillisecond=-28]="DurationMillisecond",e[e.DurationMicrosecond=-29]="DurationMicrosecond",e[e.DurationNanosecond=-30]="DurationNanosecond"})(v||(v={}));var Zn;(function(e){e[e.OFFSET=0]="OFFSET",e[e.DATA=1]="DATA",e[e.VALIDITY=2]="VALIDITY",e[e.TYPE=3]="TYPE"})(Zn||(Zn={}));const IE=void 0;function di(e){if(e===null)return"null";if(e===IE)return"undefined";switch(typeof e){case"number":return`${e}`;case"bigint":return`${e}`;case"string":return`"${e}"`}return typeof e[Symbol.toPrimitive]=="function"?e[Symbol.toPrimitive]("string"):ArrayBuffer.isView(e)?e instanceof BigInt64Array||e instanceof BigUint64Array?`[${[...e].map(t=>di(t))}]`:`[${e}]`:ArrayBuffer.isView(e)?`[${e}]`:JSON.stringify(e,(t,n)=>typeof n=="bigint"?`${n}`:n)}function Ct(e){if(typeof e=="bigint"&&(e<Number.MIN_SAFE_INTEGER||e>Number.MAX_SAFE_INTEGER))throw new TypeError(`${e} is not safe to convert to a number.`);return Number(e)}function dg(e,t){return Ct(e/t)+Ct(e%t)/Ct(t)}const NE=Symbol.for("isArrowBigNum");function yn(e,...t){return t.length===0?Object.setPrototypeOf(Ft(this.TypedArray,e),this.constructor.prototype):Object.setPrototypeOf(new this.TypedArray(e,...t),this.constructor.prototype)}yn.prototype[NE]=!0;yn.prototype.toJSON=function(){return`"${_a(this)}"`};yn.prototype.valueOf=function(e){return hg(this,e)};yn.prototype.toString=function(){return _a(this)};yn.prototype[Symbol.toPrimitive]=function(e="default"){switch(e){case"number":return hg(this);case"string":return _a(this);case"default":return RE(this)}return _a(this)};function Zi(...e){return yn.apply(this,e)}function ts(...e){return yn.apply(this,e)}function ba(...e){return yn.apply(this,e)}Object.setPrototypeOf(Zi.prototype,Object.create(Int32Array.prototype));Object.setPrototypeOf(ts.prototype,Object.create(Uint32Array.prototype));Object.setPrototypeOf(ba.prototype,Object.create(Uint32Array.prototype));Object.assign(Zi.prototype,yn.prototype,{constructor:Zi,signed:!0,TypedArray:Int32Array,BigIntArray:BigInt64Array});Object.assign(ts.prototype,yn.prototype,{constructor:ts,signed:!1,TypedArray:Uint32Array,BigIntArray:BigUint64Array});Object.assign(ba.prototype,yn.prototype,{constructor:ba,signed:!0,TypedArray:Uint32Array,BigIntArray:BigUint64Array});const ME=BigInt(4294967296)*BigInt(4294967296),OE=ME-BigInt(1);function hg(e,t){const{buffer:n,byteOffset:r,byteLength:i,signed:s}=e,a=new BigUint64Array(n,r,i/8),o=s&&a.at(-1)&BigInt(1)<<BigInt(63);let c=BigInt(0),l=0;if(o){for(const u of a)c|=(u^OE)*(BigInt(1)<<BigInt(64*l++));c*=BigInt(-1),c-=BigInt(1)}else for(const u of a)c|=u*(BigInt(1)<<BigInt(64*l++));if(typeof t=="number"){const u=BigInt(Math.pow(10,t)),f=c/u,d=c%u;return Ct(f)+Ct(d)/Ct(u)}return Ct(c)}function _a(e){if(e.byteLength===8)return`${new e.BigIntArray(e.buffer,e.byteOffset,1)[0]}`;if(!e.signed)return Ru(e);let t=new Uint16Array(e.buffer,e.byteOffset,e.byteLength/2);if(new Int16Array([t.at(-1)])[0]>=0)return Ru(e);t=t.slice();let r=1;for(let s=0;s<t.length;s++){const a=t[s],o=~a+r;t[s]=o,r&=a===0?1:0}return`-${Ru(t)}`}function RE(e){return e.byteLength===8?new e.BigIntArray(e.buffer,e.byteOffset,1)[0]:_a(e)}function Ru(e){let t="";const n=new Uint32Array(2);let r=new Uint16Array(e.buffer,e.byteOffset,e.byteLength/2);const i=new Uint32Array((r=new Uint16Array(r).reverse()).buffer);let s=-1;const a=r.length-1;do{for(n[0]=r[s=0];s<a;)r[s++]=n[1]=n[0]/10,n[0]=(n[0]-n[1]*10<<16)+r[s];r[s]=n[1]=n[0]/10,n[0]=n[0]-n[1]*10,t=`${n[0]}${t}`}while(i[0]||i[1]||i[2]||i[3]);return t??"0"}class zd{static new(t,n){switch(n){case!0:return new Zi(t);case!1:return new ts(t)}switch(t.constructor){case Int8Array:case Int16Array:case Int32Array:case BigInt64Array:return new Zi(t)}return t.byteLength===16?new ba(t):new ts(t)}static signed(t){return new Zi(t)}static unsigned(t){return new ts(t)}static decimal(t){return new ba(t)}constructor(t,n){return zd.new(t,n)}}var pg,mg,yg,gg,bg,_g,wg,vg,xg,Sg,Eg,Tg,Ag,Ig,Ng,Mg,Og,Rg,Dg,Lg,Fg,kg;class X{static isNull(t){return t?.typeId===v.Null}static isInt(t){return t?.typeId===v.Int}static isFloat(t){return t?.typeId===v.Float}static isBinary(t){return t?.typeId===v.Binary}static isLargeBinary(t){return t?.typeId===v.LargeBinary}static isUtf8(t){return t?.typeId===v.Utf8}static isLargeUtf8(t){return t?.typeId===v.LargeUtf8}static isBool(t){return t?.typeId===v.Bool}static isDecimal(t){return t?.typeId===v.Decimal}static isDate(t){return t?.typeId===v.Date}static isTime(t){return t?.typeId===v.Time}static isTimestamp(t){return t?.typeId===v.Timestamp}static isInterval(t){return t?.typeId===v.Interval}static isDuration(t){return t?.typeId===v.Duration}static isList(t){return t?.typeId===v.List}static isStruct(t){return t?.typeId===v.Struct}static isUnion(t){return t?.typeId===v.Union}static isFixedSizeBinary(t){return t?.typeId===v.FixedSizeBinary}static isFixedSizeList(t){return t?.typeId===v.FixedSizeList}static isMap(t){return t?.typeId===v.Map}static isDictionary(t){return t?.typeId===v.Dictionary}static isDenseUnion(t){return X.isUnion(t)&&t.mode===ye.Dense}static isSparseUnion(t){return X.isUnion(t)&&t.mode===ye.Sparse}constructor(t){this.typeId=t}}pg=Symbol.toStringTag;X[pg]=(e=>(e.children=null,e.ArrayType=Array,e.OffsetArrayType=Int32Array,e[Symbol.toStringTag]="DataType"))(X.prototype);class lr extends X{constructor(){super(v.Null)}toString(){return"Null"}}mg=Symbol.toStringTag;lr[mg]=(e=>e[Symbol.toStringTag]="Null")(lr.prototype);class Ne extends X{constructor(t,n){super(v.Int),this.isSigned=t,this.bitWidth=n}get ArrayType(){switch(this.bitWidth){case 8:return this.isSigned?Int8Array:Uint8Array;case 16:return this.isSigned?Int16Array:Uint16Array;case 32:return this.isSigned?Int32Array:Uint32Array;case 64:return this.isSigned?BigInt64Array:BigUint64Array}throw new Error(`Unrecognized ${this[Symbol.toStringTag]} type`)}toString(){return`${this.isSigned?"I":"Ui"}nt${this.bitWidth}`}}yg=Symbol.toStringTag;Ne[yg]=(e=>(e.isSigned=null,e.bitWidth=null,e[Symbol.toStringTag]="Int"))(Ne.prototype);class Cg extends Ne{constructor(){super(!0,8)}get ArrayType(){return Int8Array}}class Bg extends Ne{constructor(){super(!0,16)}get ArrayType(){return Int16Array}}class hi extends Ne{constructor(){super(!0,32)}get ArrayType(){return Int32Array}}let Yd=class extends Ne{constructor(){super(!0,64)}get ArrayType(){return BigInt64Array}};class $g extends Ne{constructor(){super(!1,8)}get ArrayType(){return Uint8Array}}class Ug extends Ne{constructor(){super(!1,16)}get ArrayType(){return Uint16Array}}class Pg extends Ne{constructor(){super(!1,32)}get ArrayType(){return Uint32Array}}let jg=class extends Ne{constructor(){super(!1,64)}get ArrayType(){return BigUint64Array}};Object.defineProperty(Cg.prototype,"ArrayType",{value:Int8Array});Object.defineProperty(Bg.prototype,"ArrayType",{value:Int16Array});Object.defineProperty(hi.prototype,"ArrayType",{value:Int32Array});Object.defineProperty(Yd.prototype,"ArrayType",{value:BigInt64Array});Object.defineProperty($g.prototype,"ArrayType",{value:Uint8Array});Object.defineProperty(Ug.prototype,"ArrayType",{value:Uint16Array});Object.defineProperty(Pg.prototype,"ArrayType",{value:Uint32Array});Object.defineProperty(jg.prototype,"ArrayType",{value:BigUint64Array});class ls extends X{constructor(t){super(v.Float),this.precision=t}get ArrayType(){switch(this.precision){case ie.HALF:return Uint16Array;case ie.SINGLE:return Float32Array;case ie.DOUBLE:return Float64Array}throw new Error(`Unrecognized ${this[Symbol.toStringTag]} type`)}toString(){return`Float${this.precision<<5||16}`}}gg=Symbol.toStringTag;ls[gg]=(e=>(e.precision=null,e[Symbol.toStringTag]="Float"))(ls.prototype);class Vg extends ls{constructor(){super(ie.SINGLE)}}class Wd extends ls{constructor(){super(ie.DOUBLE)}}Object.defineProperty(Vg.prototype,"ArrayType",{value:Float32Array});Object.defineProperty(Wd.prototype,"ArrayType",{value:Float64Array});class wc extends X{constructor(){super(v.Binary)}toString(){return"Binary"}}bg=Symbol.toStringTag;wc[bg]=(e=>(e.ArrayType=Uint8Array,e[Symbol.toStringTag]="Binary"))(wc.prototype);class vc extends X{constructor(){super(v.LargeBinary)}toString(){return"LargeBinary"}}_g=Symbol.toStringTag;vc[_g]=(e=>(e.ArrayType=Uint8Array,e.OffsetArrayType=BigInt64Array,e[Symbol.toStringTag]="LargeBinary"))(vc.prototype);class wa extends X{constructor(){super(v.Utf8)}toString(){return"Utf8"}}wg=Symbol.toStringTag;wa[wg]=(e=>(e.ArrayType=Uint8Array,e[Symbol.toStringTag]="Utf8"))(wa.prototype);class xc extends X{constructor(){super(v.LargeUtf8)}toString(){return"LargeUtf8"}}vg=Symbol.toStringTag;xc[vg]=(e=>(e.ArrayType=Uint8Array,e.OffsetArrayType=BigInt64Array,e[Symbol.toStringTag]="LargeUtf8"))(xc.prototype);class va extends X{constructor(){super(v.Bool)}toString(){return"Bool"}}xg=Symbol.toStringTag;va[xg]=(e=>(e.ArrayType=Uint8Array,e[Symbol.toStringTag]="Bool"))(va.prototype);class Sc extends X{constructor(t,n,r=128){super(v.Decimal),this.scale=t,this.precision=n,this.bitWidth=r}toString(){return`Decimal[${this.precision}e${this.scale>0?"+":""}${this.scale}]`}}Sg=Symbol.toStringTag;Sc[Sg]=(e=>(e.scale=null,e.precision=null,e.ArrayType=Uint32Array,e[Symbol.toStringTag]="Decimal"))(Sc.prototype);class Ec extends X{constructor(t){super(v.Date),this.unit=t}toString(){return`Date${(this.unit+1)*32}<${nn[this.unit]}>`}get ArrayType(){return this.unit===nn.DAY?Int32Array:BigInt64Array}}Eg=Symbol.toStringTag;Ec[Eg]=(e=>(e.unit=null,e[Symbol.toStringTag]="Date"))(Ec.prototype);class Tc extends X{constructor(t,n){super(v.Time),this.unit=t,this.bitWidth=n}toString(){return`Time${this.bitWidth}<${Q[this.unit]}>`}get ArrayType(){switch(this.bitWidth){case 32:return Int32Array;case 64:return BigInt64Array}throw new Error(`Unrecognized ${this[Symbol.toStringTag]} type`)}}Tg=Symbol.toStringTag;Tc[Tg]=(e=>(e.unit=null,e.bitWidth=null,e[Symbol.toStringTag]="Time"))(Tc.prototype);class xa extends X{constructor(t,n){super(v.Timestamp),this.unit=t,this.timezone=n}toString(){return`Timestamp<${Q[this.unit]}${this.timezone?`, ${this.timezone}`:""}>`}}Ag=Symbol.toStringTag;xa[Ag]=(e=>(e.unit=null,e.timezone=null,e.ArrayType=BigInt64Array,e[Symbol.toStringTag]="Timestamp"))(xa.prototype);class DE extends xa{constructor(t){super(Q.MILLISECOND,t)}}class Ac extends X{constructor(t){super(v.Interval),this.unit=t}toString(){return`Interval<${Bn[this.unit]}>`}}Ig=Symbol.toStringTag;Ac[Ig]=(e=>(e.unit=null,e.ArrayType=Int32Array,e[Symbol.toStringTag]="Interval"))(Ac.prototype);class Ic extends X{constructor(t){super(v.Duration),this.unit=t}toString(){return`Duration<${Q[this.unit]}>`}}Ng=Symbol.toStringTag;Ic[Ng]=(e=>(e.unit=null,e.ArrayType=BigInt64Array,e[Symbol.toStringTag]="Duration"))(Ic.prototype);class us extends X{constructor(t){super(v.List),this.children=[t]}toString(){return`List<${this.valueType}>`}get valueType(){return this.children[0].type}get valueField(){return this.children[0]}get ArrayType(){return this.valueType.ArrayType}}Mg=Symbol.toStringTag;us[Mg]=(e=>(e.children=null,e[Symbol.toStringTag]="List"))(us.prototype);class ce extends X{constructor(t){super(v.Struct),this.children=t}toString(){return`Struct<{${this.children.map(t=>`${t.name}:${t.type}`).join(", ")}}>`}}Og=Symbol.toStringTag;ce[Og]=(e=>(e.children=null,e[Symbol.toStringTag]="Struct"))(ce.prototype);class Sa extends X{constructor(t,n,r){super(v.Union),this.mode=t,this.children=r,this.typeIds=n=Int32Array.from(n),this.typeIdToChildIndex=n.reduce((i,s,a)=>(i[s]=a)&&i||i,Object.create(null))}toString(){return`${this[Symbol.toStringTag]}<${this.children.map(t=>`${t.type}`).join(" | ")}>`}}Rg=Symbol.toStringTag;Sa[Rg]=(e=>(e.mode=null,e.typeIds=null,e.children=null,e.typeIdToChildIndex=null,e.ArrayType=Int8Array,e[Symbol.toStringTag]="Union"))(Sa.prototype);class Nc extends X{constructor(t){super(v.FixedSizeBinary),this.byteWidth=t}toString(){return`FixedSizeBinary[${this.byteWidth}]`}}Dg=Symbol.toStringTag;Nc[Dg]=(e=>(e.byteWidth=null,e.ArrayType=Uint8Array,e[Symbol.toStringTag]="FixedSizeBinary"))(Nc.prototype);class Ea extends X{constructor(t,n){super(v.FixedSizeList),this.listSize=t,this.children=[n]}get valueType(){return this.children[0].type}get valueField(){return this.children[0]}get ArrayType(){return this.valueType.ArrayType}toString(){return`FixedSizeList[${this.listSize}]<${this.valueType}>`}}Lg=Symbol.toStringTag;Ea[Lg]=(e=>(e.children=null,e.listSize=null,e[Symbol.toStringTag]="FixedSizeList"))(Ea.prototype);class Ta extends X{constructor(t,n=!1){var r,i,s;if(super(v.Map),this.children=[t],this.keysSorted=n,t&&(t.name="entries",!((r=t?.type)===null||r===void 0)&&r.children)){const a=(i=t?.type)===null||i===void 0?void 0:i.children[0];a&&(a.name="key");const o=(s=t?.type)===null||s===void 0?void 0:s.children[1];o&&(o.name="value")}}get keyType(){return this.children[0].type.children[0].type}get valueType(){return this.children[0].type.children[1].type}get childType(){return this.children[0].type}toString(){return`Map<{${this.children[0].type.children.map(t=>`${t.name}:${t.type}`).join(", ")}}>`}}Fg=Symbol.toStringTag;Ta[Fg]=(e=>(e.children=null,e.keysSorted=null,e[Symbol.toStringTag]="Map_"))(Ta.prototype);const LE=(e=>()=>++e)(-1);class kr extends X{constructor(t,n,r,i){super(v.Dictionary),this.indices=n,this.dictionary=t,this.isOrdered=i||!1,this.id=r==null?LE():Ct(r)}get children(){return this.dictionary.children}get valueType(){return this.dictionary}get ArrayType(){return this.dictionary.ArrayType}toString(){return`Dictionary<${this.indices}, ${this.dictionary}>`}}kg=Symbol.toStringTag;kr[kg]=(e=>(e.id=null,e.indices=null,e.isOrdered=null,e.dictionary=null,e[Symbol.toStringTag]="Dictionary"))(kr.prototype);function En(e){const t=e;switch(e.typeId){case v.Decimal:return e.bitWidth/32;case v.Interval:return 1+t.unit;case v.FixedSizeList:return t.listSize;case v.FixedSizeBinary:return t.byteWidth;default:return 1}}class wt{visitMany(t,...n){return t.map((r,i)=>this.visit(r,...n.map(s=>s[i])))}visit(...t){return this.getVisitFn(t[0],!1).apply(this,t)}getVisitFn(t,n=!0){return FE(this,t,n)}getVisitFnByTypeId(t,n=!0){return Hi(this,t,n)}visitNull(t,...n){return null}visitBool(t,...n){return null}visitInt(t,...n){return null}visitFloat(t,...n){return null}visitUtf8(t,...n){return null}visitLargeUtf8(t,...n){return null}visitBinary(t,...n){return null}visitLargeBinary(t,...n){return null}visitFixedSizeBinary(t,...n){return null}visitDate(t,...n){return null}visitTimestamp(t,...n){return null}visitTime(t,...n){return null}visitDecimal(t,...n){return null}visitList(t,...n){return null}visitStruct(t,...n){return null}visitUnion(t,...n){return null}visitDictionary(t,...n){return null}visitInterval(t,...n){return null}visitDuration(t,...n){return null}visitFixedSizeList(t,...n){return null}visitMap(t,...n){return null}}function FE(e,t,n=!0){return typeof t=="number"?Hi(e,t,n):typeof t=="string"&&t in v?Hi(e,v[t],n):t&&t instanceof X?Hi(e,yp(t),n):t?.type&&t.type instanceof X?Hi(e,yp(t.type),n):Hi(e,v.NONE,n)}function Hi(e,t,n=!0){let r=null;switch(t){case v.Null:r=e.visitNull;break;case v.Bool:r=e.visitBool;break;case v.Int:r=e.visitInt;break;case v.Int8:r=e.visitInt8||e.visitInt;break;case v.Int16:r=e.visitInt16||e.visitInt;break;case v.Int32:r=e.visitInt32||e.visitInt;break;case v.Int64:r=e.visitInt64||e.visitInt;break;case v.Uint8:r=e.visitUint8||e.visitInt;break;case v.Uint16:r=e.visitUint16||e.visitInt;break;case v.Uint32:r=e.visitUint32||e.visitInt;break;case v.Uint64:r=e.visitUint64||e.visitInt;break;case v.Float:r=e.visitFloat;break;case v.Float16:r=e.visitFloat16||e.visitFloat;break;case v.Float32:r=e.visitFloat32||e.visitFloat;break;case v.Float64:r=e.visitFloat64||e.visitFloat;break;case v.Utf8:r=e.visitUtf8;break;case v.LargeUtf8:r=e.visitLargeUtf8;break;case v.Binary:r=e.visitBinary;break;case v.LargeBinary:r=e.visitLargeBinary;break;case v.FixedSizeBinary:r=e.visitFixedSizeBinary;break;case v.Date:r=e.visitDate;break;case v.DateDay:r=e.visitDateDay||e.visitDate;break;case v.DateMillisecond:r=e.visitDateMillisecond||e.visitDate;break;case v.Timestamp:r=e.visitTimestamp;break;case v.TimestampSecond:r=e.visitTimestampSecond||e.visitTimestamp;break;case v.TimestampMillisecond:r=e.visitTimestampMillisecond||e.visitTimestamp;break;case v.TimestampMicrosecond:r=e.visitTimestampMicrosecond||e.visitTimestamp;break;case v.TimestampNanosecond:r=e.visitTimestampNanosecond||e.visitTimestamp;break;case v.Time:r=e.visitTime;break;case v.TimeSecond:r=e.visitTimeSecond||e.visitTime;break;case v.TimeMillisecond:r=e.visitTimeMillisecond||e.visitTime;break;case v.TimeMicrosecond:r=e.visitTimeMicrosecond||e.visitTime;break;case v.TimeNanosecond:r=e.visitTimeNanosecond||e.visitTime;break;case v.Decimal:r=e.visitDecimal;break;case v.List:r=e.visitList;break;case v.Struct:r=e.visitStruct;break;case v.Union:r=e.visitUnion;break;case v.DenseUnion:r=e.visitDenseUnion||e.visitUnion;break;case v.SparseUnion:r=e.visitSparseUnion||e.visitUnion;break;case v.Dictionary:r=e.visitDictionary;break;case v.Interval:r=e.visitInterval;break;case v.IntervalDayTime:r=e.visitIntervalDayTime||e.visitInterval;break;case v.IntervalYearMonth:r=e.visitIntervalYearMonth||e.visitInterval;break;case v.Duration:r=e.visitDuration;break;case v.DurationSecond:r=e.visitDurationSecond||e.visitDuration;break;case v.DurationMillisecond:r=e.visitDurationMillisecond||e.visitDuration;break;case v.DurationMicrosecond:r=e.visitDurationMicrosecond||e.visitDuration;break;case v.DurationNanosecond:r=e.visitDurationNanosecond||e.visitDuration;break;case v.FixedSizeList:r=e.visitFixedSizeList;break;case v.Map:r=e.visitMap;break}if(typeof r=="function")return r;if(!n)return()=>null;throw new Error(`Unrecognized type '${v[t]}'`)}function yp(e){switch(e.typeId){case v.Null:return v.Null;case v.Int:{const{bitWidth:t,isSigned:n}=e;switch(t){case 8:return n?v.Int8:v.Uint8;case 16:return n?v.Int16:v.Uint16;case 32:return n?v.Int32:v.Uint32;case 64:return n?v.Int64:v.Uint64}return v.Int}case v.Float:switch(e.precision){case ie.HALF:return v.Float16;case ie.SINGLE:return v.Float32;case ie.DOUBLE:return v.Float64}return v.Float;case v.Binary:return v.Binary;case v.LargeBinary:return v.LargeBinary;case v.Utf8:return v.Utf8;case v.LargeUtf8:return v.LargeUtf8;case v.Bool:return v.Bool;case v.Decimal:return v.Decimal;case v.Time:switch(e.unit){case Q.SECOND:return v.TimeSecond;case Q.MILLISECOND:return v.TimeMillisecond;case Q.MICROSECOND:return v.TimeMicrosecond;case Q.NANOSECOND:return v.TimeNanosecond}return v.Time;case v.Timestamp:switch(e.unit){case Q.SECOND:return v.TimestampSecond;case Q.MILLISECOND:return v.TimestampMillisecond;case Q.MICROSECOND:return v.TimestampMicrosecond;case Q.NANOSECOND:return v.TimestampNanosecond}return v.Timestamp;case v.Date:switch(e.unit){case nn.DAY:return v.DateDay;case nn.MILLISECOND:return v.DateMillisecond}return v.Date;case v.Interval:switch(e.unit){case Bn.DAY_TIME:return v.IntervalDayTime;case Bn.YEAR_MONTH:return v.IntervalYearMonth}return v.Interval;case v.Duration:switch(e.unit){case Q.SECOND:return v.DurationSecond;case Q.MILLISECOND:return v.DurationMillisecond;case Q.MICROSECOND:return v.DurationMicrosecond;case Q.NANOSECOND:return v.DurationNanosecond}return v.Duration;case v.Map:return v.Map;case v.List:return v.List;case v.Struct:return v.Struct;case v.Union:switch(e.mode){case ye.Dense:return v.DenseUnion;case ye.Sparse:return v.SparseUnion}return v.Union;case v.FixedSizeBinary:return v.FixedSizeBinary;case v.FixedSizeList:return v.FixedSizeList;case v.Dictionary:return v.Dictionary}throw new Error(`Unrecognized type '${v[e.typeId]}'`)}wt.prototype.visitInt8=null;wt.prototype.visitInt16=null;wt.prototype.visitInt32=null;wt.prototype.visitInt64=null;wt.prototype.visitUint8=null;wt.prototype.visitUint16=null;wt.prototype.visitUint32=null;wt.prototype.visitUint64=null;wt.prototype.visitFloat16=null;wt.prototype.visitFloat32=null;wt.prototype.visitFloat64=null;wt.prototype.visitDateDay=null;wt.prototype.visitDateMillisecond=null;wt.prototype.visitTimestampSecond=null;wt.prototype.visitTimestampMillisecond=null;wt.prototype.visitTimestampMicrosecond=null;wt.prototype.visitTimestampNanosecond=null;wt.prototype.visitTimeSecond=null;wt.prototype.visitTimeMillisecond=null;wt.prototype.visitTimeMicrosecond=null;wt.prototype.visitTimeNanosecond=null;wt.prototype.visitDenseUnion=null;wt.prototype.visitSparseUnion=null;wt.prototype.visitIntervalDayTime=null;wt.prototype.visitIntervalYearMonth=null;wt.prototype.visitDuration=null;wt.prototype.visitDurationSecond=null;wt.prototype.visitDurationMillisecond=null;wt.prototype.visitDurationMicrosecond=null;wt.prototype.visitDurationNanosecond=null;const zg=new Float64Array(1),Fi=new Uint32Array(zg.buffer);function Yg(e){const t=(e&31744)>>10,n=(e&1023)/1024,r=Math.pow(-1,(e&32768)>>15);switch(t){case 31:return r*(n?Number.NaN:1/0);case 0:return r*(n?6103515625e-14*n:0)}return r*Math.pow(2,t-15)*(1+n)}function Wg(e){if(e!==e)return 32256;zg[0]=e;const t=(Fi[1]&2147483648)>>16&65535;let n=Fi[1]&2146435072,r=0;return n>=1089470464?Fi[0]>0?n=31744:(n=(n&2080374784)>>16,r=(Fi[1]&1048575)>>10):n<=1056964608?(r=1048576+(Fi[1]&1048575),r=1048576+(r<<(n>>20)-998)>>21,n=0):(n=n-1056964608>>10,r=(Fi[1]&1048575)+512>>10),t|n|r&65535}class rt extends wt{}function ut(e){return(t,n,r)=>{if(t.setValid(n,r!=null))return e(t,n,r)}}const kE=(e,t,n)=>{e[t]=Math.floor(n/864e5)},Hg=(e,t,n,r)=>{if(n+1<t.length){const i=Ct(t[n]),s=Ct(t[n+1]);e.set(r.subarray(0,s-i),i)}},CE=({offset:e,values:t},n,r)=>{const i=e+n;r?t[i>>3]|=1<<i%8:t[i>>3]&=~(1<<i%8)},gr=({values:e},t,n)=>{e[t]=n},Hd=({values:e},t,n)=>{e[t]=n},qg=({values:e},t,n)=>{e[t]=Wg(n)},BE=(e,t,n)=>{switch(e.type.precision){case ie.HALF:return qg(e,t,n);case ie.SINGLE:case ie.DOUBLE:return Hd(e,t,n)}},qd=({values:e},t,n)=>{kE(e,t,n.valueOf())},Gd=({values:e},t,n)=>{e[t]=BigInt(n)},Gg=({stride:e,values:t},n,r)=>{t.set(r.subarray(0,e),e*n)},Xg=({values:e,valueOffsets:t},n,r)=>Hg(e,t,n,r),Kg=({values:e,valueOffsets:t},n,r)=>Hg(e,t,n,za(r)),Qg=(e,t,n)=>{e.type.unit===nn.DAY?qd(e,t,n):Gd(e,t,n)},Xd=({values:e},t,n)=>{e[t]=BigInt(n/1e3)},Kd=({values:e},t,n)=>{e[t]=BigInt(n)},Qd=({values:e},t,n)=>{e[t]=BigInt(n*1e3)},Jd=({values:e},t,n)=>{e[t]=BigInt(n*1e6)},Jg=(e,t,n)=>{switch(e.type.unit){case Q.SECOND:return Xd(e,t,n);case Q.MILLISECOND:return Kd(e,t,n);case Q.MICROSECOND:return Qd(e,t,n);case Q.NANOSECOND:return Jd(e,t,n)}},Zd=({values:e},t,n)=>{e[t]=n},th=({values:e},t,n)=>{e[t]=n},eh=({values:e},t,n)=>{e[t]=n},nh=({values:e},t,n)=>{e[t]=n},Zg=(e,t,n)=>{switch(e.type.unit){case Q.SECOND:return Zd(e,t,n);case Q.MILLISECOND:return th(e,t,n);case Q.MICROSECOND:return eh(e,t,n);case Q.NANOSECOND:return nh(e,t,n)}},tb=({values:e,stride:t},n,r)=>{e.set(r.subarray(0,t),t*n)},$E=(e,t,n)=>{const r=e.children[0],i=e.valueOffsets,s=rn.getVisitFn(r);if(Array.isArray(n))for(let a=-1,o=i[t],c=i[t+1];o<c;)s(r,o++,n[++a]);else for(let a=-1,o=i[t],c=i[t+1];o<c;)s(r,o++,n.get(++a))},UE=(e,t,n)=>{const r=e.children[0],{valueOffsets:i}=e,s=rn.getVisitFn(r);let{[t]:a,[t+1]:o}=i;const c=n instanceof Map?n.entries():Object.entries(n);for(const l of c)if(s(r,a,l),++a>=o)break},PE=(e,t)=>(n,r,i,s)=>r&&n(r,e,t[s]),jE=(e,t)=>(n,r,i,s)=>r&&n(r,e,t.get(s)),VE=(e,t)=>(n,r,i,s)=>r&&n(r,e,t.get(i.name)),zE=(e,t)=>(n,r,i,s)=>r&&n(r,e,t[i.name]),YE=(e,t,n)=>{const r=e.type.children.map(s=>rn.getVisitFn(s.type)),i=n instanceof Map?VE(t,n):n instanceof gt?jE(t,n):Array.isArray(n)?PE(t,n):zE(t,n);e.type.children.forEach((s,a)=>i(r[a],e.children[a],s,a))},WE=(e,t,n)=>{e.type.mode===ye.Dense?eb(e,t,n):nb(e,t,n)},eb=(e,t,n)=>{const r=e.type.typeIdToChildIndex[e.typeIds[t]],i=e.children[r];rn.visit(i,e.valueOffsets[t],n)},nb=(e,t,n)=>{const r=e.type.typeIdToChildIndex[e.typeIds[t]],i=e.children[r];rn.visit(i,t,n)},HE=(e,t,n)=>{var r;(r=e.dictionary)===null||r===void 0||r.set(e.values[t],n)},rb=(e,t,n)=>{e.type.unit===Bn.DAY_TIME?rh(e,t,n):ih(e,t,n)},rh=({values:e},t,n)=>{e.set(n.subarray(0,2),2*t)},ih=({values:e},t,n)=>{e[t]=n[0]*12+n[1]%12},sh=({values:e},t,n)=>{e[t]=n},ah=({values:e},t,n)=>{e[t]=n},oh=({values:e},t,n)=>{e[t]=n},ch=({values:e},t,n)=>{e[t]=n},ib=(e,t,n)=>{switch(e.type.unit){case Q.SECOND:return sh(e,t,n);case Q.MILLISECOND:return ah(e,t,n);case Q.MICROSECOND:return oh(e,t,n);case Q.NANOSECOND:return ch(e,t,n)}},qE=(e,t,n)=>{const{stride:r}=e,i=e.children[0],s=rn.getVisitFn(i);if(Array.isArray(n))for(let a=-1,o=t*r;++a<r;)s(i,o+a,n[a]);else for(let a=-1,o=t*r;++a<r;)s(i,o+a,n.get(a))};rt.prototype.visitBool=ut(CE);rt.prototype.visitInt=ut(gr);rt.prototype.visitInt8=ut(gr);rt.prototype.visitInt16=ut(gr);rt.prototype.visitInt32=ut(gr);rt.prototype.visitInt64=ut(gr);rt.prototype.visitUint8=ut(gr);rt.prototype.visitUint16=ut(gr);rt.prototype.visitUint32=ut(gr);rt.prototype.visitUint64=ut(gr);rt.prototype.visitFloat=ut(BE);rt.prototype.visitFloat16=ut(qg);rt.prototype.visitFloat32=ut(Hd);rt.prototype.visitFloat64=ut(Hd);rt.prototype.visitUtf8=ut(Kg);rt.prototype.visitLargeUtf8=ut(Kg);rt.prototype.visitBinary=ut(Xg);rt.prototype.visitLargeBinary=ut(Xg);rt.prototype.visitFixedSizeBinary=ut(Gg);rt.prototype.visitDate=ut(Qg);rt.prototype.visitDateDay=ut(qd);rt.prototype.visitDateMillisecond=ut(Gd);rt.prototype.visitTimestamp=ut(Jg);rt.prototype.visitTimestampSecond=ut(Xd);rt.prototype.visitTimestampMillisecond=ut(Kd);rt.prototype.visitTimestampMicrosecond=ut(Qd);rt.prototype.visitTimestampNanosecond=ut(Jd);rt.prototype.visitTime=ut(Zg);rt.prototype.visitTimeSecond=ut(Zd);rt.prototype.visitTimeMillisecond=ut(th);rt.prototype.visitTimeMicrosecond=ut(eh);rt.prototype.visitTimeNanosecond=ut(nh);rt.prototype.visitDecimal=ut(tb);rt.prototype.visitList=ut($E);rt.prototype.visitStruct=ut(YE);rt.prototype.visitUnion=ut(WE);rt.prototype.visitDenseUnion=ut(eb);rt.prototype.visitSparseUnion=ut(nb);rt.prototype.visitDictionary=ut(HE);rt.prototype.visitInterval=ut(rb);rt.prototype.visitIntervalDayTime=ut(rh);rt.prototype.visitIntervalYearMonth=ut(ih);rt.prototype.visitDuration=ut(ib);rt.prototype.visitDurationSecond=ut(sh);rt.prototype.visitDurationMillisecond=ut(ah);rt.prototype.visitDurationMicrosecond=ut(oh);rt.prototype.visitDurationNanosecond=ut(ch);rt.prototype.visitFixedSizeList=ut(qE);rt.prototype.visitMap=ut(UE);const rn=new rt,on=Symbol.for("parent"),es=Symbol.for("rowIndex");class lh{constructor(t,n){return this[on]=t,this[es]=n,new Proxy(this,new XE)}toArray(){return Object.values(this.toJSON())}toJSON(){const t=this[es],n=this[on],r=n.type.children,i={};for(let s=-1,a=r.length;++s<a;)i[r[s].name]=Me.visit(n.children[s],t);return i}toString(){return`{${[...this].map(([t,n])=>`${di(t)}: ${di(n)}`).join(", ")}}`}[Symbol.for("nodejs.util.inspect.custom")](){return this.toString()}[Symbol.iterator](){return new GE(this[on],this[es])}}class GE{constructor(t,n){this.childIndex=0,this.children=t.children,this.rowIndex=n,this.childFields=t.type.children,this.numChildren=this.childFields.length}[Symbol.iterator](){return this}next(){const t=this.childIndex;return t<this.numChildren?(this.childIndex=t+1,{done:!1,value:[this.childFields[t].name,Me.visit(this.children[t],this.rowIndex)]}):{done:!0,value:null}}}Object.defineProperties(lh.prototype,{[Symbol.toStringTag]:{enumerable:!1,configurable:!1,value:"Row"},[on]:{writable:!0,enumerable:!1,configurable:!1,value:null},[es]:{writable:!0,enumerable:!1,configurable:!1,value:-1}});class XE{isExtensible(){return!1}deleteProperty(){return!1}preventExtensions(){return!0}ownKeys(t){return t[on].type.children.map(n=>n.name)}has(t,n){return t[on].type.children.findIndex(r=>r.name===n)!==-1}getOwnPropertyDescriptor(t,n){if(t[on].type.children.findIndex(r=>r.name===n)!==-1)return{writable:!0,enumerable:!0,configurable:!0}}get(t,n){if(Reflect.has(t,n))return t[n];const r=t[on].type.children.findIndex(i=>i.name===n);if(r!==-1){const i=Me.visit(t[on].children[r],t[es]);return Reflect.set(t,n,i),i}}set(t,n,r){const i=t[on].type.children.findIndex(s=>s.name===n);return i!==-1?(rn.visit(t[on].children[i],t[es],r),Reflect.set(t,n,r)):Reflect.has(t,n)||typeof n=="symbol"?Reflect.set(t,n,r):!1}}class J extends wt{}function st(e){return(t,n)=>t.getValid(n)?e(t,n):null}const KE=(e,t)=>864e5*e[t],QE=(e,t)=>null,sb=(e,t,n)=>{if(n+1>=t.length)return null;const r=Ct(t[n]),i=Ct(t[n+1]);return e.subarray(r,i)},JE=({offset:e,values:t},n)=>{const r=e+n;return(t[r>>3]&1<<r%8)!==0},ab=({values:e},t)=>KE(e,t),ob=({values:e},t)=>Ct(e[t]),Wr=({stride:e,values:t},n)=>t[e*n],ZE=({stride:e,values:t},n)=>Yg(t[e*n]),cb=({values:e},t)=>e[t],tT=({stride:e,values:t},n)=>t.subarray(e*n,e*(n+1)),lb=({values:e,valueOffsets:t},n)=>sb(e,t,n),ub=({values:e,valueOffsets:t},n)=>{const r=sb(e,t,n);return r!==null?If(r):null},eT=({values:e},t)=>e[t],nT=({type:e,values:t},n)=>e.precision!==ie.HALF?t[n]:Yg(t[n]),rT=(e,t)=>e.type.unit===nn.DAY?ab(e,t):ob(e,t),fb=({values:e},t)=>1e3*Ct(e[t]),db=({values:e},t)=>Ct(e[t]),hb=({values:e},t)=>dg(e[t],BigInt(1e3)),pb=({values:e},t)=>dg(e[t],BigInt(1e6)),iT=(e,t)=>{switch(e.type.unit){case Q.SECOND:return fb(e,t);case Q.MILLISECOND:return db(e,t);case Q.MICROSECOND:return hb(e,t);case Q.NANOSECOND:return pb(e,t)}},mb=({values:e},t)=>e[t],yb=({values:e},t)=>e[t],gb=({values:e},t)=>e[t],bb=({values:e},t)=>e[t],sT=(e,t)=>{switch(e.type.unit){case Q.SECOND:return mb(e,t);case Q.MILLISECOND:return yb(e,t);case Q.MICROSECOND:return gb(e,t);case Q.NANOSECOND:return bb(e,t)}},aT=({values:e,stride:t},n)=>zd.decimal(e.subarray(t*n,t*(n+1))),oT=(e,t)=>{const{valueOffsets:n,stride:r,children:i}=e,{[t*r]:s,[t*r+1]:a}=n,c=i[0].slice(s,a-s);return new gt([c])},cT=(e,t)=>{const{valueOffsets:n,children:r}=e,{[t]:i,[t+1]:s}=n,a=r[0];return new Ol(a.slice(i,s-i))},lT=(e,t)=>new lh(e,t),uT=(e,t)=>e.type.mode===ye.Dense?_b(e,t):wb(e,t),_b=(e,t)=>{const n=e.type.typeIdToChildIndex[e.typeIds[t]],r=e.children[n];return Me.visit(r,e.valueOffsets[t])},wb=(e,t)=>{const n=e.type.typeIdToChildIndex[e.typeIds[t]],r=e.children[n];return Me.visit(r,t)},fT=(e,t)=>{var n;return(n=e.dictionary)===null||n===void 0?void 0:n.get(e.values[t])},dT=(e,t)=>e.type.unit===Bn.DAY_TIME?vb(e,t):xb(e,t),vb=({values:e},t)=>e.subarray(2*t,2*(t+1)),xb=({values:e},t)=>{const n=e[t],r=new Int32Array(2);return r[0]=Math.trunc(n/12),r[1]=Math.trunc(n%12),r},Sb=({values:e},t)=>e[t],Eb=({values:e},t)=>e[t],Tb=({values:e},t)=>e[t],Ab=({values:e},t)=>e[t],hT=(e,t)=>{switch(e.type.unit){case Q.SECOND:return Sb(e,t);case Q.MILLISECOND:return Eb(e,t);case Q.MICROSECOND:return Tb(e,t);case Q.NANOSECOND:return Ab(e,t)}},pT=(e,t)=>{const{stride:n,children:r}=e,s=r[0].slice(t*n,n);return new gt([s])};J.prototype.visitNull=st(QE);J.prototype.visitBool=st(JE);J.prototype.visitInt=st(eT);J.prototype.visitInt8=st(Wr);J.prototype.visitInt16=st(Wr);J.prototype.visitInt32=st(Wr);J.prototype.visitInt64=st(cb);J.prototype.visitUint8=st(Wr);J.prototype.visitUint16=st(Wr);J.prototype.visitUint32=st(Wr);J.prototype.visitUint64=st(cb);J.prototype.visitFloat=st(nT);J.prototype.visitFloat16=st(ZE);J.prototype.visitFloat32=st(Wr);J.prototype.visitFloat64=st(Wr);J.prototype.visitUtf8=st(ub);J.prototype.visitLargeUtf8=st(ub);J.prototype.visitBinary=st(lb);J.prototype.visitLargeBinary=st(lb);J.prototype.visitFixedSizeBinary=st(tT);J.prototype.visitDate=st(rT);J.prototype.visitDateDay=st(ab);J.prototype.visitDateMillisecond=st(ob);J.prototype.visitTimestamp=st(iT);J.prototype.visitTimestampSecond=st(fb);J.prototype.visitTimestampMillisecond=st(db);J.prototype.visitTimestampMicrosecond=st(hb);J.prototype.visitTimestampNanosecond=st(pb);J.prototype.visitTime=st(sT);J.prototype.visitTimeSecond=st(mb);J.prototype.visitTimeMillisecond=st(yb);J.prototype.visitTimeMicrosecond=st(gb);J.prototype.visitTimeNanosecond=st(bb);J.prototype.visitDecimal=st(aT);J.prototype.visitList=st(oT);J.prototype.visitStruct=st(lT);J.prototype.visitUnion=st(uT);J.prototype.visitDenseUnion=st(_b);J.prototype.visitSparseUnion=st(wb);J.prototype.visitDictionary=st(fT);J.prototype.visitInterval=st(dT);J.prototype.visitIntervalDayTime=st(vb);J.prototype.visitIntervalYearMonth=st(xb);J.prototype.visitDuration=st(hT);J.prototype.visitDurationSecond=st(Sb);J.prototype.visitDurationMillisecond=st(Eb);J.prototype.visitDurationMicrosecond=st(Tb);J.prototype.visitDurationNanosecond=st(Ab);J.prototype.visitFixedSizeList=st(pT);J.prototype.visitMap=st(cT);const Me=new J,ei=Symbol.for("keys"),ns=Symbol.for("vals"),qi=Symbol.for("kKeysAsStrings"),Ff=Symbol.for("_kKeysAsStrings");class Ol{constructor(t){return this[ei]=new gt([t.children[0]]).memoize(),this[ns]=t.children[1],new Proxy(this,new yT)}get[qi](){return this[Ff]||(this[Ff]=Array.from(this[ei].toArray(),String))}[Symbol.iterator](){return new mT(this[ei],this[ns])}get size(){return this[ei].length}toArray(){return Object.values(this.toJSON())}toJSON(){const t=this[ei],n=this[ns],r={};for(let i=-1,s=t.length;++i<s;)r[t.get(i)]=Me.visit(n,i);return r}toString(){return`{${[...this].map(([t,n])=>`${di(t)}: ${di(n)}`).join(", ")}}`}[Symbol.for("nodejs.util.inspect.custom")](){return this.toString()}}class mT{constructor(t,n){this.keys=t,this.vals=n,this.keyIndex=0,this.numKeys=t.length}[Symbol.iterator](){return this}next(){const t=this.keyIndex;return t===this.numKeys?{done:!0,value:null}:(this.keyIndex++,{done:!1,value:[this.keys.get(t),Me.visit(this.vals,t)]})}}class yT{isExtensible(){return!1}deleteProperty(){return!1}preventExtensions(){return!0}ownKeys(t){return t[qi]}has(t,n){return t[qi].includes(n)}getOwnPropertyDescriptor(t,n){if(t[qi].indexOf(n)!==-1)return{writable:!0,enumerable:!0,configurable:!0}}get(t,n){if(Reflect.has(t,n))return t[n];const r=t[qi].indexOf(n);if(r!==-1){const i=Me.visit(Reflect.get(t,ns),r);return Reflect.set(t,n,i),i}}set(t,n,r){const i=t[qi].indexOf(n);return i!==-1?(rn.visit(Reflect.get(t,ns),i,r),Reflect.set(t,n,r)):Reflect.has(t,n)?Reflect.set(t,n,r):!1}}Object.defineProperties(Ol.prototype,{[Symbol.toStringTag]:{enumerable:!1,configurable:!1,value:"Row"},[ei]:{writable:!0,enumerable:!1,configurable:!1,value:null},[ns]:{writable:!0,enumerable:!1,configurable:!1,value:null},[Ff]:{writable:!0,enumerable:!1,configurable:!1,value:null}});let gp;function Ib(e,t,n,r){const{length:i=0}=e;let s=typeof t!="number"?0:t,a=typeof n!="number"?i:n;return s<0&&(s=(s%i+i)%i),a<0&&(a=(a%i+i)%i),a<s&&(gp=s,s=a,a=gp),a>i&&(a=i),r?r(e,s,a):[s,a]}const uh=(e,t)=>e<0?t+e:e,bp=e=>e!==e;function Ms(e){if(typeof e!=="object"||e===null)return bp(e)?bp:n=>n===e;if(e instanceof Date){const n=e.valueOf();return r=>r instanceof Date?r.valueOf()===n:!1}return ArrayBuffer.isView(e)?n=>n?vE(e,n):!1:e instanceof Map?bT(e):Array.isArray(e)?gT(e):e instanceof gt?_T(e):wT(e,!0)}function gT(e){const t=[];for(let n=-1,r=e.length;++n<r;)t[n]=Ms(e[n]);return Rl(t)}function bT(e){let t=-1;const n=[];for(const r of e.values())n[++t]=Ms(r);return Rl(n)}function _T(e){const t=[];for(let n=-1,r=e.length;++n<r;)t[n]=Ms(e.get(n));return Rl(t)}function wT(e,t=!1){const n=Object.keys(e);if(!t&&n.length===0)return()=>!1;const r=[];for(let i=-1,s=n.length;++i<s;)r[i]=Ms(e[n[i]]);return Rl(r,n)}function Rl(e,t){return n=>{if(!n||typeof n!="object")return!1;switch(n.constructor){case Array:return vT(e,n);case Map:return _p(e,n,n.keys());case Ol:case lh:case Object:case void 0:return _p(e,n,t||Object.keys(n))}return n instanceof gt?xT(e,n):!1}}function vT(e,t){const n=e.length;if(t.length!==n)return!1;for(let r=-1;++r<n;)if(!e[r](t[r]))return!1;return!0}function xT(e,t){const n=e.length;if(t.length!==n)return!1;for(let r=-1;++r<n;)if(!e[r](t.get(r)))return!1;return!0}function _p(e,t,n){const r=n[Symbol.iterator](),i=t instanceof Map?t.keys():Object.keys(t)[Symbol.iterator](),s=t instanceof Map?t.values():Object.values(t)[Symbol.iterator]();let a=0;const o=e.length;let c=s.next(),l=r.next(),u=i.next();for(;a<o&&!l.done&&!u.done&&!c.done&&!(l.value!==u.value||!e[a](c.value));++a,l=r.next(),u=i.next(),c=s.next());return a===o&&l.done&&u.done&&c.done?!0:(r.return&&r.return(),i.return&&i.return(),s.return&&s.return(),!1)}function Nb(e,t,n,r){return(n&1<<r)!==0}function ST(e,t,n,r){return(n&1<<r)>>r}function Mc(e,t,n){const r=n.byteLength+7&-8;if(e>0||n.byteLength<r){const i=new Uint8Array(r);return i.set(e%8===0?n.subarray(e>>3):Oc(new fh(n,e,t,null,Nb)).subarray(0,r)),i}return n}function Oc(e){const t=[];let n=0,r=0,i=0;for(const a of e)a&&(i|=1<<r),++r===8&&(t[n++]=i,i=r=0);(n===0||r>0)&&(t[n++]=i);const s=new Uint8Array(t.length+7&-8);return s.set(t),s}class fh{constructor(t,n,r,i,s){this.bytes=t,this.length=r,this.context=i,this.get=s,this.bit=n%8,this.byteIndex=n>>3,this.byte=t[this.byteIndex++],this.index=0}next(){return this.index<this.length?(this.bit===8&&(this.bit=0,this.byte=this.bytes[this.byteIndex++]),{value:this.get(this.context,this.index++,this.byte,this.bit++)}):{done:!0,value:null}}[Symbol.iterator](){return this}}function kf(e,t,n){if(n-t<=0)return 0;if(n-t<8){let s=0;for(const a of new fh(e,t,n-t,e,ST))s+=a;return s}const r=n>>3<<3,i=t+(t%8===0?0:8-t%8);return kf(e,t,i)+kf(e,r,n)+ET(e,i>>3,r-i>>3)}function ET(e,t,n){let r=0,i=Math.trunc(t);const s=new DataView(e.buffer,e.byteOffset,e.byteLength),a=n===void 0?e.byteLength:i+n;for(;a-i>=4;)r+=Du(s.getUint32(i)),i+=4;for(;a-i>=2;)r+=Du(s.getUint16(i)),i+=2;for(;a-i>=1;)r+=Du(s.getUint8(i)),i+=1;return r}function Du(e){let t=Math.trunc(e);return t=t-(t>>>1&1431655765),t=(t&858993459)+(t>>>2&858993459),(t+(t>>>4)&252645135)*16843009>>>24}const TT=-1;class At{get typeId(){return this.type.typeId}get ArrayType(){return this.type.ArrayType}get buffers(){return[this.valueOffsets,this.values,this.nullBitmap,this.typeIds]}get nullable(){if(this._nullCount!==0){const{type:t}=this;return X.isSparseUnion(t)?this.children.some(n=>n.nullable):X.isDenseUnion(t)?this.children.some(n=>n.nullable):this.nullBitmap&&this.nullBitmap.byteLength>0}return!0}get byteLength(){let t=0;const{valueOffsets:n,values:r,nullBitmap:i,typeIds:s}=this;return n&&(t+=n.byteLength),r&&(t+=r.byteLength),i&&(t+=i.byteLength),s&&(t+=s.byteLength),this.children.reduce((a,o)=>a+o.byteLength,t)}get nullCount(){if(X.isUnion(this.type))return this.children.reduce((r,i)=>r+i.nullCount,0);let t=this._nullCount,n;return t<=TT&&(n=this.nullBitmap)&&(this._nullCount=t=n.length===0?0:this.length-kf(n,this.offset,this.offset+this.length)),t}constructor(t,n,r,i,s,a=[],o){this.type=t,this.children=a,this.dictionary=o,this.offset=Math.floor(Math.max(n||0,0)),this.length=Math.floor(Math.max(r||0,0)),this._nullCount=Math.floor(Math.max(i||0,-1));let c;s instanceof At?(this.stride=s.stride,this.values=s.values,this.typeIds=s.typeIds,this.nullBitmap=s.nullBitmap,this.valueOffsets=s.valueOffsets):(this.stride=En(t),s&&((c=s[0])&&(this.valueOffsets=c),(c=s[1])&&(this.values=c),(c=s[2])&&(this.nullBitmap=c),(c=s[3])&&(this.typeIds=c)))}getValid(t){const{type:n}=this;if(X.isUnion(n)){const r=n,i=this.children[r.typeIdToChildIndex[this.typeIds[t]]],s=r.mode===ye.Dense?this.valueOffsets[t]:t;return i.getValid(s)}if(this.nullable&&this.nullCount>0){const r=this.offset+t;return(this.nullBitmap[r>>3]&1<<r%8)!==0}return!0}setValid(t,n){let r;const{type:i}=this;if(X.isUnion(i)){const s=i,a=this.children[s.typeIdToChildIndex[this.typeIds[t]]],o=s.mode===ye.Dense?this.valueOffsets[t]:t;r=a.getValid(o),a.setValid(o,n)}else{let{nullBitmap:s}=this;const{offset:a,length:o}=this,c=a+t,l=1<<c%8,u=c>>3;(!s||s.byteLength<=u)&&(s=new Uint8Array((a+o+63&-64)>>3).fill(255),this.nullCount>0?(s.set(Mc(a,o,this.nullBitmap),0),Object.assign(this,{nullBitmap:s})):Object.assign(this,{nullBitmap:s,_nullCount:0}));const f=s[u];r=(f&l)!==0,s[u]=n?f|l:f&~l}return r!==!!n&&(this._nullCount=this.nullCount+(n?-1:1)),n}clone(t=this.type,n=this.offset,r=this.length,i=this._nullCount,s=this,a=this.children){return new At(t,n,r,i,s,a,this.dictionary)}slice(t,n){const{stride:r,typeId:i,children:s}=this,a=+(this._nullCount===0)-1,o=i===16?r:1,c=this._sliceBuffers(t,n,r,i);return this.clone(this.type,this.offset+t,n,a,c,s.length===0||this.valueOffsets?s:this._sliceChildren(s,o*t,o*n))}_changeLengthAndBackfillNullBitmap(t){if(this.typeId===v.Null)return this.clone(this.type,0,t,0);const{length:n,nullCount:r}=this,i=new Uint8Array((t+63&-64)>>3).fill(255,0,n>>3);i[n>>3]=(1<<n-(n&-8))-1,r>0&&i.set(Mc(this.offset,n,this.nullBitmap),0);const s=this.buffers;return s[Zn.VALIDITY]=i,this.clone(this.type,0,t,r+(t-n),s)}_sliceBuffers(t,n,r,i){let s;const{buffers:a}=this;return(s=a[Zn.TYPE])&&(a[Zn.TYPE]=s.subarray(t,t+n)),(s=a[Zn.OFFSET])&&(a[Zn.OFFSET]=s.subarray(t,t+n+1))||(s=a[Zn.DATA])&&(a[Zn.DATA]=i===6?s:s.subarray(r*t,r*(t+n))),a}_sliceChildren(t,n,r){return t.map(i=>i.slice(n,r))}}At.prototype.children=Object.freeze([]);class ha extends wt{visit(t){return this.getVisitFn(t.type).call(this,t)}visitNull(t){const{["type"]:n,["offset"]:r=0,["length"]:i=0}=t;return new At(n,r,i,i)}visitBool(t){const{["type"]:n,["offset"]:r=0}=t,i=Et(t.nullBitmap),s=Ft(n.ArrayType,t.data),{["length"]:a=s.length>>3,["nullCount"]:o=t.nullBitmap?-1:0}=t;return new At(n,r,a,o,[void 0,s,i])}visitInt(t){const{["type"]:n,["offset"]:r=0}=t,i=Et(t.nullBitmap),s=Ft(n.ArrayType,t.data),{["length"]:a=s.length,["nullCount"]:o=t.nullBitmap?-1:0}=t;return new At(n,r,a,o,[void 0,s,i])}visitFloat(t){const{["type"]:n,["offset"]:r=0}=t,i=Et(t.nullBitmap),s=Ft(n.ArrayType,t.data),{["length"]:a=s.length,["nullCount"]:o=t.nullBitmap?-1:0}=t;return new At(n,r,a,o,[void 0,s,i])}visitUtf8(t){const{["type"]:n,["offset"]:r=0}=t,i=Et(t.data),s=Et(t.nullBitmap),a=Vs(t.valueOffsets),{["length"]:o=a.length-1,["nullCount"]:c=t.nullBitmap?-1:0}=t;return new At(n,r,o,c,[a,i,s])}visitLargeUtf8(t){const{["type"]:n,["offset"]:r=0}=t,i=Et(t.data),s=Et(t.nullBitmap),a=ap(t.valueOffsets),{["length"]:o=a.length-1,["nullCount"]:c=t.nullBitmap?-1:0}=t;return new At(n,r,o,c,[a,i,s])}visitBinary(t){const{["type"]:n,["offset"]:r=0}=t,i=Et(t.data),s=Et(t.nullBitmap),a=Vs(t.valueOffsets),{["length"]:o=a.length-1,["nullCount"]:c=t.nullBitmap?-1:0}=t;return new At(n,r,o,c,[a,i,s])}visitLargeBinary(t){const{["type"]:n,["offset"]:r=0}=t,i=Et(t.data),s=Et(t.nullBitmap),a=ap(t.valueOffsets),{["length"]:o=a.length-1,["nullCount"]:c=t.nullBitmap?-1:0}=t;return new At(n,r,o,c,[a,i,s])}visitFixedSizeBinary(t){const{["type"]:n,["offset"]:r=0}=t,i=Et(t.nullBitmap),s=Ft(n.ArrayType,t.data),{["length"]:a=s.length/En(n),["nullCount"]:o=t.nullBitmap?-1:0}=t;return new At(n,r,a,o,[void 0,s,i])}visitDate(t){const{["type"]:n,["offset"]:r=0}=t,i=Et(t.nullBitmap),s=Ft(n.ArrayType,t.data),{["length"]:a=s.length/En(n),["nullCount"]:o=t.nullBitmap?-1:0}=t;return new At(n,r,a,o,[void 0,s,i])}visitTimestamp(t){const{["type"]:n,["offset"]:r=0}=t,i=Et(t.nullBitmap),s=Ft(n.ArrayType,t.data),{["length"]:a=s.length/En(n),["nullCount"]:o=t.nullBitmap?-1:0}=t;return new At(n,r,a,o,[void 0,s,i])}visitTime(t){const{["type"]:n,["offset"]:r=0}=t,i=Et(t.nullBitmap),s=Ft(n.ArrayType,t.data),{["length"]:a=s.length/En(n),["nullCount"]:o=t.nullBitmap?-1:0}=t;return new At(n,r,a,o,[void 0,s,i])}visitDecimal(t){const{["type"]:n,["offset"]:r=0}=t,i=Et(t.nullBitmap),s=Ft(n.ArrayType,t.data),{["length"]:a=s.length/En(n),["nullCount"]:o=t.nullBitmap?-1:0}=t;return new At(n,r,a,o,[void 0,s,i])}visitList(t){const{["type"]:n,["offset"]:r=0,["child"]:i}=t,s=Et(t.nullBitmap),a=Vs(t.valueOffsets),{["length"]:o=a.length-1,["nullCount"]:c=t.nullBitmap?-1:0}=t;return new At(n,r,o,c,[a,void 0,s],[i])}visitStruct(t){const{["type"]:n,["offset"]:r=0,["children"]:i=[]}=t,s=Et(t.nullBitmap),{length:a=i.reduce((c,{length:l})=>Math.max(c,l),0),nullCount:o=t.nullBitmap?-1:0}=t;return new At(n,r,a,o,[void 0,void 0,s],i)}visitUnion(t){const{["type"]:n,["offset"]:r=0,["children"]:i=[]}=t,s=Ft(n.ArrayType,t.typeIds),{["length"]:a=s.length,["nullCount"]:o=-1}=t;if(X.isSparseUnion(n))return new At(n,r,a,o,[void 0,void 0,void 0,s],i);const c=Vs(t.valueOffsets);return new At(n,r,a,o,[c,void 0,void 0,s],i)}visitDictionary(t){const{["type"]:n,["offset"]:r=0}=t,i=Et(t.nullBitmap),s=Ft(n.indices.ArrayType,t.data),{["dictionary"]:a=new gt([new ha().visit({type:n.dictionary})])}=t,{["length"]:o=s.length,["nullCount"]:c=t.nullBitmap?-1:0}=t;return new At(n,r,o,c,[void 0,s,i],[],a)}visitInterval(t){const{["type"]:n,["offset"]:r=0}=t,i=Et(t.nullBitmap),s=Ft(n.ArrayType,t.data),{["length"]:a=s.length/En(n),["nullCount"]:o=t.nullBitmap?-1:0}=t;return new At(n,r,a,o,[void 0,s,i])}visitDuration(t){const{["type"]:n,["offset"]:r=0}=t,i=Et(t.nullBitmap),s=Ft(n.ArrayType,t.data),{["length"]:a=s.length,["nullCount"]:o=t.nullBitmap?-1:0}=t;return new At(n,r,a,o,[void 0,s,i])}visitFixedSizeList(t){const{["type"]:n,["offset"]:r=0,["child"]:i=new ha().visit({type:n.valueType})}=t,s=Et(t.nullBitmap),{["length"]:a=i.length/En(n),["nullCount"]:o=t.nullBitmap?-1:0}=t;return new At(n,r,a,o,[void 0,void 0,s],[i])}visitMap(t){const{["type"]:n,["offset"]:r=0,["child"]:i=new ha().visit({type:n.childType})}=t,s=Et(t.nullBitmap),a=Vs(t.valueOffsets),{["length"]:o=a.length-1,["nullCount"]:c=t.nullBitmap?-1:0}=t;return new At(n,r,o,c,[a,void 0,s],[i])}}const AT=new ha;function nt(e){return AT.visit(e)}class wp{constructor(t=0,n){this.numChunks=t,this.getChunkIterator=n,this.chunkIndex=0,this.chunkIterator=this.getChunkIterator(0)}next(){for(;this.chunkIndex<this.numChunks;){const t=this.chunkIterator.next();if(!t.done)return t;++this.chunkIndex<this.numChunks&&(this.chunkIterator=this.getChunkIterator(this.chunkIndex))}return{done:!0,value:null}}[Symbol.iterator](){return this}}function IT(e){return e.some(t=>t.nullable)}function Mb(e){return e.reduce((t,n)=>t+n.nullCount,0)}function Ob(e){return e.reduce((t,n,r)=>(t[r+1]=t[r]+n.length,t),new Uint32Array(e.length+1))}function Rb(e,t,n,r){const i=[];for(let s=-1,a=e.length;++s<a;){const o=e[s],c=t[s],{length:l}=o;if(c>=r)break;if(n>=c+l)continue;if(c>=n&&c+l<=r){i.push(o);continue}const u=Math.max(0,n-c),f=Math.min(r-c,l);i.push(o.slice(u,f-u))}return i.length===0&&i.push(e[0].slice(0,0)),i}function dh(e,t,n,r){let i=0,s=0,a=t.length-1;do{if(i>=a-1)return n<t[a]?r(e,i,n-t[i]):null;s=i+Math.trunc((a-i)*.5),n<t[s]?a=s:i=s}while(i<a)}function hh(e,t){return e.getValid(t)}function Rc(e){function t(n,r,i){return e(n[r],i)}return function(n){const r=this.data;return dh(r,this._offsets,n,t)}}function Db(e){let t;function n(r,i,s){return e(r[i],s,t)}return function(r,i){const s=this.data;t=i;const a=dh(s,this._offsets,r,n);return t=void 0,a}}function Lb(e){let t;function n(r,i,s){let a=s,o=0,c=0;for(let l=i-1,u=r.length;++l<u;){const f=r[l];if(~(o=e(f,t,a)))return c+o;a=0,c+=f.length}return-1}return function(r,i){t=r;const s=this.data,a=typeof i!="number"?n(s,0,0):dh(s,this._offsets,i,n);return t=void 0,a}}class Z extends wt{}function NT(e,t){return t===null&&e.length>0?0:-1}function MT(e,t){const{nullBitmap:n}=e;if(!n||e.nullCount<=0)return-1;let r=0;for(const i of new fh(n,e.offset+(t||0),e.length,n,Nb)){if(!i)return r;++r}return-1}function ft(e,t,n){if(t===void 0)return-1;if(t===null)switch(e.typeId){case v.Union:break;case v.Dictionary:break;default:return MT(e,n)}const r=Me.getVisitFn(e),i=Ms(t);for(let s=(n||0)-1,a=e.length;++s<a;)if(i(r(e,s)))return s;return-1}function Fb(e,t,n){const r=Me.getVisitFn(e),i=Ms(t);for(let s=(n||0)-1,a=e.length;++s<a;)if(i(r(e,s)))return s;return-1}Z.prototype.visitNull=NT;Z.prototype.visitBool=ft;Z.prototype.visitInt=ft;Z.prototype.visitInt8=ft;Z.prototype.visitInt16=ft;Z.prototype.visitInt32=ft;Z.prototype.visitInt64=ft;Z.prototype.visitUint8=ft;Z.prototype.visitUint16=ft;Z.prototype.visitUint32=ft;Z.prototype.visitUint64=ft;Z.prototype.visitFloat=ft;Z.prototype.visitFloat16=ft;Z.prototype.visitFloat32=ft;Z.prototype.visitFloat64=ft;Z.prototype.visitUtf8=ft;Z.prototype.visitLargeUtf8=ft;Z.prototype.visitBinary=ft;Z.prototype.visitLargeBinary=ft;Z.prototype.visitFixedSizeBinary=ft;Z.prototype.visitDate=ft;Z.prototype.visitDateDay=ft;Z.prototype.visitDateMillisecond=ft;Z.prototype.visitTimestamp=ft;Z.prototype.visitTimestampSecond=ft;Z.prototype.visitTimestampMillisecond=ft;Z.prototype.visitTimestampMicrosecond=ft;Z.prototype.visitTimestampNanosecond=ft;Z.prototype.visitTime=ft;Z.prototype.visitTimeSecond=ft;Z.prototype.visitTimeMillisecond=ft;Z.prototype.visitTimeMicrosecond=ft;Z.prototype.visitTimeNanosecond=ft;Z.prototype.visitDecimal=ft;Z.prototype.visitList=ft;Z.prototype.visitStruct=ft;Z.prototype.visitUnion=ft;Z.prototype.visitDenseUnion=Fb;Z.prototype.visitSparseUnion=Fb;Z.prototype.visitDictionary=ft;Z.prototype.visitInterval=ft;Z.prototype.visitIntervalDayTime=ft;Z.prototype.visitIntervalYearMonth=ft;Z.prototype.visitDuration=ft;Z.prototype.visitDurationSecond=ft;Z.prototype.visitDurationMillisecond=ft;Z.prototype.visitDurationMicrosecond=ft;Z.prototype.visitDurationNanosecond=ft;Z.prototype.visitFixedSizeList=ft;Z.prototype.visitMap=ft;const Dc=new Z;class tt extends wt{}function at(e){const{type:t}=e;if(e.nullCount===0&&e.stride===1&&(X.isInt(t)&&t.bitWidth!==64||X.isTime(t)&&t.bitWidth!==64||X.isFloat(t)&&t.precision!==ie.HALF))return new wp(e.data.length,r=>{const i=e.data[r];return i.values.subarray(0,i.length)[Symbol.iterator]()});let n=0;return new wp(e.data.length,r=>{const s=e.data[r].length,a=e.slice(n,n+s);return n+=s,new OT(a)})}class OT{constructor(t){this.vector=t,this.index=0}next(){return this.index<this.vector.length?{value:this.vector.get(this.index++)}:{done:!0,value:null}}[Symbol.iterator](){return this}}tt.prototype.visitNull=at;tt.prototype.visitBool=at;tt.prototype.visitInt=at;tt.prototype.visitInt8=at;tt.prototype.visitInt16=at;tt.prototype.visitInt32=at;tt.prototype.visitInt64=at;tt.prototype.visitUint8=at;tt.prototype.visitUint16=at;tt.prototype.visitUint32=at;tt.prototype.visitUint64=at;tt.prototype.visitFloat=at;tt.prototype.visitFloat16=at;tt.prototype.visitFloat32=at;tt.prototype.visitFloat64=at;tt.prototype.visitUtf8=at;tt.prototype.visitLargeUtf8=at;tt.prototype.visitBinary=at;tt.prototype.visitLargeBinary=at;tt.prototype.visitFixedSizeBinary=at;tt.prototype.visitDate=at;tt.prototype.visitDateDay=at;tt.prototype.visitDateMillisecond=at;tt.prototype.visitTimestamp=at;tt.prototype.visitTimestampSecond=at;tt.prototype.visitTimestampMillisecond=at;tt.prototype.visitTimestampMicrosecond=at;tt.prototype.visitTimestampNanosecond=at;tt.prototype.visitTime=at;tt.prototype.visitTimeSecond=at;tt.prototype.visitTimeMillisecond=at;tt.prototype.visitTimeMicrosecond=at;tt.prototype.visitTimeNanosecond=at;tt.prototype.visitDecimal=at;tt.prototype.visitList=at;tt.prototype.visitStruct=at;tt.prototype.visitUnion=at;tt.prototype.visitDenseUnion=at;tt.prototype.visitSparseUnion=at;tt.prototype.visitDictionary=at;tt.prototype.visitInterval=at;tt.prototype.visitIntervalDayTime=at;tt.prototype.visitIntervalYearMonth=at;tt.prototype.visitDuration=at;tt.prototype.visitDurationSecond=at;tt.prototype.visitDurationMillisecond=at;tt.prototype.visitDurationMicrosecond=at;tt.prototype.visitDurationNanosecond=at;tt.prototype.visitFixedSizeList=at;tt.prototype.visitMap=at;const ph=new tt;var kb;const Cb={},Bb={};let gt=class Zr{constructor(t){var n,r,i;const s=t[0]instanceof Zr?t.flatMap(o=>o.data):t;if(s.length===0||s.some(o=>!(o instanceof At)))throw new TypeError("Vector constructor expects an Array of Data instances.");const a=(n=s[0])===null||n===void 0?void 0:n.type;switch(s.length){case 0:this._offsets=[0];break;case 1:{const{get:o,set:c,indexOf:l}=Cb[a.typeId],u=s[0];this.isValid=f=>hh(u,f),this.get=f=>o(u,f),this.set=(f,d)=>c(u,f,d),this.indexOf=f=>l(u,f),this._offsets=[0,u.length];break}default:Object.setPrototypeOf(this,Bb[a.typeId]),this._offsets=Ob(s);break}this.data=s,this.type=a,this.stride=En(a),this.numChildren=(i=(r=a.children)===null||r===void 0?void 0:r.length)!==null&&i!==void 0?i:0,this.length=this._offsets.at(-1)}get byteLength(){return this.data.reduce((t,n)=>t+n.byteLength,0)}get nullable(){return IT(this.data)}get nullCount(){return Mb(this.data)}get ArrayType(){return this.type.ArrayType}get[Symbol.toStringTag](){return`${this.VectorName}<${this.type[Symbol.toStringTag]}>`}get VectorName(){return`${v[this.type.typeId]}Vector`}isValid(t){return!1}get(t){return null}at(t){return this.get(uh(t,this.length))}set(t,n){}indexOf(t,n){return-1}includes(t,n){return this.indexOf(t,n)>-1}[Symbol.iterator](){return ph.visit(this)}concat(...t){return new Zr(this.data.concat(t.flatMap(n=>n.data).flat(Number.POSITIVE_INFINITY)))}slice(t,n){return new Zr(Ib(this,t,n,({data:r,_offsets:i},s,a)=>Rb(r,i,s,a)))}toJSON(){return[...this]}toArray(){const{type:t,data:n,length:r,stride:i,ArrayType:s}=this;switch(t.typeId){case v.Int:case v.Float:case v.Decimal:case v.Time:case v.Timestamp:switch(n.length){case 0:return new s;case 1:return n[0].values.subarray(0,r*i);default:return n.reduce((a,{values:o,length:c})=>(a.array.set(o.subarray(0,c*i),a.offset),a.offset+=c*i,a),{array:new s(r*i),offset:0}).array}}return[...this]}toString(){return`[${[...this].join(",")}]`}getChild(t){var n;return this.getChildAt((n=this.type.children)===null||n===void 0?void 0:n.findIndex(r=>r.name===t))}getChildAt(t){return t>-1&&t<this.numChildren?new Zr(this.data.map(({children:n})=>n[t])):null}get isMemoized(){return X.isDictionary(this.type)?this.data[0].dictionary.isMemoized:!1}memoize(){if(X.isDictionary(this.type)){const t=new Lc(this.data[0].dictionary),n=this.data.map(r=>{const i=r.clone();return i.dictionary=t,i});return new Zr(n)}return new Lc(this)}unmemoize(){if(X.isDictionary(this.type)&&this.isMemoized){const t=this.data[0].dictionary.unmemoize(),n=this.data.map(r=>{const i=r.clone();return i.dictionary=t,i});return new Zr(n)}return this}};kb=Symbol.toStringTag;gt[kb]=(e=>{e.type=X.prototype,e.data=[],e.length=0,e.stride=1,e.numChildren=0,e._offsets=new Uint32Array([0]),e[Symbol.isConcatSpreadable]=!0;const t=Object.keys(v).map(n=>v[n]).filter(n=>typeof n=="number"&&n!==v.NONE);for(const n of t){const r=Me.getVisitFnByTypeId(n),i=rn.getVisitFnByTypeId(n),s=Dc.getVisitFnByTypeId(n);Cb[n]={get:r,set:i,indexOf:s},Bb[n]=Object.create(e,{isValid:{value:Rc(hh)},get:{value:Rc(Me.getVisitFnByTypeId(n))},set:{value:Db(rn.getVisitFnByTypeId(n))},indexOf:{value:Lb(Dc.getVisitFnByTypeId(n))}})}return"Vector"})(gt.prototype);class Lc extends gt{constructor(t){super(t.data);const n=this.get,r=this.set,i=this.slice,s=new Array(this.length);Object.defineProperty(this,"get",{value(a){const o=s[a];if(o!==void 0)return o;const c=n.call(this,a);return s[a]=c,c}}),Object.defineProperty(this,"set",{value(a,o){r.call(this,a,o),s[a]=o}}),Object.defineProperty(this,"slice",{value:(a,o)=>new Lc(i.call(this,a,o))}),Object.defineProperty(this,"isMemoized",{value:!0}),Object.defineProperty(this,"unmemoize",{value:()=>new gt(this.data)}),Object.defineProperty(this,"memoize",{value:()=>this})}}function $b(e){if(e){if(e instanceof At)return new gt([e]);if(e instanceof gt)return new gt(e.data);if(e.type instanceof X)return new gt([nt(e)]);if(Array.isArray(e))return new gt(e.flatMap(t=>RT(t)));if(ArrayBuffer.isView(e)){e instanceof DataView&&(e=new Uint8Array(e.buffer));const t={offset:0,length:e.length,nullCount:-1,data:e};if(e instanceof Int8Array)return new gt([nt(Object.assign(Object.assign({},t),{type:new Cg}))]);if(e instanceof Int16Array)return new gt([nt(Object.assign(Object.assign({},t),{type:new Bg}))]);if(e instanceof Int32Array)return new gt([nt(Object.assign(Object.assign({},t),{type:new hi}))]);if(e instanceof BigInt64Array)return new gt([nt(Object.assign(Object.assign({},t),{type:new Yd}))]);if(e instanceof Uint8Array||e instanceof Uint8ClampedArray)return new gt([nt(Object.assign(Object.assign({},t),{type:new $g}))]);if(e instanceof Uint16Array)return new gt([nt(Object.assign(Object.assign({},t),{type:new Ug}))]);if(e instanceof Uint32Array)return new gt([nt(Object.assign(Object.assign({},t),{type:new Pg}))]);if(e instanceof BigUint64Array)return new gt([nt(Object.assign(Object.assign({},t),{type:new jg}))]);if(e instanceof Float32Array)return new gt([nt(Object.assign(Object.assign({},t),{type:new Vg}))]);if(e instanceof Float64Array)return new gt([nt(Object.assign(Object.assign({},t),{type:new Wd}))]);throw new Error("Unrecognized input")}}throw new Error("Unrecognized input")}function RT(e){return e instanceof At?[e]:e instanceof gt?e.data:$b(e).data}function DT(e){if(!e||e.length<=0)return function(i){return!0};let t="";const n=e.filter(r=>r===r);return n.length>0&&(t=`
    switch (x) {${n.map(r=>`
        case ${LT(r)}:`).join("")}
            return false;
    }`),e.length!==n.length&&(t=`if (x !== x) return false;
${t}`),new Function("x",`${t}
return true;`)}function LT(e){return typeof e!="bigint"?di(e):`${di(e)}n`}function Lu(e,t){const n=Math.ceil(e)*t-1;return(n-n%64+64||64)/t}function vp(e,t=0){return e.length>=t?e.subarray(0,t):Mf(new e.constructor(t),e,0)}class Wa{constructor(t,n=0,r=1){this.length=Math.ceil(n/r),this.buffer=new t(this.length),this.stride=r,this.BYTES_PER_ELEMENT=t.BYTES_PER_ELEMENT,this.ArrayType=t}get byteLength(){return Math.ceil(this.length*this.stride)*this.BYTES_PER_ELEMENT}get reservedLength(){return this.buffer.length/this.stride}get reservedByteLength(){return this.buffer.byteLength}set(t,n){return this}append(t){return this.set(this.length,t)}reserve(t){if(t>0){this.length+=t;const n=this.stride,r=this.length*n,i=this.buffer.length;r>=i&&this._resize(i===0?Lu(r*1,this.BYTES_PER_ELEMENT):Lu(r*2,this.BYTES_PER_ELEMENT))}return this}flush(t=this.length){t=Lu(t*this.stride,this.BYTES_PER_ELEMENT);const n=vp(this.buffer,t);return this.clear(),n}clear(){return this.length=0,this.buffer=new this.ArrayType,this}_resize(t){return this.buffer=vp(this.buffer,t)}}class Ha extends Wa{last(){return this.get(this.length-1)}get(t){return this.buffer[t]}set(t,n){return this.reserve(t-this.length+1),this.buffer[t*this.stride]=n,this}}class Ub extends Ha{constructor(){super(Uint8Array,0,1/8),this.numValid=0}get numInvalid(){return this.length-this.numValid}get(t){return this.buffer[t>>3]>>t%8&1}set(t,n){const{buffer:r}=this.reserve(t-this.length+1),i=t>>3,s=t%8,a=r[i]>>s&1;return n?a===0&&(r[i]|=1<<s,++this.numValid):a===1&&(r[i]&=~(1<<s),--this.numValid),this}clear(){return this.numValid=0,super.clear()}}class Pb extends Ha{constructor(t){super(t.OffsetArrayType,1,1)}append(t){return this.set(this.length-1,t)}set(t,n){const r=this.length-1,i=this.reserve(t-r+1).buffer;return r<t++&&r>=0&&i.fill(i[r],r,t),i[t]=i[t-1]+n,this}flush(t=this.length-1){return t>this.length&&this.set(t-1,this.BYTES_PER_ELEMENT>4?BigInt(0):0),super.flush(t+1)}}let Le=class{static throughNode(t){throw new Error('"throughNode" not available in this environment')}static throughDOM(t){throw new Error('"throughDOM" not available in this environment')}constructor({type:t,nullValues:n}){this.length=0,this.finished=!1,this.type=t,this.children=[],this.nullValues=n,this.stride=En(t),this._nulls=new Ub,n&&n.length>0&&(this._isValid=DT(n))}toVector(){return new gt([this.flush()])}get ArrayType(){return this.type.ArrayType}get nullCount(){return this._nulls.numInvalid}get numChildren(){return this.children.length}get byteLength(){let t=0;const{_offsets:n,_values:r,_nulls:i,_typeIds:s,children:a}=this;return n&&(t+=n.byteLength),r&&(t+=r.byteLength),i&&(t+=i.byteLength),s&&(t+=s.byteLength),a.reduce((o,c)=>o+c.byteLength,t)}get reservedLength(){return this._nulls.reservedLength}get reservedByteLength(){let t=0;return this._offsets&&(t+=this._offsets.reservedByteLength),this._values&&(t+=this._values.reservedByteLength),this._nulls&&(t+=this._nulls.reservedByteLength),this._typeIds&&(t+=this._typeIds.reservedByteLength),this.children.reduce((n,r)=>n+r.reservedByteLength,t)}get valueOffsets(){return this._offsets?this._offsets.buffer:null}get values(){return this._values?this._values.buffer:null}get nullBitmap(){return this._nulls?this._nulls.buffer:null}get typeIds(){return this._typeIds?this._typeIds.buffer:null}append(t){return this.set(this.length,t)}isValid(t){return this._isValid(t)}set(t,n){return this.setValid(t,this.isValid(n))&&this.setValue(t,n),this}setValue(t,n){this._setValue(this,t,n)}setValid(t,n){return this.length=this._nulls.set(t,+n).length,n}addChild(t,n=`${this.numChildren}`){throw new Error(`Cannot append children to non-nested type "${this.type}"`)}getChildAt(t){return this.children[t]||null}flush(){let t,n,r,i;const{type:s,length:a,nullCount:o,_typeIds:c,_offsets:l,_values:u,_nulls:f}=this;(n=c?.flush(a))?i=l?.flush(a):(i=l?.flush(a))?t=u?.flush(l.last()):t=u?.flush(a),o>0&&(r=f?.flush(a));const d=this.children.map(h=>h.flush());return this.clear(),nt({type:s,length:a,nullCount:o,children:d,child:d[0],data:t,typeIds:n,nullBitmap:r,valueOffsets:i})}finish(){this.finished=!0;for(const t of this.children)t.finish();return this}clear(){var t,n,r,i;this.length=0,(t=this._nulls)===null||t===void 0||t.clear(),(n=this._values)===null||n===void 0||n.clear(),(r=this._offsets)===null||r===void 0||r.clear(),(i=this._typeIds)===null||i===void 0||i.clear();for(const s of this.children)s.clear();return this}};Le.prototype.length=1;Le.prototype.stride=1;Le.prototype.children=null;Le.prototype.finished=!1;Le.prototype.nullValues=null;Le.prototype._isValid=()=>!0;class br extends Le{constructor(t){super(t),this._values=new Ha(this.ArrayType,0,this.stride)}setValue(t,n){const r=this._values;return r.reserve(t-r.length+1),super.setValue(t,n)}}class Os extends Le{constructor(t){super(t),this._pendingLength=0,this._offsets=new Pb(t.type)}setValue(t,n){const r=this._pending||(this._pending=new Map),i=r.get(t);i&&(this._pendingLength-=i.length),this._pendingLength+=n instanceof Ol?n[ei].length:n.length,r.set(t,n)}setValid(t,n){return super.setValid(t,n)?!0:((this._pending||(this._pending=new Map)).set(t,void 0),!1)}clear(){return this._pendingLength=0,this._pending=void 0,super.clear()}flush(){return this._flush(),super.flush()}finish(){return this._flush(),super.finish()}_flush(){const t=this._pending,n=this._pendingLength;return this._pendingLength=0,this._pending=void 0,t&&t.size>0&&this._flushPending(t,n),this}}class Cf{constructor(){this.bb=null,this.bb_pos=0}__init(t,n){return this.bb_pos=t,this.bb=n,this}offset(){return this.bb.readInt64(this.bb_pos)}metaDataLength(){return this.bb.readInt32(this.bb_pos+8)}bodyLength(){return this.bb.readInt64(this.bb_pos+16)}static sizeOf(){return 24}static createBlock(t,n,r,i){return t.prep(8,24),t.writeInt64(BigInt(i??0)),t.pad(4),t.writeInt32(r),t.writeInt64(BigInt(n??0)),t.offset()}}class Ce{constructor(){this.bb=null,this.bb_pos=0}__init(t,n){return this.bb_pos=t,this.bb=n,this}static getRootAsFooter(t,n){return(n||new Ce).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsFooter(t,n){return t.setPosition(t.position()+Dt),(n||new Ce).__init(t.readInt32(t.position())+t.position(),t)}version(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):qt.V1}schema(t){const n=this.bb.__offset(this.bb_pos,6);return n?(t||new vn).__init(this.bb.__indirect(this.bb_pos+n),this.bb):null}dictionaries(t,n){const r=this.bb.__offset(this.bb_pos,8);return r?(n||new Cf).__init(this.bb.__vector(this.bb_pos+r)+t*24,this.bb):null}dictionariesLength(){const t=this.bb.__offset(this.bb_pos,8);return t?this.bb.__vector_len(this.bb_pos+t):0}recordBatches(t,n){const r=this.bb.__offset(this.bb_pos,10);return r?(n||new Cf).__init(this.bb.__vector(this.bb_pos+r)+t*24,this.bb):null}recordBatchesLength(){const t=this.bb.__offset(this.bb_pos,10);return t?this.bb.__vector_len(this.bb_pos+t):0}customMetadata(t,n){const r=this.bb.__offset(this.bb_pos,12);return r?(n||new Jt).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+r)+t*4),this.bb):null}customMetadataLength(){const t=this.bb.__offset(this.bb_pos,12);return t?this.bb.__vector_len(this.bb_pos+t):0}static startFooter(t){t.startObject(5)}static addVersion(t,n){t.addFieldInt16(0,n,qt.V1)}static addSchema(t,n){t.addFieldOffset(1,n,0)}static addDictionaries(t,n){t.addFieldOffset(2,n,0)}static startDictionariesVector(t,n){t.startVector(24,n,8)}static addRecordBatches(t,n){t.addFieldOffset(3,n,0)}static startRecordBatchesVector(t,n){t.startVector(24,n,8)}static addCustomMetadata(t,n){t.addFieldOffset(4,n,0)}static createCustomMetadataVector(t,n){t.startVector(4,n.length,4);for(let r=n.length-1;r>=0;r--)t.addOffset(n[r]);return t.endVector()}static startCustomMetadataVector(t,n){t.startVector(4,n,4)}static endFooter(t){return t.endObject()}static finishFooterBuffer(t,n){t.finish(n)}static finishSizePrefixedFooterBuffer(t,n){t.finish(n,void 0,!0)}}class Rt{constructor(t=[],n,r,i=qt.V5){this.fields=t||[],this.metadata=n||new Map,r||(r=Bf(this.fields)),this.dictionaries=r,this.metadataVersion=i}get[Symbol.toStringTag](){return"Schema"}get names(){return this.fields.map(t=>t.name)}toString(){return`Schema<{ ${this.fields.map((t,n)=>`${n}: ${t}`).join(", ")} }>`}select(t){const n=new Set(t),r=this.fields.filter(i=>n.has(i.name));return new Rt(r,this.metadata)}selectAt(t){const n=t.map(r=>this.fields[r]).filter(Boolean);return new Rt(n,this.metadata)}assign(...t){const n=t[0]instanceof Rt?t[0]:Array.isArray(t[0])?new Rt(t[0]):new Rt(t),r=[...this.fields],i=Io(Io(new Map,this.metadata),n.metadata),s=n.fields.filter(o=>{const c=r.findIndex(l=>l.name===o.name);return~c?(r[c]=o.clone({metadata:Io(Io(new Map,r[c].metadata),o.metadata)}))&&!1:!0}),a=Bf(s,new Map);return new Rt([...r,...s],i,new Map([...this.dictionaries,...a]))}}Rt.prototype.fields=null;Rt.prototype.metadata=null;Rt.prototype.dictionaries=null;class Nt{static new(...t){let[n,r,i,s]=t;return t[0]&&typeof t[0]=="object"&&({name:n}=t[0],r===void 0&&(r=t[0].type),i===void 0&&(i=t[0].nullable),s===void 0&&(s=t[0].metadata)),new Nt(`${n}`,r,i,s)}constructor(t,n,r=!1,i){this.name=t,this.type=n,this.nullable=r,this.metadata=i||new Map}get typeId(){return this.type.typeId}get[Symbol.toStringTag](){return"Field"}toString(){return`${this.name}: ${this.type}`}clone(...t){let[n,r,i,s]=t;return!t[0]||typeof t[0]!="object"?[n=this.name,r=this.type,i=this.nullable,s=this.metadata]=t:{name:n=this.name,type:r=this.type,nullable:i=this.nullable,metadata:s=this.metadata}=t[0],Nt.new(n,r,i,s)}}Nt.prototype.type=null;Nt.prototype.name=null;Nt.prototype.nullable=null;Nt.prototype.metadata=null;function Io(e,t){return new Map([...e||new Map,...t||new Map])}function Bf(e,t=new Map){for(let n=-1,r=e.length;++n<r;){const s=e[n].type;if(X.isDictionary(s)){if(!t.has(s.id))t.set(s.id,s.dictionary);else if(t.get(s.id)!==s.dictionary)throw new Error("Cannot create Schema containing two different dictionaries with the same Id")}s.children&&s.children.length>0&&Bf(s.children,t)}return t}var FT=cg,kT=os;class Aa{static decode(t){t=new kT(Et(t));const n=Ce.getRootAsFooter(t),r=Rt.decode(n.schema(),new Map,n.version());return new CT(r,n)}static encode(t){const n=new FT,r=Rt.encode(n,t.schema);Ce.startRecordBatchesVector(n,t.numRecordBatches);for(const a of[...t.recordBatches()].slice().reverse())Cr.encode(n,a);const i=n.endVector();Ce.startDictionariesVector(n,t.numDictionaries);for(const a of[...t.dictionaryBatches()].slice().reverse())Cr.encode(n,a);const s=n.endVector();return Ce.startFooter(n),Ce.addSchema(n,r),Ce.addVersion(n,qt.V5),Ce.addRecordBatches(n,i),Ce.addDictionaries(n,s),Ce.finishFooterBuffer(n,Ce.endFooter(n)),n.asUint8Array()}get numRecordBatches(){return this._recordBatches.length}get numDictionaries(){return this._dictionaryBatches.length}constructor(t,n=qt.V5,r,i){this.schema=t,this.version=n,r&&(this._recordBatches=r),i&&(this._dictionaryBatches=i)}*recordBatches(){for(let t,n=-1,r=this.numRecordBatches;++n<r;)(t=this.getRecordBatch(n))&&(yield t)}*dictionaryBatches(){for(let t,n=-1,r=this.numDictionaries;++n<r;)(t=this.getDictionaryBatch(n))&&(yield t)}getRecordBatch(t){return t>=0&&t<this.numRecordBatches&&this._recordBatches[t]||null}getDictionaryBatch(t){return t>=0&&t<this.numDictionaries&&this._dictionaryBatches[t]||null}}class CT extends Aa{get numRecordBatches(){return this._footer.recordBatchesLength()}get numDictionaries(){return this._footer.dictionariesLength()}constructor(t,n){super(t,n.version()),this._footer=n}getRecordBatch(t){if(t>=0&&t<this.numRecordBatches){const n=this._footer.recordBatches(t);if(n)return Cr.decode(n)}return null}getDictionaryBatch(t){if(t>=0&&t<this.numDictionaries){const n=this._footer.dictionaries(t);if(n)return Cr.decode(n)}return null}}class Cr{static decode(t){return new Cr(t.metaDataLength(),t.bodyLength(),t.offset())}static encode(t,n){const{metaDataLength:r}=n,i=BigInt(n.offset),s=BigInt(n.bodyLength);return Cf.createBlock(t,i,r,s)}constructor(t,n,r){this.metaDataLength=t,this.offset=Ct(r),this.bodyLength=Ct(n)}}const jt=Object.freeze({done:!0,value:void 0});class xp{constructor(t){this._json=t}get schema(){return this._json.schema}get batches(){return this._json.batches||[]}get dictionaries(){return this._json.dictionaries||[]}}class mh{tee(){return this._getDOMStream().tee()}pipe(t,n){return this._getNodeStream().pipe(t,n)}pipeTo(t,n){return this._getDOMStream().pipeTo(t,n)}pipeThrough(t,n){return this._getDOMStream().pipeThrough(t,n)}_getDOMStream(){return this._DOMStream||(this._DOMStream=this.toDOMStream())}_getNodeStream(){return this._nodeStream||(this._nodeStream=this.toNodeStream())}}class BT extends mh{constructor(){super(),this._values=[],this.resolvers=[],this._closedPromise=new Promise(t=>this._closedPromiseResolve=t)}get closed(){return this._closedPromise}cancel(t){return dt(this,void 0,void 0,function*(){yield this.return(t)})}write(t){this._ensureOpen()&&(this.resolvers.length<=0?this._values.push(t):this.resolvers.shift().resolve({done:!1,value:t}))}abort(t){this._closedPromiseResolve&&(this.resolvers.length<=0?this._error={error:t}:this.resolvers.shift().reject({done:!0,value:t}))}close(){if(this._closedPromiseResolve){const{resolvers:t}=this;for(;t.length>0;)t.shift().resolve(jt);this._closedPromiseResolve(),this._closedPromiseResolve=void 0}}[Symbol.asyncIterator](){return this}toDOMStream(t){return qe.toDOMStream(this._closedPromiseResolve||this._error?this:this._values,t)}toNodeStream(t){return qe.toNodeStream(this._closedPromiseResolve||this._error?this:this._values,t)}throw(t){return dt(this,void 0,void 0,function*(){return yield this.abort(t),jt})}return(t){return dt(this,void 0,void 0,function*(){return yield this.close(),jt})}read(t){return dt(this,void 0,void 0,function*(){return(yield this.next(t,"read")).value})}peek(t){return dt(this,void 0,void 0,function*(){return(yield this.next(t,"peek")).value})}next(...t){return this._values.length>0?Promise.resolve({done:!1,value:this._values.shift()}):this._error?Promise.reject({done:!0,value:this._error.error}):this._closedPromiseResolve?new Promise((n,r)=>{this.resolvers.push({resolve:n,reject:r})}):Promise.resolve(jt)}_ensureOpen(){if(this._closedPromiseResolve)return!0;throw new Error("AsyncQueue is closed")}}class ic extends BT{write(t){if((t=Et(t)).byteLength>0)return super.write(t)}toString(t=!1){return t?If(this.toUint8Array(!0)):this.toUint8Array(!1).then(If)}toUint8Array(t=!1){return t?Cn(this._values)[0]:dt(this,void 0,void 0,function*(){var n,r,i,s;const a=[];let o=0;try{for(var c=!0,l=ai(this),u;u=yield l.next(),n=u.done,!n;c=!0){s=u.value,c=!1;const f=s;a.push(f),o+=f.byteLength}}catch(f){r={error:f}}finally{try{!c&&!n&&(i=l.return)&&(yield i.call(l))}finally{if(r)throw r.error}}return Cn(a,o)[0]})}}class Fc{constructor(t){t&&(this.source=new $T(qe.fromIterable(t)))}[Symbol.iterator](){return this}next(t){return this.source.next(t)}throw(t){return this.source.throw(t)}return(t){return this.source.return(t)}peek(t){return this.source.peek(t)}read(t){return this.source.read(t)}}class fs{constructor(t){t instanceof fs?this.source=t.source:t instanceof ic?this.source=new Jr(qe.fromAsyncIterable(t)):ig(t)?this.source=new Jr(qe.fromNodeStream(t)):jd(t)?this.source=new Jr(qe.fromDOMStream(t)):rg(t)?this.source=new Jr(qe.fromDOMStream(t.body)):Ya(t)?this.source=new Jr(qe.fromIterable(t)):fi(t)?this.source=new Jr(qe.fromAsyncIterable(t)):Ns(t)&&(this.source=new Jr(qe.fromAsyncIterable(t)))}[Symbol.asyncIterator](){return this}next(t){return this.source.next(t)}throw(t){return this.source.throw(t)}return(t){return this.source.return(t)}get closed(){return this.source.closed}cancel(t){return this.source.cancel(t)}peek(t){return this.source.peek(t)}read(t){return this.source.read(t)}}class $T{constructor(t){this.source=t}cancel(t){this.return(t)}peek(t){return this.next(t,"peek").value}read(t){return this.next(t,"read").value}next(t,n="read"){return this.source.next({cmd:n,size:t})}throw(t){return Object.create(this.source.throw&&this.source.throw(t)||jt)}return(t){return Object.create(this.source.return&&this.source.return(t)||jt)}}class Jr{constructor(t){this.source=t,this._closedPromise=new Promise(n=>this._closedPromiseResolve=n)}cancel(t){return dt(this,void 0,void 0,function*(){yield this.return(t)})}get closed(){return this._closedPromise}read(t){return dt(this,void 0,void 0,function*(){return(yield this.next(t,"read")).value})}peek(t){return dt(this,void 0,void 0,function*(){return(yield this.next(t,"peek")).value})}next(t){return dt(this,arguments,void 0,function*(n,r="read"){return yield this.source.next({cmd:r,size:n})})}throw(t){return dt(this,void 0,void 0,function*(){const n=this.source.throw&&(yield this.source.throw(t))||jt;return this._closedPromiseResolve&&this._closedPromiseResolve(),this._closedPromiseResolve=void 0,Object.create(n)})}return(t){return dt(this,void 0,void 0,function*(){const n=this.source.return&&(yield this.source.return(t))||jt;return this._closedPromiseResolve&&this._closedPromiseResolve(),this._closedPromiseResolve=void 0,Object.create(n)})}}class Sp extends Fc{constructor(t,n){super(),this.position=0,this.buffer=Et(t),this.size=n===void 0?this.buffer.byteLength:n}readInt32(t){const{buffer:n,byteOffset:r}=this.readAt(t,4);return new DataView(n,r).getInt32(0,!0)}seek(t){return this.position=Math.min(t,this.size),t<this.size}read(t){const{buffer:n,size:r,position:i}=this;return n&&i<r?(typeof t!="number"&&(t=Number.POSITIVE_INFINITY),this.position=Math.min(r,i+Math.min(r-i,t)),n.subarray(i,this.position)):null}readAt(t,n){const r=this.buffer,i=Math.min(this.size,t+n);return r?r.subarray(t,i):new Uint8Array(n)}close(){this.buffer&&(this.buffer=null)}throw(t){return this.close(),{done:!0,value:t}}return(t){return this.close(),{done:!0,value:t}}}class kc extends fs{constructor(t,n){super(),this.position=0,this._handle=t,typeof n=="number"?this.size=n:this._pending=dt(this,void 0,void 0,function*(){this.size=(yield t.stat()).size,delete this._pending})}readInt32(t){return dt(this,void 0,void 0,function*(){const{buffer:n,byteOffset:r}=yield this.readAt(t,4);return new DataView(n,r).getInt32(0,!0)})}seek(t){return dt(this,void 0,void 0,function*(){return this._pending&&(yield this._pending),this.position=Math.min(t,this.size),t<this.size})}read(t){return dt(this,void 0,void 0,function*(){this._pending&&(yield this._pending);const{_handle:n,size:r,position:i}=this;if(n&&i<r){typeof t!="number"&&(t=Number.POSITIVE_INFINITY);let s=i,a=0,o=0;const c=Math.min(r,s+Math.min(r-s,t)),l=new Uint8Array(Math.max(0,(this.position=c)-s));for(;(s+=o)<c&&(a+=o)<l.byteLength;)({bytesRead:o}=yield n.read(l,a,l.byteLength-a,s));return l}return null})}readAt(t,n){return dt(this,void 0,void 0,function*(){this._pending&&(yield this._pending);const{_handle:r,size:i}=this;if(r&&t+n<i){const s=Math.min(i,t+n),a=new Uint8Array(s-t);return(yield r.read(a,0,n,t)).buffer}return new Uint8Array(n)})}close(){return dt(this,void 0,void 0,function*(){const t=this._handle;this._handle=null,t&&(yield t.close())})}throw(t){return dt(this,void 0,void 0,function*(){return yield this.close(),{done:!0,value:t}})}return(t){return dt(this,void 0,void 0,function*(){return yield this.close(),{done:!0,value:t}})}}const UT=65536;function Xi(e){return e<0&&(e=4294967295+e+1),`0x${e.toString(16)}`}const ds=8,yh=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8];class jb{constructor(t){this.buffer=t}high(){return this.buffer[1]}low(){return this.buffer[0]}_times(t){const n=new Uint32Array([this.buffer[1]>>>16,this.buffer[1]&65535,this.buffer[0]>>>16,this.buffer[0]&65535]),r=new Uint32Array([t.buffer[1]>>>16,t.buffer[1]&65535,t.buffer[0]>>>16,t.buffer[0]&65535]);let i=n[3]*r[3];this.buffer[0]=i&65535;let s=i>>>16;return i=n[2]*r[3],s+=i,i=n[3]*r[2]>>>0,s+=i,this.buffer[0]+=s<<16,this.buffer[1]=s>>>0<i?UT:0,this.buffer[1]+=s>>>16,this.buffer[1]+=n[1]*r[3]+n[2]*r[2]+n[3]*r[1],this.buffer[1]+=n[0]*r[3]+n[1]*r[2]+n[2]*r[1]+n[3]*r[0]<<16,this}_plus(t){const n=this.buffer[0]+t.buffer[0]>>>0;this.buffer[1]+=t.buffer[1],n<this.buffer[0]>>>0&&++this.buffer[1],this.buffer[0]=n}lessThan(t){return this.buffer[1]<t.buffer[1]||this.buffer[1]===t.buffer[1]&&this.buffer[0]<t.buffer[0]}equals(t){return this.buffer[1]===t.buffer[1]&&this.buffer[0]==t.buffer[0]}greaterThan(t){return t.lessThan(this)}hex(){return`${Xi(this.buffer[1])} ${Xi(this.buffer[0])}`}}class Lt extends jb{times(t){return this._times(t),this}plus(t){return this._plus(t),this}static from(t,n=new Uint32Array(2)){return Lt.fromString(typeof t=="string"?t:t.toString(),n)}static fromNumber(t,n=new Uint32Array(2)){return Lt.fromString(t.toString(),n)}static fromString(t,n=new Uint32Array(2)){const r=t.length,i=new Lt(n);for(let s=0;s<r;){const a=ds<r-s?ds:r-s,o=new Lt(new Uint32Array([Number.parseInt(t.slice(s,s+a),10),0])),c=new Lt(new Uint32Array([yh[a],0]));i.times(c),i.plus(o),s+=a}return i}static convertArray(t){const n=new Uint32Array(t.length*2);for(let r=-1,i=t.length;++r<i;)Lt.from(t[r],new Uint32Array(n.buffer,n.byteOffset+2*r*4,2));return n}static multiply(t,n){return new Lt(new Uint32Array(t.buffer)).times(n)}static add(t,n){return new Lt(new Uint32Array(t.buffer)).plus(n)}}class Se extends jb{negate(){return this.buffer[0]=~this.buffer[0]+1,this.buffer[1]=~this.buffer[1],this.buffer[0]==0&&++this.buffer[1],this}times(t){return this._times(t),this}plus(t){return this._plus(t),this}lessThan(t){const n=this.buffer[1]<<0,r=t.buffer[1]<<0;return n<r||n===r&&this.buffer[0]<t.buffer[0]}static from(t,n=new Uint32Array(2)){return Se.fromString(typeof t=="string"?t:t.toString(),n)}static fromNumber(t,n=new Uint32Array(2)){return Se.fromString(t.toString(),n)}static fromString(t,n=new Uint32Array(2)){const r=t.startsWith("-"),i=t.length,s=new Se(n);for(let a=r?1:0;a<i;){const o=ds<i-a?ds:i-a,c=new Se(new Uint32Array([Number.parseInt(t.slice(a,a+o),10),0])),l=new Se(new Uint32Array([yh[o],0]));s.times(l),s.plus(c),a+=o}return r?s.negate():s}static convertArray(t){const n=new Uint32Array(t.length*2);for(let r=-1,i=t.length;++r<i;)Se.from(t[r],new Uint32Array(n.buffer,n.byteOffset+2*r*4,2));return n}static multiply(t,n){return new Se(new Uint32Array(t.buffer)).times(n)}static add(t,n){return new Se(new Uint32Array(t.buffer)).plus(n)}}class xn{constructor(t){this.buffer=t}high(){return new Se(new Uint32Array(this.buffer.buffer,this.buffer.byteOffset+8,2))}low(){return new Se(new Uint32Array(this.buffer.buffer,this.buffer.byteOffset,2))}negate(){return this.buffer[0]=~this.buffer[0]+1,this.buffer[1]=~this.buffer[1],this.buffer[2]=~this.buffer[2],this.buffer[3]=~this.buffer[3],this.buffer[0]==0&&++this.buffer[1],this.buffer[1]==0&&++this.buffer[2],this.buffer[2]==0&&++this.buffer[3],this}times(t){const n=new Lt(new Uint32Array([this.buffer[3],0])),r=new Lt(new Uint32Array([this.buffer[2],0])),i=new Lt(new Uint32Array([this.buffer[1],0])),s=new Lt(new Uint32Array([this.buffer[0],0])),a=new Lt(new Uint32Array([t.buffer[3],0])),o=new Lt(new Uint32Array([t.buffer[2],0])),c=new Lt(new Uint32Array([t.buffer[1],0])),l=new Lt(new Uint32Array([t.buffer[0],0]));let u=Lt.multiply(s,l);this.buffer[0]=u.low();const f=new Lt(new Uint32Array([u.high(),0]));return u=Lt.multiply(i,l),f.plus(u),u=Lt.multiply(s,c),f.plus(u),this.buffer[1]=f.low(),this.buffer[3]=f.lessThan(u)?1:0,this.buffer[2]=f.high(),new Lt(new Uint32Array(this.buffer.buffer,this.buffer.byteOffset+8,2)).plus(Lt.multiply(r,l)).plus(Lt.multiply(i,c)).plus(Lt.multiply(s,o)),this.buffer[3]+=Lt.multiply(n,l).plus(Lt.multiply(r,c)).plus(Lt.multiply(i,o)).plus(Lt.multiply(s,a)).low(),this}plus(t){const n=new Uint32Array(4);return n[3]=this.buffer[3]+t.buffer[3]>>>0,n[2]=this.buffer[2]+t.buffer[2]>>>0,n[1]=this.buffer[1]+t.buffer[1]>>>0,n[0]=this.buffer[0]+t.buffer[0]>>>0,n[0]<this.buffer[0]>>>0&&++n[1],n[1]<this.buffer[1]>>>0&&++n[2],n[2]<this.buffer[2]>>>0&&++n[3],this.buffer[3]=n[3],this.buffer[2]=n[2],this.buffer[1]=n[1],this.buffer[0]=n[0],this}hex(){return`${Xi(this.buffer[3])} ${Xi(this.buffer[2])} ${Xi(this.buffer[1])} ${Xi(this.buffer[0])}`}static multiply(t,n){return new xn(new Uint32Array(t.buffer)).times(n)}static add(t,n){return new xn(new Uint32Array(t.buffer)).plus(n)}static from(t,n=new Uint32Array(4)){return xn.fromString(typeof t=="string"?t:t.toString(),n)}static fromNumber(t,n=new Uint32Array(4)){return xn.fromString(t.toString(),n)}static fromString(t,n=new Uint32Array(4)){const r=t.startsWith("-"),i=t.length,s=new xn(n);for(let a=r?1:0;a<i;){const o=ds<i-a?ds:i-a,c=new xn(new Uint32Array([Number.parseInt(t.slice(a,a+o),10),0,0,0])),l=new xn(new Uint32Array([yh[o],0,0,0]));s.times(l),s.plus(c),a+=o}return r?s.negate():s}static convertArray(t){const n=new Uint32Array(t.length*4);for(let r=-1,i=t.length;++r<i;)xn.from(t[r],new Uint32Array(n.buffer,n.byteOffset+16*r,4));return n}}class Vb extends wt{constructor(t,n,r,i,s=qt.V5){super(),this.nodesIndex=-1,this.buffersIndex=-1,this.bytes=t,this.nodes=n,this.buffers=r,this.dictionaries=i,this.metadataVersion=s}visit(t){return super.visit(t instanceof Nt?t.type:t)}visitNull(t,{length:n}=this.nextFieldNode()){return nt({type:t,length:n})}visitBool(t,{length:n,nullCount:r}=this.nextFieldNode()){return nt({type:t,length:n,nullCount:r,nullBitmap:this.readNullBitmap(t,r),data:this.readData(t)})}visitInt(t,{length:n,nullCount:r}=this.nextFieldNode()){return nt({type:t,length:n,nullCount:r,nullBitmap:this.readNullBitmap(t,r),data:this.readData(t)})}visitFloat(t,{length:n,nullCount:r}=this.nextFieldNode()){return nt({type:t,length:n,nullCount:r,nullBitmap:this.readNullBitmap(t,r),data:this.readData(t)})}visitUtf8(t,{length:n,nullCount:r}=this.nextFieldNode()){return nt({type:t,length:n,nullCount:r,nullBitmap:this.readNullBitmap(t,r),valueOffsets:this.readOffsets(t),data:this.readData(t)})}visitLargeUtf8(t,{length:n,nullCount:r}=this.nextFieldNode()){return nt({type:t,length:n,nullCount:r,nullBitmap:this.readNullBitmap(t,r),valueOffsets:this.readOffsets(t),data:this.readData(t)})}visitBinary(t,{length:n,nullCount:r}=this.nextFieldNode()){return nt({type:t,length:n,nullCount:r,nullBitmap:this.readNullBitmap(t,r),valueOffsets:this.readOffsets(t),data:this.readData(t)})}visitLargeBinary(t,{length:n,nullCount:r}=this.nextFieldNode()){return nt({type:t,length:n,nullCount:r,nullBitmap:this.readNullBitmap(t,r),valueOffsets:this.readOffsets(t),data:this.readData(t)})}visitFixedSizeBinary(t,{length:n,nullCount:r}=this.nextFieldNode()){return nt({type:t,length:n,nullCount:r,nullBitmap:this.readNullBitmap(t,r),data:this.readData(t)})}visitDate(t,{length:n,nullCount:r}=this.nextFieldNode()){return nt({type:t,length:n,nullCount:r,nullBitmap:this.readNullBitmap(t,r),data:this.readData(t)})}visitTimestamp(t,{length:n,nullCount:r}=this.nextFieldNode()){return nt({type:t,length:n,nullCount:r,nullBitmap:this.readNullBitmap(t,r),data:this.readData(t)})}visitTime(t,{length:n,nullCount:r}=this.nextFieldNode()){return nt({type:t,length:n,nullCount:r,nullBitmap:this.readNullBitmap(t,r),data:this.readData(t)})}visitDecimal(t,{length:n,nullCount:r}=this.nextFieldNode()){return nt({type:t,length:n,nullCount:r,nullBitmap:this.readNullBitmap(t,r),data:this.readData(t)})}visitList(t,{length:n,nullCount:r}=this.nextFieldNode()){return nt({type:t,length:n,nullCount:r,nullBitmap:this.readNullBitmap(t,r),valueOffsets:this.readOffsets(t),child:this.visit(t.children[0])})}visitStruct(t,{length:n,nullCount:r}=this.nextFieldNode()){return nt({type:t,length:n,nullCount:r,nullBitmap:this.readNullBitmap(t,r),children:this.visitMany(t.children)})}visitUnion(t,{length:n,nullCount:r}=this.nextFieldNode()){return this.metadataVersion<qt.V5&&this.readNullBitmap(t,r),t.mode===ye.Sparse?this.visitSparseUnion(t,{length:n,nullCount:r}):this.visitDenseUnion(t,{length:n,nullCount:r})}visitDenseUnion(t,{length:n,nullCount:r}=this.nextFieldNode()){return nt({type:t,length:n,nullCount:r,typeIds:this.readTypeIds(t),valueOffsets:this.readOffsets(t),children:this.visitMany(t.children)})}visitSparseUnion(t,{length:n,nullCount:r}=this.nextFieldNode()){return nt({type:t,length:n,nullCount:r,typeIds:this.readTypeIds(t),children:this.visitMany(t.children)})}visitDictionary(t,{length:n,nullCount:r}=this.nextFieldNode()){return nt({type:t,length:n,nullCount:r,nullBitmap:this.readNullBitmap(t,r),data:this.readData(t.indices),dictionary:this.readDictionary(t)})}visitInterval(t,{length:n,nullCount:r}=this.nextFieldNode()){return nt({type:t,length:n,nullCount:r,nullBitmap:this.readNullBitmap(t,r),data:this.readData(t)})}visitDuration(t,{length:n,nullCount:r}=this.nextFieldNode()){return nt({type:t,length:n,nullCount:r,nullBitmap:this.readNullBitmap(t,r),data:this.readData(t)})}visitFixedSizeList(t,{length:n,nullCount:r}=this.nextFieldNode()){return nt({type:t,length:n,nullCount:r,nullBitmap:this.readNullBitmap(t,r),child:this.visit(t.children[0])})}visitMap(t,{length:n,nullCount:r}=this.nextFieldNode()){return nt({type:t,length:n,nullCount:r,nullBitmap:this.readNullBitmap(t,r),valueOffsets:this.readOffsets(t),child:this.visit(t.children[0])})}nextFieldNode(){return this.nodes[++this.nodesIndex]}nextBufferRange(){return this.buffers[++this.buffersIndex]}readNullBitmap(t,n,r=this.nextBufferRange()){return n>0&&this.readData(t,r)||new Uint8Array(0)}readOffsets(t,n){return this.readData(t,n)}readTypeIds(t,n){return this.readData(t,n)}readData(t,{length:n,offset:r}=this.nextBufferRange()){return this.bytes.subarray(r,r+n)}readDictionary(t){return this.dictionaries.get(t.id)}}class PT extends Vb{constructor(t,n,r,i,s){super(new Uint8Array(0),n,r,i,s),this.sources=t}readNullBitmap(t,n,{offset:r}=this.nextBufferRange()){return n<=0?new Uint8Array(0):Oc(this.sources[r])}readOffsets(t,{offset:n}=this.nextBufferRange()){return Ft(Uint8Array,Ft(t.OffsetArrayType,this.sources[n]))}readTypeIds(t,{offset:n}=this.nextBufferRange()){return Ft(Uint8Array,Ft(t.ArrayType,this.sources[n]))}readData(t,{offset:n}=this.nextBufferRange()){const{sources:r}=this;return X.isTimestamp(t)||(X.isInt(t)||X.isTime(t))&&t.bitWidth===64||X.isDuration(t)||X.isDate(t)&&t.unit===nn.MILLISECOND?Ft(Uint8Array,Se.convertArray(r[n])):X.isDecimal(t)?Ft(Uint8Array,xn.convertArray(r[n])):X.isBinary(t)||X.isLargeBinary(t)||X.isFixedSizeBinary(t)?jT(r[n]):X.isBool(t)?Oc(r[n]):X.isUtf8(t)||X.isLargeUtf8(t)?za(r[n].join("")):Ft(Uint8Array,Ft(t.ArrayType,r[n].map(i=>+i)))}}function jT(e){const t=e.join(""),n=new Uint8Array(t.length/2);for(let r=0;r<t.length;r+=2)n[r>>1]=Number.parseInt(t.slice(r,r+2),16);return n}class zb extends Os{constructor(t){super(t),this._values=new Wa(Uint8Array)}get byteLength(){let t=this._pendingLength+this.length*4;return this._offsets&&(t+=this._offsets.byteLength),this._values&&(t+=this._values.byteLength),this._nulls&&(t+=this._nulls.byteLength),t}setValue(t,n){return super.setValue(t,Et(n))}_flushPending(t,n){const r=this._offsets,i=this._values.reserve(n).buffer;let s=0;for(const[a,o]of t)if(o===void 0)r.set(a,0);else{const c=o.length;i.set(o,s),r.set(a,c),s+=c}}}class Yb extends Os{constructor(t){super(t),this._values=new Wa(Uint8Array)}get byteLength(){let t=this._pendingLength+this.length*4;return this._offsets&&(t+=this._offsets.byteLength),this._values&&(t+=this._values.byteLength),this._nulls&&(t+=this._nulls.byteLength),t}setValue(t,n){return super.setValue(t,Et(n))}_flushPending(t,n){const r=this._offsets,i=this._values.reserve(n).buffer;let s=0;for(const[a,o]of t)if(o===void 0)r.set(a,BigInt(0));else{const c=o.length;i.set(o,s),r.set(a,BigInt(c)),s+=c}}}class VT extends Le{constructor(t){super(t),this._values=new Ub}setValue(t,n){this._values.set(t,+n)}}class Dl extends br{}Dl.prototype._setValue=Qg;class Wb extends Dl{}Wb.prototype._setValue=qd;class Hb extends Dl{}Hb.prototype._setValue=Gd;class qb extends br{}qb.prototype._setValue=tb;class zT extends Le{constructor({type:t,nullValues:n,dictionaryHashFunction:r}){super({type:new kr(t.dictionary,t.indices,t.id,t.isOrdered)}),this._nulls=null,this._dictionaryOffset=0,this._keysToIndices=Object.create(null),this.indices=Cc({type:this.type.indices,nullValues:n}),this.dictionary=Cc({type:this.type.dictionary,nullValues:null}),typeof r=="function"&&(this.valueToKey=r)}get values(){return this.indices.values}get nullCount(){return this.indices.nullCount}get nullBitmap(){return this.indices.nullBitmap}get byteLength(){return this.indices.byteLength+this.dictionary.byteLength}get reservedLength(){return this.indices.reservedLength+this.dictionary.reservedLength}get reservedByteLength(){return this.indices.reservedByteLength+this.dictionary.reservedByteLength}isValid(t){return this.indices.isValid(t)}setValid(t,n){const r=this.indices;return n=r.setValid(t,n),this.length=r.length,n}setValue(t,n){const r=this._keysToIndices,i=this.valueToKey(n);let s=r[i];return s===void 0&&(r[i]=s=this._dictionaryOffset+this.dictionary.append(n).length-1),this.indices.setValue(t,s)}flush(){const t=this.type,n=this._dictionary,r=this.dictionary.toVector(),i=this.indices.flush().clone(t);return i.dictionary=n?n.concat(r):r,this.finished||(this._dictionaryOffset+=r.length),this._dictionary=i.dictionary,this.clear(),i}finish(){return this.indices.finish(),this.dictionary.finish(),this._dictionaryOffset=0,this._keysToIndices=Object.create(null),super.finish()}clear(){return this.indices.clear(),this.dictionary.clear(),super.clear()}valueToKey(t){return typeof t=="string"?t:`${t}`}}class Gb extends br{}Gb.prototype._setValue=Gg;class YT extends Le{setValue(t,n){const[r]=this.children,i=t*this.stride;for(let s=-1,a=n.length;++s<a;)r.set(i+s,n[s])}addChild(t,n="0"){if(this.numChildren>0)throw new Error("FixedSizeListBuilder can only have one child.");const r=this.children.push(t);return this.type=new Ea(this.type.listSize,new Nt(n,t.type,!0)),r}}class Ll extends br{setValue(t,n){this._values.set(t,n)}}class WT extends Ll{setValue(t,n){super.setValue(t,Wg(n))}}class HT extends Ll{}class qT extends Ll{}class Fl extends br{}Fl.prototype._setValue=rb;class Xb extends Fl{}Xb.prototype._setValue=rh;class Kb extends Fl{}Kb.prototype._setValue=ih;class Rs extends br{}Rs.prototype._setValue=ib;class Qb extends Rs{}Qb.prototype._setValue=sh;class Jb extends Rs{}Jb.prototype._setValue=ah;class Zb extends Rs{}Zb.prototype._setValue=oh;class t_ extends Rs{}t_.prototype._setValue=ch;class _r extends br{setValue(t,n){this._values.set(t,n)}}class GT extends _r{}class XT extends _r{}class KT extends _r{}class QT extends _r{}class JT extends _r{}class ZT extends _r{}class tA extends _r{}class eA extends _r{}class nA extends Os{constructor(t){super(t),this._offsets=new Pb(t.type)}addChild(t,n="0"){if(this.numChildren>0)throw new Error("ListBuilder can only have one child.");return this.children[this.numChildren]=t,this.type=new us(new Nt(n,t.type,!0)),this.numChildren-1}_flushPending(t){const n=this._offsets,[r]=this.children;for(const[i,s]of t)if(typeof s>"u")n.set(i,0);else{const a=s,o=a.length,c=n.set(i,o).buffer[i];for(let l=-1;++l<o;)r.set(c+l,a[l])}}}class rA extends Os{set(t,n){return super.set(t,n)}setValue(t,n){const r=n instanceof Map?n:new Map(Object.entries(n)),i=this._pending||(this._pending=new Map),s=i.get(t);s&&(this._pendingLength-=s.size),this._pendingLength+=r.size,i.set(t,r)}addChild(t,n=`${this.numChildren}`){if(this.numChildren>0)throw new Error("ListBuilder can only have one child.");return this.children[this.numChildren]=t,this.type=new Ta(new Nt(n,t.type,!0),this.type.keysSorted),this.numChildren-1}_flushPending(t){const n=this._offsets,[r]=this.children;for(const[i,s]of t)if(s===void 0)n.set(i,0);else{let{[i]:a,[i+1]:o}=n.set(i,s.size).buffer;for(const c of s.entries())if(r.set(a,c),++a>=o)break}}}class iA extends Le{setValue(t,n){}setValid(t,n){return this.length=Math.max(t+1,this.length),n}}class sA extends Le{setValue(t,n){const{children:r,type:i}=this;switch(Array.isArray(n)||n.constructor){case!0:return i.children.forEach((s,a)=>r[a].set(t,n[a]));case Map:return i.children.forEach((s,a)=>r[a].set(t,n.get(s.name)));default:return i.children.forEach((s,a)=>r[a].set(t,n[s.name]))}}setValid(t,n){return super.setValid(t,n)||this.children.forEach(r=>r.setValid(t,n)),n}addChild(t,n=`${this.numChildren}`){const r=this.children.push(t);return this.type=new ce([...this.type.children,new Nt(n,t.type,!0)]),r}}class Ds extends br{}Ds.prototype._setValue=Jg;class e_ extends Ds{}e_.prototype._setValue=Xd;class n_ extends Ds{}n_.prototype._setValue=Kd;class r_ extends Ds{}r_.prototype._setValue=Qd;class i_ extends Ds{}i_.prototype._setValue=Jd;class Ls extends br{}Ls.prototype._setValue=Zg;class s_ extends Ls{}s_.prototype._setValue=Zd;class a_ extends Ls{}a_.prototype._setValue=th;class o_ extends Ls{}o_.prototype._setValue=eh;class c_ extends Ls{}c_.prototype._setValue=nh;class gh extends Le{constructor(t){super(t),this._typeIds=new Ha(Int8Array,0,1),typeof t.valueToChildTypeId=="function"&&(this._valueToChildTypeId=t.valueToChildTypeId)}get typeIdToChildIndex(){return this.type.typeIdToChildIndex}append(t,n){return this.set(this.length,t,n)}set(t,n,r){return r===void 0&&(r=this._valueToChildTypeId(this,n,t)),this.setValue(t,n,r),this}setValue(t,n,r){this._typeIds.set(t,r);const i=this.type.typeIdToChildIndex[r],s=this.children[i];s?.set(t,n)}addChild(t,n=`${this.children.length}`){const r=this.children.push(t),{type:{children:i,mode:s,typeIds:a}}=this,o=[...i,new Nt(n,t.type)];return this.type=new Sa(s,[...a,r],o),r}_valueToChildTypeId(t,n,r){throw new Error("Cannot map UnionBuilder value to child typeId. Pass the `childTypeId` as the second argument to unionBuilder.append(), or supply a `valueToChildTypeId` function as part of the UnionBuilder constructor options.")}}class aA extends gh{}class oA extends gh{constructor(t){super(t),this._offsets=new Ha(Int32Array)}setValue(t,n,r){const i=this._typeIds.set(t,r).buffer[t],s=this.getChildAt(this.type.typeIdToChildIndex[i]),a=this._offsets.set(t,s.length).buffer[t];s?.set(a,n)}}class l_ extends Os{constructor(t){super(t),this._values=new Wa(Uint8Array)}get byteLength(){let t=this._pendingLength+this.length*4;return this._offsets&&(t+=this._offsets.byteLength),this._values&&(t+=this._values.byteLength),this._nulls&&(t+=this._nulls.byteLength),t}setValue(t,n){return super.setValue(t,za(n))}_flushPending(t,n){}}l_.prototype._flushPending=zb.prototype._flushPending;class u_ extends Os{constructor(t){super(t),this._values=new Wa(Uint8Array)}get byteLength(){let t=this._pendingLength+this.length*4;return this._offsets&&(t+=this._offsets.byteLength),this._values&&(t+=this._values.byteLength),this._nulls&&(t+=this._nulls.byteLength),t}setValue(t,n){return super.setValue(t,za(n))}_flushPending(t,n){}}u_.prototype._flushPending=Yb.prototype._flushPending;class cA extends wt{visitNull(){return iA}visitBool(){return VT}visitInt(){return _r}visitInt8(){return GT}visitInt16(){return XT}visitInt32(){return KT}visitInt64(){return QT}visitUint8(){return JT}visitUint16(){return ZT}visitUint32(){return tA}visitUint64(){return eA}visitFloat(){return Ll}visitFloat16(){return WT}visitFloat32(){return HT}visitFloat64(){return qT}visitUtf8(){return l_}visitLargeUtf8(){return u_}visitBinary(){return zb}visitLargeBinary(){return Yb}visitFixedSizeBinary(){return Gb}visitDate(){return Dl}visitDateDay(){return Wb}visitDateMillisecond(){return Hb}visitTimestamp(){return Ds}visitTimestampSecond(){return e_}visitTimestampMillisecond(){return n_}visitTimestampMicrosecond(){return r_}visitTimestampNanosecond(){return i_}visitTime(){return Ls}visitTimeSecond(){return s_}visitTimeMillisecond(){return a_}visitTimeMicrosecond(){return o_}visitTimeNanosecond(){return c_}visitDecimal(){return qb}visitList(){return nA}visitStruct(){return sA}visitUnion(){return gh}visitDenseUnion(){return oA}visitSparseUnion(){return aA}visitDictionary(){return zT}visitInterval(){return Fl}visitIntervalDayTime(){return Xb}visitIntervalYearMonth(){return Kb}visitDuration(){return Rs}visitDurationSecond(){return Qb}visitDurationMillisecond(){return Jb}visitDurationMicrosecond(){return Zb}visitDurationNanosecond(){return t_}visitFixedSizeList(){return YT}visitMap(){return rA}}const lA=new cA;class et extends wt{compareSchemas(t,n){return t===n||n instanceof t.constructor&&this.compareManyFields(t.fields,n.fields)}compareManyFields(t,n){return t===n||Array.isArray(t)&&Array.isArray(n)&&t.length===n.length&&t.every((r,i)=>this.compareFields(r,n[i]))}compareFields(t,n){return t===n||n instanceof t.constructor&&t.name===n.name&&t.nullable===n.nullable&&this.visit(t.type,n.type)}}function ve(e,t){return t instanceof e.constructor}function Ei(e,t){return e===t||ve(e,t)}function wr(e,t){return e===t||ve(e,t)&&e.bitWidth===t.bitWidth&&e.isSigned===t.isSigned}function kl(e,t){return e===t||ve(e,t)&&e.precision===t.precision}function uA(e,t){return e===t||ve(e,t)&&e.byteWidth===t.byteWidth}function bh(e,t){return e===t||ve(e,t)&&e.unit===t.unit}function qa(e,t){return e===t||ve(e,t)&&e.unit===t.unit&&e.timezone===t.timezone}function Ga(e,t){return e===t||ve(e,t)&&e.unit===t.unit&&e.bitWidth===t.bitWidth}function fA(e,t){return e===t||ve(e,t)&&e.children.length===t.children.length&&ur.compareManyFields(e.children,t.children)}function dA(e,t){return e===t||ve(e,t)&&e.children.length===t.children.length&&ur.compareManyFields(e.children,t.children)}function _h(e,t){return e===t||ve(e,t)&&e.mode===t.mode&&e.typeIds.every((n,r)=>n===t.typeIds[r])&&ur.compareManyFields(e.children,t.children)}function hA(e,t){return e===t||ve(e,t)&&e.id===t.id&&e.isOrdered===t.isOrdered&&ur.visit(e.indices,t.indices)&&ur.visit(e.dictionary,t.dictionary)}function wh(e,t){return e===t||ve(e,t)&&e.unit===t.unit}function Xa(e,t){return e===t||ve(e,t)&&e.unit===t.unit}function pA(e,t){return e===t||ve(e,t)&&e.listSize===t.listSize&&e.children.length===t.children.length&&ur.compareManyFields(e.children,t.children)}function mA(e,t){return e===t||ve(e,t)&&e.keysSorted===t.keysSorted&&e.children.length===t.children.length&&ur.compareManyFields(e.children,t.children)}et.prototype.visitNull=Ei;et.prototype.visitBool=Ei;et.prototype.visitInt=wr;et.prototype.visitInt8=wr;et.prototype.visitInt16=wr;et.prototype.visitInt32=wr;et.prototype.visitInt64=wr;et.prototype.visitUint8=wr;et.prototype.visitUint16=wr;et.prototype.visitUint32=wr;et.prototype.visitUint64=wr;et.prototype.visitFloat=kl;et.prototype.visitFloat16=kl;et.prototype.visitFloat32=kl;et.prototype.visitFloat64=kl;et.prototype.visitUtf8=Ei;et.prototype.visitLargeUtf8=Ei;et.prototype.visitBinary=Ei;et.prototype.visitLargeBinary=Ei;et.prototype.visitFixedSizeBinary=uA;et.prototype.visitDate=bh;et.prototype.visitDateDay=bh;et.prototype.visitDateMillisecond=bh;et.prototype.visitTimestamp=qa;et.prototype.visitTimestampSecond=qa;et.prototype.visitTimestampMillisecond=qa;et.prototype.visitTimestampMicrosecond=qa;et.prototype.visitTimestampNanosecond=qa;et.prototype.visitTime=Ga;et.prototype.visitTimeSecond=Ga;et.prototype.visitTimeMillisecond=Ga;et.prototype.visitTimeMicrosecond=Ga;et.prototype.visitTimeNanosecond=Ga;et.prototype.visitDecimal=Ei;et.prototype.visitList=fA;et.prototype.visitStruct=dA;et.prototype.visitUnion=_h;et.prototype.visitDenseUnion=_h;et.prototype.visitSparseUnion=_h;et.prototype.visitDictionary=hA;et.prototype.visitInterval=wh;et.prototype.visitIntervalDayTime=wh;et.prototype.visitIntervalYearMonth=wh;et.prototype.visitDuration=Xa;et.prototype.visitDurationSecond=Xa;et.prototype.visitDurationMillisecond=Xa;et.prototype.visitDurationMicrosecond=Xa;et.prototype.visitDurationNanosecond=Xa;et.prototype.visitFixedSizeList=pA;et.prototype.visitMap=mA;const ur=new et;function $f(e,t){return ur.compareSchemas(e,t)}function yA(e,t){return ur.visit(e,t)}function Cc(e){const t=e.type,n=new(lA.getVisitFn(t)())(e);if(t.children&&t.children.length>0){const r=e.children||[],i={nullValues:e.nullValues},s=Array.isArray(r)?((a,o)=>r[o]||i):(({name:a})=>r[a]||i);for(const[a,o]of t.children.entries()){const{type:c}=o,l=s(o,a);n.children.push(Cc(Object.assign(Object.assign({},l),{type:c})))}}return n}function gA(e,t){if(e instanceof At||e instanceof gt||e.type instanceof X||ArrayBuffer.isView(e))return $b(e);const n={type:sc(e),nullValues:[null]},r=[..._A(n)(e)],i=r.length===1?r[0]:r.reduce((s,a)=>s.concat(a));return X.isDictionary(i.type)?i.memoize():i}function bA(e){const t=gA(e),n=new _e(new Rt(t.type.children),t.data[0]);return new ue(n)}function sc(e){if(e.length===0)return new lr;let t=0,n=0,r=0,i=0,s=0,a=0,o=0,c=0;for(const l of e){if(l==null){++t;continue}switch(typeof l){case"bigint":++a;continue;case"boolean":++o;continue;case"number":++i;continue;case"string":++s;continue;case"object":Array.isArray(l)?++n:Object.prototype.toString.call(l)==="[object Date]"?++c:++r;continue}throw new TypeError("Unable to infer Vector type from input values, explicit type declaration expected.")}if(i+t===e.length)return new Wd;if(s+t===e.length)return new kr(new wa,new hi);if(a+t===e.length)return new Yd;if(o+t===e.length)return new va;if(c+t===e.length)return new DE;if(n+t===e.length){const l=e,u=sc(l[l.findIndex(f=>f!=null)]);if(l.every(f=>f==null||yA(u,sc(f))))return new us(new Nt("",u,!0))}else if(r+t===e.length){const l=new Map;for(const u of e)for(const f of Object.keys(u))!l.has(f)&&u[f]!=null&&l.set(f,new Nt(f,sc([u[f]]),!0));return new ce([...l.values()])}throw new TypeError("Unable to infer Vector type from input values, explicit type declaration expected.")}function _A(e){const{["queueingStrategy"]:t="count"}=e,{["highWaterMark"]:n=t!=="bytes"?Number.POSITIVE_INFINITY:Math.pow(2,14)}=e,r=t!=="bytes"?"length":"byteLength";return function*(i){let s=0;const a=Cc(e);for(const o of i)a.append(o)[r]>=n&&++s&&(yield a.toVector());(a.finish().length>0||s===0)&&(yield a.toVector())}}function Fu(e,t){return wA(e,t.map(n=>n.data.concat()))}function wA(e,t){const n=[...e.fields],r=[],i={numBatches:t.reduce((f,d)=>Math.max(f,d.length),0)};let s=0,a=0,o=-1;const c=t.length;let l,u=[];for(;i.numBatches-- >0;){for(a=Number.POSITIVE_INFINITY,o=-1;++o<c;)u[o]=l=t[o].shift(),a=Math.min(a,l?l.length:a);Number.isFinite(a)&&(u=vA(n,a,u,t,i),a>0&&(r[s++]=nt({type:new ce(n),length:a,nullCount:0,children:u.slice()})))}return[e=e.assign(n),r.map(f=>new _e(e,f))]}function vA(e,t,n,r,i){var s;const a=(t+63&-64)>>3;for(let o=-1,c=r.length;++o<c;){const l=n[o],u=l?.length;if(u>=t)u===t?n[o]=l:(n[o]=l.slice(0,t),i.numBatches=Math.max(i.numBatches,r[o].unshift(l.slice(t,u-t))));else{const f=e[o];e[o]=f.clone({nullable:!0}),n[o]=(s=l?._changeLengthAndBackfillNullBitmap(t))!==null&&s!==void 0?s:nt({type:f.type,length:t,nullCount:t,nullBitmap:new Uint8Array(a)})}}return n}var f_;class ue{constructor(...t){var n,r;if(t.length===0)return this.batches=[],this.schema=new Rt([]),this._offsets=[0],this;let i,s;t[0]instanceof Rt&&(i=t.shift()),t.at(-1)instanceof Uint32Array&&(s=t.pop());const a=c=>{if(c){if(c instanceof _e)return[c];if(c instanceof ue)return c.batches;if(c instanceof At){if(c.type instanceof ce)return[new _e(new Rt(c.type.children),c)]}else{if(Array.isArray(c))return c.flatMap(l=>a(l));if(typeof c[Symbol.iterator]=="function")return[...c].flatMap(l=>a(l));if(typeof c=="object"){const l=Object.keys(c),u=l.map(h=>new gt([c[h]])),f=i??new Rt(l.map((h,p)=>new Nt(String(h),u[p].type,u[p].nullable))),[,d]=Fu(f,u);return d.length===0?[new _e(c)]:d}}}return[]},o=t.flatMap(c=>a(c));if(i=(r=i??((n=o[0])===null||n===void 0?void 0:n.schema))!==null&&r!==void 0?r:new Rt([]),!(i instanceof Rt))throw new TypeError("Table constructor expects a [Schema, RecordBatch[]] pair.");for(const c of o){if(!(c instanceof _e))throw new TypeError("Table constructor expects a [Schema, RecordBatch[]] pair.");if(!$f(i,c.schema))throw new TypeError("Table and inner RecordBatch schemas must be equivalent.")}this.schema=i,this.batches=o,this._offsets=s??Ob(this.data)}get data(){return this.batches.map(({data:t})=>t)}get numCols(){return this.schema.fields.length}get numRows(){return this.data.reduce((t,n)=>t+n.length,0)}get nullCount(){return this._nullCount===-1&&(this._nullCount=Mb(this.data)),this._nullCount}isValid(t){return!1}get(t){return null}at(t){return this.get(uh(t,this.numRows))}set(t,n){}indexOf(t,n){return-1}[Symbol.iterator](){return this.batches.length>0?ph.visit(new gt(this.data)):new Array(0)[Symbol.iterator]()}toArray(){return[...this]}toString(){return`[
  ${this.toArray().join(`,
  `)}
]`}concat(...t){const n=this.schema,r=this.data.concat(t.flatMap(({data:i})=>i));return new ue(n,r.map(i=>new _e(n,i)))}slice(t,n){const r=this.schema;[t,n]=Ib({length:this.numRows},t,n);const i=Rb(this.data,this._offsets,t,n);return new ue(r,i.map(s=>new _e(r,s)))}getChild(t){return this.getChildAt(this.schema.fields.findIndex(n=>n.name===t))}getChildAt(t){if(t>-1&&t<this.schema.fields.length){const n=this.data.map(r=>r.children[t]);if(n.length===0){const{type:r}=this.schema.fields[t],i=nt({type:r,length:0,nullCount:0});n.push(i._changeLengthAndBackfillNullBitmap(this.numRows))}return new gt(n)}return null}setChild(t,n){var r;return this.setChildAt((r=this.schema.fields)===null||r===void 0?void 0:r.findIndex(i=>i.name===t),n)}setChildAt(t,n){let r=this.schema,i=[...this.batches];if(t>-1&&t<this.numCols){n||(n=new gt([nt({type:new lr,length:this.numRows})]));const s=r.fields.slice(),a=s[t].clone({type:n.type}),o=this.schema.fields.map((c,l)=>this.getChildAt(l));[s[t],o[t]]=[a,n],[r,i]=Fu(r,o)}return new ue(r,i)}select(t){const n=this.schema.fields.reduce((r,i,s)=>r.set(i.name,s),new Map);return this.selectAt(t.map(r=>n.get(r)).filter(r=>r>-1))}selectAt(t){const n=this.schema.selectAt(t),r=this.batches.map(i=>i.selectAt(t));return new ue(n,r)}assign(t){const n=this.schema.fields,[r,i]=t.schema.fields.reduce((o,c,l)=>{const[u,f]=o,d=n.findIndex(h=>h.name===c.name);return~d?f[d]=l:u.push(l),o},[[],[]]),s=this.schema.assign(t.schema),a=[...n.map((o,c)=>[c,i[c]]).map(([o,c])=>c===void 0?this.getChildAt(o):t.getChildAt(c)),...r.map(o=>t.getChildAt(o))].filter(Boolean);return new ue(...Fu(s,a))}}f_=Symbol.toStringTag;ue[f_]=(e=>(e.schema=null,e.batches=[],e._offsets=new Uint32Array([0]),e._nullCount=-1,e[Symbol.isConcatSpreadable]=!0,e.isValid=Rc(hh),e.get=Rc(Me.getVisitFn(v.Struct)),e.set=Db(rn.getVisitFn(v.Struct)),e.indexOf=Lb(Dc.getVisitFn(v.Struct)),"Table"))(ue.prototype);var d_;let _e=class ra{constructor(...t){switch(t.length){case 2:{if([this.schema]=t,!(this.schema instanceof Rt))throw new TypeError("RecordBatch constructor expects a [Schema, Data] pair.");if([,this.data=nt({nullCount:0,type:new ce(this.schema.fields),children:this.schema.fields.map(n=>nt({type:n.type,nullCount:0}))})]=t,!(this.data instanceof At))throw new TypeError("RecordBatch constructor expects a [Schema, Data] pair.");[this.schema,this.data]=Ep(this.schema,this.data.children);break}case 1:{const[n]=t,{fields:r,children:i,length:s}=Object.keys(n).reduce((c,l,u)=>(c.children[u]=n[l],c.length=Math.max(c.length,n[l].length),c.fields[u]=Nt.new({name:l,type:n[l].type,nullable:!0}),c),{length:0,fields:new Array,children:new Array}),a=new Rt(r),o=nt({type:new ce(r),length:s,children:i,nullCount:0});[this.schema,this.data]=Ep(a,o.children,s);break}default:throw new TypeError("RecordBatch constructor expects an Object mapping names to child Data, or a [Schema, Data] pair.")}}get dictionaries(){return this._dictionaries||(this._dictionaries=h_(this.schema.fields,this.data.children))}get numCols(){return this.schema.fields.length}get numRows(){return this.data.length}get nullCount(){return this.data.nullCount}isValid(t){return this.data.getValid(t)}get(t){return Me.visit(this.data,t)}at(t){return this.get(uh(t,this.numRows))}set(t,n){return rn.visit(this.data,t,n)}indexOf(t,n){return Dc.visit(this.data,t,n)}[Symbol.iterator](){return ph.visit(new gt([this.data]))}toArray(){return[...this]}concat(...t){return new ue(this.schema,[this,...t])}slice(t,n){const[r]=new gt([this.data]).slice(t,n).data;return new ra(this.schema,r)}getChild(t){var n;return this.getChildAt((n=this.schema.fields)===null||n===void 0?void 0:n.findIndex(r=>r.name===t))}getChildAt(t){return t>-1&&t<this.schema.fields.length?new gt([this.data.children[t]]):null}setChild(t,n){var r;return this.setChildAt((r=this.schema.fields)===null||r===void 0?void 0:r.findIndex(i=>i.name===t),n)}setChildAt(t,n){let r=this.schema,i=this.data;if(t>-1&&t<this.numCols){n||(n=new gt([nt({type:new lr,length:this.numRows})]));const s=r.fields.slice(),a=i.children.slice(),o=s[t].clone({type:n.type});[s[t],a[t]]=[o,n.data[0]],r=new Rt(s,new Map(this.schema.metadata)),i=nt({type:new ce(s),children:a})}return new ra(r,i)}select(t){const n=this.schema.select(t),r=new ce(n.fields),i=[];for(const s of t){const a=this.schema.fields.findIndex(o=>o.name===s);~a&&(i[a]=this.data.children[a])}return new ra(n,nt({type:r,length:this.numRows,children:i}))}selectAt(t){const n=this.schema.selectAt(t),r=t.map(s=>this.data.children[s]).filter(Boolean),i=nt({type:new ce(n.fields),length:this.numRows,children:r});return new ra(n,i)}};d_=Symbol.toStringTag;_e[d_]=(e=>(e._nullCount=-1,e[Symbol.isConcatSpreadable]=!0,"RecordBatch"))(_e.prototype);function Ep(e,t,n=t.reduce((r,i)=>Math.max(r,i.length),0)){var r;const i=[...e.fields],s=[...t],a=(n+63&-64)>>3;for(const[o,c]of e.fields.entries()){const l=t[o];(!l||l.length!==n)&&(i[o]=c.clone({nullable:!0}),s[o]=(r=l?._changeLengthAndBackfillNullBitmap(n))!==null&&r!==void 0?r:nt({type:c.type,length:n,nullCount:n,nullBitmap:new Uint8Array(a)}))}return[e.assign(i),nt({type:new ce(i),length:n,children:s})]}function h_(e,t,n=new Map){var r,i;if(((r=e?.length)!==null&&r!==void 0?r:0)>0&&e?.length===t?.length)for(let s=-1,a=e.length;++s<a;){const{type:o}=e[s],c=t[s];for(const l of[c,...((i=c?.dictionary)===null||i===void 0?void 0:i.data)||[]])h_(o.children,l?.children,n);if(X.isDictionary(o)){const{id:l}=o;if(!n.has(l))c?.dictionary&&n.set(l,c.dictionary);else if(n.get(l)!==c.dictionary)throw new Error("Cannot create Schema containing two different dictionaries with the same Id")}}return n}class vh extends _e{constructor(t){const n=t.fields.map(i=>nt({type:i.type})),r=nt({type:new ce(t.fields),nullCount:0,children:n});super(t,r)}}let Ar=class wn{constructor(){this.bb=null,this.bb_pos=0}__init(t,n){return this.bb_pos=t,this.bb=n,this}static getRootAsMessage(t,n){return(n||new wn).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsMessage(t,n){return t.setPosition(t.position()+Dt),(n||new wn).__init(t.readInt32(t.position())+t.position(),t)}version(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):qt.V1}headerType(){const t=this.bb.__offset(this.bb_pos,6);return t?this.bb.readUint8(this.bb_pos+t):It.NONE}header(t){const n=this.bb.__offset(this.bb_pos,8);return n?this.bb.__union(t,this.bb_pos+n):null}bodyLength(){const t=this.bb.__offset(this.bb_pos,10);return t?this.bb.readInt64(this.bb_pos+t):BigInt("0")}customMetadata(t,n){const r=this.bb.__offset(this.bb_pos,12);return r?(n||new Jt).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+r)+t*4),this.bb):null}customMetadataLength(){const t=this.bb.__offset(this.bb_pos,12);return t?this.bb.__vector_len(this.bb_pos+t):0}static startMessage(t){t.startObject(5)}static addVersion(t,n){t.addFieldInt16(0,n,qt.V1)}static addHeaderType(t,n){t.addFieldInt8(1,n,It.NONE)}static addHeader(t,n){t.addFieldOffset(2,n,0)}static addBodyLength(t,n){t.addFieldInt64(3,n,BigInt("0"))}static addCustomMetadata(t,n){t.addFieldOffset(4,n,0)}static createCustomMetadataVector(t,n){t.startVector(4,n.length,4);for(let r=n.length-1;r>=0;r--)t.addOffset(n[r]);return t.endVector()}static startCustomMetadataVector(t,n){t.startVector(4,n,4)}static endMessage(t){return t.endObject()}static finishMessageBuffer(t,n){t.finish(n)}static finishSizePrefixedMessageBuffer(t,n){t.finish(n,void 0,!0)}static createMessage(t,n,r,i,s,a){return wn.startMessage(t),wn.addVersion(t,n),wn.addHeaderType(t,r),wn.addHeader(t,i),wn.addBodyLength(t,s),wn.addCustomMetadata(t,a),wn.endMessage(t)}};class xA extends wt{visit(t,n){return t==null||n==null?void 0:super.visit(t,n)}visitNull(t,n){return pp.startNull(n),pp.endNull(n)}visitInt(t,n){return Be.startInt(n),Be.addBitWidth(n,t.bitWidth),Be.addIsSigned(n,t.isSigned),Be.endInt(n)}visitFloat(t,n){return An.startFloatingPoint(n),An.addPrecision(n,t.precision),An.endFloatingPoint(n)}visitBinary(t,n){return lp.startBinary(n),lp.endBinary(n)}visitLargeBinary(t,n){return fp.startLargeBinary(n),fp.endLargeBinary(n)}visitBool(t,n){return up.startBool(n),up.endBool(n)}visitUtf8(t,n){return mp.startUtf8(n),mp.endUtf8(n)}visitLargeUtf8(t,n){return dp.startLargeUtf8(n),dp.endLargeUtf8(n)}visitDecimal(t,n){return ji.startDecimal(n),ji.addScale(n,t.scale),ji.addPrecision(n,t.precision),ji.addBitWidth(n,t.bitWidth),ji.endDecimal(n)}visitDate(t,n){return Jo.startDate(n),Jo.addUnit(n,t.unit),Jo.endDate(n)}visitTime(t,n){return Ge.startTime(n),Ge.addUnit(n,t.unit),Ge.addBitWidth(n,t.bitWidth),Ge.endTime(n)}visitTimestamp(t,n){const r=t.timezone&&n.createString(t.timezone)||void 0;return Xe.startTimestamp(n),Xe.addUnit(n,t.unit),r!==void 0&&Xe.addTimezone(n,r),Xe.endTimestamp(n)}visitInterval(t,n){return In.startInterval(n),In.addUnit(n,t.unit),In.endInterval(n)}visitDuration(t,n){return Zo.startDuration(n),Zo.addUnit(n,t.unit),Zo.endDuration(n)}visitList(t,n){return hp.startList(n),hp.endList(n)}visitStruct(t,n){return ii.startStruct_(n),ii.endStruct_(n)}visitUnion(t,n){Ee.startTypeIdsVector(n,t.typeIds.length);const r=Ee.createTypeIdsVector(n,t.typeIds);return Ee.startUnion(n),Ee.addMode(n,t.mode),Ee.addTypeIds(n,r),Ee.endUnion(n)}visitDictionary(t,n){const r=this.visit(t.indices,n);return nr.startDictionaryEncoding(n),nr.addId(n,BigInt(t.id)),nr.addIsOrdered(n,t.isOrdered),r!==void 0&&nr.addIndexType(n,r),nr.endDictionaryEncoding(n)}visitFixedSizeBinary(t,n){return tc.startFixedSizeBinary(n),tc.addByteWidth(n,t.byteWidth),tc.endFixedSizeBinary(n)}visitFixedSizeList(t,n){return ec.startFixedSizeList(n),ec.addListSize(n,t.listSize),ec.endFixedSizeList(n)}visitMap(t,n){return nc.startMap(n),nc.addKeysSorted(n,t.keysSorted),nc.endMap(n)}}const ku=new xA;function SA(e,t=new Map){return new Rt(TA(e,t),ac(e.metadata),t)}function p_(e){return new Pe(e.count,m_(e.columns),y_(e.columns))}function EA(e){return new $n(p_(e.data),e.id,e.isDelta)}function TA(e,t){return(e.fields||[]).filter(Boolean).map(n=>Nt.fromJSON(n,t))}function Tp(e,t){return(e.children||[]).filter(Boolean).map(n=>Nt.fromJSON(n,t))}function m_(e){return(e||[]).reduce((t,n)=>[...t,new Br(n.count,AA(n.VALIDITY)),...m_(n.children)],[])}function y_(e,t=[]){for(let n=-1,r=(e||[]).length;++n<r;){const i=e[n];i.VALIDITY&&t.push(new Rn(t.length,i.VALIDITY.length)),i.TYPE_ID&&t.push(new Rn(t.length,i.TYPE_ID.length)),i.OFFSET&&t.push(new Rn(t.length,i.OFFSET.length)),i.DATA&&t.push(new Rn(t.length,i.DATA.length)),t=y_(i.children,t)}return t}function AA(e){return(e||[]).reduce((t,n)=>t+ +(n===0),0)}function IA(e,t){let n,r,i,s,a,o;return!t||!(s=e.dictionary)?(a=Ip(e,Tp(e,t)),i=new Nt(e.name,a,e.nullable,ac(e.metadata))):t.has(n=s.id)?(r=(r=s.indexType)?Ap(r):new hi,o=new kr(t.get(n),r,n,s.isOrdered),i=new Nt(e.name,o,e.nullable,ac(e.metadata))):(r=(r=s.indexType)?Ap(r):new hi,t.set(n,a=Ip(e,Tp(e,t))),o=new kr(a,r,n,s.isOrdered),i=new Nt(e.name,o,e.nullable,ac(e.metadata))),i||null}function ac(e=[]){return new Map(e.map(({key:t,value:n})=>[t,n]))}function Ap(e){return new Ne(e.isSigned,e.bitWidth)}function Ip(e,t){const n=e.type.name;switch(n){case"NONE":return new lr;case"null":return new lr;case"binary":return new wc;case"largebinary":return new vc;case"utf8":return new wa;case"largeutf8":return new xc;case"bool":return new va;case"list":return new us((t||[])[0]);case"struct":return new ce(t||[]);case"struct_":return new ce(t||[])}switch(n){case"int":{const r=e.type;return new Ne(r.isSigned,r.bitWidth)}case"floatingpoint":{const r=e.type;return new ls(ie[r.precision])}case"decimal":{const r=e.type;return new Sc(r.scale,r.precision,r.bitWidth)}case"date":{const r=e.type;return new Ec(nn[r.unit])}case"time":{const r=e.type;return new Tc(Q[r.unit],r.bitWidth)}case"timestamp":{const r=e.type;return new xa(Q[r.unit],r.timezone)}case"interval":{const r=e.type;return new Ac(Bn[r.unit])}case"duration":{const r=e.type;return new Ic(Q[r.unit])}case"union":{const r=e.type,[i,...s]=(r.mode+"").toLowerCase(),a=i.toUpperCase()+s.join("");return new Sa(ye[a],r.typeIds||[],t||[])}case"fixedsizebinary":{const r=e.type;return new Nc(r.byteWidth)}case"fixedsizelist":{const r=e.type;return new Ea(r.listSize,(t||[])[0])}case"map":{const r=e.type;return new Ta((t||[])[0],r.keysSorted)}}throw new Error(`Unrecognized type: "${n}"`)}var NA=cg,MA=os;class we{static fromJSON(t,n){const r=new we(0,qt.V5,n);return r._createHeader=OA(t,n),r}static decode(t){t=new MA(Et(t));const n=Ar.getRootAsMessage(t),r=n.bodyLength(),i=n.version(),s=n.headerType(),a=new we(r,i,s);return a._createHeader=RA(n,s),a}static encode(t){const n=new NA;let r=-1;return t.isSchema()?r=Rt.encode(n,t.header()):t.isRecordBatch()?r=Pe.encode(n,t.header()):t.isDictionaryBatch()&&(r=$n.encode(n,t.header())),Ar.startMessage(n),Ar.addVersion(n,qt.V5),Ar.addHeader(n,r),Ar.addHeaderType(n,t.headerType),Ar.addBodyLength(n,BigInt(t.bodyLength)),Ar.finishMessageBuffer(n,Ar.endMessage(n)),n.asUint8Array()}static from(t,n=0){if(t instanceof Rt)return new we(0,qt.V5,It.Schema,t);if(t instanceof Pe)return new we(n,qt.V5,It.RecordBatch,t);if(t instanceof $n)return new we(n,qt.V5,It.DictionaryBatch,t);throw new Error(`Unrecognized Message header: ${t}`)}get type(){return this.headerType}get version(){return this._version}get headerType(){return this._headerType}get bodyLength(){return this._bodyLength}header(){return this._createHeader()}isSchema(){return this.headerType===It.Schema}isRecordBatch(){return this.headerType===It.RecordBatch}isDictionaryBatch(){return this.headerType===It.DictionaryBatch}constructor(t,n,r,i){this._version=n,this._headerType=r,this.body=new Uint8Array(0),i&&(this._createHeader=()=>i),this._bodyLength=Ct(t)}}class Pe{get nodes(){return this._nodes}get length(){return this._length}get buffers(){return this._buffers}constructor(t,n,r){this._nodes=n,this._buffers=r,this._length=Ct(t)}}class $n{get id(){return this._id}get data(){return this._data}get isDelta(){return this._isDelta}get length(){return this.data.length}get nodes(){return this.data.nodes}get buffers(){return this.data.buffers}constructor(t,n,r=!1){this._data=t,this._isDelta=r,this._id=Ct(n)}}class Rn{constructor(t,n){this.offset=Ct(t),this.length=Ct(n)}}class Br{constructor(t,n){this.length=Ct(t),this.nullCount=Ct(n)}}function OA(e,t){return(()=>{switch(t){case It.Schema:return Rt.fromJSON(e);case It.RecordBatch:return Pe.fromJSON(e);case It.DictionaryBatch:return $n.fromJSON(e)}throw new Error(`Unrecognized Message type: { name: ${It[t]}, type: ${t} }`)})}function RA(e,t){return(()=>{switch(t){case It.Schema:return Rt.decode(e.header(new vn),new Map,e.version());case It.RecordBatch:return Pe.decode(e.header(new Jn),e.version());case It.DictionaryBatch:return $n.decode(e.header(new Ui),e.version())}throw new Error(`Unrecognized Message type: { name: ${It[t]}, type: ${t} }`)})}Nt.encode=VA;Nt.decode=PA;Nt.fromJSON=IA;Rt.encode=jA;Rt.decode=DA;Rt.fromJSON=SA;Pe.encode=zA;Pe.decode=LA;Pe.fromJSON=p_;$n.encode=YA;$n.decode=FA;$n.fromJSON=EA;Br.encode=WA;Br.decode=CA;Rn.encode=HA;Rn.decode=kA;function DA(e,t=new Map,n=qt.V5){const r=UA(e,t);return new Rt(r,oc(e),t,n)}function LA(e,t=qt.V5){if(e.compression()!==null)throw new Error("Record batch compression not implemented");return new Pe(e.length(),BA(e),$A(e,t))}function FA(e,t=qt.V5){return new $n(Pe.decode(e.data(),t),e.id(),e.isDelta())}function kA(e){return new Rn(e.offset(),e.length())}function CA(e){return new Br(e.length(),e.nullCount())}function BA(e){const t=[];for(let n,r=-1,i=-1,s=e.nodesLength();++r<s;)(n=e.nodes(r))&&(t[++i]=Br.decode(n));return t}function $A(e,t){const n=[];for(let r,i=-1,s=-1,a=e.buffersLength();++i<a;)(r=e.buffers(i))&&(t<qt.V4&&(r.bb_pos+=8*(i+1)),n[++s]=Rn.decode(r));return n}function UA(e,t){const n=[];for(let r,i=-1,s=-1,a=e.fieldsLength();++i<a;)(r=e.fields(i))&&(n[++s]=Nt.decode(r,t));return n}function Np(e,t){const n=[];for(let r,i=-1,s=-1,a=e.childrenLength();++i<a;)(r=e.children(i))&&(n[++s]=Nt.decode(r,t));return n}function PA(e,t){let n,r,i,s,a,o;return!t||!(o=e.dictionary())?(i=Op(e,Np(e,t)),r=new Nt(e.name(),i,e.nullable(),oc(e))):t.has(n=Ct(o.id()))?(s=(s=o.indexType())?Mp(s):new hi,a=new kr(t.get(n),s,n,o.isOrdered()),r=new Nt(e.name(),a,e.nullable(),oc(e))):(s=(s=o.indexType())?Mp(s):new hi,t.set(n,i=Op(e,Np(e,t))),a=new kr(i,s,n,o.isOrdered()),r=new Nt(e.name(),a,e.nullable(),oc(e))),r||null}function oc(e){const t=new Map;if(e)for(let n,r,i=-1,s=Math.trunc(e.customMetadataLength());++i<s;)(n=e.customMetadata(i))&&(r=n.key())!=null&&t.set(r,n.value());return t}function Mp(e){return new Ne(e.isSigned(),e.bitWidth())}function Op(e,t){const n=e.typeType();switch(n){case $t.NONE:return new lr;case $t.Null:return new lr;case $t.Binary:return new wc;case $t.LargeBinary:return new vc;case $t.Utf8:return new wa;case $t.LargeUtf8:return new xc;case $t.Bool:return new va;case $t.List:return new us((t||[])[0]);case $t.Struct_:return new ce(t||[])}switch(n){case $t.Int:{const r=e.type(new Be);return new Ne(r.isSigned(),r.bitWidth())}case $t.FloatingPoint:{const r=e.type(new An);return new ls(r.precision())}case $t.Decimal:{const r=e.type(new ji);return new Sc(r.scale(),r.precision(),r.bitWidth())}case $t.Date:{const r=e.type(new Jo);return new Ec(r.unit())}case $t.Time:{const r=e.type(new Ge);return new Tc(r.unit(),r.bitWidth())}case $t.Timestamp:{const r=e.type(new Xe);return new xa(r.unit(),r.timezone())}case $t.Interval:{const r=e.type(new In);return new Ac(r.unit())}case $t.Duration:{const r=e.type(new Zo);return new Ic(r.unit())}case $t.Union:{const r=e.type(new Ee);return new Sa(r.mode(),r.typeIdsArray()||[],t||[])}case $t.FixedSizeBinary:{const r=e.type(new tc);return new Nc(r.byteWidth())}case $t.FixedSizeList:{const r=e.type(new ec);return new Ea(r.listSize(),(t||[])[0])}case $t.Map:{const r=e.type(new nc);return new Ta((t||[])[0],r.keysSorted())}}throw new Error(`Unrecognized type: "${$t[n]}" (${n})`)}function jA(e,t){const n=t.fields.map(s=>Nt.encode(e,s));vn.startFieldsVector(e,n.length);const r=vn.createFieldsVector(e,n),i=t.metadata&&t.metadata.size>0?vn.createCustomMetadataVector(e,[...t.metadata].map(([s,a])=>{const o=e.createString(`${s}`),c=e.createString(`${a}`);return Jt.startKeyValue(e),Jt.addKey(e,o),Jt.addValue(e,c),Jt.endKeyValue(e)})):-1;return vn.startSchema(e),vn.addFields(e,r),vn.addEndianness(e,qA?cs.Little:cs.Big),i!==-1&&vn.addCustomMetadata(e,i),vn.endSchema(e)}function VA(e,t){let n=-1,r=-1,i=-1;const s=t.type;let a=t.typeId;X.isDictionary(s)?(a=s.dictionary.typeId,i=ku.visit(s,e),r=ku.visit(s.dictionary,e)):r=ku.visit(s,e);const o=(s.children||[]).map(u=>Nt.encode(e,u)),c=He.createChildrenVector(e,o),l=t.metadata&&t.metadata.size>0?He.createCustomMetadataVector(e,[...t.metadata].map(([u,f])=>{const d=e.createString(`${u}`),h=e.createString(`${f}`);return Jt.startKeyValue(e),Jt.addKey(e,d),Jt.addValue(e,h),Jt.endKeyValue(e)})):-1;return t.name&&(n=e.createString(t.name)),He.startField(e),He.addType(e,r),He.addTypeType(e,a),He.addChildren(e,c),He.addNullable(e,!!t.nullable),n!==-1&&He.addName(e,n),i!==-1&&He.addDictionary(e,i),l!==-1&&He.addCustomMetadata(e,l),He.endField(e)}function zA(e,t){const n=t.nodes||[],r=t.buffers||[];Jn.startNodesVector(e,n.length);for(const a of n.slice().reverse())Br.encode(e,a);const i=e.endVector();Jn.startBuffersVector(e,r.length);for(const a of r.slice().reverse())Rn.encode(e,a);const s=e.endVector();return Jn.startRecordBatch(e),Jn.addLength(e,BigInt(t.length)),Jn.addNodes(e,i),Jn.addBuffers(e,s),Jn.endRecordBatch(e)}function YA(e,t){const n=Pe.encode(e,t.data);return Ui.startDictionaryBatch(e),Ui.addId(e,BigInt(t.id)),Ui.addIsDelta(e,t.isDelta),Ui.addData(e,n),Ui.endDictionaryBatch(e)}function WA(e,t){return fg.createFieldNode(e,BigInt(t.length),BigInt(t.nullCount))}function HA(e,t){return ug.createBuffer(e,BigInt(t.offset),BigInt(t.length))}const qA=(()=>{const e=new ArrayBuffer(2);return new DataView(e).setInt16(0,256,!0),new Int16Array(e)[0]===256})(),xh=e=>`Expected ${It[e]} Message in stream, but was null or length 0.`,Sh=e=>`Header pointer of flatbuffer-encoded ${It[e]} Message is null or length 0.`,g_=(e,t)=>`Expected to read ${e} metadata bytes, but only read ${t}.`,b_=(e,t)=>`Expected to read ${e} bytes for message body, but only read ${t}.`;class __{constructor(t){this.source=t instanceof Fc?t:new Fc(t)}[Symbol.iterator](){return this}next(){let t;return(t=this.readMetadataLength()).done||t.value===-1&&(t=this.readMetadataLength()).done||(t=this.readMetadata(t.value)).done?jt:t}throw(t){return this.source.throw(t)}return(t){return this.source.return(t)}readMessage(t){let n;if((n=this.next()).done)return null;if(t!=null&&n.value.headerType!==t)throw new Error(xh(t));return n.value}readMessageBody(t){if(t<=0)return new Uint8Array(0);const n=Et(this.source.read(t));if(n.byteLength<t)throw new Error(b_(t,n.byteLength));return n.byteOffset%8===0&&n.byteOffset+n.byteLength<=n.buffer.byteLength?n:n.slice()}readSchema(t=!1){const n=It.Schema,r=this.readMessage(n),i=r?.header();if(t&&!i)throw new Error(Sh(n));return i}readMetadataLength(){const t=this.source.read(Cl),n=t&&new os(t),r=n?.readInt32(0)||0;return{done:r===0,value:r}}readMetadata(t){const n=this.source.read(t);if(!n)return jt;if(n.byteLength<t)throw new Error(g_(t,n.byteLength));return{done:!1,value:we.decode(n)}}}class GA{constructor(t,n){this.source=t instanceof fs?t:ng(t)?new kc(t,n):new fs(t)}[Symbol.asyncIterator](){return this}next(){return dt(this,void 0,void 0,function*(){let t;return(t=yield this.readMetadataLength()).done||t.value===-1&&(t=yield this.readMetadataLength()).done||(t=yield this.readMetadata(t.value)).done?jt:t})}throw(t){return dt(this,void 0,void 0,function*(){return yield this.source.throw(t)})}return(t){return dt(this,void 0,void 0,function*(){return yield this.source.return(t)})}readMessage(t){return dt(this,void 0,void 0,function*(){let n;if((n=yield this.next()).done)return null;if(t!=null&&n.value.headerType!==t)throw new Error(xh(t));return n.value})}readMessageBody(t){return dt(this,void 0,void 0,function*(){if(t<=0)return new Uint8Array(0);const n=Et(yield this.source.read(t));if(n.byteLength<t)throw new Error(b_(t,n.byteLength));return n.byteOffset%8===0&&n.byteOffset+n.byteLength<=n.buffer.byteLength?n:n.slice()})}readSchema(){return dt(this,arguments,void 0,function*(t=!1){const n=It.Schema,r=yield this.readMessage(n),i=r?.header();if(t&&!i)throw new Error(Sh(n));return i})}readMetadataLength(){return dt(this,void 0,void 0,function*(){const t=yield this.source.read(Cl),n=t&&new os(t),r=n?.readInt32(0)||0;return{done:r===0,value:r}})}readMetadata(t){return dt(this,void 0,void 0,function*(){const n=yield this.source.read(t);if(!n)return jt;if(n.byteLength<t)throw new Error(g_(t,n.byteLength));return{done:!1,value:we.decode(n)}})}}class XA extends __{constructor(t){super(new Uint8Array(0)),this._schema=!1,this._body=[],this._batchIndex=0,this._dictionaryIndex=0,this._json=t instanceof xp?t:new xp(t)}next(){const{_json:t}=this;if(!this._schema)return this._schema=!0,{done:!1,value:we.fromJSON(t.schema,It.Schema)};if(this._dictionaryIndex<t.dictionaries.length){const n=t.dictionaries[this._dictionaryIndex++];return this._body=n.data.columns,{done:!1,value:we.fromJSON(n,It.DictionaryBatch)}}if(this._batchIndex<t.batches.length){const n=t.batches[this._batchIndex++];return this._body=n.columns,{done:!1,value:we.fromJSON(n,It.RecordBatch)}}return this._body=[],jt}readMessageBody(t){return n(this._body);function n(r){return(r||[]).reduce((i,s)=>[...i,...s.VALIDITY&&[s.VALIDITY]||[],...s.TYPE_ID&&[s.TYPE_ID]||[],...s.OFFSET&&[s.OFFSET]||[],...s.DATA&&[s.DATA]||[],...n(s.children)],[])}}readMessage(t){let n;if((n=this.next()).done)return null;if(t!=null&&n.value.headerType!==t)throw new Error(xh(t));return n.value}readSchema(){const t=It.Schema,n=this.readMessage(t),r=n?.header();if(!n||!r)throw new Error(Sh(t));return r}}const Cl=4,Uf="ARROW1",Ia=new Uint8Array(Uf.length);for(let e=0;e<Uf.length;e+=1)Ia[e]=Uf.codePointAt(e);function Eh(e,t=0){for(let n=-1,r=Ia.length;++n<r;)if(Ia[n]!==e[t+n])return!1;return!0}const Ka=Ia.length,w_=Ka+Cl,KA=Ka*2+Cl;class en extends mh{constructor(t){super(),this._impl=t}get closed(){return this._impl.closed}get schema(){return this._impl.schema}get autoDestroy(){return this._impl.autoDestroy}get dictionaries(){return this._impl.dictionaries}get numDictionaries(){return this._impl.numDictionaries}get numRecordBatches(){return this._impl.numRecordBatches}get footer(){return this._impl.isFile()?this._impl.footer:null}isSync(){return this._impl.isSync()}isAsync(){return this._impl.isAsync()}isFile(){return this._impl.isFile()}isStream(){return this._impl.isStream()}next(){return this._impl.next()}throw(t){return this._impl.throw(t)}return(t){return this._impl.return(t)}cancel(){return this._impl.cancel()}reset(t){return this._impl.reset(t),this._DOMStream=void 0,this._nodeStream=void 0,this}open(t){const n=this._impl.open(t);return fi(n)?n.then(()=>this):this}readRecordBatch(t){return this._impl.isFile()?this._impl.readRecordBatch(t):null}[Symbol.iterator](){return this._impl[Symbol.iterator]()}[Symbol.asyncIterator](){return this._impl[Symbol.asyncIterator]()}toDOMStream(){return qe.toDOMStream(this.isSync()?{[Symbol.iterator]:()=>this}:{[Symbol.asyncIterator]:()=>this})}toNodeStream(){return qe.toNodeStream(this.isSync()?{[Symbol.iterator]:()=>this}:{[Symbol.asyncIterator]:()=>this},{objectMode:!0})}static throughNode(t){throw new Error('"throughNode" not available in this environment')}static throughDOM(t,n){throw new Error('"throughDOM" not available in this environment')}static from(t){return t instanceof en?t:Nf(t)?tI(t):ng(t)?rI(t):fi(t)?dt(this,void 0,void 0,function*(){return yield en.from(yield t)}):rg(t)||jd(t)||ig(t)||Ns(t)?nI(new fs(t)):eI(new Fc(t))}static readAll(t){return t instanceof en?t.isSync()?Rp(t):Dp(t):Nf(t)||ArrayBuffer.isView(t)||Ya(t)||eg(t)?Rp(t):Dp(t)}}class Bc extends en{constructor(t){super(t),this._impl=t}readAll(){return[...this]}[Symbol.iterator](){return this._impl[Symbol.iterator]()}[Symbol.asyncIterator](){return On(this,arguments,function*(){yield bt(yield*Qo(ai(this[Symbol.iterator]())))})}}class $c extends en{constructor(t){super(t),this._impl=t}readAll(){return dt(this,void 0,void 0,function*(){var t,n,r,i;const s=new Array;try{for(var a=!0,o=ai(this),c;c=yield o.next(),t=c.done,!t;a=!0){i=c.value,a=!1;const l=i;s.push(l)}}catch(l){n={error:l}}finally{try{!a&&!t&&(r=o.return)&&(yield r.call(o))}finally{if(n)throw n.error}}return s})}[Symbol.iterator](){throw new Error("AsyncRecordBatchStreamReader is not Iterable")}[Symbol.asyncIterator](){return this._impl[Symbol.asyncIterator]()}}class v_ extends Bc{constructor(t){super(t),this._impl=t}}class QA extends $c{constructor(t){super(t),this._impl=t}}class x_{get numDictionaries(){return this._dictionaryIndex}get numRecordBatches(){return this._recordBatchIndex}constructor(t=new Map){this.closed=!1,this.autoDestroy=!0,this._dictionaryIndex=0,this._recordBatchIndex=0,this.dictionaries=t}isSync(){return!1}isAsync(){return!1}isFile(){return!1}isStream(){return!1}reset(t){return this._dictionaryIndex=0,this._recordBatchIndex=0,this.schema=t,this.dictionaries=new Map,this}_loadRecordBatch(t,n){const r=this._loadVectors(t,n,this.schema.fields),i=nt({type:new ce(this.schema.fields),length:t.length,children:r});return new _e(this.schema,i)}_loadDictionaryBatch(t,n){const{id:r,isDelta:i}=t,{dictionaries:s,schema:a}=this,o=s.get(r),c=a.dictionaries.get(r),l=this._loadVectors(t.data,n,[c]);return(o&&i?o.concat(new gt(l)):new gt(l)).memoize()}_loadVectors(t,n,r){return new Vb(n,t.nodes,t.buffers,this.dictionaries,this.schema.metadataVersion).visitMany(r)}}class Uc extends x_{constructor(t,n){super(n),this._reader=Nf(t)?new XA(this._handle=t):new __(this._handle=t)}isSync(){return!0}isStream(){return!0}[Symbol.iterator](){return this}cancel(){!this.closed&&(this.closed=!0)&&(this.reset()._reader.return(),this._reader=null,this.dictionaries=null)}open(t){return this.closed||(this.autoDestroy=E_(this,t),this.schema||(this.schema=this._reader.readSchema())||this.cancel()),this}throw(t){return!this.closed&&this.autoDestroy&&(this.closed=!0)?this.reset()._reader.throw(t):jt}return(t){return!this.closed&&this.autoDestroy&&(this.closed=!0)?this.reset()._reader.return(t):jt}next(){if(this.closed)return jt;let t;const{_reader:n}=this;for(;t=this._readNextMessageAndValidate();)if(t.isSchema())this.reset(t.header());else if(t.isRecordBatch()){this._recordBatchIndex++;const r=t.header(),i=n.readMessageBody(t.bodyLength);return{done:!1,value:this._loadRecordBatch(r,i)}}else if(t.isDictionaryBatch()){this._dictionaryIndex++;const r=t.header(),i=n.readMessageBody(t.bodyLength),s=this._loadDictionaryBatch(r,i);this.dictionaries.set(r.id,s)}return this.schema&&this._recordBatchIndex===0?(this._recordBatchIndex++,{done:!1,value:new vh(this.schema)}):this.return()}_readNextMessageAndValidate(t){return this._reader.readMessage(t)}}class Pc extends x_{constructor(t,n){super(n),this._reader=new GA(this._handle=t)}isAsync(){return!0}isStream(){return!0}[Symbol.asyncIterator](){return this}cancel(){return dt(this,void 0,void 0,function*(){!this.closed&&(this.closed=!0)&&(yield this.reset()._reader.return(),this._reader=null,this.dictionaries=null)})}open(t){return dt(this,void 0,void 0,function*(){return this.closed||(this.autoDestroy=E_(this,t),this.schema||(this.schema=yield this._reader.readSchema())||(yield this.cancel())),this})}throw(t){return dt(this,void 0,void 0,function*(){return!this.closed&&this.autoDestroy&&(this.closed=!0)?yield this.reset()._reader.throw(t):jt})}return(t){return dt(this,void 0,void 0,function*(){return!this.closed&&this.autoDestroy&&(this.closed=!0)?yield this.reset()._reader.return(t):jt})}next(){return dt(this,void 0,void 0,function*(){if(this.closed)return jt;let t;const{_reader:n}=this;for(;t=yield this._readNextMessageAndValidate();)if(t.isSchema())yield this.reset(t.header());else if(t.isRecordBatch()){this._recordBatchIndex++;const r=t.header(),i=yield n.readMessageBody(t.bodyLength);return{done:!1,value:this._loadRecordBatch(r,i)}}else if(t.isDictionaryBatch()){this._dictionaryIndex++;const r=t.header(),i=yield n.readMessageBody(t.bodyLength),s=this._loadDictionaryBatch(r,i);this.dictionaries.set(r.id,s)}return this.schema&&this._recordBatchIndex===0?(this._recordBatchIndex++,{done:!1,value:new vh(this.schema)}):yield this.return()})}_readNextMessageAndValidate(t){return dt(this,void 0,void 0,function*(){return yield this._reader.readMessage(t)})}}class S_ extends Uc{get footer(){return this._footer}get numDictionaries(){return this._footer?this._footer.numDictionaries:0}get numRecordBatches(){return this._footer?this._footer.numRecordBatches:0}constructor(t,n){super(t instanceof Sp?t:new Sp(t),n)}isSync(){return!0}isFile(){return!0}open(t){if(!this.closed&&!this._footer){this.schema=(this._footer=this._readFooter()).schema;for(const n of this._footer.dictionaryBatches())n&&this._readDictionaryBatch(this._dictionaryIndex++)}return super.open(t)}readRecordBatch(t){var n;if(this.closed)return null;this._footer||this.open();const r=(n=this._footer)===null||n===void 0?void 0:n.getRecordBatch(t);if(r&&this._handle.seek(r.offset)){const i=this._reader.readMessage(It.RecordBatch);if(i?.isRecordBatch()){const s=i.header(),a=this._reader.readMessageBody(i.bodyLength);return this._loadRecordBatch(s,a)}}return null}_readDictionaryBatch(t){var n;const r=(n=this._footer)===null||n===void 0?void 0:n.getDictionaryBatch(t);if(r&&this._handle.seek(r.offset)){const i=this._reader.readMessage(It.DictionaryBatch);if(i?.isDictionaryBatch()){const s=i.header(),a=this._reader.readMessageBody(i.bodyLength),o=this._loadDictionaryBatch(s,a);this.dictionaries.set(s.id,o)}}}_readFooter(){const{_handle:t}=this,n=t.size-w_,r=t.readInt32(n),i=t.readAt(n-r,r);return Aa.decode(i)}_readNextMessageAndValidate(t){var n;if(this._footer||this.open(),this._footer&&this._recordBatchIndex<this.numRecordBatches){const r=(n=this._footer)===null||n===void 0?void 0:n.getRecordBatch(this._recordBatchIndex);if(r&&this._handle.seek(r.offset))return this._reader.readMessage(t)}return null}}class JA extends Pc{get footer(){return this._footer}get numDictionaries(){return this._footer?this._footer.numDictionaries:0}get numRecordBatches(){return this._footer?this._footer.numRecordBatches:0}constructor(t,...n){const r=typeof n[0]!="number"?n.shift():void 0,i=n[0]instanceof Map?n.shift():void 0;super(t instanceof kc?t:new kc(t,r),i)}isFile(){return!0}isAsync(){return!0}open(t){const n=Object.create(null,{open:{get:()=>super.open}});return dt(this,void 0,void 0,function*(){if(!this.closed&&!this._footer){this.schema=(this._footer=yield this._readFooter()).schema;for(const r of this._footer.dictionaryBatches())r&&(yield this._readDictionaryBatch(this._dictionaryIndex++))}return yield n.open.call(this,t)})}readRecordBatch(t){return dt(this,void 0,void 0,function*(){var n;if(this.closed)return null;this._footer||(yield this.open());const r=(n=this._footer)===null||n===void 0?void 0:n.getRecordBatch(t);if(r&&(yield this._handle.seek(r.offset))){const i=yield this._reader.readMessage(It.RecordBatch);if(i?.isRecordBatch()){const s=i.header(),a=yield this._reader.readMessageBody(i.bodyLength);return this._loadRecordBatch(s,a)}}return null})}_readDictionaryBatch(t){return dt(this,void 0,void 0,function*(){var n;const r=(n=this._footer)===null||n===void 0?void 0:n.getDictionaryBatch(t);if(r&&(yield this._handle.seek(r.offset))){const i=yield this._reader.readMessage(It.DictionaryBatch);if(i?.isDictionaryBatch()){const s=i.header(),a=yield this._reader.readMessageBody(i.bodyLength),o=this._loadDictionaryBatch(s,a);this.dictionaries.set(s.id,o)}}})}_readFooter(){return dt(this,void 0,void 0,function*(){const{_handle:t}=this;t._pending&&(yield t._pending);const n=t.size-w_,r=yield t.readInt32(n),i=yield t.readAt(n-r,r);return Aa.decode(i)})}_readNextMessageAndValidate(t){return dt(this,void 0,void 0,function*(){if(this._footer||(yield this.open()),this._footer&&this._recordBatchIndex<this.numRecordBatches){const n=this._footer.getRecordBatch(this._recordBatchIndex);if(n&&(yield this._handle.seek(n.offset)))return yield this._reader.readMessage(t)}return null})}}class ZA extends Uc{constructor(t,n){super(t,n)}_loadVectors(t,n,r){return new PT(n,t.nodes,t.buffers,this.dictionaries,this.schema.metadataVersion).visitMany(r)}}function E_(e,t){return t&&typeof t.autoDestroy=="boolean"?t.autoDestroy:e.autoDestroy}function*Rp(e){const t=en.from(e);try{if(!t.open({autoDestroy:!1}).closed)do yield t;while(!t.reset().open().closed)}finally{t.cancel()}}function Dp(e){return On(this,arguments,function*(){const n=yield bt(en.from(e));try{if(!(yield bt(n.open({autoDestroy:!1}))).closed)do yield yield bt(n);while(!(yield bt(n.reset().open())).closed)}finally{yield bt(n.cancel())}})}function tI(e){return new Bc(new ZA(e))}function eI(e){const t=e.peek(Ka+7&-8);return t&&t.byteLength>=4?Eh(t)?new v_(new S_(e.read())):new Bc(new Uc(e)):new Bc(new Uc((function*(){})()))}function nI(e){return dt(this,void 0,void 0,function*(){const t=yield e.peek(Ka+7&-8);return t&&t.byteLength>=4?Eh(t)?new v_(new S_(yield e.read())):new $c(new Pc(e)):new $c(new Pc((function(){return On(this,arguments,function*(){})})()))})}function rI(e){return dt(this,void 0,void 0,function*(){const{size:t}=yield e.stat(),n=new kc(e,t);return t>=KA&&Eh(yield n.readAt(0,Ka+7&-8))?new QA(new JA(n)):new $c(new Pc(n))})}class Vt extends wt{static assemble(...t){const n=i=>i.flatMap(s=>Array.isArray(s)?n(s):s instanceof _e?s.data.children:s.data),r=new Vt;return r.visitMany(n(t)),r}constructor(){super(),this._byteLength=0,this._nodes=[],this._buffers=[],this._bufferRegions=[]}visit(t){if(t instanceof gt)return this.visitMany(t.data),this;const{type:n}=t;if(!X.isDictionary(n)){const{length:r}=t;if(r>2147483647)throw new RangeError("Cannot write arrays larger than 2^31 - 1 in length");if(X.isUnion(n))this.nodes.push(new Br(r,0));else{const{nullCount:i}=t;X.isNull(n)||un.call(this,i<=0?new Uint8Array(0):Mc(t.offset,r,t.nullBitmap)),this.nodes.push(new Br(r,i))}}return super.visit(t)}visitNull(t){return this}visitDictionary(t){return this.visit(t.clone(t.type.indices))}get nodes(){return this._nodes}get buffers(){return this._buffers}get byteLength(){return this._byteLength}get bufferRegions(){return this._bufferRegions}}function un(e){const t=e.byteLength+7&-8;return this.buffers.push(e),this.bufferRegions.push(new Rn(this._byteLength,t)),this._byteLength+=t,this}function iI(e){var t;const{type:n,length:r,typeIds:i,valueOffsets:s}=e;if(un.call(this,i),n.mode===ye.Sparse)return Pf.call(this,e);if(n.mode===ye.Dense){if(e.offset<=0)return un.call(this,s),Pf.call(this,e);{const a=new Int32Array(r),o=Object.create(null),c=Object.create(null);for(let l,u,f=-1;++f<r;)(l=i[f])!==void 0&&((u=o[l])===void 0&&(u=o[l]=s[f]),a[f]=s[f]-u,c[l]=((t=c[l])!==null&&t!==void 0?t:0)+1);un.call(this,a),this.visitMany(e.children.map((l,u)=>{const f=n.typeIds[u],d=o[f],h=c[f];return l.slice(d,Math.min(r,h))}))}}return this}function sI(e){let t;return e.nullCount>=e.length?un.call(this,new Uint8Array(0)):(t=e.values)instanceof Uint8Array?un.call(this,Mc(e.offset,e.length,t)):un.call(this,Oc(e.values))}function vr(e){return un.call(this,e.values.subarray(0,e.length*e.stride))}function Bl(e){const{length:t,values:n,valueOffsets:r}=e,i=Ct(r[0]),s=Ct(r[t]),a=Math.min(s-i,n.byteLength-i);return un.call(this,ag(-i,t+1,r)),un.call(this,n.subarray(i,i+a)),this}function Th(e){const{length:t,valueOffsets:n}=e;if(n){const{[0]:r,[t]:i}=n;return un.call(this,ag(-r,t+1,n)),this.visit(e.children[0].slice(r,i-r))}return this.visit(e.children[0])}function Pf(e){return this.visitMany(e.type.children.map((t,n)=>e.children[n]).filter(Boolean))[0]}Vt.prototype.visitBool=sI;Vt.prototype.visitInt=vr;Vt.prototype.visitFloat=vr;Vt.prototype.visitUtf8=Bl;Vt.prototype.visitLargeUtf8=Bl;Vt.prototype.visitBinary=Bl;Vt.prototype.visitLargeBinary=Bl;Vt.prototype.visitFixedSizeBinary=vr;Vt.prototype.visitDate=vr;Vt.prototype.visitTimestamp=vr;Vt.prototype.visitTime=vr;Vt.prototype.visitDecimal=vr;Vt.prototype.visitList=Th;Vt.prototype.visitStruct=Pf;Vt.prototype.visitUnion=iI;Vt.prototype.visitInterval=vr;Vt.prototype.visitDuration=vr;Vt.prototype.visitFixedSizeList=Th;Vt.prototype.visitMap=Th;class T_ extends mh{static throughNode(t){throw new Error('"throughNode" not available in this environment')}static throughDOM(t,n){throw new Error('"throughDOM" not available in this environment')}constructor(t){super(),this._position=0,this._started=!1,this._sink=new ic,this._schema=null,this._dictionaryBlocks=[],this._recordBatchBlocks=[],this._seenDictionaries=new Map,this._dictionaryDeltaOffsets=new Map,Ie(t)||(t={autoDestroy:!0,writeLegacyIpcFormat:!1}),this._autoDestroy=typeof t.autoDestroy=="boolean"?t.autoDestroy:!0,this._writeLegacyIpcFormat=typeof t.writeLegacyIpcFormat=="boolean"?t.writeLegacyIpcFormat:!1}toString(t=!1){return this._sink.toString(t)}toUint8Array(t=!1){return this._sink.toUint8Array(t)}writeAll(t){return fi(t)?t.then(n=>this.writeAll(n)):Ns(t)?Mh(this,t):Nh(this,t)}get closed(){return this._sink.closed}[Symbol.asyncIterator](){return this._sink[Symbol.asyncIterator]()}toDOMStream(t){return this._sink.toDOMStream(t)}toNodeStream(t){return this._sink.toNodeStream(t)}close(){return this.reset()._sink.close()}abort(t){return this.reset()._sink.abort(t)}finish(){return this._autoDestroy?this.close():this.reset(this._sink,this._schema),this}reset(t=this._sink,n=null){return t===this._sink||t instanceof ic?this._sink=t:(this._sink=new ic,t&&pE(t)?this.toDOMStream({type:"bytes"}).pipeTo(t):t&&mE(t)&&this.toNodeStream({objectMode:!1}).pipe(t)),this._started&&this._schema&&this._writeFooter(this._schema),this._started=!1,this._dictionaryBlocks=[],this._recordBatchBlocks=[],this._seenDictionaries=new Map,this._dictionaryDeltaOffsets=new Map,(!n||!$f(n,this._schema))&&(n==null?(this._position=0,this._schema=null):(this._started=!0,this._schema=n,this._writeSchema(n))),this}write(t){let n=null;if(this._sink){if(t==null)return this.finish()&&void 0;if(t instanceof ue&&!(n=t.schema))return this.finish()&&void 0;if(t instanceof _e&&!(n=t.schema))return this.finish()&&void 0}else throw new Error("RecordBatchWriter is closed");if(n&&!$f(n,this._schema)){if(this._started&&this._autoDestroy)return this.close();this.reset(this._sink,n)}t instanceof _e?t instanceof vh||this._writeRecordBatch(t):t instanceof ue?this.writeAll(t.batches):Ya(t)&&this.writeAll(t)}_writeMessage(t,n=8){const r=n-1,i=we.encode(t),s=i.byteLength,a=this._writeLegacyIpcFormat?4:8,o=s+a+r&~r,c=o-s-a;return t.headerType===It.RecordBatch?this._recordBatchBlocks.push(new Cr(o,t.bodyLength,this._position)):t.headerType===It.DictionaryBatch&&this._dictionaryBlocks.push(new Cr(o,t.bodyLength,this._position)),this._writeLegacyIpcFormat||this._write(Int32Array.of(-1)),this._write(Int32Array.of(o-a)),s>0&&this._write(i),this._writePadding(c)}_write(t){if(this._started){const n=Et(t);n&&n.byteLength>0&&(this._sink.write(n),this._position+=n.byteLength)}return this}_writeSchema(t){return this._writeMessage(we.from(t))}_writeFooter(t){return this._writeLegacyIpcFormat?this._write(Int32Array.of(0)):this._write(Int32Array.of(-1,0))}_writeMagic(){return this._write(Ia)}_writePadding(t){return t>0?this._write(new Uint8Array(t)):this}_writeRecordBatch(t){const{byteLength:n,nodes:r,bufferRegions:i,buffers:s}=Vt.assemble(t),a=new Pe(t.numRows,r,i),o=we.from(a,n);return this._writeDictionaries(t)._writeMessage(o)._writeBodyBuffers(s)}_writeDictionaryBatch(t,n,r=!1){const{byteLength:i,nodes:s,bufferRegions:a,buffers:o}=Vt.assemble(new gt([t])),c=new Pe(t.length,s,a),l=new $n(c,n,r),u=we.from(l,i);return this._writeMessage(u)._writeBodyBuffers(o)}_writeBodyBuffers(t){let n,r,i;for(let s=-1,a=t.length;++s<a;)(n=t[s])&&(r=n.byteLength)>0&&(this._write(n),(i=(r+7&-8)-r)>0&&this._writePadding(i));return this}_writeDictionaries(t){var n,r;for(const[i,s]of t.dictionaries){const a=(n=s?.data)!==null&&n!==void 0?n:[],o=this._seenDictionaries.get(i),c=(r=this._dictionaryDeltaOffsets.get(i))!==null&&r!==void 0?r:0;if(!o||o.data[0]!==a[0])for(const[l,u]of a.entries())this._writeDictionaryBatch(u,i,l>0);else if(c<a.length)for(const l of a.slice(c))this._writeDictionaryBatch(l,i,!0);this._seenDictionaries.set(i,s),this._dictionaryDeltaOffsets.set(i,a.length)}return this}}class Ah extends T_{static writeAll(t,n){const r=new Ah(n);return fi(t)?t.then(i=>r.writeAll(i)):Ns(t)?Mh(r,t):Nh(r,t)}}class Ih extends T_{static writeAll(t){const n=new Ih;return fi(t)?t.then(r=>n.writeAll(r)):Ns(t)?Mh(n,t):Nh(n,t)}constructor(){super(),this._autoDestroy=!0}_writeSchema(t){return this._writeMagic()._writePadding(2)}_writeDictionaryBatch(t,n,r=!1){if(!r&&this._seenDictionaries.has(n))throw new Error("The Arrow File format does not support replacement dictionaries. ");return super._writeDictionaryBatch(t,n,r)}_writeFooter(t){const n=Aa.encode(new Aa(t,qt.V5,this._recordBatchBlocks,this._dictionaryBlocks));return super._writeFooter(t)._write(n)._write(Int32Array.of(n.byteLength))._writeMagic()}}function Nh(e,t){let n=t;t instanceof ue&&(n=t.batches,e.reset(void 0,t.schema));for(const r of n)e.write(r);return e.finish()}function Mh(e,t){return dt(this,void 0,void 0,function*(){var n,r,i,s,a,o,c;try{for(n=!0,r=ai(t);i=yield r.next(),s=i.done,!s;n=!0){c=i.value,n=!1;const l=c;e.write(l)}}catch(l){a={error:l}}finally{try{!n&&!s&&(o=r.return)&&(yield o.call(r))}finally{if(a)throw a.error}}return e.finish()})}function aI(e,t="stream"){return(t==="stream"?Ah:Ih).writeAll(e).toUint8Array(!0)}var oI=Object.create,A_=Object.defineProperty,cI=Object.getOwnPropertyDescriptor,lI=Object.getOwnPropertyNames,uI=Object.getPrototypeOf,fI=Object.prototype.hasOwnProperty,dI=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),hI=(e,t,n,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let i of lI(t))!fI.call(e,i)&&i!==n&&A_(e,i,{get:()=>t[i],enumerable:!(r=cI(t,i))||r.enumerable});return e},pI=(e,t,n)=>(n=e!=null?oI(uI(e)):{},hI(!e||!e.__esModule?A_(n,"default",{value:e,enumerable:!0}):n,e)),mI=dI((e,t)=>{t.exports=Worker}),yI=(e=>(e[e.UNDEFINED=0]="UNDEFINED",e[e.AUTOMATIC=1]="AUTOMATIC",e[e.READ_ONLY=2]="READ_ONLY",e[e.READ_WRITE=3]="READ_WRITE",e))(yI||{}),gI=(e=>(e[e.IDENTIFIER=0]="IDENTIFIER",e[e.NUMERIC_CONSTANT=1]="NUMERIC_CONSTANT",e[e.STRING_CONSTANT=2]="STRING_CONSTANT",e[e.OPERATOR=3]="OPERATOR",e[e.KEYWORD=4]="KEYWORD",e[e.COMMENT=5]="COMMENT",e))(gI||{}),bI=(e=>(e[e.NONE=0]="NONE",e[e.DEBUG=1]="DEBUG",e[e.INFO=2]="INFO",e[e.WARNING=3]="WARNING",e[e.ERROR=4]="ERROR",e))(bI||{}),_I=(e=>(e[e.NONE=0]="NONE",e[e.CONNECT=1]="CONNECT",e[e.DISCONNECT=2]="DISCONNECT",e[e.OPEN=3]="OPEN",e[e.QUERY=4]="QUERY",e[e.INSTANTIATE=5]="INSTANTIATE",e))(_I||{}),wI=(e=>(e[e.NONE=0]="NONE",e[e.OK=1]="OK",e[e.ERROR=2]="ERROR",e[e.START=3]="START",e[e.RUN=4]="RUN",e[e.CAPTURE=5]="CAPTURE",e))(wI||{}),vI=(e=>(e[e.NONE=0]="NONE",e[e.WEB_WORKER=1]="WEB_WORKER",e[e.NODE_WORKER=2]="NODE_WORKER",e[e.BINDINGS=3]="BINDINGS",e[e.ASYNC_DUCKDB=4]="ASYNC_DUCKDB",e))(vI||{}),xI=class{constructor(t=2){this.level=t}log(t){t.level>=this.level&&console.log(t)}},SI=(e=>(e[e.SUCCESS=0]="SUCCESS",e[e.MAX_ARROW_ERROR=255]="MAX_ARROW_ERROR",e[e.DUCKDB_WASM_RETRY=256]="DUCKDB_WASM_RETRY",e))(SI||{}),EI=class{constructor(t,n){this._bindings=t,this._conn=n}get bindings(){return this._bindings}async close(){return this._bindings.disconnect(this._conn)}useUnsafe(t){return t(this._bindings,this._conn)}async query(t){this._bindings.logger.log({timestamp:new Date,level:2,origin:4,topic:4,event:4,value:t});let n=await this._bindings.runQuery(this._conn,t),r=en.from(n);return console.assert(r.isSync(),"Reader is not sync"),console.assert(r.isFile(),"Reader is not file"),new ue(r)}async send(t,n=!1){this._bindings.logger.log({timestamp:new Date,level:2,origin:4,topic:4,event:4,value:t});let r=await this._bindings.startPendingQuery(this._conn,t,n);for(;r==null;){if(this._bindings.isDetached()){console.error("cannot send a message since the worker is not set!");return}r=await this._bindings.pollPendingQuery(this._conn)}let i=new I_(this._bindings,this._conn,r),s=await en.from(i);return console.assert(s.isAsync()),console.assert(s.isStream()),s}async cancelSent(){return await this._bindings.cancelPendingQuery(this._conn)}async getTableNames(t){return await this._bindings.getTableNames(this._conn,t)}async prepare(t){let n=await this._bindings.createPrepared(this._conn,t);return new TI(this._bindings,this._conn,n)}async insertArrowTable(t,n){let r=aI(t,"stream");await this.insertArrowFromIPCStream(r,n)}async insertArrowFromIPCStream(t,n){await this._bindings.insertArrowFromIPCStream(this._conn,t,n)}async insertCSVFromPath(t,n){await this._bindings.insertCSVFromPath(this._conn,t,n)}async insertJSONFromPath(t,n){await this._bindings.insertJSONFromPath(this._conn,t,n)}},I_=class{constructor(t,n,r){this.db=t,this.conn=n,this.header=r,this._first=!0,this._depleted=!1,this._inFlight=null}async next(){if(this._first)return this._first=!1,{done:!1,value:this.header};if(this._depleted)return{done:!0,value:null};let t=null;for(this._inFlight!=null&&(t=await this._inFlight,this._inFlight=null);t==null;)t=await this.db.fetchQueryResults(this.conn);return this._depleted=t.length==0,this._depleted||(this._inFlight=this.db.fetchQueryResults(this.conn)),{done:this._depleted,value:t}}[Symbol.asyncIterator](){return this}},TI=class{constructor(t,n,r){this.bindings=t,this.connectionId=n,this.statementId=r}async close(){await this.bindings.closePrepared(this.connectionId,this.statementId)}async query(...t){let n=await this.bindings.runPrepared(this.connectionId,this.statementId,t),r=en.from(n);return console.assert(r.isSync()),console.assert(r.isFile()),new ue(r)}async send(...t){let n=await this.bindings.sendPrepared(this.connectionId,this.statementId,t),r=new I_(this.bindings,this.connectionId,n),i=await en.from(r);return console.assert(i.isAsync()),console.assert(i.isStream()),i}},AI=(e=>(e.CANCEL_PENDING_QUERY="CANCEL_PENDING_QUERY",e.CLOSE_PREPARED="CLOSE_PREPARED",e.COLLECT_FILE_STATISTICS="COLLECT_FILE_STATISTICS",e.REGISTER_OPFS_FILE_NAME="REGISTER_OPFS_FILE_NAME",e.CONNECT="CONNECT",e.COPY_FILE_TO_BUFFER="COPY_FILE_TO_BUFFER",e.COPY_FILE_TO_PATH="COPY_FILE_TO_PATH",e.CREATE_PREPARED="CREATE_PREPARED",e.DISCONNECT="DISCONNECT",e.DROP_FILE="DROP_FILE",e.DROP_FILES="DROP_FILES",e.EXPORT_FILE_STATISTICS="EXPORT_FILE_STATISTICS",e.FETCH_QUERY_RESULTS="FETCH_QUERY_RESULTS",e.FLUSH_FILES="FLUSH_FILES",e.GET_FEATURE_FLAGS="GET_FEATURE_FLAGS",e.GET_TABLE_NAMES="GET_TABLE_NAMES",e.GET_VERSION="GET_VERSION",e.GLOB_FILE_INFOS="GLOB_FILE_INFOS",e.INSERT_ARROW_FROM_IPC_STREAM="INSERT_ARROW_FROM_IPC_STREAM",e.INSERT_CSV_FROM_PATH="IMPORT_CSV_FROM_PATH",e.INSERT_JSON_FROM_PATH="IMPORT_JSON_FROM_PATH",e.INSTANTIATE="INSTANTIATE",e.OPEN="OPEN",e.PING="PING",e.POLL_PENDING_QUERY="POLL_PENDING_QUERY",e.REGISTER_FILE_BUFFER="REGISTER_FILE_BUFFER",e.REGISTER_FILE_HANDLE="REGISTER_FILE_HANDLE",e.REGISTER_FILE_URL="REGISTER_FILE_URL",e.RESET="RESET",e.RUN_PREPARED="RUN_PREPARED",e.RUN_QUERY="RUN_QUERY",e.SEND_PREPARED="SEND_PREPARED",e.START_PENDING_QUERY="START_PENDING_QUERY",e.TOKENIZE="TOKENIZE",e))(AI||{}),II=(e=>(e.CONNECTION_INFO="CONNECTION_INFO",e.ERROR="ERROR",e.FEATURE_FLAGS="FEATURE_FLAGS",e.FILE_BUFFER="FILE_BUFFER",e.FILE_INFOS="FILE_INFOS",e.FILE_SIZE="FILE_SIZE",e.FILE_STATISTICS="FILE_STATISTICS",e.INSTANTIATE_PROGRESS="INSTANTIATE_PROGRESS",e.LOG="LOG",e.PROGRESS_UPDATE="PROGRESS_UPDATE",e.OK="OK",e.PREPARED_STATEMENT_ID="PREPARED_STATEMENT_ID",e.QUERY_PLAN="QUERY_PLAN",e.QUERY_RESULT="QUERY_RESULT",e.QUERY_RESULT_CHUNK="QUERY_RESULT_CHUNK",e.QUERY_RESULT_HEADER="QUERY_RESULT_HEADER",e.QUERY_RESULT_HEADER_OR_NULL="QUERY_RESULT_HEADER_OR_NULL",e.REGISTERED_FILE="REGISTERED_FILE",e.SCRIPT_TOKENS="SCRIPT_TOKENS",e.SUCCESS="SUCCESS",e.TABLE_NAMES="TABLE_NAMES",e.VERSION_STRING="VERSION_STRING",e))(II||{}),Tt=class{constructor(t,n){this.promiseResolver=()=>{},this.promiseRejecter=()=>{},this.type=t,this.data=n,this.promise=new Promise((r,i)=>{this.promiseResolver=r,this.promiseRejecter=i})}};function cc(e){switch(e.typeId){case v.Binary:return{sqlType:"binary"};case v.Bool:return{sqlType:"bool"};case v.Date:return{sqlType:"date"};case v.DateDay:return{sqlType:"date32[d]"};case v.DateMillisecond:return{sqlType:"date64[ms]"};case v.Decimal:{let t=e;return{sqlType:"decimal",precision:t.precision,scale:t.scale}}case v.Float:return{sqlType:"float"};case v.Float16:return{sqlType:"float16"};case v.Float32:return{sqlType:"float32"};case v.Float64:return{sqlType:"float64"};case v.Int:return{sqlType:"int32"};case v.Int16:return{sqlType:"int16"};case v.Int32:return{sqlType:"int32"};case v.Int64:return{sqlType:"int64"};case v.Uint16:return{sqlType:"uint16"};case v.Uint32:return{sqlType:"uint32"};case v.Uint64:return{sqlType:"uint64"};case v.Uint8:return{sqlType:"uint8"};case v.IntervalDayTime:return{sqlType:"interval[dt]"};case v.IntervalYearMonth:return{sqlType:"interval[m]"};case v.List:return{sqlType:"list",valueType:cc(e.valueType)};case v.FixedSizeBinary:return{sqlType:"fixedsizebinary",byteWidth:e.byteWidth};case v.Null:return{sqlType:"null"};case v.Utf8:return{sqlType:"utf8"};case v.Struct:return{sqlType:"struct",fields:e.children.map(t=>jf(t.name,t.type))};case v.Map:{let t=e;return{sqlType:"map",keyType:cc(t.keyType),valueType:cc(t.valueType)}}case v.Time:return{sqlType:"time[s]"};case v.TimeMicrosecond:return{sqlType:"time[us]"};case v.TimeMillisecond:return{sqlType:"time[ms]"};case v.TimeNanosecond:return{sqlType:"time[ns]"};case v.TimeSecond:return{sqlType:"time[s]"};case v.Timestamp:return{sqlType:"timestamp",timezone:e.timezone||void 0};case v.TimestampSecond:return{sqlType:"timestamp[s]",timezone:e.timezone||void 0};case v.TimestampMicrosecond:return{sqlType:"timestamp[us]",timezone:e.timezone||void 0};case v.TimestampNanosecond:return{sqlType:"timestamp[ns]",timezone:e.timezone||void 0};case v.TimestampMillisecond:return{sqlType:"timestamp[ms]",timezone:e.timezone||void 0}}throw new Error("unsupported arrow type: ".concat(e.toString()))}function jf(e,t){let n=cc(t);return n.name=e,n}var NI=/'(opfs:\/\/\S*?)'/g,MI=/(opfs:\/\/\S*?)/g;function OI(e){return e.search(MI)>-1}function RI(e){return[...e.matchAll(NI)].map(t=>t[1])}var DI=new TextEncoder,LI=class{constructor(t,n=null){this._onInstantiationProgress=[],this._onExecutionProgress=[],this._worker=null,this._workerShutdownPromise=null,this._workerShutdownResolver=()=>{},this._nextMessageId=0,this._pendingRequests=new Map,this._config={},this._logger=t,this._onMessageHandler=this.onMessage.bind(this),this._onErrorHandler=this.onError.bind(this),this._onCloseHandler=this.onClose.bind(this),n!=null&&this.attach(n)}get logger(){return this._logger}get config(){return this._config}attach(t){this._worker=t,this._worker.addEventListener("message",this._onMessageHandler),this._worker.addEventListener("error",this._onErrorHandler),this._worker.addEventListener("close",this._onCloseHandler),this._workerShutdownPromise=new Promise((n,r)=>{this._workerShutdownResolver=n})}detach(){this._worker&&(this._worker.removeEventListener("message",this._onMessageHandler),this._worker.removeEventListener("error",this._onErrorHandler),this._worker.removeEventListener("close",this._onCloseHandler),this._worker=null,this._workerShutdownResolver(null),this._workerShutdownPromise=null,this._workerShutdownResolver=()=>{})}async terminate(){this._worker&&(this._worker.terminate(),this._worker=null,this._workerShutdownPromise=null,this._workerShutdownResolver=()=>{})}async postTask(t,n=[]){if(!this._worker){console.error("cannot send a message since the worker is not set!:"+t.type+","+t.data);return}let r=this._nextMessageId++;return this._pendingRequests.set(r,t),this._worker.postMessage({messageId:r,type:t.type,data:t.data},n),await t.promise}onMessage(t){var n;let r=t.data;switch(r.type){case"PROGRESS_UPDATE":{for(let s of this._onExecutionProgress)s(r.data);return}case"LOG":{this._logger.log(r.data);return}case"INSTANTIATE_PROGRESS":{for(let s of this._onInstantiationProgress)s(r.data);return}}let i=this._pendingRequests.get(r.requestId);if(!i){console.warn("unassociated response: [".concat(r.requestId,", ").concat(r.type.toString(),"]"));return}if(this._pendingRequests.delete(r.requestId),r.type=="ERROR"){let s=new Error(r.data.message);s.name=r.data.name,(n=Object.getOwnPropertyDescriptor(s,"stack"))!=null&&n.writable&&(s.stack=r.data.stack),i.promiseRejecter(s);return}switch(i.type){case"CLOSE_PREPARED":case"COLLECT_FILE_STATISTICS":case"REGISTER_OPFS_FILE_NAME":case"COPY_FILE_TO_PATH":case"DISCONNECT":case"DROP_FILE":case"DROP_FILES":case"FLUSH_FILES":case"INSERT_ARROW_FROM_IPC_STREAM":case"IMPORT_CSV_FROM_PATH":case"IMPORT_JSON_FROM_PATH":case"OPEN":case"PING":case"REGISTER_FILE_BUFFER":case"REGISTER_FILE_HANDLE":case"REGISTER_FILE_URL":case"RESET":if(r.type=="OK"){i.promiseResolver(r.data);return}break;case"INSTANTIATE":if(this._onInstantiationProgress=[],r.type=="OK"){i.promiseResolver(r.data);return}break;case"GLOB_FILE_INFOS":if(r.type=="FILE_INFOS"){i.promiseResolver(r.data);return}break;case"GET_VERSION":if(r.type=="VERSION_STRING"){i.promiseResolver(r.data);return}break;case"GET_FEATURE_FLAGS":if(r.type=="FEATURE_FLAGS"){i.promiseResolver(r.data);return}break;case"GET_TABLE_NAMES":if(r.type=="TABLE_NAMES"){i.promiseResolver(r.data);return}break;case"TOKENIZE":if(r.type=="SCRIPT_TOKENS"){i.promiseResolver(r.data);return}break;case"COPY_FILE_TO_BUFFER":if(r.type=="FILE_BUFFER"){i.promiseResolver(r.data);return}break;case"EXPORT_FILE_STATISTICS":if(r.type=="FILE_STATISTICS"){i.promiseResolver(r.data);return}break;case"CONNECT":if(r.type=="CONNECTION_INFO"){i.promiseResolver(r.data);return}break;case"RUN_PREPARED":case"RUN_QUERY":if(r.type=="QUERY_RESULT"){i.promiseResolver(r.data);return}break;case"SEND_PREPARED":if(r.type=="QUERY_RESULT_HEADER"){i.promiseResolver(r.data);return}break;case"START_PENDING_QUERY":if(r.type=="QUERY_RESULT_HEADER_OR_NULL"){i.promiseResolver(r.data);return}break;case"POLL_PENDING_QUERY":if(r.type=="QUERY_RESULT_HEADER_OR_NULL"){i.promiseResolver(r.data);return}break;case"CANCEL_PENDING_QUERY":if(this._onInstantiationProgress=[],r.type=="SUCCESS"){i.promiseResolver(r.data);return}break;case"FETCH_QUERY_RESULTS":if(r.type=="QUERY_RESULT_CHUNK"){i.promiseResolver(r.data);return}break;case"CREATE_PREPARED":if(r.type=="PREPARED_STATEMENT_ID"){i.promiseResolver(r.data);return}break}i.promiseRejecter(new Error("unexpected response type: ".concat(r.type.toString())))}onError(t){console.error(t),console.error("error in duckdb worker: ".concat(t.message)),this._pendingRequests.clear()}onClose(){if(this._workerShutdownResolver(null),this._pendingRequests.size!=0){console.warn("worker terminated with ".concat(this._pendingRequests.size," pending requests"));return}this._pendingRequests.clear()}isDetached(){return!this._worker}async reset(){let t=new Tt("RESET",null);return await this.postTask(t)}async ping(){let t=new Tt("PING",null);await this.postTask(t)}async dropFile(t){let n=new Tt("DROP_FILE",t);return await this.postTask(n)}async dropFiles(t){let n=new Tt("DROP_FILES",t);return await this.postTask(n)}async flushFiles(){let t=new Tt("FLUSH_FILES",null);return await this.postTask(t)}async instantiate(t,n=null,r=i=>{}){this._onInstantiationProgress.push(r);let i=new Tt("INSTANTIATE",[t,n]);return await this.postTask(i)}async getVersion(){let t=new Tt("GET_VERSION",null);return await this.postTask(t)}async getFeatureFlags(){let t=new Tt("GET_FEATURE_FLAGS",null);return await this.postTask(t)}async open(t){this._config=t;let n=new Tt("OPEN",t);await this.postTask(n)}async tokenize(t){let n=new Tt("TOKENIZE",t);return await this.postTask(n)}async connectInternal(){let t=new Tt("CONNECT",null);return await this.postTask(t)}async connect(){let t=await this.connectInternal();return new EI(this,t)}async disconnect(t){let n=new Tt("DISCONNECT",t);await this.postTask(n)}async runQuery(t,n){if(this.shouldOPFSFileHandling()){let r=await this.registerOPFSFileFromSQL(n);try{return await this._runQueryAsync(t,n)}finally{r.length>0&&await this.dropFiles(r)}}else return await this._runQueryAsync(t,n)}async _runQueryAsync(t,n){let r=new Tt("RUN_QUERY",[t,n]);return await this.postTask(r)}async startPendingQuery(t,n,r=!1){if(this.shouldOPFSFileHandling()){let i=await this.registerOPFSFileFromSQL(n);try{return await this._startPendingQueryAsync(t,n,r)}finally{i.length>0&&await this.dropFiles(i)}}else return await this._startPendingQueryAsync(t,n,r)}async _startPendingQueryAsync(t,n,r=!1){let i=new Tt("START_PENDING_QUERY",[t,n,r]);return await this.postTask(i)}async pollPendingQuery(t){let n=new Tt("POLL_PENDING_QUERY",t);return await this.postTask(n)}async cancelPendingQuery(t){let n=new Tt("CANCEL_PENDING_QUERY",t);return await this.postTask(n)}async fetchQueryResults(t){let n=new Tt("FETCH_QUERY_RESULTS",t);return await this.postTask(n)}async getTableNames(t,n){let r=new Tt("GET_TABLE_NAMES",[t,n]);return await this.postTask(r)}async createPrepared(t,n){let r=new Tt("CREATE_PREPARED",[t,n]);return await this.postTask(r)}async closePrepared(t,n){let r=new Tt("CLOSE_PREPARED",[t,n]);await this.postTask(r)}async runPrepared(t,n,r){let i=new Tt("RUN_PREPARED",[t,n,r]);return await this.postTask(i)}async sendPrepared(t,n,r){let i=new Tt("SEND_PREPARED",[t,n,r]);return await this.postTask(i)}async globFiles(t){let n=new Tt("GLOB_FILE_INFOS",t);return await this.postTask(n)}async registerFileText(t,n){let r=DI.encode(n);await this.registerFileBuffer(t,r)}async registerFileURL(t,n,r,i){n===void 0&&(n=t);let s=new Tt("REGISTER_FILE_URL",[t,n,r,i]);await this.postTask(s)}async registerEmptyFileBuffer(t){}async registerFileBuffer(t,n){let r=new Tt("REGISTER_FILE_BUFFER",[t,n]);await this.postTask(r,[n.buffer])}async registerFileHandle(t,n,r,i){let s=new Tt("REGISTER_FILE_HANDLE",[t,n,r,i]);await this.postTask(s,[])}async registerOPFSFileName(t){let n=new Tt("REGISTER_OPFS_FILE_NAME",[t]);await this.postTask(n,[])}async collectFileStatistics(t,n){let r=new Tt("COLLECT_FILE_STATISTICS",[t,n]);await this.postTask(r,[])}async exportFileStatistics(t){let n=new Tt("EXPORT_FILE_STATISTICS",t);return await this.postTask(n,[])}async copyFileToBuffer(t){let n=new Tt("COPY_FILE_TO_BUFFER",t);return await this.postTask(n)}async copyFileToPath(t,n){let r=new Tt("COPY_FILE_TO_PATH",[t,n]);await this.postTask(r)}async insertArrowFromIPCStream(t,n,r){if(n.length==0)return;let i=new Tt("INSERT_ARROW_FROM_IPC_STREAM",[t,n,r]);await this.postTask(i,[n.buffer])}async insertCSVFromPath(t,n,r){if(r.columns!==void 0){let s=[];for(let a in r.columns){let o=r.columns[a];s.push(jf(a,o))}r.columnsFlat=s,delete r.columns}let i=new Tt("IMPORT_CSV_FROM_PATH",[t,n,r]);await this.postTask(i)}async insertJSONFromPath(t,n,r){if(r.columns!==void 0){let s=[];for(let a in r.columns){let o=r.columns[a];s.push(jf(a,o))}r.columnsFlat=s,delete r.columns}let i=new Tt("IMPORT_JSON_FROM_PATH",[t,n,r]);await this.postTask(i)}shouldOPFSFileHandling(){var t,n;return OI((t=this.config.path)!=null?t:"")?((n=this.config.opfs)==null?void 0:n.fileHandling)=="auto":!1}async registerOPFSFileFromSQL(t){let n=RI(t),r=[];for(let i of n)try{await this.registerOPFSFileName(i),r.push(i)}catch(s){throw console.error(s),new Error("File Not found:"+i)}return r}};function FI(){let e=new TextDecoder;return t=>(typeof SharedArrayBuffer<"u"&&t.buffer instanceof SharedArrayBuffer&&(t=new Uint8Array(t)),e.decode(t))}FI();var kI=(e=>(e[e.BUFFER=0]="BUFFER",e[e.NODE_FS=1]="NODE_FS",e[e.BROWSER_FILEREADER=2]="BROWSER_FILEREADER",e[e.BROWSER_FSACCESS=3]="BROWSER_FSACCESS",e[e.HTTP=4]="HTTP",e[e.S3=5]="S3",e))(kI||{}),CI=async()=>WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,5,3,1,0,1,10,14,1,12,0,65,0,65,0,65,0,252,10,0,0,11])),BI=async()=>WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,10,8,1,6,0,6,64,25,11,11])),$I=async()=>WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,5,1,96,0,1,123,3,2,1,0,10,10,1,8,0,65,0,253,15,253,98,11])),UI=()=>(async e=>{try{return typeof MessageChannel<"u"&&new MessageChannel().port1.postMessage(new SharedArrayBuffer(1)),WebAssembly.validate(e)}catch{return!1}})(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,5,4,1,3,1,1,10,11,1,9,0,65,0,254,16,2,0,26,11])),PI={version:"1.32.0"},Oh=PI.version.split(".");Oh[0];Oh[1];Oh[2];var jI=()=>typeof navigator>"u",Cu=null,Bu=null,$u=null,Uu=null,Pu=null;async function VI(){return Cu==null&&(Cu=typeof BigInt64Array<"u"),Bu==null&&(Bu=await BI()),$u==null&&($u=await UI()),Uu==null&&(Uu=await $I()),Pu==null&&(Pu=await CI()),{bigInt64Array:Cu,crossOriginIsolated:jI()||globalThis.crossOriginIsolated||!1,wasmExceptions:Bu,wasmSIMD:Uu,wasmThreads:$u,wasmBulkMemory:Pu}}async function zI(e){let t=await VI();if(t.wasmExceptions){if(t.wasmSIMD&&t.wasmThreads&&t.crossOriginIsolated&&e.coi)return{mainModule:e.coi.mainModule,mainWorker:e.coi.mainWorker,pthreadWorker:e.coi.pthreadWorker};if(e.eh)return{mainModule:e.eh.mainModule,mainWorker:e.eh.mainWorker,pthreadWorker:null}}return{mainModule:e.mvp.mainModule,mainWorker:e.mvp.mainWorker,pthreadWorker:null}}pI(mI());const YI="/tracksy/_astro/duckdb-mvp.BP0pRkMH.wasm",WI="/tracksy/_astro/duckdb-browser-mvp.worker.C9hF7LGh.js",HI="/tracksy/_astro/duckdb-eh.9ubY-jlA.wasm",qI="/tracksy/_astro/duckdb-browser-eh.worker.hQa-dcAV.js",GI={mvp:{mainModule:YI,mainWorker:WI},eh:{mainModule:HI,mainWorker:qI}};async function XI(){const e=await zI(GI),t=new Worker(e.mainWorker),n=new xI,r=new LI(n,t);await r.instantiate(e.mainModule,e.pthreadWorker);const i=await r.connect();return{db:r,conn:i}}const Qa=async()=>{if(!window.db||!window.conn){const{db:e,conn:t}=await XI();window.db=e,window.conn=t,console.debug("Database initialized")}return{db:window.db,conn:window.conn}};function KI(e){return QI(e)&&typeof e.ts=="string"&&typeof e.ms_played=="number"&&typeof e.master_metadata_track_name=="string"&&typeof e.master_metadata_album_artist_name=="string"}function QI(e){return typeof e.track_uri=="string"}function JI(e){return e.ms_played>=3e4}class ZI{validateFile(t){return this.filePattern.test(t.name)}validate(t){return t.filter(KI)}filter(t){return t.filter(JI)}async processFile(t){const n=await this.readFile(t),r=this.transform(n),i=this.validate(r);return this.filter(i)}}class t6 extends ZI{name="spotify";displayName="Spotify";filePattern=/^Streaming_History_Audio_\d{4}(-\d{4})?(_\d+)?\.json$/i;fileContentType="application/json";async readFile(t){const n=await t.text(),r=JSON.parse(n);if(!Array.isArray(r))throw new Error("Expected JSON array of streaming records");return r}transform(t){return t.map(({spotify_track_uri:r,...i})=>({...i,track_uri:r}))}}const N_=[new t6],M_=N_.map(e=>e.fileContentType);function e6(e){for(const t of N_)if(t.validateFile(e))return t}const n6=e=>M_.some(t=>t===e.type),O_="application/zip",Lp=e=>e.type===O_;function r6({handleDrop:e,handleDragOver:t,handleFileUpload:n,contentTypeAccepted:r}){return m.jsx("div",{children:m.jsxs("div",{className:"flex flex-col items-center justify-center p-6 border border-2 border-dashed border-gray-300/60 dark:border-slate-700/50 text-gray-900 dark:text-gray-200 rounded-lg bg-gray-100 dark:bg-slate-800/50 hover:bg-gray-200 transition-all cursor-pointer",onDrop:e,"aria-label":"dropzone",onDragOver:t,children:[m.jsx("input",{type:"file",className:"hidden",id:"fileInput","aria-label":"upload file",onChange:n,accept:r}),m.jsxs("label",{htmlFor:"fileInput",className:"text-sm cursor-pointer text-center",children:["Drag and drop or click to upload your Spotify data files",m.jsx("br",{}),"Only ",m.jsx("strong",{children:"ZIP archive"})," or a"," ",m.jsx("strong",{children:"JSON file"})," are accepted"]})]})})}const i6=e=>{const t=new DataTransfer;return e.forEach(n=>t.items.add(n)),t.files};/**
 * @license
 * Copyright 2019 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const R_=Symbol("Comlink.proxy"),s6=Symbol("Comlink.endpoint"),a6=Symbol("Comlink.releaseProxy"),ju=Symbol("Comlink.finalizer"),lc=Symbol("Comlink.thrown"),Fp=e=>typeof e=="object"&&e!==null||typeof e=="function",D_=new Map([["proxy",{canHandle:e=>Fp(e)&&e[R_],serialize(e){const{port1:t,port2:n}=new MessageChannel;return L_(e,t),[n,[n]]},deserialize:e=>(e.start(),k_(e))}],["throw",{canHandle:e=>Fp(e)&&lc in e,serialize({value:e}){let t;return t=e instanceof Error?{isError:!0,value:{message:e.message,name:e.name,stack:e.stack}}:{isError:!1,value:e},[t,[]]},deserialize(e){throw e.isError?Object.assign(new Error(e.value.message),e.value):e.value}}]]);function L_(e,t=globalThis,n=["*"]){t.addEventListener("message",(function r(i){if(!i||!i.data)return;if(!(function(u,f){for(const d of u)if(f===d||d==="*"||d instanceof RegExp&&d.test(f))return!0;return!1})(n,i.origin))return void console.warn(`Invalid origin '${i.origin}' for comlink proxy`);const{id:s,type:a,path:o}=Object.assign({path:[]},i.data),c=(i.data.argumentList||[]).map(ni);let l;try{const u=o.slice(0,-1).reduce(((d,h)=>d[h]),e),f=o.reduce(((d,h)=>d[h]),e);switch(a){case"GET":l=f;break;case"SET":u[o.slice(-1)[0]]=ni(i.data.value),l=!0;break;case"APPLY":l=f.apply(u,c);break;case"CONSTRUCT":l=Rh(new f(...c));break;case"ENDPOINT":{const{port1:d,port2:h}=new MessageChannel;L_(e,h),l=(function(p,y){return B_.set(p,y),p})(d,[d])}break;case"RELEASE":l=void 0;break;default:return}}catch(u){l={value:u,[lc]:0}}Promise.resolve(l).catch((u=>({value:u,[lc]:0}))).then((u=>{const[f,d]=Vc(u);t.postMessage(Object.assign(Object.assign({},f),{id:s}),d),a==="RELEASE"&&(t.removeEventListener("message",r),F_(t),ju in e&&typeof e[ju]=="function"&&e[ju]())})).catch((u=>{const[f,d]=Vc({value:new TypeError("Unserializable return value"),[lc]:0});t.postMessage(Object.assign(Object.assign({},f),{id:s}),d)}))})),t.start&&t.start()}function F_(e){(function(t){return t.constructor.name==="MessagePort"})(e)&&e.close()}function k_(e,t){return Vf(e,[],t)}function No(e){if(e)throw new Error("Proxy has been released and is not useable")}function C_(e){return Gi(e,{type:"RELEASE"}).then((()=>{F_(e)}))}const jc=new WeakMap,Mo="FinalizationRegistry"in globalThis&&new FinalizationRegistry((e=>{const t=(jc.get(e)||0)-1;jc.set(e,t),t===0&&C_(e)}));function Vf(e,t=[],n=function(){}){let r=!1;const i=new Proxy(n,{get(s,a){if(No(r),a===a6)return()=>{(function(o){Mo&&Mo.unregister(o)})(i),C_(e),r=!0};if(a==="then"){if(t.length===0)return{then:()=>i};const o=Gi(e,{type:"GET",path:t.map((c=>c.toString()))}).then(ni);return o.then.bind(o)}return Vf(e,[...t,a])},set(s,a,o){No(r);const[c,l]=Vc(o);return Gi(e,{type:"SET",path:[...t,a].map((u=>u.toString())),value:c},l).then(ni)},apply(s,a,o){No(r);const c=t[t.length-1];if(c===s6)return Gi(e,{type:"ENDPOINT"}).then(ni);if(c==="bind")return Vf(e,t.slice(0,-1));const[l,u]=kp(o);return Gi(e,{type:"APPLY",path:t.map((f=>f.toString())),argumentList:l},u).then(ni)},construct(s,a){No(r);const[o,c]=kp(a);return Gi(e,{type:"CONSTRUCT",path:t.map((l=>l.toString())),argumentList:o},c).then(ni)}});return(function(s,a){const o=(jc.get(a)||0)+1;jc.set(a,o),Mo&&Mo.register(s,a,s)})(i,e),i}function kp(e){const t=e.map(Vc);return[t.map((r=>r[0])),(n=t.map((r=>r[1])),Array.prototype.concat.apply([],n))];var n}const B_=new WeakMap;function Rh(e){return Object.assign(e,{[R_]:!0})}function Vc(e){for(const[t,n]of D_)if(n.canHandle(e)){const[r,i]=n.serialize(e);return[{type:"HANDLER",name:t,value:r},i]}return[{type:"RAW",value:e},B_.get(e)||[]]}function ni(e){switch(e.type){case"HANDLER":return D_.get(e.name).deserialize(e.value);case"RAW":return e.value}}function Gi(e,t,n){return new Promise((r=>{const i=new Array(4).fill(0).map((()=>Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16))).join("-");e.addEventListener("message",(function s(a){a.data&&a.data.id&&a.data.id===i&&(e.removeEventListener("message",s),r(a.data))})),e.start&&e.start(),e.postMessage(Object.assign({id:i},t),n)}))}class Dh{constructor(t,n,r,i,s){this._name=t,this._size=n,this._path=r,this._lastModified=i,this._archiveRef=s}get name(){return this._name}get size(){return this._size}get lastModified(){return this._lastModified}extract(){return this._archiveRef.extractSingleFile(this._path)}}function zf(e){if(e instanceof File||e instanceof Dh||e===null)return e;const t={};for(const n of Object.keys(e))t[n]=zf(e[n]);return t}function $_(e,t=""){const n=[];for(const r of Object.keys(e))e[r]instanceof File||e[r]instanceof Dh||e[r]===null?n.push({file:e[r]||r,path:t}):n.push(...$_(e[r],`${t}${r}/`));return n}function Cp(e,t){const n=t.split("/");n[n.length-1]===""&&n.pop();let r=e,i=null;for(const s of n)r[s]=r[s]||{},i=r,r=r[s];return[i,n[n.length-1]]}let o6=class{constructor(t,n,r){this._content={},this._processed=0,this.file=t,this.client=n,this.worker=r}open(){return this._content={},this._processed=0,new Promise(((t,n)=>{this.client.open(this.file,Rh((()=>{t(this)})))}))}async close(){var t;(t=this.worker)===null||t===void 0||t.terminate(),this.worker=null,this.client=null,this.file=null}async hasEncryptedData(){return await this.client.hasEncryptedData()}async usePassword(t){await this.client.usePassword(t)}async setLocale(t){await this.client.setLocale(t)}async getFilesObject(){return this._processed>0?Promise.resolve().then((()=>this._content)):((await this.client.listFiles()).forEach((t=>{const[n,r]=Cp(this._content,t.path);t.type==="FILE"&&(n[r]=new Dh(t.fileName,t.size,t.path,t.lastModified,this))})),this._processed=1,zf(this._content))}getFilesArray(){return this.getFilesObject().then((t=>$_(t)))}async extractSingleFile(t){if(this.worker===null)throw new Error("Archive already closed");const n=await this.client.extractSingleFile(t);return new File([n.fileData],n.fileName,{type:"application/octet-stream",lastModified:n.lastModified/1e6})}async extractFiles(t=void 0){var n;return this._processed>1?Promise.resolve().then((()=>this._content)):((await this.client.extractFiles()).forEach((r=>{const[i,s]=Cp(this._content,r.path);r.type==="FILE"&&(i[s]=new File([r.fileData],r.fileName,{type:"application/octet-stream"}),t!==void 0&&setTimeout(t.bind(null,{file:i[s],path:r.path})))})),this._processed=2,(n=this.worker)===null||n===void 0||n.terminate(),zf(this._content))}};var Bp,$p;(function(e){e.SEVEN_ZIP="7zip",e.AR="ar",e.ARBSD="arbsd",e.ARGNU="argnu",e.ARSVR4="arsvr4",e.BIN="bin",e.BSDTAR="bsdtar",e.CD9660="cd9660",e.CPIO="cpio",e.GNUTAR="gnutar",e.ISO="iso",e.ISO9660="iso9660",e.MTREE="mtree",e.MTREE_CLASSIC="mtree-classic",e.NEWC="newc",e.ODC="odc",e.OLDTAR="oldtar",e.PAX="pax",e.PAXR="paxr",e.POSIX="posix",e.PWB="pwb",e.RAW="raw",e.RPAX="rpax",e.SHAR="shar",e.SHARDUMP="shardump",e.USTAR="ustar",e.V7TAR="v7tar",e.V7="v7",e.WARC="warc",e.XAR="xar",e.ZIP="zip"})(Bp||(Bp={})),(function(e){e.B64ENCODE="b64encode",e.BZIP2="bzip2",e.COMPRESS="compress",e.GRZIP="grzip",e.GZIP="gzip",e.LRZIP="lrzip",e.LZ4="lz4",e.LZIP="lzip",e.LZMA="lzma",e.LZOP="lzop",e.UUENCODE="uuencode",e.XZ="xz",e.ZSTD="zstd",e.NONE="none"})($p||($p={}));class xe{static init(t=null){return xe._options=t||{},xe._options}static async open(t){const n=xe.getWorker(xe._options),r=await xe.getClient(n,xe._options);return await new o6(t,r,n).open()}static async write({files:t,outputFileName:n,compression:r,format:i,passphrase:s=null}){const a=xe.getWorker(xe._options),o=await xe.getClient(a,xe._options),c=await o.writeArchive(t,r,i,s);return a.terminate(),new File([c],n,{type:"application/octet-stream"})}static getWorker(t){return t.getWorker?t.getWorker():new Worker(t.workerUrl||new URL("/tracksy/_astro/worker-bundle.Dx5mKZOL.js",import.meta.url),{type:"module"})}static async getClient(t,n){var r;const i=((r=n.createClient)===null||r===void 0?void 0:r.call(n,t))||k_(t);let{promise:s,resolve:a}=Promise.withResolvers();const o=await new i(Rh((()=>{a()})));return await s,o}}xe._options={},Promise.withResolvers||(Promise.withResolvers=function(){var e,t,n=new this((function(r,i){e=r,t=i}));return{resolve:e,reject:t,promise:n}});const c6="/tracksy/_astro/worker-bundle.Dx5mKZOL.js";async function l6(e){return xe.init({workerUrl:c6}),await xe.open(e)}const u6=["__MACOSX"];function f6({onSuccess:e,onFail:t}){const n=s=>{const a=c=>n6(c)||Lp(c);if(Array.from(s).filter(a).length!==s.length)throw new Error("One or more files have an unsupported content type")},r=async s=>{const o=await(await l6(s)).extractFiles(),c=Object.entries(o).filter(([l])=>!u6.some(u=>l.startsWith(u))).flatMap(([,l])=>l instanceof File?[l]:Object.values(l));if(c.length===0)throw new Error("No files found in the archive");return i6(c)};return{uploadFiles:async s=>{try{n(s);const a=s.length===1&&Lp(s[0])?await r(s[0]):s;e(a)}catch(a){console.error("Error while processing files:",a),t()}}}}function d6({handleValidatedFiles:e}){const{uploadFiles:t}=f6({onSuccess:a=>e(a),onFail:()=>console.error("Upload failed")}),n=async a=>{const o=a.target.files;o!==null&&(console.debug("Uploaded files:",Array.from(o)),await t(o))},r=async a=>{a.preventDefault();const o=a.dataTransfer.files;console.debug("Dragged in files:",Array.from(o)),await t(o)},i=a=>{a.preventDefault()},s=M_.join(",")+O_;return m.jsx(r6,{handleDrop:r,handleDragOver:i,handleFileUpload:n,contentTypeAccepted:s})}const q="spotitable",U_=`DROP TABLE IF EXISTS ${q}`;async function h6(e){if(e.length<1)throw console.error("No file to process"),new Error("No file to process");const t=[];for(const i of Array.from(e)){console.debug(`File ${i.name} is being processed.`);const s=e6(i);if(!s){console.warn(`File ${i.name} does not match any known provider. Skipping.`);continue}console.debug(`File ${i.name} detected as ${s.displayName} format.`);const a=await s.processFile(i);t.push(...a)}if(t.length===0)throw console.error("No valid stream records found"),new Error("No valid stream records found");const n=bA(t),{conn:r}=await Qa();await r.query(U_),console.debug(`Table ${q} dropped.`),await r.insertArrowTable(n,{name:q,create:!0}),console.debug(`Table ${q} created with ${t.length} records.`)}function p6(){return m.jsxs("svg",{width:"50",height:"50",viewBox:"0 0 50 50",xmlns:"http://www.w3.org/2000/svg",children:[m.jsx("defs",{children:m.jsxs("linearGradient",{id:"spinner-gradient",x1:"0%",y1:"0%",x2:"100%",y2:"0%",children:[m.jsx("stop",{offset:"0%",style:{stopColor:"#3498db",stopOpacity:1}}),m.jsx("stop",{offset:"100%",style:{stopColor:"#e74c3c",stopOpacity:1}})]})}),m.jsx("circle",{cx:"25",cy:"25",r:"20",fill:"none",strokeWidth:"5",stroke:"url(#spinner-gradient)",strokeLinecap:"round",children:m.jsx("animateTransform",{attributeName:"transform",type:"rotate",dur:"1s",from:"0 25 25",to:"360 25 25",repeatCount:"indefinite"})})]})}function m6({label:e,tooltip:t,handleClick:n}){return m.jsx("button",{type:"button",title:t,className:"px-4 py-2 rounded-lg bg-gray-100 dark:bg-slate-800/50 backdrop-blur-md p-1.5 rounded-2xl shadow-lg border border-gray-300/60 dark:border-slate-700/50 text-sm text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200 transition-all duration-200",onClick:n,children:m.jsx("span",{className:"whitespace-nowrap",children:e})})}function y6({label:e,tooltip:t}){return m.jsx("a",{href:"https://github.com/Gudsfile/tracksy?tab=readme-ov-file#%EF%B8%8F-download-your-data",title:t,target:"_blank",rel:"noopener noreferrer",className:"px-4 py-2 rounded-lg bg-gray-100 dark:bg-slate-800/50 backdrop-blur-md p-1.5 rounded-2xl shadow-lg border border-gray-300/60 dark:border-slate-700/50 text-sm text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200 transition-all duration-200",children:m.jsx("span",{className:"whitespace-nowrap",children:e})})}async function g6(e){const{conn:t}=await Qa();await t.query(U_),await t.insertJSONFromPath(e.toString(),{name:q})}function b6(){const[e,t]=P.useState(!1),n=(()=>{const i="https://huggingface.co/datasets/tracksy/synthetic-datasets/resolve/main/datasets/spotify/streamings_25000.json";try{return new URL(i)}catch{console.warn("Invalid PUBLIC_DEMO_JSON_URL environment variable:",{url:i});return}})();return{isDemoReady:e,handleDemoButtonClick:async()=>{if(t(!1),!!n)try{await g6(n),t(!0)}catch{t(!1)}},demoJsonUrl:n}}function _6(e){return`
    WITH all_months AS (
      SELECT LAST_DAY(month) as ts
      FROM generate_series(
        CAST('${e||"2006"}-01-01' AS DATE),
        CAST('${e||new Date().getFullYear()}-12-01' AS DATE),
        INTERVAL 1 MONTH
      ) AS t(month)
    ),
    monthly_streams AS (
      SELECT
        LAST_DAY(ts::DATE) as ts,
        SUM(ms_played) as ms_played,
        COUNT(*) as count_streams
      FROM ${q}
      ${e?`WHERE YEAR(ts::DATE) = ${e}`:""}
      GROUP BY LAST_DAY(ts::DATE)
    )
    SELECT
      MAKE_DATE(YEAR(all_months.ts), MONTH(all_months.ts), 1) as ts,
      COALESCE(monthly_streams.ms_played, 0) as ms_played,
      COALESCE(monthly_streams.count_streams, 0)::INT as count_streams
    FROM all_months
    LEFT JOIN monthly_streams ON all_months.ts = monthly_streams.ts
    ORDER BY all_months.ts`}function w6(e){return _6(e)}function Ae(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function Ja(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function $l(e){let t,n,r;e.length!==2?(t=Ae,n=(o,c)=>Ae(e(o),c),r=(o,c)=>e(o)-c):(t=e===Ae||e===Ja?e:v6,n=e,r=e);function i(o,c,l=0,u=o.length){if(l<u){if(t(c,c)!==0)return u;do{const f=l+u>>>1;n(o[f],c)<0?l=f+1:u=f}while(l<u)}return l}function s(o,c,l=0,u=o.length){if(l<u){if(t(c,c)!==0)return u;do{const f=l+u>>>1;n(o[f],c)<=0?l=f+1:u=f}while(l<u)}return l}function a(o,c,l=0,u=o.length){const f=i(o,c,l,u-1);return f>l&&r(o[f-1],c)>-r(o[f],c)?f-1:f}return{left:i,center:a,right:s}}function v6(){return 0}function P_(e){return e===null?NaN:+e}function*x6(e,t){if(t===void 0)for(let n of e)n!=null&&(n=+n)>=n&&(yield n);else{let n=-1;for(let r of e)(r=t(r,++n,e))!=null&&(r=+r)>=r&&(yield r)}}const S6=$l(Ae),Ul=S6.right;$l(P_).center;function Lh(e,t){let n=0;for(let r of e)r!=null&&(r=+r)>=r&&++n;return n}function E6(e){return e.length|0}function T6(e){return!(e>0)}function A6(e){return typeof e!="object"||"length"in e?e:Array.from(e)}function I6(e){return t=>e(...t)}function N6(...e){const t=typeof e[e.length-1]=="function"&&I6(e.pop());e=e.map(A6);const n=e.map(E6),r=e.length-1,i=new Array(r+1).fill(0),s=[];if(r<0||n.some(T6))return s;for(;;){s.push(i.map((o,c)=>e[c][o]));let a=r;for(;++i[a]===n[a];){if(a===0)return t?s.map(t):s;i[a--]=0}}}function M6(e,t){var n=0;return Float64Array.from(e,r=>n+=+r||0)}function j_(e,t){let n=0,r,i=0,s=0;if(t===void 0)for(let a of e)a!=null&&(a=+a)>=a&&(r=a-i,i+=r/++n,s+=r*(a-i));else{let a=-1;for(let o of e)(o=t(o,++a,e))!=null&&(o=+o)>=o&&(r=o-i,i+=r/++n,s+=r*(o-i))}if(n>1)return s/(n-1)}function V_(e,t){const n=j_(e,t);return n&&Math.sqrt(n)}function $e(e,t){let n,r;if(t===void 0)for(const i of e)i!=null&&(n===void 0?i>=i&&(n=r=i):(n>i&&(n=i),r<i&&(r=i)));else{let i=-1;for(let s of e)(s=t(s,++i,e))!=null&&(n===void 0?s>=s&&(n=r=s):(n>s&&(n=s),r<s&&(r=s)))}return[n,r]}class pi{constructor(){this._partials=new Float64Array(32),this._n=0}add(t){const n=this._partials;let r=0;for(let i=0;i<this._n&&i<32;i++){const s=n[i],a=t+s,o=Math.abs(t)<Math.abs(s)?t-(a-s):s-(a-t);o&&(n[r++]=o),t=a}return n[r]=t,this._n=r+1,this}valueOf(){const t=this._partials;let n=this._n,r,i,s,a=0;if(n>0){for(a=t[--n];n>0&&(r=a,i=t[--n],a=r+i,s=i-(a-r),!s););n>0&&(s<0&&t[n-1]<0||s>0&&t[n-1]>0)&&(i=s*2,r=a+i,i==r-a&&(a=r))}return a}}class mi extends Map{constructor(t,n=W_){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:n}}),t!=null)for(const[r,i]of t)this.set(r,i)}get(t){return super.get(Yf(this,t))}has(t){return super.has(Yf(this,t))}set(t,n){return super.set(z_(this,t),n)}delete(t){return super.delete(Y_(this,t))}}class Pl extends Set{constructor(t,n=W_){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:n}}),t!=null)for(const r of t)this.add(r)}has(t){return super.has(Yf(this,t))}add(t){return super.add(z_(this,t))}delete(t){return super.delete(Y_(this,t))}}function Yf({_intern:e,_key:t},n){const r=t(n);return e.has(r)?e.get(r):n}function z_({_intern:e,_key:t},n){const r=t(n);return e.has(r)?e.get(r):(e.set(r,n),n)}function Y_({_intern:e,_key:t},n){const r=t(n);return e.has(r)&&(n=e.get(r),e.delete(r)),n}function W_(e){return e!==null&&typeof e=="object"?e.valueOf():e}function Wf(e){return e}function jl(e,...t){return Fh(e,Wf,Wf,t)}function rs(e,t,...n){return Fh(e,Wf,t,n)}function O6(e,t,...n){return Fh(e,Array.from,t,n)}function Fh(e,t,n,r){return(function i(s,a){if(a>=r.length)return n(s);const o=new mi,c=r[a++];let l=-1;for(const u of s){const f=c(u,++l,s),d=o.get(f);d?d.push(u):o.set(f,[u])}for(const[u,f]of o)o.set(u,i(f,a));return t(o)})(e,0)}function R6(e,t){return Array.from(t,n=>e[n])}function zc(e,...t){if(typeof e[Symbol.iterator]!="function")throw new TypeError("values is not iterable");e=Array.from(e);let[n]=t;if(n&&n.length!==2||t.length>1){const r=Uint32Array.from(e,(i,s)=>s);return t.length>1?(t=t.map(i=>e.map(i)),r.sort((i,s)=>{for(const a of t){const o=Yc(a[i],a[s]);if(o)return o}})):(n=e.map(n),r.sort((i,s)=>Yc(n[i],n[s]))),R6(e,r)}return e.sort(H_(n))}function H_(e=Ae){if(e===Ae)return Yc;if(typeof e!="function")throw new TypeError("compare is not a function");return(t,n)=>{const r=e(t,n);return r||r===0?r:(e(n,n)===0)-(e(t,t)===0)}}function Yc(e,t){return(e==null||!(e>=e))-(t==null||!(t>=t))||(e<t?-1:e>t?1:0)}function kh(e,t,n){return(t.length!==2?zc(rs(e,t,n),(([r,i],[s,a])=>Ae(i,a)||Ae(r,s))):zc(jl(e,n),(([r,i],[s,a])=>t(i,a)||Ae(r,s)))).map(([r])=>r)}const D6=Math.sqrt(50),L6=Math.sqrt(10),F6=Math.sqrt(2);function Wc(e,t,n){const r=(t-e)/Math.max(0,n),i=Math.floor(Math.log10(r)),s=r/Math.pow(10,i),a=s>=D6?10:s>=L6?5:s>=F6?2:1;let o,c,l;return i<0?(l=Math.pow(10,-i)/a,o=Math.round(e*l),c=Math.round(t*l),o/l<e&&++o,c/l>t&&--c,l=-l):(l=Math.pow(10,i)*a,o=Math.round(e/l),c=Math.round(t/l),o*l<e&&++o,c*l>t&&--c),c<o&&.5<=n&&n<2?Wc(e,t,n*2):[o,c,l]}function Na(e,t,n){if(t=+t,e=+e,n=+n,!(n>0))return[];if(e===t)return[e];const r=t<e,[i,s,a]=r?Wc(t,e,n):Wc(e,t,n);if(!(s>=i))return[];const o=s-i+1,c=new Array(o);if(r)if(a<0)for(let l=0;l<o;++l)c[l]=(s-l)/-a;else for(let l=0;l<o;++l)c[l]=(s-l)*a;else if(a<0)for(let l=0;l<o;++l)c[l]=(i+l)/-a;else for(let l=0;l<o;++l)c[l]=(i+l)*a;return c}function Hc(e,t,n){return t=+t,e=+e,n=+n,Wc(e,t,n)[2]}function Hf(e,t,n){t=+t,e=+e,n=+n;const r=t<e,i=r?Hc(t,e,n):Hc(e,t,n);return(r?-1:1)*(i<0?1/-i:i)}function k6(e){return Math.max(1,Math.ceil(Math.log(Lh(e))/Math.LN2)+1)}function je(e,t){let n;if(t===void 0)for(const r of e)r!=null&&(n<r||n===void 0&&r>=r)&&(n=r);else{let r=-1;for(let i of e)(i=t(i,++r,e))!=null&&(n<i||n===void 0&&i>=i)&&(n=i)}return n}function C6(e,t){let n,r=-1,i=-1;if(t===void 0)for(const s of e)++i,s!=null&&(n<s||n===void 0&&s>=s)&&(n=s,r=i);else for(let s of e)(s=t(s,++i,e))!=null&&(n<s||n===void 0&&s>=s)&&(n=s,r=i);return r}function fr(e,t){let n;if(t===void 0)for(const r of e)r!=null&&(n>r||n===void 0&&r>=r)&&(n=r);else{let r=-1;for(let i of e)(i=t(i,++r,e))!=null&&(n>i||n===void 0&&i>=i)&&(n=i)}return n}function B6(e,t){let n,r=-1,i=-1;if(t===void 0)for(const s of e)++i,s!=null&&(n>s||n===void 0&&s>=s)&&(n=s,r=i);else for(let s of e)(s=t(s,++i,e))!=null&&(n>s||n===void 0&&s>=s)&&(n=s,r=i);return r}function q_(e,t,n=0,r=1/0,i){if(t=Math.floor(t),n=Math.floor(Math.max(0,n)),r=Math.floor(Math.min(e.length-1,r)),!(n<=t&&t<=r))return e;for(i=i===void 0?Yc:H_(i);r>n;){if(r-n>600){const c=r-n+1,l=t-n+1,u=Math.log(c),f=.5*Math.exp(2*u/3),d=.5*Math.sqrt(u*f*(c-f)/c)*(l-c/2<0?-1:1),h=Math.max(n,Math.floor(t-l*f/c+d)),p=Math.min(r,Math.floor(t+(c-l)*f/c+d));q_(e,t,h,p,i)}const s=e[t];let a=n,o=r;for(zs(e,n,t),i(e[r],s)>0&&zs(e,n,r);a<o;){for(zs(e,a,o),++a,--o;i(e[a],s)<0;)++a;for(;i(e[o],s)>0;)--o}i(e[n],s)===0?zs(e,n,o):(++o,zs(e,o,r)),o<=t&&(n=o+1),t<=o&&(r=o-1)}return e}function zs(e,t,n){const r=e[t];e[t]=e[n],e[n]=r}function G_(e,t=Ae){let n,r=!1;if(t.length===1){let i;for(const s of e){const a=t(s);(r?Ae(a,i)>0:Ae(a,a)===0)&&(n=s,i=a,r=!0)}}else for(const i of e)(r?t(i,n)>0:t(i,i)===0)&&(n=i,r=!0);return n}function hs(e,t,n){if(e=Float64Array.from(x6(e,n)),!(!(r=e.length)||isNaN(t=+t))){if(t<=0||r<2)return fr(e);if(t>=1)return je(e);var r,i=(r-1)*t,s=Math.floor(i),a=je(q_(e,s).subarray(0,s+1)),o=fr(e.subarray(s+1));return a+(o-a)*(i-s)}}function $6(e,t,n=P_){if(!(!(r=e.length)||isNaN(t=+t))){if(t<=0||r<2)return+n(e[0],0,e);if(t>=1)return+n(e[r-1],r-1,e);var r,i=(r-1)*t,s=Math.floor(i),a=+n(e[s],s,e),o=+n(e[s+1],s+1,e);return a+(o-a)*(i-s)}}function U6(e,t,n){const r=Lh(e),i=hs(e,.75)-hs(e,.25);return r&&i?Math.ceil((n-t)/(2*i*Math.pow(r,-1/3))):1}function X_(e,t,n){const r=Lh(e),i=V_(e);return r&&i?Math.ceil((n-t)*Math.cbrt(r)/(3.49*i)):1}function P6(e,t){let n=0,r=0;if(t===void 0)for(let i of e)i!=null&&(i=+i)>=i&&(++n,r+=i);else{let i=-1;for(let s of e)(s=t(s,++i,e))!=null&&(s=+s)>=s&&(++n,r+=s)}if(n)return r/n}function qf(e,t){return hs(e,.5,t)}function*j6(e){for(const t of e)yield*t}function K_(e){return Array.from(j6(e))}function V6(e,t){const n=new mi;if(t===void 0)for(let s of e)s!=null&&s>=s&&n.set(s,(n.get(s)||0)+1);else{let s=-1;for(let a of e)(a=t(a,++s,e))!=null&&a>=a&&n.set(a,(n.get(a)||0)+1)}let r,i=0;for(const[s,a]of n)a>i&&(i=a,r=s);return r}function z6(e,t=Y6){const n=[];let r,i=!1;for(const s of e)i&&n.push(t(r,s)),r=s,i=!0;return n}function Y6(e,t){return[e,t]}function Gf(e,t,n){e=+e,t=+t,n=(i=arguments.length)<2?(t=e,e=0,1):i<3?1:+n;for(var r=-1,i=Math.max(0,Math.ceil((t-e)/n))|0,s=new Array(i);++r<i;)s[r]=e+r*n;return s}function $r(e,t){let n=0;if(t===void 0)for(let r of e)(r=+r)&&(n+=r);else{let r=-1;for(let i of e)(i=+t(i,++r,e))&&(n+=i)}return n}function qc(e){if(typeof e[Symbol.iterator]!="function")throw new TypeError("values is not iterable");return Array.from(e).reverse()}function W6(e){return e}var H6=3,Up=1e-6;function q6(e){return"translate("+e+",0)"}function G6(e){return t=>+e(t)}function X6(e,t){return t=Math.max(0,e.bandwidth()-t*2)/2,e.round()&&(t=Math.round(t)),n=>+e(n)+t}function K6(){return!this.__axis}function Q6(e,t){var n=[],r=null,i=null,s=6,a=6,o=3,c=typeof window<"u"&&window.devicePixelRatio>1?0:.5,l=1,u="y",f=q6;function d(h){var p=r??(t.ticks?t.ticks.apply(t,n):t.domain()),y=i??(t.tickFormat?t.tickFormat.apply(t,n):W6),g=Math.max(s,0)+o,b=t.range(),_=+b[0]+c,E=+b[b.length-1]+c,w=(t.bandwidth?X6:G6)(t.copy(),c),A=h.selection?h.selection():h,x=A.selectAll(".domain").data([null]),T=A.selectAll(".tick").data(p,t).order(),M=T.exit(),R=T.enter().append("g").attr("class","tick"),F=T.select("line"),N=T.select("text");x=x.merge(x.enter().insert("path",".tick").attr("class","domain").attr("stroke","currentColor")),T=T.merge(R),F=F.merge(R.append("line").attr("stroke","currentColor").attr(u+"2",l*s)),N=N.merge(R.append("text").attr("fill","currentColor").attr(u,l*g).attr("dy","0.71em")),h!==A&&(x=x.transition(h),T=T.transition(h),F=F.transition(h),N=N.transition(h),M=M.transition(h).attr("opacity",Up).attr("transform",function(B){return isFinite(B=w(B))?f(B+c):this.getAttribute("transform")}),R.attr("opacity",Up).attr("transform",function(B){var W=this.parentNode.__axis;return f((W&&isFinite(W=W(B))?W:w(B))+c)})),M.remove(),x.attr("d",a?"M"+_+","+l*a+"V"+c+"H"+E+"V"+l*a:"M"+_+","+c+"H"+E),T.attr("opacity",1).attr("transform",function(B){return f(w(B)+c)}),F.attr(u+"2",l*s),N.attr(u,l*g).text(y),A.filter(K6).attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor","middle"),A.each(function(){this.__axis=w})}return d.scale=function(h){return arguments.length?(t=h,d):t},d.ticks=function(){return n=Array.from(arguments),d},d.tickArguments=function(h){return arguments.length?(n=h==null?[]:Array.from(h),d):n.slice()},d.tickValues=function(h){return arguments.length?(r=h==null?null:Array.from(h),d):r&&r.slice()},d.tickFormat=function(h){return arguments.length?(i=h,d):i},d.tickSize=function(h){return arguments.length?(s=a=+h,d):s},d.tickSizeInner=function(h){return arguments.length?(s=+h,d):s},d.tickSizeOuter=function(h){return arguments.length?(a=+h,d):a},d.tickPadding=function(h){return arguments.length?(o=+h,d):o},d.offset=function(h){return arguments.length?(c=+h,d):c},d}function J6(e){return Q6(H6,e)}var Z6={value:()=>{}};function Q_(){for(var e=0,t=arguments.length,n={},r;e<t;++e){if(!(r=arguments[e]+"")||r in n||/[\s.]/.test(r))throw new Error("illegal type: "+r);n[r]=[]}return new uc(n)}function uc(e){this._=e}function t3(e,t){return e.trim().split(/^|\s+/).map(function(n){var r="",i=n.indexOf(".");if(i>=0&&(r=n.slice(i+1),n=n.slice(0,i)),n&&!t.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:r}})}uc.prototype=Q_.prototype={constructor:uc,on:function(e,t){var n=this._,r=t3(e+"",n),i,s=-1,a=r.length;if(arguments.length<2){for(;++s<a;)if((i=(e=r[s]).type)&&(i=e3(n[i],e.name)))return i;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++s<a;)if(i=(e=r[s]).type)n[i]=Pp(n[i],e.name,t);else if(t==null)for(i in n)n[i]=Pp(n[i],e.name,null);return this},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new uc(e)},call:function(e,t){if((i=arguments.length-2)>0)for(var n=new Array(i),r=0,i,s;r<i;++r)n[r]=arguments[r+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(s=this._[e],r=0,i=s.length;r<i;++r)s[r].value.apply(t,n)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var r=this._[e],i=0,s=r.length;i<s;++i)r[i].value.apply(t,n)}};function e3(e,t){for(var n=0,r=e.length,i;n<r;++n)if((i=e[n]).name===t)return i.value}function Pp(e,t,n){for(var r=0,i=e.length;r<i;++r)if(e[r].name===t){e[r]=Z6,e=e.slice(0,r).concat(e.slice(r+1));break}return n!=null&&e.push({name:t,value:n}),e}var Xf="http://www.w3.org/1999/xhtml";const Ur={svg:"http://www.w3.org/2000/svg",xhtml:Xf,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function Vl(e){var t=e+="",n=t.indexOf(":");return n>=0&&(t=e.slice(0,n))!=="xmlns"&&(e=e.slice(n+1)),Ur.hasOwnProperty(t)?{space:Ur[t],local:e}:e}function n3(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===Xf&&t.documentElement.namespaceURI===Xf?t.createElement(e):t.createElementNS(n,e)}}function r3(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function zl(e){var t=Vl(e);return(t.local?r3:n3)(t)}function i3(){}function Ch(e){return e==null?i3:function(){return this.querySelector(e)}}function s3(e){typeof e!="function"&&(e=Ch(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var s=t[i],a=s.length,o=r[i]=new Array(a),c,l,u=0;u<a;++u)(c=s[u])&&(l=e.call(c,c.__data__,u,s))&&("__data__"in c&&(l.__data__=c.__data__),o[u]=l);return new Ve(r,this._parents)}function a3(e){return e==null?[]:Array.isArray(e)?e:Array.from(e)}function o3(){return[]}function J_(e){return e==null?o3:function(){return this.querySelectorAll(e)}}function c3(e){return function(){return a3(e.apply(this,arguments))}}function l3(e){typeof e=="function"?e=c3(e):e=J_(e);for(var t=this._groups,n=t.length,r=[],i=[],s=0;s<n;++s)for(var a=t[s],o=a.length,c,l=0;l<o;++l)(c=a[l])&&(r.push(e.call(c,c.__data__,l,a)),i.push(c));return new Ve(r,i)}function Z_(e){return function(){return this.matches(e)}}function t1(e){return function(t){return t.matches(e)}}var u3=Array.prototype.find;function f3(e){return function(){return u3.call(this.children,e)}}function d3(){return this.firstElementChild}function h3(e){return this.select(e==null?d3:f3(typeof e=="function"?e:t1(e)))}var p3=Array.prototype.filter;function m3(){return Array.from(this.children)}function y3(e){return function(){return p3.call(this.children,e)}}function g3(e){return this.selectAll(e==null?m3:y3(typeof e=="function"?e:t1(e)))}function b3(e){typeof e!="function"&&(e=Z_(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var s=t[i],a=s.length,o=r[i]=[],c,l=0;l<a;++l)(c=s[l])&&e.call(c,c.__data__,l,s)&&o.push(c);return new Ve(r,this._parents)}function e1(e){return new Array(e.length)}function _3(){return new Ve(this._enter||this._groups.map(e1),this._parents)}function Gc(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}Gc.prototype={constructor:Gc,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function w3(e){return function(){return e}}function v3(e,t,n,r,i,s){for(var a=0,o,c=t.length,l=s.length;a<l;++a)(o=t[a])?(o.__data__=s[a],r[a]=o):n[a]=new Gc(e,s[a]);for(;a<c;++a)(o=t[a])&&(i[a]=o)}function x3(e,t,n,r,i,s,a){var o,c,l=new Map,u=t.length,f=s.length,d=new Array(u),h;for(o=0;o<u;++o)(c=t[o])&&(d[o]=h=a.call(c,c.__data__,o,t)+"",l.has(h)?i[o]=c:l.set(h,c));for(o=0;o<f;++o)h=a.call(e,s[o],o,s)+"",(c=l.get(h))?(r[o]=c,c.__data__=s[o],l.delete(h)):n[o]=new Gc(e,s[o]);for(o=0;o<u;++o)(c=t[o])&&l.get(d[o])===c&&(i[o]=c)}function S3(e){return e.__data__}function E3(e,t){if(!arguments.length)return Array.from(this,S3);var n=t?x3:v3,r=this._parents,i=this._groups;typeof e!="function"&&(e=w3(e));for(var s=i.length,a=new Array(s),o=new Array(s),c=new Array(s),l=0;l<s;++l){var u=r[l],f=i[l],d=f.length,h=T3(e.call(u,u&&u.__data__,l,r)),p=h.length,y=o[l]=new Array(p),g=a[l]=new Array(p),b=c[l]=new Array(d);n(u,f,y,g,b,h,t);for(var _=0,E=0,w,A;_<p;++_)if(w=y[_]){for(_>=E&&(E=_+1);!(A=g[E])&&++E<p;);w._next=A||null}}return a=new Ve(a,r),a._enter=o,a._exit=c,a}function T3(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function A3(){return new Ve(this._exit||this._groups.map(e1),this._parents)}function I3(e,t,n){var r=this.enter(),i=this,s=this.exit();return typeof e=="function"?(r=e(r),r&&(r=r.selection())):r=r.append(e+""),t!=null&&(i=t(i),i&&(i=i.selection())),n==null?s.remove():n(s),r&&i?r.merge(i).order():i}function N3(e){for(var t=e.selection?e.selection():e,n=this._groups,r=t._groups,i=n.length,s=r.length,a=Math.min(i,s),o=new Array(i),c=0;c<a;++c)for(var l=n[c],u=r[c],f=l.length,d=o[c]=new Array(f),h,p=0;p<f;++p)(h=l[p]||u[p])&&(d[p]=h);for(;c<i;++c)o[c]=n[c];return new Ve(o,this._parents)}function M3(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var r=e[t],i=r.length-1,s=r[i],a;--i>=0;)(a=r[i])&&(s&&a.compareDocumentPosition(s)^4&&s.parentNode.insertBefore(a,s),s=a);return this}function O3(e){e||(e=R3);function t(f,d){return f&&d?e(f.__data__,d.__data__):!f-!d}for(var n=this._groups,r=n.length,i=new Array(r),s=0;s<r;++s){for(var a=n[s],o=a.length,c=i[s]=new Array(o),l,u=0;u<o;++u)(l=a[u])&&(c[u]=l);c.sort(t)}return new Ve(i,this._parents).order()}function R3(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function D3(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function L3(){return Array.from(this)}function F3(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],i=0,s=r.length;i<s;++i){var a=r[i];if(a)return a}return null}function k3(){let e=0;for(const t of this)++e;return e}function C3(){return!this.node()}function B3(e){for(var t=this._groups,n=0,r=t.length;n<r;++n)for(var i=t[n],s=0,a=i.length,o;s<a;++s)(o=i[s])&&e.call(o,o.__data__,s,i);return this}function $3(e){return function(){this.removeAttribute(e)}}function U3(e){return function(){this.removeAttributeNS(e.space,e.local)}}function P3(e,t){return function(){this.setAttribute(e,t)}}function j3(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function V3(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttribute(e):this.setAttribute(e,n)}}function z3(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}function Y3(e,t){var n=Vl(e);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((t==null?n.local?U3:$3:typeof t=="function"?n.local?z3:V3:n.local?j3:P3)(n,t))}function n1(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function W3(e){return function(){this.style.removeProperty(e)}}function H3(e,t,n){return function(){this.style.setProperty(e,t,n)}}function q3(e,t,n){return function(){var r=t.apply(this,arguments);r==null?this.style.removeProperty(e):this.style.setProperty(e,r,n)}}function G3(e,t,n){return arguments.length>1?this.each((t==null?W3:typeof t=="function"?q3:H3)(e,t,n??"")):ps(this.node(),e)}function ps(e,t){return e.style.getPropertyValue(t)||n1(e).getComputedStyle(e,null).getPropertyValue(t)}function X3(e){return function(){delete this[e]}}function K3(e,t){return function(){this[e]=t}}function Q3(e,t){return function(){var n=t.apply(this,arguments);n==null?delete this[e]:this[e]=n}}function J3(e,t){return arguments.length>1?this.each((t==null?X3:typeof t=="function"?Q3:K3)(e,t)):this.node()[e]}function r1(e){return e.trim().split(/^|\s+/)}function Bh(e){return e.classList||new i1(e)}function i1(e){this._node=e,this._names=r1(e.getAttribute("class")||"")}i1.prototype={add:function(e){var t=this._names.indexOf(e);t<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function s1(e,t){for(var n=Bh(e),r=-1,i=t.length;++r<i;)n.add(t[r])}function a1(e,t){for(var n=Bh(e),r=-1,i=t.length;++r<i;)n.remove(t[r])}function Z3(e){return function(){s1(this,e)}}function tN(e){return function(){a1(this,e)}}function eN(e,t){return function(){(t.apply(this,arguments)?s1:a1)(this,e)}}function nN(e,t){var n=r1(e+"");if(arguments.length<2){for(var r=Bh(this.node()),i=-1,s=n.length;++i<s;)if(!r.contains(n[i]))return!1;return!0}return this.each((typeof t=="function"?eN:t?Z3:tN)(n,t))}function rN(){this.textContent=""}function iN(e){return function(){this.textContent=e}}function sN(e){return function(){var t=e.apply(this,arguments);this.textContent=t??""}}function aN(e){return arguments.length?this.each(e==null?rN:(typeof e=="function"?sN:iN)(e)):this.node().textContent}function oN(){this.innerHTML=""}function cN(e){return function(){this.innerHTML=e}}function lN(e){return function(){var t=e.apply(this,arguments);this.innerHTML=t??""}}function uN(e){return arguments.length?this.each(e==null?oN:(typeof e=="function"?lN:cN)(e)):this.node().innerHTML}function fN(){this.nextSibling&&this.parentNode.appendChild(this)}function dN(){return this.each(fN)}function hN(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function pN(){return this.each(hN)}function mN(e){var t=typeof e=="function"?e:zl(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function yN(){return null}function gN(e,t){var n=typeof e=="function"?e:zl(e),r=t==null?yN:typeof t=="function"?t:Ch(t);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})}function bN(){var e=this.parentNode;e&&e.removeChild(this)}function _N(){return this.each(bN)}function wN(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function vN(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function xN(e){return this.select(e?vN:wN)}function SN(e){return arguments.length?this.property("__data__",e):this.node().__data__}function EN(e){return function(t){e.call(this,t,this.__data__)}}function TN(e){return e.trim().split(/^|\s+/).map(function(t){var n="",r=t.indexOf(".");return r>=0&&(n=t.slice(r+1),t=t.slice(0,r)),{type:t,name:n}})}function AN(e){return function(){var t=this.__on;if(t){for(var n=0,r=-1,i=t.length,s;n<i;++n)s=t[n],(!e.type||s.type===e.type)&&s.name===e.name?this.removeEventListener(s.type,s.listener,s.options):t[++r]=s;++r?t.length=r:delete this.__on}}}function IN(e,t,n){return function(){var r=this.__on,i,s=EN(t);if(r){for(var a=0,o=r.length;a<o;++a)if((i=r[a]).type===e.type&&i.name===e.name){this.removeEventListener(i.type,i.listener,i.options),this.addEventListener(i.type,i.listener=s,i.options=n),i.value=t;return}}this.addEventListener(e.type,s,n),i={type:e.type,name:e.name,value:t,listener:s,options:n},r?r.push(i):this.__on=[i]}}function NN(e,t,n){var r=TN(e+""),i,s=r.length,a;if(arguments.length<2){var o=this.node().__on;if(o){for(var c=0,l=o.length,u;c<l;++c)for(i=0,u=o[c];i<s;++i)if((a=r[i]).type===u.type&&a.name===u.name)return u.value}return}for(o=t?IN:AN,i=0;i<s;++i)this.each(o(r[i],t,n));return this}function o1(e,t,n){var r=n1(e),i=r.CustomEvent;typeof i=="function"?i=new i(t,n):(i=r.document.createEvent("Event"),n?(i.initEvent(t,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(t,!1,!1)),e.dispatchEvent(i)}function MN(e,t){return function(){return o1(this,e,t)}}function ON(e,t){return function(){return o1(this,e,t.apply(this,arguments))}}function RN(e,t){return this.each((typeof t=="function"?ON:MN)(e,t))}function*DN(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],i=0,s=r.length,a;i<s;++i)(a=r[i])&&(yield a)}var c1=[null];function Ve(e,t){this._groups=e,this._parents=t}function Za(){return new Ve([[document.documentElement]],c1)}function LN(){return this}Ve.prototype=Za.prototype={constructor:Ve,select:s3,selectAll:l3,selectChild:h3,selectChildren:g3,filter:b3,data:E3,enter:_3,exit:A3,join:I3,merge:N3,selection:LN,order:M3,sort:O3,call:D3,nodes:L3,node:F3,size:k3,empty:C3,each:B3,attr:Y3,style:G3,property:J3,classed:nN,text:aN,html:uN,raise:dN,lower:pN,append:mN,insert:gN,remove:_N,clone:xN,datum:SN,on:NN,dispatch:RN,[Symbol.iterator]:DN};function oi(e){return typeof e=="string"?new Ve([[document.querySelector(e)]],[document.documentElement]):new Ve([[e]],c1)}function FN(e){let t;for(;t=e.sourceEvent;)e=t;return e}function kN(e,t){if(e=FN(e),t===void 0&&(t=e.currentTarget),t){var n=t.ownerSVGElement||t;if(n.createSVGPoint){var r=n.createSVGPoint();return r.x=e.clientX,r.y=e.clientY,r=r.matrixTransform(t.getScreenCTM().inverse()),[r.x,r.y]}if(t.getBoundingClientRect){var i=t.getBoundingClientRect();return[e.clientX-i.left-t.clientLeft,e.clientY-i.top-t.clientTop]}}return[e.pageX,e.pageY]}function Fs(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function to(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function Hr(){}var yi=.7,ms=1/yi,is="\\s*([+-]?\\d+)\\s*",Ma="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Fn="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",CN=/^#([0-9a-f]{3,8})$/,BN=new RegExp(`^rgb\\(${is},${is},${is}\\)$`),$N=new RegExp(`^rgb\\(${Fn},${Fn},${Fn}\\)$`),UN=new RegExp(`^rgba\\(${is},${is},${is},${Ma}\\)$`),PN=new RegExp(`^rgba\\(${Fn},${Fn},${Fn},${Ma}\\)$`),jN=new RegExp(`^hsl\\(${Ma},${Fn},${Fn}\\)$`),VN=new RegExp(`^hsla\\(${Ma},${Fn},${Fn},${Ma}\\)$`),jp={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Fs(Hr,gi,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:Vp,formatHex:Vp,formatHex8:zN,formatHsl:YN,formatRgb:zp,toString:zp});function Vp(){return this.rgb().formatHex()}function zN(){return this.rgb().formatHex8()}function YN(){return l1(this).formatHsl()}function zp(){return this.rgb().formatRgb()}function gi(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=CN.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?Yp(t):n===3?new re(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?Oo(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?Oo(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=BN.exec(e))?new re(t[1],t[2],t[3],1):(t=$N.exec(e))?new re(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=UN.exec(e))?Oo(t[1],t[2],t[3],t[4]):(t=PN.exec(e))?Oo(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=jN.exec(e))?qp(t[1],t[2]/100,t[3]/100,1):(t=VN.exec(e))?qp(t[1],t[2]/100,t[3]/100,t[4]):jp.hasOwnProperty(e)?Yp(jp[e]):e==="transparent"?new re(NaN,NaN,NaN,0):null}function Yp(e){return new re(e>>16&255,e>>8&255,e&255,1)}function Oo(e,t,n,r){return r<=0&&(e=t=n=NaN),new re(e,t,n,r)}function $h(e){return e instanceof Hr||(e=gi(e)),e?(e=e.rgb(),new re(e.r,e.g,e.b,e.opacity)):new re}function Pr(e,t,n,r){return arguments.length===1?$h(e):new re(e,t,n,r??1)}function re(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}Fs(re,Pr,to(Hr,{brighter(e){return e=e==null?ms:Math.pow(ms,e),new re(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?yi:Math.pow(yi,e),new re(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new re(ci(this.r),ci(this.g),ci(this.b),Xc(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Wp,formatHex:Wp,formatHex8:WN,formatRgb:Hp,toString:Hp}));function Wp(){return`#${si(this.r)}${si(this.g)}${si(this.b)}`}function WN(){return`#${si(this.r)}${si(this.g)}${si(this.b)}${si((isNaN(this.opacity)?1:this.opacity)*255)}`}function Hp(){const e=Xc(this.opacity);return`${e===1?"rgb(":"rgba("}${ci(this.r)}, ${ci(this.g)}, ${ci(this.b)}${e===1?")":`, ${e})`}`}function Xc(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function ci(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function si(e){return e=ci(e),(e<16?"0":"")+e.toString(16)}function qp(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new cn(e,t,n,r)}function l1(e){if(e instanceof cn)return new cn(e.h,e.s,e.l,e.opacity);if(e instanceof Hr||(e=gi(e)),!e)return new cn;if(e instanceof cn)return e;e=e.rgb();var t=e.r/255,n=e.g/255,r=e.b/255,i=Math.min(t,n,r),s=Math.max(t,n,r),a=NaN,o=s-i,c=(s+i)/2;return o?(t===s?a=(n-r)/o+(n<r)*6:n===s?a=(r-t)/o+2:a=(t-n)/o+4,o/=c<.5?s+i:2-s-i,a*=60):o=c>0&&c<1?0:a,new cn(a,o,c,e.opacity)}function Kf(e,t,n,r){return arguments.length===1?l1(e):new cn(e,t,n,r??1)}function cn(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}Fs(cn,Kf,to(Hr,{brighter(e){return e=e==null?ms:Math.pow(ms,e),new cn(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?yi:Math.pow(yi,e),new cn(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,i=2*n-r;return new re(Vu(e>=240?e-240:e+120,i,r),Vu(e,i,r),Vu(e<120?e+240:e-120,i,r),this.opacity)},clamp(){return new cn(Gp(this.h),Ro(this.s),Ro(this.l),Xc(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=Xc(this.opacity);return`${e===1?"hsl(":"hsla("}${Gp(this.h)}, ${Ro(this.s)*100}%, ${Ro(this.l)*100}%${e===1?")":`, ${e})`}`}}));function Gp(e){return e=(e||0)%360,e<0?e+360:e}function Ro(e){return Math.max(0,Math.min(1,e||0))}function Vu(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}const u1=Math.PI/180,f1=180/Math.PI,Kc=18,d1=.96422,h1=1,p1=.82521,m1=4/29,ss=6/29,y1=3*ss*ss,HN=ss*ss*ss;function g1(e){if(e instanceof kn)return new kn(e.l,e.a,e.b,e.opacity);if(e instanceof ir)return b1(e);e instanceof re||(e=$h(e));var t=Hu(e.r),n=Hu(e.g),r=Hu(e.b),i=zu((.2225045*t+.7168786*n+.0606169*r)/h1),s,a;return t===n&&n===r?s=a=i:(s=zu((.4360747*t+.3850649*n+.1430804*r)/d1),a=zu((.0139322*t+.0971045*n+.7141733*r)/p1)),new kn(116*i-16,500*(s-i),200*(i-a),e.opacity)}function Qf(e,t,n,r){return arguments.length===1?g1(e):new kn(e,t,n,r??1)}function kn(e,t,n,r){this.l=+e,this.a=+t,this.b=+n,this.opacity=+r}Fs(kn,Qf,to(Hr,{brighter(e){return new kn(this.l+Kc*(e??1),this.a,this.b,this.opacity)},darker(e){return new kn(this.l-Kc*(e??1),this.a,this.b,this.opacity)},rgb(){var e=(this.l+16)/116,t=isNaN(this.a)?e:e+this.a/500,n=isNaN(this.b)?e:e-this.b/200;return t=d1*Yu(t),e=h1*Yu(e),n=p1*Yu(n),new re(Wu(3.1338561*t-1.6168667*e-.4906146*n),Wu(-.9787684*t+1.9161415*e+.033454*n),Wu(.0719453*t-.2289914*e+1.4052427*n),this.opacity)}}));function zu(e){return e>HN?Math.pow(e,1/3):e/y1+m1}function Yu(e){return e>ss?e*e*e:y1*(e-m1)}function Wu(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function Hu(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function qN(e){if(e instanceof ir)return new ir(e.h,e.c,e.l,e.opacity);if(e instanceof kn||(e=g1(e)),e.a===0&&e.b===0)return new ir(NaN,0<e.l&&e.l<100?0:NaN,e.l,e.opacity);var t=Math.atan2(e.b,e.a)*f1;return new ir(t<0?t+360:t,Math.sqrt(e.a*e.a+e.b*e.b),e.l,e.opacity)}function Jf(e,t,n,r){return arguments.length===1?qN(e):new ir(e,t,n,r??1)}function ir(e,t,n,r){this.h=+e,this.c=+t,this.l=+n,this.opacity=+r}function b1(e){if(isNaN(e.h))return new kn(e.l,0,0,e.opacity);var t=e.h*u1;return new kn(e.l,Math.cos(t)*e.c,Math.sin(t)*e.c,e.opacity)}Fs(ir,Jf,to(Hr,{brighter(e){return new ir(this.h,this.c,this.l+Kc*(e??1),this.opacity)},darker(e){return new ir(this.h,this.c,this.l-Kc*(e??1),this.opacity)},rgb(){return b1(this).rgb()}}));var _1=-.14861,Uh=1.78277,Ph=-.29227,Yl=-.90649,Oa=1.97294,Xp=Oa*Yl,Kp=Oa*Uh,Qp=Uh*Ph-Yl*_1;function GN(e){if(e instanceof li)return new li(e.h,e.s,e.l,e.opacity);e instanceof re||(e=$h(e));var t=e.r/255,n=e.g/255,r=e.b/255,i=(Qp*r+Xp*t-Kp*n)/(Qp+Xp-Kp),s=r-i,a=(Oa*(n-i)-Ph*s)/Yl,o=Math.sqrt(a*a+s*s)/(Oa*i*(1-i)),c=o?Math.atan2(a,s)*f1-120:NaN;return new li(c<0?c+360:c,o,i,e.opacity)}function Un(e,t,n,r){return arguments.length===1?GN(e):new li(e,t,n,r??1)}function li(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}Fs(li,Un,to(Hr,{brighter(e){return e=e==null?ms:Math.pow(ms,e),new li(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?yi:Math.pow(yi,e),new li(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=isNaN(this.h)?0:(this.h+120)*u1,t=+this.l,n=isNaN(this.s)?0:this.s*t*(1-t),r=Math.cos(e),i=Math.sin(e);return new re(255*(t+n*(_1*r+Uh*i)),255*(t+n*(Ph*r+Yl*i)),255*(t+n*(Oa*r)),this.opacity)}}));function XN(e,t,n,r,i){var s=e*e,a=s*e;return((1-3*e+3*s-a)*t+(4-6*s+3*a)*n+(1+3*e+3*s-3*a)*r+a*i)/6}function KN(e){var t=e.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,t-1):Math.floor(n*t),i=e[r],s=e[r+1],a=r>0?e[r-1]:2*i-s,o=r<t-1?e[r+2]:2*s-i;return XN((n-r/t)*t,a,i,s,o)}}const Wl=e=>()=>e;function w1(e,t){return function(n){return e+n*t}}function QN(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}function jh(e,t){var n=t-e;return n?w1(e,n>180||n<-180?n-360*Math.round(n/360):n):Wl(isNaN(e)?t:e)}function JN(e){return(e=+e)==1?he:function(t,n){return n-t?QN(t,n,e):Wl(isNaN(t)?n:t)}}function he(e,t){var n=t-e;return n?w1(e,n):Wl(isNaN(e)?t:e)}const bi=(function e(t){var n=JN(t);function r(i,s){var a=n((i=Pr(i)).r,(s=Pr(s)).r),o=n(i.g,s.g),c=n(i.b,s.b),l=he(i.opacity,s.opacity);return function(u){return i.r=a(u),i.g=o(u),i.b=c(u),i.opacity=l(u),i+""}}return r.gamma=e,r})(1);function ZN(e){return function(t){var n=t.length,r=new Array(n),i=new Array(n),s=new Array(n),a,o;for(a=0;a<n;++a)o=Pr(t[a]),r[a]=o.r||0,i[a]=o.g||0,s[a]=o.b||0;return r=e(r),i=e(i),s=e(s),o.opacity=1,function(c){return o.r=r(c),o.g=i(c),o.b=s(c),o+""}}}var tM=ZN(KN);function eM(e,t){t||(t=[]);var n=e?Math.min(t.length,e.length):0,r=t.slice(),i;return function(s){for(i=0;i<n;++i)r[i]=e[i]*(1-s)+t[i]*s;return r}}function nM(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function rM(e,t){var n=t?t.length:0,r=e?Math.min(n,e.length):0,i=new Array(r),s=new Array(n),a;for(a=0;a<r;++a)i[a]=eo(e[a],t[a]);for(;a<n;++a)s[a]=t[a];return function(o){for(a=0;a<r;++a)s[a]=i[a](o);return s}}function iM(e,t){var n=new Date;return e=+e,t=+t,function(r){return n.setTime(e*(1-r)+t*r),n}}function fe(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}function sM(e,t){var n={},r={},i;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(i in t)i in e?n[i]=eo(e[i],t[i]):r[i]=t[i];return function(s){for(i in n)r[i]=n[i](s);return r}}var Zf=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,qu=new RegExp(Zf.source,"g");function aM(e){return function(){return e}}function oM(e){return function(t){return e(t)+""}}function v1(e,t){var n=Zf.lastIndex=qu.lastIndex=0,r,i,s,a=-1,o=[],c=[];for(e=e+"",t=t+"";(r=Zf.exec(e))&&(i=qu.exec(t));)(s=i.index)>n&&(s=t.slice(n,s),o[a]?o[a]+=s:o[++a]=s),(r=r[0])===(i=i[0])?o[a]?o[a]+=i:o[++a]=i:(o[++a]=null,c.push({i:a,x:fe(r,i)})),n=qu.lastIndex;return n<t.length&&(s=t.slice(n),o[a]?o[a]+=s:o[++a]=s),o.length<2?c[0]?oM(c[0].x):aM(t):(t=c.length,function(l){for(var u=0,f;u<t;++u)o[(f=c[u]).i]=f.x(l);return o.join("")})}function eo(e,t){var n=typeof t,r;return t==null||n==="boolean"?Wl(t):(n==="number"?fe:n==="string"?(r=gi(t))?(t=r,bi):v1:t instanceof gi?bi:t instanceof Date?iM:nM(t)?eM:Array.isArray(t)?rM:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?sM:fe)(e,t)}function Vh(e,t){return e=+e,t=+t,function(n){return Math.round(e*(1-n)+t*n)}}var Jp=180/Math.PI,td={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function x1(e,t,n,r,i,s){var a,o,c;return(a=Math.sqrt(e*e+t*t))&&(e/=a,t/=a),(c=e*n+t*r)&&(n-=e*c,r-=t*c),(o=Math.sqrt(n*n+r*r))&&(n/=o,r/=o,c/=o),e*r<t*n&&(e=-e,t=-t,c=-c,a=-a),{translateX:i,translateY:s,rotate:Math.atan2(t,e)*Jp,skewX:Math.atan(c)*Jp,scaleX:a,scaleY:o}}var Do;function cM(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?td:x1(t.a,t.b,t.c,t.d,t.e,t.f)}function lM(e){return e==null||(Do||(Do=document.createElementNS("http://www.w3.org/2000/svg","g")),Do.setAttribute("transform",e),!(e=Do.transform.baseVal.consolidate()))?td:(e=e.matrix,x1(e.a,e.b,e.c,e.d,e.e,e.f))}function S1(e,t,n,r){function i(l){return l.length?l.pop()+" ":""}function s(l,u,f,d,h,p){if(l!==f||u!==d){var y=h.push("translate(",null,t,null,n);p.push({i:y-4,x:fe(l,f)},{i:y-2,x:fe(u,d)})}else(f||d)&&h.push("translate("+f+t+d+n)}function a(l,u,f,d){l!==u?(l-u>180?u+=360:u-l>180&&(l+=360),d.push({i:f.push(i(f)+"rotate(",null,r)-2,x:fe(l,u)})):u&&f.push(i(f)+"rotate("+u+r)}function o(l,u,f,d){l!==u?d.push({i:f.push(i(f)+"skewX(",null,r)-2,x:fe(l,u)}):u&&f.push(i(f)+"skewX("+u+r)}function c(l,u,f,d,h,p){if(l!==f||u!==d){var y=h.push(i(h)+"scale(",null,",",null,")");p.push({i:y-4,x:fe(l,f)},{i:y-2,x:fe(u,d)})}else(f!==1||d!==1)&&h.push(i(h)+"scale("+f+","+d+")")}return function(l,u){var f=[],d=[];return l=e(l),u=e(u),s(l.translateX,l.translateY,u.translateX,u.translateY,f,d),a(l.rotate,u.rotate,f,d),o(l.skewX,u.skewX,f,d),c(l.scaleX,l.scaleY,u.scaleX,u.scaleY,f,d),l=u=null,function(h){for(var p=-1,y=d.length,g;++p<y;)f[(g=d[p]).i]=g.x(h);return f.join("")}}}var uM=S1(cM,"px, ","px)","deg)"),fM=S1(lM,", ",")",")");function dM(e){return function(t,n){var r=e((t=Kf(t)).h,(n=Kf(n)).h),i=he(t.s,n.s),s=he(t.l,n.l),a=he(t.opacity,n.opacity);return function(o){return t.h=r(o),t.s=i(o),t.l=s(o),t.opacity=a(o),t+""}}}const hM=dM(jh);function pM(e,t){var n=he((e=Qf(e)).l,(t=Qf(t)).l),r=he(e.a,t.a),i=he(e.b,t.b),s=he(e.opacity,t.opacity);return function(a){return e.l=n(a),e.a=r(a),e.b=i(a),e.opacity=s(a),e+""}}function mM(e){return function(t,n){var r=e((t=Jf(t)).h,(n=Jf(n)).h),i=he(t.c,n.c),s=he(t.l,n.l),a=he(t.opacity,n.opacity);return function(o){return t.h=r(o),t.c=i(o),t.l=s(o),t.opacity=a(o),t+""}}}const yM=mM(jh);function E1(e){return(function t(n){n=+n;function r(i,s){var a=e((i=Un(i)).h,(s=Un(s)).h),o=he(i.s,s.s),c=he(i.l,s.l),l=he(i.opacity,s.opacity);return function(u){return i.h=a(u),i.s=o(u),i.l=c(Math.pow(u,n)),i.opacity=l(u),i+""}}return r.gamma=t,r})(1)}E1(jh);var zh=E1(he);function Hl(e,t){t===void 0&&(t=e,e=eo);for(var n=0,r=t.length-1,i=t[0],s=new Array(r<0?0:r);n<r;)s[n]=e(i,i=t[++n]);return function(a){var o=Math.max(0,Math.min(r-1,Math.floor(a*=r)));return s[o](a-o)}}function fn(e,t){for(var n=new Array(t),r=0;r<t;++r)n[r]=e(r/(t-1));return n}var ys=0,ia=0,Ys=0,T1=1e3,Qc,sa,Jc=0,_i=0,ql=0,Ra=typeof performance=="object"&&performance.now?performance:Date,A1=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function Yh(){return _i||(A1(gM),_i=Ra.now()+ql)}function gM(){_i=0}function Zc(){this._call=this._time=this._next=null}Zc.prototype=I1.prototype={constructor:Zc,restart:function(e,t,n){if(typeof e!="function")throw new TypeError("callback is not a function");n=(n==null?Yh():+n)+(t==null?0:+t),!this._next&&sa!==this&&(sa?sa._next=this:Qc=this,sa=this),this._call=e,this._time=n,ed()},stop:function(){this._call&&(this._call=null,this._time=1/0,ed())}};function I1(e,t,n){var r=new Zc;return r.restart(e,t,n),r}function bM(){Yh(),++ys;for(var e=Qc,t;e;)(t=_i-e._time)>=0&&e._call.call(void 0,t),e=e._next;--ys}function Zp(){_i=(Jc=Ra.now())+ql,ys=ia=0;try{bM()}finally{ys=0,wM(),_i=0}}function _M(){var e=Ra.now(),t=e-Jc;t>T1&&(ql-=t,Jc=e)}function wM(){for(var e,t=Qc,n,r=1/0;t;)t._call?(r>t._time&&(r=t._time),e=t,t=t._next):(n=t._next,t._next=null,t=e?e._next=n:Qc=n);sa=e,ed(r)}function ed(e){if(!ys){ia&&(ia=clearTimeout(ia));var t=e-_i;t>24?(e<1/0&&(ia=setTimeout(Zp,e-Ra.now()-ql)),Ys&&(Ys=clearInterval(Ys))):(Ys||(Jc=Ra.now(),Ys=setInterval(_M,T1)),ys=1,A1(Zp))}}function tm(e,t,n){var r=new Zc;return t=t==null?0:+t,r.restart(i=>{r.stop(),e(i+t)},t,n),r}var vM=Q_("start","end","cancel","interrupt"),xM=[],N1=0,em=1,nd=2,fc=3,nm=4,rd=5,dc=6;function Gl(e,t,n,r,i,s){var a=e.__transition;if(!a)e.__transition={};else if(n in a)return;SM(e,n,{name:t,index:r,group:i,on:vM,tween:xM,time:s.time,delay:s.delay,duration:s.duration,ease:s.ease,timer:null,state:N1})}function Wh(e,t){var n=gn(e,t);if(n.state>N1)throw new Error("too late; already scheduled");return n}function Vn(e,t){var n=gn(e,t);if(n.state>fc)throw new Error("too late; already running");return n}function gn(e,t){var n=e.__transition;if(!n||!(n=n[t]))throw new Error("transition not found");return n}function SM(e,t,n){var r=e.__transition,i;r[t]=n,n.timer=I1(s,0,n.time);function s(l){n.state=em,n.timer.restart(a,n.delay,n.time),n.delay<=l&&a(l-n.delay)}function a(l){var u,f,d,h;if(n.state!==em)return c();for(u in r)if(h=r[u],h.name===n.name){if(h.state===fc)return tm(a);h.state===nm?(h.state=dc,h.timer.stop(),h.on.call("interrupt",e,e.__data__,h.index,h.group),delete r[u]):+u<t&&(h.state=dc,h.timer.stop(),h.on.call("cancel",e,e.__data__,h.index,h.group),delete r[u])}if(tm(function(){n.state===fc&&(n.state=nm,n.timer.restart(o,n.delay,n.time),o(l))}),n.state=nd,n.on.call("start",e,e.__data__,n.index,n.group),n.state===nd){for(n.state=fc,i=new Array(d=n.tween.length),u=0,f=-1;u<d;++u)(h=n.tween[u].value.call(e,e.__data__,n.index,n.group))&&(i[++f]=h);i.length=f+1}}function o(l){for(var u=l<n.duration?n.ease.call(null,l/n.duration):(n.timer.restart(c),n.state=rd,1),f=-1,d=i.length;++f<d;)i[f].call(e,u);n.state===rd&&(n.on.call("end",e,e.__data__,n.index,n.group),c())}function c(){n.state=dc,n.timer.stop(),delete r[t];for(var l in r)return;delete e.__transition}}function EM(e,t){var n=e.__transition,r,i,s=!0,a;if(n){t=t==null?null:t+"";for(a in n){if((r=n[a]).name!==t){s=!1;continue}i=r.state>nd&&r.state<rd,r.state=dc,r.timer.stop(),r.on.call(i?"interrupt":"cancel",e,e.__data__,r.index,r.group),delete n[a]}s&&delete e.__transition}}function TM(e){return this.each(function(){EM(this,e)})}function AM(e,t){var n,r;return function(){var i=Vn(this,e),s=i.tween;if(s!==n){r=n=s;for(var a=0,o=r.length;a<o;++a)if(r[a].name===t){r=r.slice(),r.splice(a,1);break}}i.tween=r}}function IM(e,t,n){var r,i;if(typeof n!="function")throw new Error;return function(){var s=Vn(this,e),a=s.tween;if(a!==r){i=(r=a).slice();for(var o={name:t,value:n},c=0,l=i.length;c<l;++c)if(i[c].name===t){i[c]=o;break}c===l&&i.push(o)}s.tween=i}}function NM(e,t){var n=this._id;if(e+="",arguments.length<2){for(var r=gn(this.node(),n).tween,i=0,s=r.length,a;i<s;++i)if((a=r[i]).name===e)return a.value;return null}return this.each((t==null?AM:IM)(n,e,t))}function Hh(e,t,n){var r=e._id;return e.each(function(){var i=Vn(this,r);(i.value||(i.value={}))[t]=n.apply(this,arguments)}),function(i){return gn(i,r).value[t]}}function M1(e,t){var n;return(typeof t=="number"?fe:t instanceof gi?bi:(n=gi(t))?(t=n,bi):v1)(e,t)}function MM(e){return function(){this.removeAttribute(e)}}function OM(e){return function(){this.removeAttributeNS(e.space,e.local)}}function RM(e,t,n){var r,i=n+"",s;return function(){var a=this.getAttribute(e);return a===i?null:a===r?s:s=t(r=a,n)}}function DM(e,t,n){var r,i=n+"",s;return function(){var a=this.getAttributeNS(e.space,e.local);return a===i?null:a===r?s:s=t(r=a,n)}}function LM(e,t,n){var r,i,s;return function(){var a,o=n(this),c;return o==null?void this.removeAttribute(e):(a=this.getAttribute(e),c=o+"",a===c?null:a===r&&c===i?s:(i=c,s=t(r=a,o)))}}function FM(e,t,n){var r,i,s;return function(){var a,o=n(this),c;return o==null?void this.removeAttributeNS(e.space,e.local):(a=this.getAttributeNS(e.space,e.local),c=o+"",a===c?null:a===r&&c===i?s:(i=c,s=t(r=a,o)))}}function kM(e,t){var n=Vl(e),r=n==="transform"?fM:M1;return this.attrTween(e,typeof t=="function"?(n.local?FM:LM)(n,r,Hh(this,"attr."+e,t)):t==null?(n.local?OM:MM)(n):(n.local?DM:RM)(n,r,t))}function CM(e,t){return function(n){this.setAttribute(e,t.call(this,n))}}function BM(e,t){return function(n){this.setAttributeNS(e.space,e.local,t.call(this,n))}}function $M(e,t){var n,r;function i(){var s=t.apply(this,arguments);return s!==r&&(n=(r=s)&&BM(e,s)),n}return i._value=t,i}function UM(e,t){var n,r;function i(){var s=t.apply(this,arguments);return s!==r&&(n=(r=s)&&CM(e,s)),n}return i._value=t,i}function PM(e,t){var n="attr."+e;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(t==null)return this.tween(n,null);if(typeof t!="function")throw new Error;var r=Vl(e);return this.tween(n,(r.local?$M:UM)(r,t))}function jM(e,t){return function(){Wh(this,e).delay=+t.apply(this,arguments)}}function VM(e,t){return t=+t,function(){Wh(this,e).delay=t}}function zM(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?jM:VM)(t,e)):gn(this.node(),t).delay}function YM(e,t){return function(){Vn(this,e).duration=+t.apply(this,arguments)}}function WM(e,t){return t=+t,function(){Vn(this,e).duration=t}}function HM(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?YM:WM)(t,e)):gn(this.node(),t).duration}function qM(e,t){if(typeof t!="function")throw new Error;return function(){Vn(this,e).ease=t}}function GM(e){var t=this._id;return arguments.length?this.each(qM(t,e)):gn(this.node(),t).ease}function XM(e,t){return function(){var n=t.apply(this,arguments);if(typeof n!="function")throw new Error;Vn(this,e).ease=n}}function KM(e){if(typeof e!="function")throw new Error;return this.each(XM(this._id,e))}function QM(e){typeof e!="function"&&(e=Z_(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var s=t[i],a=s.length,o=r[i]=[],c,l=0;l<a;++l)(c=s[l])&&e.call(c,c.__data__,l,s)&&o.push(c);return new dr(r,this._parents,this._name,this._id)}function JM(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,n=e._groups,r=t.length,i=n.length,s=Math.min(r,i),a=new Array(r),o=0;o<s;++o)for(var c=t[o],l=n[o],u=c.length,f=a[o]=new Array(u),d,h=0;h<u;++h)(d=c[h]||l[h])&&(f[h]=d);for(;o<r;++o)a[o]=t[o];return new dr(a,this._parents,this._name,this._id)}function ZM(e){return(e+"").trim().split(/^|\s+/).every(function(t){var n=t.indexOf(".");return n>=0&&(t=t.slice(0,n)),!t||t==="start"})}function tO(e,t,n){var r,i,s=ZM(t)?Wh:Vn;return function(){var a=s(this,e),o=a.on;o!==r&&(i=(r=o).copy()).on(t,n),a.on=i}}function eO(e,t){var n=this._id;return arguments.length<2?gn(this.node(),n).on.on(e):this.each(tO(n,e,t))}function nO(e){return function(){var t=this.parentNode;for(var n in this.__transition)if(+n!==e)return;t&&t.removeChild(this)}}function rO(){return this.on("end.remove",nO(this._id))}function iO(e){var t=this._name,n=this._id;typeof e!="function"&&(e=Ch(e));for(var r=this._groups,i=r.length,s=new Array(i),a=0;a<i;++a)for(var o=r[a],c=o.length,l=s[a]=new Array(c),u,f,d=0;d<c;++d)(u=o[d])&&(f=e.call(u,u.__data__,d,o))&&("__data__"in u&&(f.__data__=u.__data__),l[d]=f,Gl(l[d],t,n,d,l,gn(u,n)));return new dr(s,this._parents,t,n)}function sO(e){var t=this._name,n=this._id;typeof e!="function"&&(e=J_(e));for(var r=this._groups,i=r.length,s=[],a=[],o=0;o<i;++o)for(var c=r[o],l=c.length,u,f=0;f<l;++f)if(u=c[f]){for(var d=e.call(u,u.__data__,f,c),h,p=gn(u,n),y=0,g=d.length;y<g;++y)(h=d[y])&&Gl(h,t,n,y,d,p);s.push(d),a.push(u)}return new dr(s,a,t,n)}var aO=Za.prototype.constructor;function oO(){return new aO(this._groups,this._parents)}function cO(e,t){var n,r,i;return function(){var s=ps(this,e),a=(this.style.removeProperty(e),ps(this,e));return s===a?null:s===n&&a===r?i:i=t(n=s,r=a)}}function O1(e){return function(){this.style.removeProperty(e)}}function lO(e,t,n){var r,i=n+"",s;return function(){var a=ps(this,e);return a===i?null:a===r?s:s=t(r=a,n)}}function uO(e,t,n){var r,i,s;return function(){var a=ps(this,e),o=n(this),c=o+"";return o==null&&(c=o=(this.style.removeProperty(e),ps(this,e))),a===c?null:a===r&&c===i?s:(i=c,s=t(r=a,o))}}function fO(e,t){var n,r,i,s="style."+t,a="end."+s,o;return function(){var c=Vn(this,e),l=c.on,u=c.value[s]==null?o||(o=O1(t)):void 0;(l!==n||i!==u)&&(r=(n=l).copy()).on(a,i=u),c.on=r}}function dO(e,t,n){var r=(e+="")=="transform"?uM:M1;return t==null?this.styleTween(e,cO(e,r)).on("end.style."+e,O1(e)):typeof t=="function"?this.styleTween(e,uO(e,r,Hh(this,"style."+e,t))).each(fO(this._id,e)):this.styleTween(e,lO(e,r,t),n).on("end.style."+e,null)}function hO(e,t,n){return function(r){this.style.setProperty(e,t.call(this,r),n)}}function pO(e,t,n){var r,i;function s(){var a=t.apply(this,arguments);return a!==i&&(r=(i=a)&&hO(e,a,n)),r}return s._value=t,s}function mO(e,t,n){var r="style."+(e+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(t==null)return this.tween(r,null);if(typeof t!="function")throw new Error;return this.tween(r,pO(e,t,n??""))}function yO(e){return function(){this.textContent=e}}function gO(e){return function(){var t=e(this);this.textContent=t??""}}function bO(e){return this.tween("text",typeof e=="function"?gO(Hh(this,"text",e)):yO(e==null?"":e+""))}function _O(e){return function(t){this.textContent=e.call(this,t)}}function wO(e){var t,n;function r(){var i=e.apply(this,arguments);return i!==n&&(t=(n=i)&&_O(i)),t}return r._value=e,r}function vO(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(e==null)return this.tween(t,null);if(typeof e!="function")throw new Error;return this.tween(t,wO(e))}function xO(){for(var e=this._name,t=this._id,n=R1(),r=this._groups,i=r.length,s=0;s<i;++s)for(var a=r[s],o=a.length,c,l=0;l<o;++l)if(c=a[l]){var u=gn(c,t);Gl(c,e,n,l,a,{time:u.time+u.delay+u.duration,delay:0,duration:u.duration,ease:u.ease})}return new dr(r,this._parents,e,n)}function SO(){var e,t,n=this,r=n._id,i=n.size();return new Promise(function(s,a){var o={value:a},c={value:function(){--i===0&&s()}};n.each(function(){var l=Vn(this,r),u=l.on;u!==e&&(t=(e=u).copy(),t._.cancel.push(o),t._.interrupt.push(o),t._.end.push(c)),l.on=t}),i===0&&s()})}var EO=0;function dr(e,t,n,r){this._groups=e,this._parents=t,this._name=n,this._id=r}function R1(){return++EO}var Wn=Za.prototype;dr.prototype={constructor:dr,select:iO,selectAll:sO,selectChild:Wn.selectChild,selectChildren:Wn.selectChildren,filter:QM,merge:JM,selection:oO,transition:xO,call:Wn.call,nodes:Wn.nodes,node:Wn.node,size:Wn.size,empty:Wn.empty,each:Wn.each,on:eO,attr:kM,attrTween:PM,style:dO,styleTween:mO,text:bO,textTween:vO,remove:rO,tween:NM,delay:zM,duration:HM,ease:GM,easeVarying:KM,end:SO,[Symbol.iterator]:Wn[Symbol.iterator]};function TO(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var AO={time:null,delay:0,duration:250,ease:TO};function IO(e,t){for(var n;!(n=e.__transition)||!(n=n[t]);)if(!(e=e.parentNode))throw new Error(`transition ${t} not found`);return n}function NO(e){var t,n;e instanceof dr?(t=e._id,e=e._name):(t=R1(),(n=AO).time=Yh(),e=e==null?null:e+"");for(var r=this._groups,i=r.length,s=0;s<i;++s)for(var a=r[s],o=a.length,c,l=0;l<o;++l)(c=a[l])&&Gl(c,e,t,l,a,n||IO(c,t));return new dr(r,this._parents,e,t)}Za.prototype.interrupt=TM;Za.prototype.transition=NO;const id=Math.PI,sd=2*id,ti=1e-6,MO=sd-ti;function D1(e){this._+=e[0];for(let t=1,n=e.length;t<n;++t)this._+=arguments[t]+e[t]}function OO(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return D1;const n=10**t;return function(r){this._+=r[0];for(let i=1,s=r.length;i<s;++i)this._+=Math.round(arguments[i]*n)/n+r[i]}}class L1{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?D1:OO(t)}moveTo(t,n){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,n){this._append`L${this._x1=+t},${this._y1=+n}`}quadraticCurveTo(t,n,r,i){this._append`Q${+t},${+n},${this._x1=+r},${this._y1=+i}`}bezierCurveTo(t,n,r,i,s,a){this._append`C${+t},${+n},${+r},${+i},${this._x1=+s},${this._y1=+a}`}arcTo(t,n,r,i,s){if(t=+t,n=+n,r=+r,i=+i,s=+s,s<0)throw new Error(`negative radius: ${s}`);let a=this._x1,o=this._y1,c=r-t,l=i-n,u=a-t,f=o-n,d=u*u+f*f;if(this._x1===null)this._append`M${this._x1=t},${this._y1=n}`;else if(d>ti)if(!(Math.abs(f*c-l*u)>ti)||!s)this._append`L${this._x1=t},${this._y1=n}`;else{let h=r-a,p=i-o,y=c*c+l*l,g=h*h+p*p,b=Math.sqrt(y),_=Math.sqrt(d),E=s*Math.tan((id-Math.acos((y+d-g)/(2*b*_)))/2),w=E/_,A=E/b;Math.abs(w-1)>ti&&this._append`L${t+w*u},${n+w*f}`,this._append`A${s},${s},0,0,${+(f*h>u*p)},${this._x1=t+A*c},${this._y1=n+A*l}`}}arc(t,n,r,i,s,a){if(t=+t,n=+n,r=+r,a=!!a,r<0)throw new Error(`negative radius: ${r}`);let o=r*Math.cos(i),c=r*Math.sin(i),l=t+o,u=n+c,f=1^a,d=a?i-s:s-i;this._x1===null?this._append`M${l},${u}`:(Math.abs(this._x1-l)>ti||Math.abs(this._y1-u)>ti)&&this._append`L${l},${u}`,r&&(d<0&&(d=d%sd+sd),d>MO?this._append`A${r},${r},0,1,${f},${t-o},${n-c}A${r},${r},0,1,${f},${this._x1=l},${this._y1=u}`:d>ti&&this._append`A${r},${r},0,${+(d>=id)},${f},${this._x1=t+r*Math.cos(s)},${this._y1=n+r*Math.sin(s)}`)}rect(t,n,r,i){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}h${r=+r}v${+i}h${-r}Z`}toString(){return this._}}function Rr(e=3){return new L1(+e)}function RO(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function tl(e,t){if(!isFinite(e)||e===0)return null;var n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"),r=e.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+e.slice(n+1)]}function gs(e){return e=tl(Math.abs(e)),e?e[1]:NaN}function DO(e,t){return function(n,r){for(var i=n.length,s=[],a=0,o=e[0],c=0;i>0&&o>0&&(c+o+1>r&&(o=Math.max(1,r-c)),s.push(n.substring(i-=o,i+o)),!((c+=o+1)>r));)o=e[a=(a+1)%e.length];return s.reverse().join(t)}}function LO(e){return function(t){return t.replace(/[0-9]/g,function(n){return e[+n]})}}var FO=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Da(e){if(!(t=FO.exec(e)))throw new Error("invalid format: "+e);var t;return new qh({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}Da.prototype=qh.prototype;function qh(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}qh.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function kO(e){t:for(var t=e.length,n=1,r=-1,i;n<t;++n)switch(e[n]){case".":r=i=n;break;case"0":r===0&&(r=n),i=n;break;default:if(!+e[n])break t;r>0&&(r=0);break}return r>0?e.slice(0,r)+e.slice(i+1):e}var el;function CO(e,t){var n=tl(e,t);if(!n)return el=void 0,e.toPrecision(t);var r=n[0],i=n[1],s=i-(el=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,a=r.length;return s===a?r:s>a?r+new Array(s-a+1).join("0"):s>0?r.slice(0,s)+"."+r.slice(s):"0."+new Array(1-s).join("0")+tl(e,Math.max(0,t+s-1))[0]}function rm(e,t){var n=tl(e,t);if(!n)return e+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}const im={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:RO,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>rm(e*100,t),r:rm,s:CO,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function sm(e){return e}var am=Array.prototype.map,om=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function BO(e){var t=e.grouping===void 0||e.thousands===void 0?sm:DO(am.call(e.grouping,Number),e.thousands+""),n=e.currency===void 0?"":e.currency[0]+"",r=e.currency===void 0?"":e.currency[1]+"",i=e.decimal===void 0?".":e.decimal+"",s=e.numerals===void 0?sm:LO(am.call(e.numerals,String)),a=e.percent===void 0?"%":e.percent+"",o=e.minus===void 0?"":e.minus+"",c=e.nan===void 0?"NaN":e.nan+"";function l(f,d){f=Da(f);var h=f.fill,p=f.align,y=f.sign,g=f.symbol,b=f.zero,_=f.width,E=f.comma,w=f.precision,A=f.trim,x=f.type;x==="n"?(E=!0,x="g"):im[x]||(w===void 0&&(w=12),A=!0,x="g"),(b||h==="0"&&p==="=")&&(b=!0,h="0",p="=");var T=(d&&d.prefix!==void 0?d.prefix:"")+(g==="$"?n:g==="#"&&/[boxX]/.test(x)?"0"+x.toLowerCase():""),M=(g==="$"?r:/[%p]/.test(x)?a:"")+(d&&d.suffix!==void 0?d.suffix:""),R=im[x],F=/[defgprs%]/.test(x);w=w===void 0?6:/[gprs]/.test(x)?Math.max(1,Math.min(21,w)):Math.max(0,Math.min(20,w));function N(B){var W=T,D=M,S,I,O;if(x==="c")D=R(B)+D,B="";else{B=+B;var C=B<0||1/B<0;if(B=isNaN(B)?c:R(Math.abs(B),w),A&&(B=kO(B)),C&&+B==0&&y!=="+"&&(C=!1),W=(C?y==="("?y:o:y==="-"||y==="("?"":y)+W,D=(x==="s"&&!isNaN(B)&&el!==void 0?om[8+el/3]:"")+D+(C&&y==="("?")":""),F){for(S=-1,I=B.length;++S<I;)if(O=B.charCodeAt(S),48>O||O>57){D=(O===46?i+B.slice(S+1):B.slice(S))+D,B=B.slice(0,S);break}}}E&&!b&&(B=t(B,1/0));var L=W.length+B.length+D.length,$=L<_?new Array(_-L+1).join(h):"";switch(E&&b&&(B=t($+B,$.length?_-D.length:1/0),$=""),p){case"<":B=W+B+D+$;break;case"=":B=W+$+B+D;break;case"^":B=$.slice(0,L=$.length>>1)+W+B+D+$.slice(L);break;default:B=$+W+B+D;break}return s(B)}return N.toString=function(){return f+""},N}function u(f,d){var h=Math.max(-8,Math.min(8,Math.floor(gs(d)/3)))*3,p=Math.pow(10,-h),y=l((f=Da(f),f.type="f",f),{suffix:om[8+h/3]});return function(g){return y(p*g)}}return{format:l,formatPrefix:u}}var Lo,ks,F1;$O({thousands:",",grouping:[3],currency:["$",""]});function $O(e){return Lo=BO(e),ks=Lo.format,F1=Lo.formatPrefix,Lo}function UO(e){return Math.max(0,-gs(Math.abs(e)))}function PO(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(gs(t)/3)))*3-gs(Math.abs(e)))}function jO(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,gs(t)-gs(e))+1}var _t=1e-6,k1=1e-12,St=Math.PI,zt=St/2,cm=St/4,ze=St*2,oe=180/St,Ut=St/180,kt=Math.abs,Cs=Math.atan,hr=Math.atan2,vt=Math.cos,C1=Math.exp,nl=Math.log,Gu=Math.pow,pt=Math.sin,Qe=Math.sign||function(e){return e>0?1:e<0?-1:0},Oe=Math.sqrt,Gh=Math.tan;function B1(e){return e>1?0:e<-1?St:Math.acos(e)}function sn(e){return e>1?zt:e<-1?-zt:Math.asin(e)}function Je(){}function rl(e,t){e&&um.hasOwnProperty(e.type)&&um[e.type](e,t)}var lm={Feature:function(e,t){rl(e.geometry,t)},FeatureCollection:function(e,t){for(var n=e.features,r=-1,i=n.length;++r<i;)rl(n[r].geometry,t)}},um={Sphere:function(e,t){t.sphere()},Point:function(e,t){e=e.coordinates,t.point(e[0],e[1],e[2])},MultiPoint:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)e=n[r],t.point(e[0],e[1],e[2])},LineString:function(e,t){ad(e.coordinates,t,0)},MultiLineString:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)ad(n[r],t,0)},Polygon:function(e,t){fm(e.coordinates,t)},MultiPolygon:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)fm(n[r],t)},GeometryCollection:function(e,t){for(var n=e.geometries,r=-1,i=n.length;++r<i;)rl(n[r],t)}};function ad(e,t,n){var r=-1,i=e.length-n,s;for(t.lineStart();++r<i;)s=e[r],t.point(s[0],s[1],s[2]);t.lineEnd()}function fm(e,t){var n=-1,r=e.length;for(t.polygonStart();++n<r;)ad(e[n],t,1);t.polygonEnd()}function ri(e,t){e&&lm.hasOwnProperty(e.type)?lm[e.type](e,t):rl(e,t)}function od(e){return[hr(e[1],e[0]),sn(e[2])]}function bs(e){var t=e[0],n=e[1],r=vt(n);return[r*vt(t),r*pt(t),pt(n)]}function Fo(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function il(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]}function Xu(e,t){e[0]+=t[0],e[1]+=t[1],e[2]+=t[2]}function ko(e,t){return[e[0]*t,e[1]*t,e[2]*t]}function cd(e){var t=Oe(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]/=t,e[1]/=t,e[2]/=t}function ki(e){return function(){return e}}function ld(e,t){function n(r,i){return r=e(r,i),t(r[0],r[1])}return e.invert&&t.invert&&(n.invert=function(r,i){return r=t.invert(r,i),r&&e.invert(r[0],r[1])}),n}function ud(e,t){return kt(e)>St&&(e-=Math.round(e/ze)*ze),[e,t]}ud.invert=ud;function Xh(e,t,n){return(e%=ze)?t||n?ld(hm(e),pm(t,n)):hm(e):t||n?pm(t,n):ud}function dm(e){return function(t,n){return t+=e,kt(t)>St&&(t-=Math.round(t/ze)*ze),[t,n]}}function hm(e){var t=dm(e);return t.invert=dm(-e),t}function pm(e,t){var n=vt(e),r=pt(e),i=vt(t),s=pt(t);function a(o,c){var l=vt(c),u=vt(o)*l,f=pt(o)*l,d=pt(c),h=d*n+u*r;return[hr(f*i-h*s,u*n-d*r),sn(h*i+f*s)]}return a.invert=function(o,c){var l=vt(c),u=vt(o)*l,f=pt(o)*l,d=pt(c),h=d*i-f*s;return[hr(f*i+d*s,u*n+h*r),sn(h*n-u*r)]},a}function VO(e){e=Xh(e[0]*Ut,e[1]*Ut,e.length>2?e[2]*Ut:0);function t(n){return n=e(n[0]*Ut,n[1]*Ut),n[0]*=oe,n[1]*=oe,n}return t.invert=function(n){return n=e.invert(n[0]*Ut,n[1]*Ut),n[0]*=oe,n[1]*=oe,n},t}function $1(e,t,n,r,i,s){if(n){var a=vt(t),o=pt(t),c=r*n;i==null?(i=t+r*ze,s=t-c/2):(i=mm(a,i),s=mm(a,s),(r>0?i<s:i>s)&&(i+=r*ze));for(var l,u=i;r>0?u>s:u<s;u-=c)l=od([a,-o*vt(u),-o*pt(u)]),e.point(l[0],l[1])}}function mm(e,t){t=bs(t),t[0]-=e,cd(t);var n=B1(-t[1]);return((-t[2]<0?-n:n)+ze-_t)%ze}function ym(){var e=ki([0,0]),t=ki(90),n=ki(2),r,i,s={point:a};function a(c,l){r.push(c=i(c,l)),c[0]*=oe,c[1]*=oe}function o(){var c=e.apply(this,arguments),l=t.apply(this,arguments)*Ut,u=n.apply(this,arguments)*Ut;return r=[],i=Xh(-c[0]*Ut,-c[1]*Ut,0).invert,$1(s,l,u,1),c={type:"Polygon",coordinates:[r]},r=i=null,c}return o.center=function(c){return arguments.length?(e=typeof c=="function"?c:ki([+c[0],+c[1]]),o):e},o.radius=function(c){return arguments.length?(t=typeof c=="function"?c:ki(+c),o):t},o.precision=function(c){return arguments.length?(n=typeof c=="function"?c:ki(+c),o):n},o}function U1(){var e=[],t;return{point:function(n,r,i){t.push([n,r,i])},lineStart:function(){e.push(t=[])},lineEnd:Je,rejoin:function(){e.length>1&&e.push(e.pop().concat(e.shift()))},result:function(){var n=e;return e=[],t=null,n}}}function hc(e,t){return kt(e[0]-t[0])<_t&&kt(e[1]-t[1])<_t}function Co(e,t,n,r){this.x=e,this.z=t,this.o=n,this.e=r,this.v=!1,this.n=this.p=null}function P1(e,t,n,r,i){var s=[],a=[],o,c;if(e.forEach(function(p){if(!((y=p.length-1)<=0)){var y,g=p[0],b=p[y],_;if(hc(g,b)){if(!g[2]&&!b[2]){for(i.lineStart(),o=0;o<y;++o)i.point((g=p[o])[0],g[1]);i.lineEnd();return}b[0]+=2*_t}s.push(_=new Co(g,p,null,!0)),a.push(_.o=new Co(g,null,_,!1)),s.push(_=new Co(b,p,null,!1)),a.push(_.o=new Co(b,null,_,!0))}}),!!s.length){for(a.sort(t),gm(s),gm(a),o=0,c=a.length;o<c;++o)a[o].e=n=!n;for(var l=s[0],u,f;;){for(var d=l,h=!0;d.v;)if((d=d.n)===l)return;u=d.z,i.lineStart();do{if(d.v=d.o.v=!0,d.e){if(h)for(o=0,c=u.length;o<c;++o)i.point((f=u[o])[0],f[1]);else r(d.x,d.n.x,1,i);d=d.n}else{if(h)for(u=d.p.z,o=u.length-1;o>=0;--o)i.point((f=u[o])[0],f[1]);else r(d.x,d.p.x,-1,i);d=d.p}d=d.o,u=d.z,h=!h}while(!d.v);i.lineEnd()}}}function gm(e){if(t=e.length){for(var t,n=0,r=e[0],i;++n<t;)r.n=i=e[n],i.p=r,r=i;r.n=i=e[0],i.p=r}}function Ku(e){return kt(e[0])<=St?e[0]:Qe(e[0])*((kt(e[0])+St)%ze-St)}function zO(e,t){var n=Ku(t),r=t[1],i=pt(r),s=[pt(n),-vt(n),0],a=0,o=0,c=new pi;i===1?r=zt+_t:i===-1&&(r=-zt-_t);for(var l=0,u=e.length;l<u;++l)if(d=(f=e[l]).length)for(var f,d,h=f[d-1],p=Ku(h),y=h[1]/2+cm,g=pt(y),b=vt(y),_=0;_<d;++_,p=w,g=x,b=T,h=E){var E=f[_],w=Ku(E),A=E[1]/2+cm,x=pt(A),T=vt(A),M=w-p,R=M>=0?1:-1,F=R*M,N=F>St,B=g*x;if(c.add(hr(B*R*pt(F),b*T+B*vt(F))),a+=N?M+R*ze:M,N^p>=n^w>=n){var W=il(bs(h),bs(E));cd(W);var D=il(s,W);cd(D);var S=(N^M>=0?-1:1)*sn(D[2]);(r>S||r===S&&(W[0]||W[1]))&&(o+=N^M>=0?1:-1)}}return(a<-_t||a<_t&&c<-k1)^o&1}function j1(e,t,n,r){return function(i){var s=t(i),a=U1(),o=t(a),c=!1,l,u,f,d={point:h,lineStart:y,lineEnd:g,polygonStart:function(){d.point=b,d.lineStart=_,d.lineEnd=E,u=[],l=[]},polygonEnd:function(){d.point=h,d.lineStart=y,d.lineEnd=g,u=K_(u);var w=zO(l,r);u.length?(c||(i.polygonStart(),c=!0),P1(u,WO,w,n,i)):w&&(c||(i.polygonStart(),c=!0),i.lineStart(),n(null,null,1,i),i.lineEnd()),c&&(i.polygonEnd(),c=!1),u=l=null},sphere:function(){i.polygonStart(),i.lineStart(),n(null,null,1,i),i.lineEnd(),i.polygonEnd()}};function h(w,A){e(w,A)&&i.point(w,A)}function p(w,A){s.point(w,A)}function y(){d.point=p,s.lineStart()}function g(){d.point=h,s.lineEnd()}function b(w,A){f.push([w,A]),o.point(w,A)}function _(){o.lineStart(),f=[]}function E(){b(f[0][0],f[0][1]),o.lineEnd();var w=o.clean(),A=a.result(),x,T=A.length,M,R,F;if(f.pop(),l.push(f),f=null,!!T){if(w&1){if(R=A[0],(M=R.length-1)>0){for(c||(i.polygonStart(),c=!0),i.lineStart(),x=0;x<M;++x)i.point((F=R[x])[0],F[1]);i.lineEnd()}return}T>1&&w&2&&A.push(A.pop().concat(A.shift())),u.push(A.filter(YO))}}return d}}function YO(e){return e.length>1}function WO(e,t){return((e=e.x)[0]<0?e[1]-zt-_t:zt-e[1])-((t=t.x)[0]<0?t[1]-zt-_t:zt-t[1])}const bm=j1(function(){return!0},HO,GO,[-St,-zt]);function HO(e){var t=NaN,n=NaN,r=NaN,i;return{lineStart:function(){e.lineStart(),i=1},point:function(s,a){var o=s>0?St:-St,c=kt(s-t);kt(c-St)<_t?(e.point(t,n=(n+a)/2>0?zt:-zt),e.point(r,n),e.lineEnd(),e.lineStart(),e.point(o,n),e.point(s,n),i=0):r!==o&&c>=St&&(kt(t-r)<_t&&(t-=r*_t),kt(s-o)<_t&&(s-=o*_t),n=qO(t,n,s,a),e.point(r,n),e.lineEnd(),e.lineStart(),e.point(o,n),i=0),e.point(t=s,n=a),r=o},lineEnd:function(){e.lineEnd(),t=n=NaN},clean:function(){return 2-i}}}function qO(e,t,n,r){var i,s,a=pt(e-n);return kt(a)>_t?Cs((pt(t)*(s=vt(r))*pt(n)-pt(r)*(i=vt(t))*pt(e))/(i*s*a)):(t+r)/2}function GO(e,t,n,r){var i;if(e==null)i=n*zt,r.point(-St,i),r.point(0,i),r.point(St,i),r.point(St,0),r.point(St,-i),r.point(0,-i),r.point(-St,-i),r.point(-St,0),r.point(-St,i);else if(kt(e[0]-t[0])>_t){var s=e[0]<t[0]?St:-St;i=n*s/2,r.point(-s,i),r.point(0,i),r.point(s,i)}else r.point(t[0],t[1])}function XO(e){var t=vt(e),n=2*Ut,r=t>0,i=kt(t)>_t;function s(u,f,d,h){$1(h,e,n,d,u,f)}function a(u,f){return vt(u)*vt(f)>t}function o(u){var f,d,h,p,y;return{lineStart:function(){p=h=!1,y=1},point:function(g,b){var _=[g,b],E,w=a(g,b),A=r?w?0:l(g,b):w?l(g+(g<0?St:-St),b):0;if(!f&&(p=h=w)&&u.lineStart(),w!==h&&(E=c(f,_),(!E||hc(f,E)||hc(_,E))&&(_[2]=1)),w!==h)y=0,w?(u.lineStart(),E=c(_,f),u.point(E[0],E[1])):(E=c(f,_),u.point(E[0],E[1],2),u.lineEnd()),f=E;else if(i&&f&&r^w){var x;!(A&d)&&(x=c(_,f,!0))&&(y=0,r?(u.lineStart(),u.point(x[0][0],x[0][1]),u.point(x[1][0],x[1][1]),u.lineEnd()):(u.point(x[1][0],x[1][1]),u.lineEnd(),u.lineStart(),u.point(x[0][0],x[0][1],3)))}w&&(!f||!hc(f,_))&&u.point(_[0],_[1]),f=_,h=w,d=A},lineEnd:function(){h&&u.lineEnd(),f=null},clean:function(){return y|(p&&h)<<1}}}function c(u,f,d){var h=bs(u),p=bs(f),y=[1,0,0],g=il(h,p),b=Fo(g,g),_=g[0],E=b-_*_;if(!E)return!d&&u;var w=t*b/E,A=-t*_/E,x=il(y,g),T=ko(y,w),M=ko(g,A);Xu(T,M);var R=x,F=Fo(T,R),N=Fo(R,R),B=F*F-N*(Fo(T,T)-1);if(!(B<0)){var W=Oe(B),D=ko(R,(-F-W)/N);if(Xu(D,T),D=od(D),!d)return D;var S=u[0],I=f[0],O=u[1],C=f[1],L;I<S&&(L=S,S=I,I=L);var $=I-S,j=kt($-St)<_t,Y=j||$<_t;if(!j&&C<O&&(L=O,O=C,C=L),Y?j?O+C>0^D[1]<(kt(D[0]-S)<_t?O:C):O<=D[1]&&D[1]<=C:$>St^(S<=D[0]&&D[0]<=I)){var V=ko(R,(-F+W)/N);return Xu(V,T),[D,od(V)]}}}function l(u,f){var d=r?e:St-e,h=0;return u<-d?h|=1:u>d&&(h|=2),f<-d?h|=4:f>d&&(h|=8),h}return j1(a,o,s,r?[0,-e]:[-St,e-St])}function KO(e,t,n,r,i,s){var a=e[0],o=e[1],c=t[0],l=t[1],u=0,f=1,d=c-a,h=l-o,p;if(p=n-a,!(!d&&p>0)){if(p/=d,d<0){if(p<u)return;p<f&&(f=p)}else if(d>0){if(p>f)return;p>u&&(u=p)}if(p=i-a,!(!d&&p<0)){if(p/=d,d<0){if(p>f)return;p>u&&(u=p)}else if(d>0){if(p<u)return;p<f&&(f=p)}if(p=r-o,!(!h&&p>0)){if(p/=h,h<0){if(p<u)return;p<f&&(f=p)}else if(h>0){if(p>f)return;p>u&&(u=p)}if(p=s-o,!(!h&&p<0)){if(p/=h,h<0){if(p>f)return;p>u&&(u=p)}else if(h>0){if(p<u)return;p<f&&(f=p)}return u>0&&(e[0]=a+u*d,e[1]=o+u*h),f<1&&(t[0]=a+f*d,t[1]=o+f*h),!0}}}}}var aa=1e9,Bo=-aa;function V1(e,t,n,r){function i(l,u){return e<=l&&l<=n&&t<=u&&u<=r}function s(l,u,f,d){var h=0,p=0;if(l==null||(h=a(l,f))!==(p=a(u,f))||c(l,u)<0^f>0)do d.point(h===0||h===3?e:n,h>1?r:t);while((h=(h+f+4)%4)!==p);else d.point(u[0],u[1])}function a(l,u){return kt(l[0]-e)<_t?u>0?0:3:kt(l[0]-n)<_t?u>0?2:1:kt(l[1]-t)<_t?u>0?1:0:u>0?3:2}function o(l,u){return c(l.x,u.x)}function c(l,u){var f=a(l,1),d=a(u,1);return f!==d?f-d:f===0?u[1]-l[1]:f===1?l[0]-u[0]:f===2?l[1]-u[1]:u[0]-l[0]}return function(l){var u=l,f=U1(),d,h,p,y,g,b,_,E,w,A,x,T={point:M,lineStart:B,lineEnd:W,polygonStart:F,polygonEnd:N};function M(S,I){i(S,I)&&u.point(S,I)}function R(){for(var S=0,I=0,O=h.length;I<O;++I)for(var C=h[I],L=1,$=C.length,j=C[0],Y,V,K=j[0],ot=j[1];L<$;++L)Y=K,V=ot,j=C[L],K=j[0],ot=j[1],V<=r?ot>r&&(K-Y)*(r-V)>(ot-V)*(e-Y)&&++S:ot<=r&&(K-Y)*(r-V)<(ot-V)*(e-Y)&&--S;return S}function F(){u=f,d=[],h=[],x=!0}function N(){var S=R(),I=x&&S,O=(d=K_(d)).length;(I||O)&&(l.polygonStart(),I&&(l.lineStart(),s(null,null,1,l),l.lineEnd()),O&&P1(d,o,S,s,l),l.polygonEnd()),u=l,d=h=p=null}function B(){T.point=D,h&&h.push(p=[]),A=!0,w=!1,_=E=NaN}function W(){d&&(D(y,g),b&&w&&f.rejoin(),d.push(f.result())),T.point=M,w&&u.lineEnd()}function D(S,I){var O=i(S,I);if(h&&p.push([S,I]),A)y=S,g=I,b=O,A=!1,O&&(u.lineStart(),u.point(S,I));else if(O&&w)u.point(S,I);else{var C=[_=Math.max(Bo,Math.min(aa,_)),E=Math.max(Bo,Math.min(aa,E))],L=[S=Math.max(Bo,Math.min(aa,S)),I=Math.max(Bo,Math.min(aa,I))];KO(C,L,e,t,n,r)?(w||(u.lineStart(),u.point(C[0],C[1])),u.point(L[0],L[1]),O||u.lineEnd(),x=!1):O&&(u.lineStart(),u.point(S,I),x=!1)}_=S,E=I,w=O}return T}}const fd=e=>e;var Qu=new pi,dd=new pi,z1,Y1,hd,pd,rr={point:Je,lineStart:Je,lineEnd:Je,polygonStart:function(){rr.lineStart=QO,rr.lineEnd=ZO},polygonEnd:function(){rr.lineStart=rr.lineEnd=rr.point=Je,Qu.add(kt(dd)),dd=new pi},result:function(){var e=Qu/2;return Qu=new pi,e}};function QO(){rr.point=JO}function JO(e,t){rr.point=W1,z1=hd=e,Y1=pd=t}function W1(e,t){dd.add(pd*e-hd*t),hd=e,pd=t}function ZO(){W1(z1,Y1)}var _s=1/0,sl=_s,La=-_s,al=La,ol={point:t4,lineStart:Je,lineEnd:Je,polygonStart:Je,polygonEnd:Je,result:function(){var e=[[_s,sl],[La,al]];return La=al=-(sl=_s=1/0),e}};function t4(e,t){e<_s&&(_s=e),e>La&&(La=e),t<sl&&(sl=t),t>al&&(al=t)}var md=0,yd=0,oa=0,cl=0,ll=0,Ki=0,gd=0,bd=0,ca=0,H1,q1,Nn,Mn,Ke={point:wi,lineStart:_m,lineEnd:wm,polygonStart:function(){Ke.lineStart=r4,Ke.lineEnd=i4},polygonEnd:function(){Ke.point=wi,Ke.lineStart=_m,Ke.lineEnd=wm},result:function(){var e=ca?[gd/ca,bd/ca]:Ki?[cl/Ki,ll/Ki]:oa?[md/oa,yd/oa]:[NaN,NaN];return md=yd=oa=cl=ll=Ki=gd=bd=ca=0,e}};function wi(e,t){md+=e,yd+=t,++oa}function _m(){Ke.point=e4}function e4(e,t){Ke.point=n4,wi(Nn=e,Mn=t)}function n4(e,t){var n=e-Nn,r=t-Mn,i=Oe(n*n+r*r);cl+=i*(Nn+e)/2,ll+=i*(Mn+t)/2,Ki+=i,wi(Nn=e,Mn=t)}function wm(){Ke.point=wi}function r4(){Ke.point=s4}function i4(){G1(H1,q1)}function s4(e,t){Ke.point=G1,wi(H1=Nn=e,q1=Mn=t)}function G1(e,t){var n=e-Nn,r=t-Mn,i=Oe(n*n+r*r);cl+=i*(Nn+e)/2,ll+=i*(Mn+t)/2,Ki+=i,i=Mn*e-Nn*t,gd+=i*(Nn+e),bd+=i*(Mn+t),ca+=i*3,wi(Nn=e,Mn=t)}function X1(e){this._context=e}X1.prototype={_radius:4.5,pointRadius:function(e){return this._radius=e,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){this._line===0&&this._context.closePath(),this._point=NaN},point:function(e,t){switch(this._point){case 0:{this._context.moveTo(e,t),this._point=1;break}case 1:{this._context.lineTo(e,t);break}default:{this._context.moveTo(e+this._radius,t),this._context.arc(e,t,this._radius,0,ze);break}}},result:Je};var _d=new pi,Ju,K1,Q1,la,ua,Fa={point:Je,lineStart:function(){Fa.point=a4},lineEnd:function(){Ju&&J1(K1,Q1),Fa.point=Je},polygonStart:function(){Ju=!0},polygonEnd:function(){Ju=null},result:function(){var e=+_d;return _d=new pi,e}};function a4(e,t){Fa.point=J1,K1=la=e,Q1=ua=t}function J1(e,t){la-=e,ua-=t,_d.add(Oe(la*la+ua*ua)),la=e,ua=t}let vm,ul,xm,Sm;class Em{constructor(t){this._append=t==null?Z1:o4(t),this._radius=4.5,this._=""}pointRadius(t){return this._radius=+t,this}polygonStart(){this._line=0}polygonEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){this._line===0&&(this._+="Z"),this._point=NaN}point(t,n){switch(this._point){case 0:{this._append`M${t},${n}`,this._point=1;break}case 1:{this._append`L${t},${n}`;break}default:{if(this._append`M${t},${n}`,this._radius!==xm||this._append!==ul){const r=this._radius,i=this._;this._="",this._append`m0,${r}a${r},${r} 0 1,1 0,${-2*r}a${r},${r} 0 1,1 0,${2*r}z`,xm=r,ul=this._append,Sm=this._,this._=i}this._+=Sm;break}}}result(){const t=this._;return this._="",t.length?t:null}}function Z1(e){let t=1;this._+=e[0];for(const n=e.length;t<n;++t)this._+=arguments[t]+e[t]}function o4(e){const t=Math.floor(e);if(!(t>=0))throw new RangeError(`invalid digits: ${e}`);if(t>15)return Z1;if(t!==vm){const n=10**t;vm=t,ul=function(i){let s=1;this._+=i[0];for(const a=i.length;s<a;++s)this._+=Math.round(arguments[s]*n)/n+i[s]}}return ul}function Kh(e,t){let n=3,r=4.5,i,s;function a(o){return o&&(typeof r=="function"&&s.pointRadius(+r.apply(this,arguments)),ri(o,i(s))),s.result()}return a.area=function(o){return ri(o,i(rr)),rr.result()},a.measure=function(o){return ri(o,i(Fa)),Fa.result()},a.bounds=function(o){return ri(o,i(ol)),ol.result()},a.centroid=function(o){return ri(o,i(Ke)),Ke.result()},a.projection=function(o){return arguments.length?(i=o==null?(e=null,fd):(e=o).stream,a):e},a.context=function(o){return arguments.length?(s=o==null?(t=null,new Em(n)):new X1(t=o),typeof r!="function"&&s.pointRadius(r),a):t},a.pointRadius=function(o){return arguments.length?(r=typeof o=="function"?o:(s.pointRadius(+o),+o),a):r},a.digits=function(o){if(!arguments.length)return n;if(o==null)n=null;else{const c=Math.floor(o);if(!(c>=0))throw new RangeError(`invalid digits: ${o}`);n=c}return t===null&&(s=new Em(n)),a},a.projection(e).digits(n).context(t)}function fl(e){return{stream:Xl(e)}}function Xl(e){return function(t){var n=new wd;for(var r in e)n[r]=e[r];return n.stream=t,n}}function wd(){}wd.prototype={constructor:wd,point:function(e,t){this.stream.point(e,t)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};function Qh(e,t,n){var r=e.clipExtent&&e.clipExtent();return e.scale(150).translate([0,0]),r!=null&&e.clipExtent(null),ri(n,e.stream(ol)),t(ol.result()),r!=null&&e.clipExtent(r),e}function Jh(e,t,n){return Qh(e,function(r){var i=t[1][0]-t[0][0],s=t[1][1]-t[0][1],a=Math.min(i/(r[1][0]-r[0][0]),s/(r[1][1]-r[0][1])),o=+t[0][0]+(i-a*(r[1][0]+r[0][0]))/2,c=+t[0][1]+(s-a*(r[1][1]+r[0][1]))/2;e.scale(150*a).translate([o,c])},n)}function tw(e,t,n){return Jh(e,[[0,0],t],n)}function ew(e,t,n){return Qh(e,function(r){var i=+t,s=i/(r[1][0]-r[0][0]),a=(i-s*(r[1][0]+r[0][0]))/2,o=-s*r[0][1];e.scale(150*s).translate([a,o])},n)}function nw(e,t,n){return Qh(e,function(r){var i=+t,s=i/(r[1][1]-r[0][1]),a=-s*r[0][0],o=(i-s*(r[1][1]+r[0][1]))/2;e.scale(150*s).translate([a,o])},n)}var Tm=16,c4=vt(30*Ut);function Am(e,t){return+t?u4(e,t):l4(e)}function l4(e){return Xl({point:function(t,n){t=e(t,n),this.stream.point(t[0],t[1])}})}function u4(e,t){function n(r,i,s,a,o,c,l,u,f,d,h,p,y,g){var b=l-r,_=u-i,E=b*b+_*_;if(E>4*t&&y--){var w=a+d,A=o+h,x=c+p,T=Oe(w*w+A*A+x*x),M=sn(x/=T),R=kt(kt(x)-1)<_t||kt(s-f)<_t?(s+f)/2:hr(A,w),F=e(R,M),N=F[0],B=F[1],W=N-r,D=B-i,S=_*W-b*D;(S*S/E>t||kt((b*W+_*D)/E-.5)>.3||a*d+o*h+c*p<c4)&&(n(r,i,s,a,o,c,N,B,R,w/=T,A/=T,x,y,g),g.point(N,B),n(N,B,R,w,A,x,l,u,f,d,h,p,y,g))}}return function(r){var i,s,a,o,c,l,u,f,d,h,p,y,g={point:b,lineStart:_,lineEnd:w,polygonStart:function(){r.polygonStart(),g.lineStart=A},polygonEnd:function(){r.polygonEnd(),g.lineStart=_}};function b(M,R){M=e(M,R),r.point(M[0],M[1])}function _(){f=NaN,g.point=E,r.lineStart()}function E(M,R){var F=bs([M,R]),N=e(M,R);n(f,d,u,h,p,y,f=N[0],d=N[1],u=M,h=F[0],p=F[1],y=F[2],Tm,r),r.point(f,d)}function w(){g.point=b,r.lineEnd()}function A(){_(),g.point=x,g.lineEnd=T}function x(M,R){E(i=M,R),s=f,a=d,o=h,c=p,l=y,g.point=E}function T(){n(f,d,u,h,p,y,s,a,i,o,c,l,Tm,r),g.lineEnd=w,w()}return g}}var f4=Xl({point:function(e,t){this.stream.point(e*Ut,t*Ut)}});function d4(e){return Xl({point:function(t,n){var r=e(t,n);return this.stream.point(r[0],r[1])}})}function h4(e,t,n,r,i){function s(a,o){return a*=r,o*=i,[t+e*a,n-e*o]}return s.invert=function(a,o){return[(a-t)/e*r,(n-o)/e*i]},s}function Im(e,t,n,r,i,s){if(!s)return h4(e,t,n,r,i);var a=vt(s),o=pt(s),c=a*e,l=o*e,u=a/e,f=o/e,d=(o*n-a*t)/e,h=(o*t+a*n)/e;function p(y,g){return y*=r,g*=i,[c*y-l*g+t,n-l*y-c*g]}return p.invert=function(y,g){return[r*(u*y-f*g+d),i*(h-f*y-u*g)]},p}function qr(e){return rw(function(){return e})()}function rw(e){var t,n=150,r=480,i=250,s=0,a=0,o=0,c=0,l=0,u,f=0,d=1,h=1,p=null,y=bm,g=null,b,_,E,w=fd,A=.5,x,T,M,R,F;function N(S){return M(S[0]*Ut,S[1]*Ut)}function B(S){return S=M.invert(S[0],S[1]),S&&[S[0]*oe,S[1]*oe]}N.stream=function(S){return R&&F===S?R:R=f4(d4(u)(y(x(w(F=S)))))},N.preclip=function(S){return arguments.length?(y=S,p=void 0,D()):y},N.postclip=function(S){return arguments.length?(w=S,g=b=_=E=null,D()):w},N.clipAngle=function(S){return arguments.length?(y=+S?XO(p=S*Ut):(p=null,bm),D()):p*oe},N.clipExtent=function(S){return arguments.length?(w=S==null?(g=b=_=E=null,fd):V1(g=+S[0][0],b=+S[0][1],_=+S[1][0],E=+S[1][1]),D()):g==null?null:[[g,b],[_,E]]},N.scale=function(S){return arguments.length?(n=+S,W()):n},N.translate=function(S){return arguments.length?(r=+S[0],i=+S[1],W()):[r,i]},N.center=function(S){return arguments.length?(s=S[0]%360*Ut,a=S[1]%360*Ut,W()):[s*oe,a*oe]},N.rotate=function(S){return arguments.length?(o=S[0]%360*Ut,c=S[1]%360*Ut,l=S.length>2?S[2]%360*Ut:0,W()):[o*oe,c*oe,l*oe]},N.angle=function(S){return arguments.length?(f=S%360*Ut,W()):f*oe},N.reflectX=function(S){return arguments.length?(d=S?-1:1,W()):d<0},N.reflectY=function(S){return arguments.length?(h=S?-1:1,W()):h<0},N.precision=function(S){return arguments.length?(x=Am(T,A=S*S),D()):Oe(A)},N.fitExtent=function(S,I){return Jh(N,S,I)},N.fitSize=function(S,I){return tw(N,S,I)},N.fitWidth=function(S,I){return ew(N,S,I)},N.fitHeight=function(S,I){return nw(N,S,I)};function W(){var S=Im(n,0,0,d,h,f).apply(null,t(s,a)),I=Im(n,r-S[0],i-S[1],d,h,f);return u=Xh(o,c,l),T=ld(t,I),M=ld(u,T),x=Am(T,A),D()}function D(){return R=F=null,N}return function(){return t=e.apply(this,arguments),N.invert=t.invert&&B,W()}}function Zh(e){var t=0,n=St/3,r=rw(e),i=r(t,n);return i.parallels=function(s){return arguments.length?r(t=s[0]*Ut,n=s[1]*Ut):[t*oe,n*oe]},i}function p4(e){var t=vt(e);function n(r,i){return[r*t,pt(i)/t]}return n.invert=function(r,i){return[r/t,sn(i*t)]},n}function m4(e,t){var n=pt(e),r=(n+pt(t))/2;if(kt(r)<_t)return p4(e);var i=1+n*(2*r-n),s=Oe(i)/r;function a(o,c){var l=Oe(i-2*r*pt(c))/r;return[l*pt(o*=r),s-l*vt(o)]}return a.invert=function(o,c){var l=s-c,u=hr(o,kt(l))*Qe(l);return l*r<0&&(u-=St*Qe(o)*Qe(l)),[u/r,sn((i-(o*o+l*l)*r*r)/(2*r))]},a}function dl(){return Zh(m4).scale(155.424).center([0,33.6442])}function iw(){return dl().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7])}function y4(e){var t=e.length;return{point:function(n,r){for(var i=-1;++i<t;)e[i].point(n,r)},sphere:function(){for(var n=-1;++n<t;)e[n].sphere()},lineStart:function(){for(var n=-1;++n<t;)e[n].lineStart()},lineEnd:function(){for(var n=-1;++n<t;)e[n].lineEnd()},polygonStart:function(){for(var n=-1;++n<t;)e[n].polygonStart()},polygonEnd:function(){for(var n=-1;++n<t;)e[n].polygonEnd()}}}function g4(){var e,t,n=iw(),r,i=dl().rotate([154,0]).center([-2,58.5]).parallels([55,65]),s,a=dl().rotate([157,0]).center([-3,19.9]).parallels([8,18]),o,c,l={point:function(d,h){c=[d,h]}};function u(d){var h=d[0],p=d[1];return c=null,r.point(h,p),c||(s.point(h,p),c)||(o.point(h,p),c)}u.invert=function(d){var h=n.scale(),p=n.translate(),y=(d[0]-p[0])/h,g=(d[1]-p[1])/h;return(g>=.12&&g<.234&&y>=-.425&&y<-.214?i:g>=.166&&g<.234&&y>=-.214&&y<-.115?a:n).invert(d)},u.stream=function(d){return e&&t===d?e:e=y4([n.stream(t=d),i.stream(d),a.stream(d)])},u.precision=function(d){return arguments.length?(n.precision(d),i.precision(d),a.precision(d),f()):n.precision()},u.scale=function(d){return arguments.length?(n.scale(d),i.scale(d*.35),a.scale(d),u.translate(n.translate())):n.scale()},u.translate=function(d){if(!arguments.length)return n.translate();var h=n.scale(),p=+d[0],y=+d[1];return r=n.translate(d).clipExtent([[p-.455*h,y-.238*h],[p+.455*h,y+.238*h]]).stream(l),s=i.translate([p-.307*h,y+.201*h]).clipExtent([[p-.425*h+_t,y+.12*h+_t],[p-.214*h-_t,y+.234*h-_t]]).stream(l),o=a.translate([p-.205*h,y+.212*h]).clipExtent([[p-.214*h+_t,y+.166*h+_t],[p-.115*h-_t,y+.234*h-_t]]).stream(l),f()},u.fitExtent=function(d,h){return Jh(u,d,h)},u.fitSize=function(d,h){return tw(u,d,h)},u.fitWidth=function(d,h){return ew(u,d,h)},u.fitHeight=function(d,h){return nw(u,d,h)};function f(){return e=t=null,u}return u.scale(1070)}function sw(e){return function(t,n){var r=vt(t),i=vt(n),s=e(r*i);return s===1/0?[2,0]:[s*i*pt(t),s*pt(n)]}}function no(e){return function(t,n){var r=Oe(t*t+n*n),i=e(r),s=pt(i),a=vt(i);return[hr(t*s,r*a),sn(r&&n*s/r)]}}var aw=sw(function(e){return Oe(2/(1+e))});aw.invert=no(function(e){return 2*sn(e/2)});function b4(){return qr(aw).scale(124.75).clipAngle(180-.001)}var ow=sw(function(e){return(e=B1(e))&&e/pt(e)});ow.invert=no(function(e){return e});function _4(){return qr(ow).scale(79.4188).clipAngle(180-.001)}function Kl(e,t){return[e,nl(Gh((zt+t)/2))]}Kl.invert=function(e,t){return[e,2*Cs(C1(t))-zt]};function w4(){return cw(Kl).scale(961/ze)}function cw(e){var t=qr(e),n=t.center,r=t.scale,i=t.translate,s=t.clipExtent,a=null,o,c,l;t.scale=function(f){return arguments.length?(r(f),u()):r()},t.translate=function(f){return arguments.length?(i(f),u()):i()},t.center=function(f){return arguments.length?(n(f),u()):n()},t.clipExtent=function(f){return arguments.length?(f==null?a=o=c=l=null:(a=+f[0][0],o=+f[0][1],c=+f[1][0],l=+f[1][1]),u()):a==null?null:[[a,o],[c,l]]};function u(){var f=St*r(),d=t(VO(t.rotate()).invert([0,0]));return s(a==null?[[d[0]-f,d[1]-f],[d[0]+f,d[1]+f]]:e===Kl?[[Math.max(d[0]-f,a),o],[Math.min(d[0]+f,c),l]]:[[a,Math.max(d[1]-f,o)],[c,Math.min(d[1]+f,l)]])}return u()}function $o(e){return Gh((zt+e)/2)}function v4(e,t){var n=vt(e),r=e===t?pt(e):nl(n/vt(t))/nl($o(t)/$o(e)),i=n*Gu($o(e),r)/r;if(!r)return Kl;function s(a,o){i>0?o<-zt+_t&&(o=-zt+_t):o>zt-_t&&(o=zt-_t);var c=i/Gu($o(o),r);return[c*pt(r*a),i-c*vt(r*a)]}return s.invert=function(a,o){var c=i-o,l=Qe(r)*Oe(a*a+c*c),u=hr(a,kt(c))*Qe(c);return c*r<0&&(u-=St*Qe(a)*Qe(c)),[u/r,2*Cs(Gu(i/l,1/r))-zt]},s}function x4(){return Zh(v4).scale(109.5).parallels([30,30])}function hl(e,t){return[e,t]}hl.invert=hl;function S4(){return qr(hl).scale(152.63)}function E4(e,t){var n=vt(e),r=e===t?pt(e):(n-vt(t))/(t-e),i=n/r+e;if(kt(r)<_t)return hl;function s(a,o){var c=i-o,l=r*a;return[c*pt(l),i-c*vt(l)]}return s.invert=function(a,o){var c=i-o,l=hr(a,kt(c))*Qe(c);return c*r<0&&(l-=St*Qe(a)*Qe(c)),[l/r,i-Qe(r)*Oe(a*a+c*c)]},s}function T4(){return Zh(E4).scale(131.154).center([0,13.9389])}var pa=1.340264,ma=-.081106,ya=893e-6,ga=.003796,pl=Oe(3)/2,A4=12;function lw(e,t){var n=sn(pl*pt(t)),r=n*n,i=r*r*r;return[e*vt(n)/(pl*(pa+3*ma*r+i*(7*ya+9*ga*r))),n*(pa+ma*r+i*(ya+ga*r))]}lw.invert=function(e,t){for(var n=t,r=n*n,i=r*r*r,s=0,a,o,c;s<A4&&(o=n*(pa+ma*r+i*(ya+ga*r))-t,c=pa+3*ma*r+i*(7*ya+9*ga*r),n-=a=o/c,r=n*n,i=r*r*r,!(kt(a)<k1));++s);return[pl*e*(pa+3*ma*r+i*(7*ya+9*ga*r))/vt(n),sn(pt(n)/pl)]};function I4(){return qr(lw).scale(177.158)}function uw(e,t){var n=vt(t),r=vt(e)*n;return[n*pt(e)/r,pt(t)/r]}uw.invert=no(Cs);function N4(){return qr(uw).scale(144.049).clipAngle(60)}function fw(e,t){return[vt(t)*pt(e),pt(t)]}fw.invert=no(sn);function M4(){return qr(fw).scale(249.5).clipAngle(90+_t)}function dw(e,t){var n=vt(t),r=1+vt(e)*n;return[n*pt(e)/r,pt(t)/r]}dw.invert=no(function(e){return 2*Cs(e)});function O4(){return qr(dw).scale(250).clipAngle(142)}function hw(e,t){return[nl(Gh((zt+t)/2)),-e]}hw.invert=function(e,t){return[-t,2*Cs(C1(e))-zt]};function R4(){var e=cw(hw),t=e.center,n=e.rotate;return e.center=function(r){return arguments.length?t([-r[1],r[0]]):(r=t(),[r[1],-r[0]])},e.rotate=function(r){return arguments.length?n([r[0],r[1],r.length>2?r[2]+90:90]):(r=n(),[r[0],r[1],r[2]-90])},n([0,0,90]).scale(159.155)}function zn(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function Ql(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}const vd=Symbol("implicit");function t0(){var e=new mi,t=[],n=[],r=vd;function i(s){let a=e.get(s);if(a===void 0){if(r!==vd)return r;e.set(s,a=t.push(s)-1)}return n[a%n.length]}return i.domain=function(s){if(!arguments.length)return t.slice();t=[],e=new mi;for(const a of s)e.has(a)||e.set(a,t.push(a)-1);return i},i.range=function(s){return arguments.length?(n=Array.from(s),i):n.slice()},i.unknown=function(s){return arguments.length?(r=s,i):r},i.copy=function(){return t0(t,n).unknown(r)},zn.apply(i,arguments),i}function Jl(){var e=t0().unknown(void 0),t=e.domain,n=e.range,r=0,i=1,s,a,o=!1,c=0,l=0,u=.5;delete e.unknown;function f(){var d=t().length,h=i<r,p=h?i:r,y=h?r:i;s=(y-p)/Math.max(1,d-c+l*2),o&&(s=Math.floor(s)),p+=(y-p-s*(d-c))*u,a=s*(1-c),o&&(p=Math.round(p),a=Math.round(a));var g=Gf(d).map(function(b){return p+s*b});return n(h?g.reverse():g)}return e.domain=function(d){return arguments.length?(t(d),f()):t()},e.range=function(d){return arguments.length?([r,i]=d,r=+r,i=+i,f()):[r,i]},e.rangeRound=function(d){return[r,i]=d,r=+r,i=+i,o=!0,f()},e.bandwidth=function(){return a},e.step=function(){return s},e.round=function(d){return arguments.length?(o=!!d,f()):o},e.padding=function(d){return arguments.length?(c=Math.min(1,l=+d),f()):c},e.paddingInner=function(d){return arguments.length?(c=Math.min(1,d),f()):c},e.paddingOuter=function(d){return arguments.length?(l=+d,f()):l},e.align=function(d){return arguments.length?(u=Math.max(0,Math.min(1,d)),f()):u},e.copy=function(){return Jl(t(),[r,i]).round(o).paddingInner(c).paddingOuter(l).align(u)},zn.apply(f(),arguments)}function pw(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return pw(t())},e}function mw(){return pw(Jl.apply(null,arguments).paddingInner(1))}function D4(e){return function(){return e}}function xd(e){return+e}var Nm=[0,1];function Ze(e){return e}function Sd(e,t){return(t-=e=+e)?function(n){return(n-e)/t}:D4(isNaN(t)?NaN:.5)}function L4(e,t){var n;return e>t&&(n=e,e=t,t=n),function(r){return Math.max(e,Math.min(t,r))}}function F4(e,t,n){var r=e[0],i=e[1],s=t[0],a=t[1];return i<r?(r=Sd(i,r),s=n(a,s)):(r=Sd(r,i),s=n(s,a)),function(o){return s(r(o))}}function k4(e,t,n){var r=Math.min(e.length,t.length)-1,i=new Array(r),s=new Array(r),a=-1;for(e[r]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++a<r;)i[a]=Sd(e[a],e[a+1]),s[a]=n(t[a],t[a+1]);return function(o){var c=Ul(e,o,1,r)-1;return s[c](i[c](o))}}function ro(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function Zl(){var e=Nm,t=Nm,n=eo,r,i,s,a=Ze,o,c,l;function u(){var d=Math.min(e.length,t.length);return a!==Ze&&(a=L4(e[0],e[d-1])),o=d>2?k4:F4,c=l=null,f}function f(d){return d==null||isNaN(d=+d)?s:(c||(c=o(e.map(r),t,n)))(r(a(d)))}return f.invert=function(d){return a(i((l||(l=o(t,e.map(r),fe)))(d)))},f.domain=function(d){return arguments.length?(e=Array.from(d,xd),u()):e.slice()},f.range=function(d){return arguments.length?(t=Array.from(d),u()):t.slice()},f.rangeRound=function(d){return t=Array.from(d),n=Vh,u()},f.clamp=function(d){return arguments.length?(a=d?!0:Ze,u()):a!==Ze},f.interpolate=function(d){return arguments.length?(n=d,u()):n},f.unknown=function(d){return arguments.length?(s=d,f):s},function(d,h){return r=d,i=h,u()}}function yw(){return Zl()(Ze,Ze)}function C4(e,t,n,r){var i=Hf(e,t,n),s;switch(r=Da(r??",f"),r.type){case"s":{var a=Math.max(Math.abs(e),Math.abs(t));return r.precision==null&&!isNaN(s=PO(i,a))&&(r.precision=s),F1(r,a)}case"":case"e":case"g":case"p":case"r":{r.precision==null&&!isNaN(s=jO(i,Math.max(Math.abs(e),Math.abs(t))))&&(r.precision=s-(r.type==="e"));break}case"f":case"%":{r.precision==null&&!isNaN(s=UO(i))&&(r.precision=s-(r.type==="%")*2);break}}return ks(r)}function io(e){var t=e.domain;return e.ticks=function(n){var r=t();return Na(r[0],r[r.length-1],n??10)},e.tickFormat=function(n,r){var i=t();return C4(i[0],i[i.length-1],n??10,r)},e.nice=function(n){n==null&&(n=10);var r=t(),i=0,s=r.length-1,a=r[i],o=r[s],c,l,u=10;for(o<a&&(l=a,a=o,o=l,l=i,i=s,s=l);u-- >0;){if(l=Hc(a,o,n),l===c)return r[i]=a,r[s]=o,t(r);if(l>0)a=Math.floor(a/l)*l,o=Math.ceil(o/l)*l;else if(l<0)a=Math.ceil(a*l)/l,o=Math.floor(o*l)/l;else break;c=l}return e},e}function tu(){var e=yw();return e.copy=function(){return ro(e,tu())},zn.apply(e,arguments),io(e)}function gw(e){var t;function n(r){return r==null||isNaN(r=+r)?t:r}return n.invert=n,n.domain=n.range=function(r){return arguments.length?(e=Array.from(r,xd),n):e.slice()},n.unknown=function(r){return arguments.length?(t=r,n):t},n.copy=function(){return gw(e).unknown(t)},e=arguments.length?Array.from(e,xd):[0,1],io(n)}function bw(e,t){e=e.slice();var n=0,r=e.length-1,i=e[n],s=e[r],a;return s<i&&(a=n,n=r,r=a,a=i,i=s,s=a),e[n]=t.floor(i),e[r]=t.ceil(s),e}function Mm(e){return Math.log(e)}function Om(e){return Math.exp(e)}function B4(e){return-Math.log(-e)}function $4(e){return-Math.exp(-e)}function U4(e){return isFinite(e)?+("1e"+e):e<0?0:e}function P4(e){return e===10?U4:e===Math.E?Math.exp:t=>Math.pow(e,t)}function j4(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}function Rm(e){return(t,n)=>-e(-t,n)}function _w(e){const t=e(Mm,Om),n=t.domain;let r=10,i,s;function a(){return i=j4(r),s=P4(r),n()[0]<0?(i=Rm(i),s=Rm(s),e(B4,$4)):e(Mm,Om),t}return t.base=function(o){return arguments.length?(r=+o,a()):r},t.domain=function(o){return arguments.length?(n(o),a()):n()},t.ticks=o=>{const c=n();let l=c[0],u=c[c.length-1];const f=u<l;f&&([l,u]=[u,l]);let d=i(l),h=i(u),p,y;const g=o==null?10:+o;let b=[];if(!(r%1)&&h-d<g){if(d=Math.floor(d),h=Math.ceil(h),l>0){for(;d<=h;++d)for(p=1;p<r;++p)if(y=d<0?p/s(-d):p*s(d),!(y<l)){if(y>u)break;b.push(y)}}else for(;d<=h;++d)for(p=r-1;p>=1;--p)if(y=d>0?p/s(-d):p*s(d),!(y<l)){if(y>u)break;b.push(y)}b.length*2<g&&(b=Na(l,u,g))}else b=Na(d,h,Math.min(h-d,g)).map(s);return f?b.reverse():b},t.tickFormat=(o,c)=>{if(o==null&&(o=10),c==null&&(c=r===10?"s":","),typeof c!="function"&&(!(r%1)&&(c=Da(c)).precision==null&&(c.trim=!0),c=ks(c)),o===1/0)return c;const l=Math.max(1,r*o/t.ticks().length);return u=>{let f=u/s(Math.round(i(u)));return f*r<r-.5&&(f*=r),f<=l?c(u):""}},t.nice=()=>n(bw(n(),{floor:o=>s(Math.floor(i(o))),ceil:o=>s(Math.ceil(i(o)))})),t}function ww(){const e=_w(Zl()).domain([1,10]);return e.copy=()=>ro(e,ww()).base(e.base()),zn.apply(e,arguments),e}function Dm(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function Lm(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function vw(e){var t=1,n=e(Dm(t),Lm(t));return n.constant=function(r){return arguments.length?e(Dm(t=+r),Lm(t)):t},io(n)}function xw(){var e=vw(Zl());return e.copy=function(){return ro(e,xw()).constant(e.constant())},zn.apply(e,arguments)}function Fm(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function V4(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function z4(e){return e<0?-e*e:e*e}function Sw(e){var t=e(Ze,Ze),n=1;function r(){return n===1?e(Ze,Ze):n===.5?e(V4,z4):e(Fm(n),Fm(1/n))}return t.exponent=function(i){return arguments.length?(n=+i,r()):n},io(t)}function Ew(){var e=Sw(Zl());return e.copy=function(){return ro(e,Ew()).exponent(e.exponent())},zn.apply(e,arguments),e}function Tw(){var e=[],t=[],n=[],r;function i(){var a=0,o=Math.max(1,t.length);for(n=new Array(o-1);++a<o;)n[a-1]=$6(e,a/o);return s}function s(a){return a==null||isNaN(a=+a)?r:t[Ul(n,a)]}return s.invertExtent=function(a){var o=t.indexOf(a);return o<0?[NaN,NaN]:[o>0?n[o-1]:e[0],o<n.length?n[o]:e[e.length-1]]},s.domain=function(a){if(!arguments.length)return e.slice();e=[];for(let o of a)o!=null&&!isNaN(o=+o)&&e.push(o);return e.sort(Ae),i()},s.range=function(a){return arguments.length?(t=Array.from(a),i()):t.slice()},s.unknown=function(a){return arguments.length?(r=a,s):r},s.quantiles=function(){return n.slice()},s.copy=function(){return Tw().domain(e).range(t).unknown(r)},zn.apply(s,arguments)}function Aw(){var e=[.5],t=[0,1],n,r=1;function i(s){return s!=null&&s<=s?t[Ul(e,s,0,r)]:n}return i.domain=function(s){return arguments.length?(e=Array.from(s),r=Math.min(e.length,t.length-1),i):e.slice()},i.range=function(s){return arguments.length?(t=Array.from(s),r=Math.min(e.length,t.length-1),i):t.slice()},i.invertExtent=function(s){var a=t.indexOf(s);return[e[a-1],e[a]]},i.unknown=function(s){return arguments.length?(n=s,i):n},i.copy=function(){return Aw().domain(e).range(t).unknown(n)},zn.apply(i,arguments)}const Zu=new Date,tf=new Date;function Zt(e,t,n,r){function i(s){return e(s=arguments.length===0?new Date:new Date(+s)),s}return i.floor=s=>(e(s=new Date(+s)),s),i.ceil=s=>(e(s=new Date(s-1)),t(s,1),e(s),s),i.round=s=>{const a=i(s),o=i.ceil(s);return s-a<o-s?a:o},i.offset=(s,a)=>(t(s=new Date(+s),a==null?1:Math.floor(a)),s),i.range=(s,a,o)=>{const c=[];if(s=i.ceil(s),o=o==null?1:Math.floor(o),!(s<a)||!(o>0))return c;let l;do c.push(l=new Date(+s)),t(s,o),e(s);while(l<s&&s<a);return c},i.filter=s=>Zt(a=>{if(a>=a)for(;e(a),!s(a);)a.setTime(a-1)},(a,o)=>{if(a>=a)if(o<0)for(;++o<=0;)for(;t(a,-1),!s(a););else for(;--o>=0;)for(;t(a,1),!s(a););}),n&&(i.count=(s,a)=>(Zu.setTime(+s),tf.setTime(+a),e(Zu),e(tf),Math.floor(n(Zu,tf))),i.every=s=>(s=Math.floor(s),!isFinite(s)||!(s>0)?null:s>1?i.filter(r?a=>r(a)%s===0:a=>i.count(0,a)%s===0):i)),i}const ml=Zt(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);ml.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?Zt(t=>{t.setTime(Math.floor(t/e)*e)},(t,n)=>{t.setTime(+t+n*e)},(t,n)=>(n-t)/e):ml);ml.range;const sr=1e3,tn=sr*60,ar=tn*60,pr=ar*24,e0=pr*7,km=pr*30,ef=pr*365,ln=Zt(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*sr)},(e,t)=>(t-e)/sr,e=>e.getUTCSeconds());ln.range;const so=Zt(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*sr)},(e,t)=>{e.setTime(+e+t*tn)},(e,t)=>(t-e)/tn,e=>e.getMinutes());so.range;const ao=Zt(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*tn)},(e,t)=>(t-e)/tn,e=>e.getUTCMinutes());ao.range;const oo=Zt(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*sr-e.getMinutes()*tn)},(e,t)=>{e.setTime(+e+t*ar)},(e,t)=>(t-e)/ar,e=>e.getHours());oo.range;const co=Zt(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*ar)},(e,t)=>(t-e)/ar,e=>e.getUTCHours());co.range;const Ti=Zt(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*tn)/pr,e=>e.getDate()-1);Ti.range;const eu=Zt(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/pr,e=>e.getUTCDate()-1);eu.range;const nu=Zt(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/pr,e=>Math.floor(e/pr));nu.range;function Ai(e){return Zt(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,n)=>{t.setDate(t.getDate()+n*7)},(t,n)=>(n-t-(n.getTimezoneOffset()-t.getTimezoneOffset())*tn)/e0)}const ws=Ai(0),ka=Ai(1),Iw=Ai(2),Nw=Ai(3),vi=Ai(4),Mw=Ai(5),Ow=Ai(6);ws.range;ka.range;Iw.range;Nw.range;vi.range;Mw.range;Ow.range;function Ii(e){return Zt(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCDate(t.getUTCDate()+n*7)},(t,n)=>(n-t)/e0)}const vs=Ii(0),Ca=Ii(1),Rw=Ii(2),Dw=Ii(3),xi=Ii(4),Lw=Ii(5),Fw=Ii(6);vs.range;Ca.range;Rw.range;Dw.range;xi.range;Lw.range;Fw.range;const lo=Zt(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth());lo.range;const uo=Zt(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth());uo.range;const dn=Zt(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());dn.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:Zt(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,n)=>{t.setFullYear(t.getFullYear()+n*e)});dn.range;const hn=Zt(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());hn.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:Zt(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCFullYear(t.getUTCFullYear()+n*e)});hn.range;function kw(e,t,n,r,i,s){const a=[[ln,1,sr],[ln,5,5*sr],[ln,15,15*sr],[ln,30,30*sr],[s,1,tn],[s,5,5*tn],[s,15,15*tn],[s,30,30*tn],[i,1,ar],[i,3,3*ar],[i,6,6*ar],[i,12,12*ar],[r,1,pr],[r,2,2*pr],[n,1,e0],[t,1,km],[t,3,3*km],[e,1,ef]];function o(l,u,f){const d=u<l;d&&([l,u]=[u,l]);const h=f&&typeof f.range=="function"?f:c(l,u,f),p=h?h.range(l,+u+1):[];return d?p.reverse():p}function c(l,u,f){const d=Math.abs(u-l)/f,h=$l(([,,g])=>g).right(a,d);if(h===a.length)return e.every(Hf(l/ef,u/ef,f));if(h===0)return ml.every(Math.max(Hf(l,u,f),1));const[p,y]=a[d/a[h-1][2]<a[h][2]/d?h-1:h];return p.every(y)}return[o,c]}const[Y4,Cw]=kw(hn,uo,vs,nu,co,ao),[W4,H4]=kw(dn,lo,ws,Ti,oo,so);function nf(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function rf(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function Ws(e,t,n){return{y:e,m:t,d:n,H:0,M:0,S:0,L:0}}function q4(e){var t=e.dateTime,n=e.date,r=e.time,i=e.periods,s=e.days,a=e.shortDays,o=e.months,c=e.shortMonths,l=Hs(i),u=qs(i),f=Hs(s),d=qs(s),h=Hs(a),p=qs(a),y=Hs(o),g=qs(o),b=Hs(c),_=qs(c),E={a:O,A:C,b:L,B:$,c:null,d:jm,e:jm,f:yR,g:AR,G:NR,H:hR,I:pR,j:mR,L:Bw,m:gR,M:bR,p:j,q:Y,Q:Ym,s:Wm,S:_R,u:wR,U:vR,V:xR,w:SR,W:ER,x:null,X:null,y:TR,Y:IR,Z:MR,"%":zm},w={a:V,A:K,b:ot,B:yt,c:null,d:Vm,e:Vm,f:LR,g:zR,G:WR,H:OR,I:RR,j:DR,L:Uw,m:FR,M:kR,p:H,q:ct,Q:Ym,s:Wm,S:CR,u:BR,U:$R,V:UR,w:PR,W:jR,x:null,X:null,y:VR,Y:YR,Z:HR,"%":zm},A={a:F,A:N,b:B,B:W,c:D,d:Um,e:Um,f:lR,g:$m,G:Bm,H:Pm,I:Pm,j:sR,L:cR,m:iR,M:aR,p:R,q:rR,Q:fR,s:dR,S:oR,u:J4,U:Z4,V:tR,w:Q4,W:eR,x:S,X:I,y:$m,Y:Bm,Z:nR,"%":uR};E.x=x(n,E),E.X=x(r,E),E.c=x(t,E),w.x=x(n,w),w.X=x(r,w),w.c=x(t,w);function x(U,z){return function(G){var k=[],xt=-1,lt=0,Ot=U.length,Pt,le,Tr;for(G instanceof Date||(G=new Date(+G));++xt<Ot;)U.charCodeAt(xt)===37&&(k.push(U.slice(lt,xt)),(le=Cm[Pt=U.charAt(++xt)])!=null?Pt=U.charAt(++xt):le=Pt==="e"?" ":"0",(Tr=z[Pt])&&(Pt=Tr(G,le)),k.push(Pt),lt=xt+1);return k.push(U.slice(lt,xt)),k.join("")}}function T(U,z){return function(G){var k=Ws(1900,void 0,1),xt=M(k,U,G+="",0),lt,Ot;if(xt!=G.length)return null;if("Q"in k)return new Date(k.Q);if("s"in k)return new Date(k.s*1e3+("L"in k?k.L:0));if(z&&!("Z"in k)&&(k.Z=0),"p"in k&&(k.H=k.H%12+k.p*12),k.m===void 0&&(k.m="q"in k?k.q:0),"V"in k){if(k.V<1||k.V>53)return null;"w"in k||(k.w=1),"Z"in k?(lt=rf(Ws(k.y,0,1)),Ot=lt.getUTCDay(),lt=Ot>4||Ot===0?Ca.ceil(lt):Ca(lt),lt=eu.offset(lt,(k.V-1)*7),k.y=lt.getUTCFullYear(),k.m=lt.getUTCMonth(),k.d=lt.getUTCDate()+(k.w+6)%7):(lt=nf(Ws(k.y,0,1)),Ot=lt.getDay(),lt=Ot>4||Ot===0?ka.ceil(lt):ka(lt),lt=Ti.offset(lt,(k.V-1)*7),k.y=lt.getFullYear(),k.m=lt.getMonth(),k.d=lt.getDate()+(k.w+6)%7)}else("W"in k||"U"in k)&&("w"in k||(k.w="u"in k?k.u%7:"W"in k?1:0),Ot="Z"in k?rf(Ws(k.y,0,1)).getUTCDay():nf(Ws(k.y,0,1)).getDay(),k.m=0,k.d="W"in k?(k.w+6)%7+k.W*7-(Ot+5)%7:k.w+k.U*7-(Ot+6)%7);return"Z"in k?(k.H+=k.Z/100|0,k.M+=k.Z%100,rf(k)):nf(k)}}function M(U,z,G,k){for(var xt=0,lt=z.length,Ot=G.length,Pt,le;xt<lt;){if(k>=Ot)return-1;if(Pt=z.charCodeAt(xt++),Pt===37){if(Pt=z.charAt(xt++),le=A[Pt in Cm?z.charAt(xt++):Pt],!le||(k=le(U,G,k))<0)return-1}else if(Pt!=G.charCodeAt(k++))return-1}return k}function R(U,z,G){var k=l.exec(z.slice(G));return k?(U.p=u.get(k[0].toLowerCase()),G+k[0].length):-1}function F(U,z,G){var k=h.exec(z.slice(G));return k?(U.w=p.get(k[0].toLowerCase()),G+k[0].length):-1}function N(U,z,G){var k=f.exec(z.slice(G));return k?(U.w=d.get(k[0].toLowerCase()),G+k[0].length):-1}function B(U,z,G){var k=b.exec(z.slice(G));return k?(U.m=_.get(k[0].toLowerCase()),G+k[0].length):-1}function W(U,z,G){var k=y.exec(z.slice(G));return k?(U.m=g.get(k[0].toLowerCase()),G+k[0].length):-1}function D(U,z,G){return M(U,t,z,G)}function S(U,z,G){return M(U,n,z,G)}function I(U,z,G){return M(U,r,z,G)}function O(U){return a[U.getDay()]}function C(U){return s[U.getDay()]}function L(U){return c[U.getMonth()]}function $(U){return o[U.getMonth()]}function j(U){return i[+(U.getHours()>=12)]}function Y(U){return 1+~~(U.getMonth()/3)}function V(U){return a[U.getUTCDay()]}function K(U){return s[U.getUTCDay()]}function ot(U){return c[U.getUTCMonth()]}function yt(U){return o[U.getUTCMonth()]}function H(U){return i[+(U.getUTCHours()>=12)]}function ct(U){return 1+~~(U.getUTCMonth()/3)}return{format:function(U){var z=x(U+="",E);return z.toString=function(){return U},z},parse:function(U){var z=T(U+="",!1);return z.toString=function(){return U},z},utcFormat:function(U){var z=x(U+="",w);return z.toString=function(){return U},z},utcParse:function(U){var z=T(U+="",!0);return z.toString=function(){return U},z}}}var Cm={"-":"",_:" ",0:"0"},se=/^\s*\d+/,G4=/^%/,X4=/[\\^$*+?|[\]().{}]/g;function Mt(e,t,n){var r=e<0?"-":"",i=(r?-e:e)+"",s=i.length;return r+(s<n?new Array(n-s+1).join(t)+i:i)}function K4(e){return e.replace(X4,"\\$&")}function Hs(e){return new RegExp("^(?:"+e.map(K4).join("|")+")","i")}function qs(e){return new Map(e.map((t,n)=>[t.toLowerCase(),n]))}function Q4(e,t,n){var r=se.exec(t.slice(n,n+1));return r?(e.w=+r[0],n+r[0].length):-1}function J4(e,t,n){var r=se.exec(t.slice(n,n+1));return r?(e.u=+r[0],n+r[0].length):-1}function Z4(e,t,n){var r=se.exec(t.slice(n,n+2));return r?(e.U=+r[0],n+r[0].length):-1}function tR(e,t,n){var r=se.exec(t.slice(n,n+2));return r?(e.V=+r[0],n+r[0].length):-1}function eR(e,t,n){var r=se.exec(t.slice(n,n+2));return r?(e.W=+r[0],n+r[0].length):-1}function Bm(e,t,n){var r=se.exec(t.slice(n,n+4));return r?(e.y=+r[0],n+r[0].length):-1}function $m(e,t,n){var r=se.exec(t.slice(n,n+2));return r?(e.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function nR(e,t,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(n,n+6));return r?(e.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function rR(e,t,n){var r=se.exec(t.slice(n,n+1));return r?(e.q=r[0]*3-3,n+r[0].length):-1}function iR(e,t,n){var r=se.exec(t.slice(n,n+2));return r?(e.m=r[0]-1,n+r[0].length):-1}function Um(e,t,n){var r=se.exec(t.slice(n,n+2));return r?(e.d=+r[0],n+r[0].length):-1}function sR(e,t,n){var r=se.exec(t.slice(n,n+3));return r?(e.m=0,e.d=+r[0],n+r[0].length):-1}function Pm(e,t,n){var r=se.exec(t.slice(n,n+2));return r?(e.H=+r[0],n+r[0].length):-1}function aR(e,t,n){var r=se.exec(t.slice(n,n+2));return r?(e.M=+r[0],n+r[0].length):-1}function oR(e,t,n){var r=se.exec(t.slice(n,n+2));return r?(e.S=+r[0],n+r[0].length):-1}function cR(e,t,n){var r=se.exec(t.slice(n,n+3));return r?(e.L=+r[0],n+r[0].length):-1}function lR(e,t,n){var r=se.exec(t.slice(n,n+6));return r?(e.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function uR(e,t,n){var r=G4.exec(t.slice(n,n+1));return r?n+r[0].length:-1}function fR(e,t,n){var r=se.exec(t.slice(n));return r?(e.Q=+r[0],n+r[0].length):-1}function dR(e,t,n){var r=se.exec(t.slice(n));return r?(e.s=+r[0],n+r[0].length):-1}function jm(e,t){return Mt(e.getDate(),t,2)}function hR(e,t){return Mt(e.getHours(),t,2)}function pR(e,t){return Mt(e.getHours()%12||12,t,2)}function mR(e,t){return Mt(1+Ti.count(dn(e),e),t,3)}function Bw(e,t){return Mt(e.getMilliseconds(),t,3)}function yR(e,t){return Bw(e,t)+"000"}function gR(e,t){return Mt(e.getMonth()+1,t,2)}function bR(e,t){return Mt(e.getMinutes(),t,2)}function _R(e,t){return Mt(e.getSeconds(),t,2)}function wR(e){var t=e.getDay();return t===0?7:t}function vR(e,t){return Mt(ws.count(dn(e)-1,e),t,2)}function $w(e){var t=e.getDay();return t>=4||t===0?vi(e):vi.ceil(e)}function xR(e,t){return e=$w(e),Mt(vi.count(dn(e),e)+(dn(e).getDay()===4),t,2)}function SR(e){return e.getDay()}function ER(e,t){return Mt(ka.count(dn(e)-1,e),t,2)}function TR(e,t){return Mt(e.getFullYear()%100,t,2)}function AR(e,t){return e=$w(e),Mt(e.getFullYear()%100,t,2)}function IR(e,t){return Mt(e.getFullYear()%1e4,t,4)}function NR(e,t){var n=e.getDay();return e=n>=4||n===0?vi(e):vi.ceil(e),Mt(e.getFullYear()%1e4,t,4)}function MR(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+Mt(t/60|0,"0",2)+Mt(t%60,"0",2)}function Vm(e,t){return Mt(e.getUTCDate(),t,2)}function OR(e,t){return Mt(e.getUTCHours(),t,2)}function RR(e,t){return Mt(e.getUTCHours()%12||12,t,2)}function DR(e,t){return Mt(1+eu.count(hn(e),e),t,3)}function Uw(e,t){return Mt(e.getUTCMilliseconds(),t,3)}function LR(e,t){return Uw(e,t)+"000"}function FR(e,t){return Mt(e.getUTCMonth()+1,t,2)}function kR(e,t){return Mt(e.getUTCMinutes(),t,2)}function CR(e,t){return Mt(e.getUTCSeconds(),t,2)}function BR(e){var t=e.getUTCDay();return t===0?7:t}function $R(e,t){return Mt(vs.count(hn(e)-1,e),t,2)}function Pw(e){var t=e.getUTCDay();return t>=4||t===0?xi(e):xi.ceil(e)}function UR(e,t){return e=Pw(e),Mt(xi.count(hn(e),e)+(hn(e).getUTCDay()===4),t,2)}function PR(e){return e.getUTCDay()}function jR(e,t){return Mt(Ca.count(hn(e)-1,e),t,2)}function VR(e,t){return Mt(e.getUTCFullYear()%100,t,2)}function zR(e,t){return e=Pw(e),Mt(e.getUTCFullYear()%100,t,2)}function YR(e,t){return Mt(e.getUTCFullYear()%1e4,t,4)}function WR(e,t){var n=e.getUTCDay();return e=n>=4||n===0?xi(e):xi.ceil(e),Mt(e.getUTCFullYear()%1e4,t,4)}function HR(){return"+0000"}function zm(){return"%"}function Ym(e){return+e}function Wm(e){return Math.floor(+e/1e3)}var Ci,n0,fo;qR({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function qR(e){return Ci=q4(e),n0=Ci.format,Ci.parse,fo=Ci.utcFormat,Ci.utcParse,Ci}function GR(e){return new Date(e)}function XR(e){return e instanceof Date?+e:+new Date(+e)}function r0(e,t,n,r,i,s,a,o,c,l){var u=yw(),f=u.invert,d=u.domain,h=l(".%L"),p=l(":%S"),y=l("%I:%M"),g=l("%I %p"),b=l("%a %d"),_=l("%b %d"),E=l("%B"),w=l("%Y");function A(x){return(c(x)<x?h:o(x)<x?p:a(x)<x?y:s(x)<x?g:r(x)<x?i(x)<x?b:_:n(x)<x?E:w)(x)}return u.invert=function(x){return new Date(f(x))},u.domain=function(x){return arguments.length?d(Array.from(x,XR)):d().map(GR)},u.ticks=function(x){var T=d();return e(T[0],T[T.length-1],x??10)},u.tickFormat=function(x,T){return T==null?A:l(T)},u.nice=function(x){var T=d();return(!x||typeof x.range!="function")&&(x=t(T[0],T[T.length-1],x??10)),x?d(bw(T,x)):u},u.copy=function(){return ro(u,r0(e,t,n,r,i,s,a,o,c,l))},u}function KR(){return zn.apply(r0(W4,H4,dn,lo,ws,Ti,oo,so,ln,n0).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function QR(){return zn.apply(r0(Y4,Cw,hn,uo,vs,eu,co,ao,ln,fo).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function ru(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function iu(){var e=0,t=.5,n=1,r=1,i,s,a,o,c,l=Ze,u,f=!1,d;function h(y){return isNaN(y=+y)?d:(y=.5+((y=+u(y))-s)*(r*y<r*s?o:c),l(f?Math.max(0,Math.min(1,y)):y))}h.domain=function(y){return arguments.length?([e,t,n]=y,i=u(e=+e),s=u(t=+t),a=u(n=+n),o=i===s?0:.5/(s-i),c=s===a?0:.5/(a-s),r=s<i?-1:1,h):[e,t,n]},h.clamp=function(y){return arguments.length?(f=!!y,h):f},h.interpolator=function(y){return arguments.length?(l=y,h):l};function p(y){return function(g){var b,_,E;return arguments.length?([b,_,E]=g,l=Hl(y,[b,_,E]),h):[l(0),l(.5),l(1)]}}return h.range=p(eo),h.rangeRound=p(Vh),h.unknown=function(y){return arguments.length?(d=y,h):d},function(y){return u=y,i=y(e),s=y(t),a=y(n),o=i===s?0:.5/(s-i),c=s===a?0:.5/(a-s),r=s<i?-1:1,h}}function jw(){var e=io(iu()(Ze));return e.copy=function(){return ru(e,jw())},Ql.apply(e,arguments)}function Vw(){var e=_w(iu()).domain([.1,1,10]);return e.copy=function(){return ru(e,Vw()).base(e.base())},Ql.apply(e,arguments)}function zw(){var e=vw(iu());return e.copy=function(){return ru(e,zw()).constant(e.constant())},Ql.apply(e,arguments)}function Yw(){var e=Sw(iu());return e.copy=function(){return ru(e,Yw()).exponent(e.exponent())},Ql.apply(e,arguments)}function mt(e){for(var t=e.length/6|0,n=new Array(t),r=0;r<t;)n[r]="#"+e.slice(r*6,++r*6);return n}const JR=mt("1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf"),ZR=mt("7fc97fbeaed4fdc086ffff99386cb0f0027fbf5b17666666"),t8=mt("1b9e77d95f027570b3e7298a66a61ee6ab02a6761d666666"),e8=mt("4269d0efb118ff725c6cc5b03ca951ff8ab7a463f297bbf59c6b4e9498a0"),n8=mt("a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928"),r8=mt("fbb4aeb3cde3ccebc5decbe4fed9a6ffffcce5d8bdfddaecf2f2f2"),i8=mt("b3e2cdfdcdaccbd5e8f4cae4e6f5c9fff2aef1e2cccccccc"),s8=mt("e41a1c377eb84daf4a984ea3ff7f00ffff33a65628f781bf999999"),a8=mt("66c2a5fc8d628da0cbe78ac3a6d854ffd92fe5c494b3b3b3"),o8=mt("8dd3c7ffffb3bebadafb807280b1d3fdb462b3de69fccde5d9d9d9bc80bdccebc5ffed6f"),c8=mt("4e79a7f28e2ce1575976b7b259a14fedc949af7aa1ff9da79c755fbab0ab"),Bt=e=>tM(e[e.length-1]);var Ww=new Array(3).concat("d8b365f5f5f55ab4ac","a6611adfc27d80cdc1018571","a6611adfc27df5f5f580cdc1018571","8c510ad8b365f6e8c3c7eae55ab4ac01665e","8c510ad8b365f6e8c3f5f5f5c7eae55ab4ac01665e","8c510abf812ddfc27df6e8c3c7eae580cdc135978f01665e","8c510abf812ddfc27df6e8c3f5f5f5c7eae580cdc135978f01665e","5430058c510abf812ddfc27df6e8c3c7eae580cdc135978f01665e003c30","5430058c510abf812ddfc27df6e8c3f5f5f5c7eae580cdc135978f01665e003c30").map(mt);const Hw=Bt(Ww);var qw=new Array(3).concat("af8dc3f7f7f77fbf7b","7b3294c2a5cfa6dba0008837","7b3294c2a5cff7f7f7a6dba0008837","762a83af8dc3e7d4e8d9f0d37fbf7b1b7837","762a83af8dc3e7d4e8f7f7f7d9f0d37fbf7b1b7837","762a839970abc2a5cfe7d4e8d9f0d3a6dba05aae611b7837","762a839970abc2a5cfe7d4e8f7f7f7d9f0d3a6dba05aae611b7837","40004b762a839970abc2a5cfe7d4e8d9f0d3a6dba05aae611b783700441b","40004b762a839970abc2a5cfe7d4e8f7f7f7d9f0d3a6dba05aae611b783700441b").map(mt);const Gw=Bt(qw);var Xw=new Array(3).concat("e9a3c9f7f7f7a1d76a","d01c8bf1b6dab8e1864dac26","d01c8bf1b6daf7f7f7b8e1864dac26","c51b7de9a3c9fde0efe6f5d0a1d76a4d9221","c51b7de9a3c9fde0eff7f7f7e6f5d0a1d76a4d9221","c51b7dde77aef1b6dafde0efe6f5d0b8e1867fbc414d9221","c51b7dde77aef1b6dafde0eff7f7f7e6f5d0b8e1867fbc414d9221","8e0152c51b7dde77aef1b6dafde0efe6f5d0b8e1867fbc414d9221276419","8e0152c51b7dde77aef1b6dafde0eff7f7f7e6f5d0b8e1867fbc414d9221276419").map(mt);const Kw=Bt(Xw);var Qw=new Array(3).concat("998ec3f7f7f7f1a340","5e3c99b2abd2fdb863e66101","5e3c99b2abd2f7f7f7fdb863e66101","542788998ec3d8daebfee0b6f1a340b35806","542788998ec3d8daebf7f7f7fee0b6f1a340b35806","5427888073acb2abd2d8daebfee0b6fdb863e08214b35806","5427888073acb2abd2d8daebf7f7f7fee0b6fdb863e08214b35806","2d004b5427888073acb2abd2d8daebfee0b6fdb863e08214b358067f3b08","2d004b5427888073acb2abd2d8daebf7f7f7fee0b6fdb863e08214b358067f3b08").map(mt);const Jw=Bt(Qw);var Ed=new Array(3).concat("ef8a62f7f7f767a9cf","ca0020f4a58292c5de0571b0","ca0020f4a582f7f7f792c5de0571b0","b2182bef8a62fddbc7d1e5f067a9cf2166ac","b2182bef8a62fddbc7f7f7f7d1e5f067a9cf2166ac","b2182bd6604df4a582fddbc7d1e5f092c5de4393c32166ac","b2182bd6604df4a582fddbc7f7f7f7d1e5f092c5de4393c32166ac","67001fb2182bd6604df4a582fddbc7d1e5f092c5de4393c32166ac053061","67001fb2182bd6604df4a582fddbc7f7f7f7d1e5f092c5de4393c32166ac053061").map(mt);const yl=Bt(Ed);var Zw=new Array(3).concat("ef8a62ffffff999999","ca0020f4a582bababa404040","ca0020f4a582ffffffbababa404040","b2182bef8a62fddbc7e0e0e09999994d4d4d","b2182bef8a62fddbc7ffffffe0e0e09999994d4d4d","b2182bd6604df4a582fddbc7e0e0e0bababa8787874d4d4d","b2182bd6604df4a582fddbc7ffffffe0e0e0bababa8787874d4d4d","67001fb2182bd6604df4a582fddbc7e0e0e0bababa8787874d4d4d1a1a1a","67001fb2182bd6604df4a582fddbc7ffffffe0e0e0bababa8787874d4d4d1a1a1a").map(mt);const tv=Bt(Zw);var Td=new Array(3).concat("fc8d59ffffbf91bfdb","d7191cfdae61abd9e92c7bb6","d7191cfdae61ffffbfabd9e92c7bb6","d73027fc8d59fee090e0f3f891bfdb4575b4","d73027fc8d59fee090ffffbfe0f3f891bfdb4575b4","d73027f46d43fdae61fee090e0f3f8abd9e974add14575b4","d73027f46d43fdae61fee090ffffbfe0f3f8abd9e974add14575b4","a50026d73027f46d43fdae61fee090e0f3f8abd9e974add14575b4313695","a50026d73027f46d43fdae61fee090ffffbfe0f3f8abd9e974add14575b4313695").map(mt);const gl=Bt(Td);var ev=new Array(3).concat("fc8d59ffffbf91cf60","d7191cfdae61a6d96a1a9641","d7191cfdae61ffffbfa6d96a1a9641","d73027fc8d59fee08bd9ef8b91cf601a9850","d73027fc8d59fee08bffffbfd9ef8b91cf601a9850","d73027f46d43fdae61fee08bd9ef8ba6d96a66bd631a9850","d73027f46d43fdae61fee08bffffbfd9ef8ba6d96a66bd631a9850","a50026d73027f46d43fdae61fee08bd9ef8ba6d96a66bd631a9850006837","a50026d73027f46d43fdae61fee08bffffbfd9ef8ba6d96a66bd631a9850006837").map(mt);const nv=Bt(ev);var rv=new Array(3).concat("fc8d59ffffbf99d594","d7191cfdae61abdda42b83ba","d7191cfdae61ffffbfabdda42b83ba","d53e4ffc8d59fee08be6f59899d5943288bd","d53e4ffc8d59fee08bffffbfe6f59899d5943288bd","d53e4ff46d43fdae61fee08be6f598abdda466c2a53288bd","d53e4ff46d43fdae61fee08bffffbfe6f598abdda466c2a53288bd","9e0142d53e4ff46d43fdae61fee08be6f598abdda466c2a53288bd5e4fa2","9e0142d53e4ff46d43fdae61fee08bffffbfe6f598abdda466c2a53288bd5e4fa2").map(mt);const iv=Bt(rv);var sv=new Array(3).concat("e5f5f999d8c92ca25f","edf8fbb2e2e266c2a4238b45","edf8fbb2e2e266c2a42ca25f006d2c","edf8fbccece699d8c966c2a42ca25f006d2c","edf8fbccece699d8c966c2a441ae76238b45005824","f7fcfde5f5f9ccece699d8c966c2a441ae76238b45005824","f7fcfde5f5f9ccece699d8c966c2a441ae76238b45006d2c00441b").map(mt);const av=Bt(sv);var ov=new Array(3).concat("e0ecf49ebcda8856a7","edf8fbb3cde38c96c688419d","edf8fbb3cde38c96c68856a7810f7c","edf8fbbfd3e69ebcda8c96c68856a7810f7c","edf8fbbfd3e69ebcda8c96c68c6bb188419d6e016b","f7fcfde0ecf4bfd3e69ebcda8c96c68c6bb188419d6e016b","f7fcfde0ecf4bfd3e69ebcda8c96c68c6bb188419d810f7c4d004b").map(mt);const cv=Bt(ov);var lv=new Array(3).concat("e0f3dba8ddb543a2ca","f0f9e8bae4bc7bccc42b8cbe","f0f9e8bae4bc7bccc443a2ca0868ac","f0f9e8ccebc5a8ddb57bccc443a2ca0868ac","f0f9e8ccebc5a8ddb57bccc44eb3d32b8cbe08589e","f7fcf0e0f3dbccebc5a8ddb57bccc44eb3d32b8cbe08589e","f7fcf0e0f3dbccebc5a8ddb57bccc44eb3d32b8cbe0868ac084081").map(mt);const uv=Bt(lv);var fv=new Array(3).concat("fee8c8fdbb84e34a33","fef0d9fdcc8afc8d59d7301f","fef0d9fdcc8afc8d59e34a33b30000","fef0d9fdd49efdbb84fc8d59e34a33b30000","fef0d9fdd49efdbb84fc8d59ef6548d7301f990000","fff7ecfee8c8fdd49efdbb84fc8d59ef6548d7301f990000","fff7ecfee8c8fdd49efdbb84fc8d59ef6548d7301fb300007f0000").map(mt);const dv=Bt(fv);var hv=new Array(3).concat("ece2f0a6bddb1c9099","f6eff7bdc9e167a9cf02818a","f6eff7bdc9e167a9cf1c9099016c59","f6eff7d0d1e6a6bddb67a9cf1c9099016c59","f6eff7d0d1e6a6bddb67a9cf3690c002818a016450","fff7fbece2f0d0d1e6a6bddb67a9cf3690c002818a016450","fff7fbece2f0d0d1e6a6bddb67a9cf3690c002818a016c59014636").map(mt);const pv=Bt(hv);var mv=new Array(3).concat("ece7f2a6bddb2b8cbe","f1eef6bdc9e174a9cf0570b0","f1eef6bdc9e174a9cf2b8cbe045a8d","f1eef6d0d1e6a6bddb74a9cf2b8cbe045a8d","f1eef6d0d1e6a6bddb74a9cf3690c00570b0034e7b","fff7fbece7f2d0d1e6a6bddb74a9cf3690c00570b0034e7b","fff7fbece7f2d0d1e6a6bddb74a9cf3690c00570b0045a8d023858").map(mt);const yv=Bt(mv);var gv=new Array(3).concat("e7e1efc994c7dd1c77","f1eef6d7b5d8df65b0ce1256","f1eef6d7b5d8df65b0dd1c77980043","f1eef6d4b9dac994c7df65b0dd1c77980043","f1eef6d4b9dac994c7df65b0e7298ace125691003f","f7f4f9e7e1efd4b9dac994c7df65b0e7298ace125691003f","f7f4f9e7e1efd4b9dac994c7df65b0e7298ace125698004367001f").map(mt);const bv=Bt(gv);var _v=new Array(3).concat("fde0ddfa9fb5c51b8a","feebe2fbb4b9f768a1ae017e","feebe2fbb4b9f768a1c51b8a7a0177","feebe2fcc5c0fa9fb5f768a1c51b8a7a0177","feebe2fcc5c0fa9fb5f768a1dd3497ae017e7a0177","fff7f3fde0ddfcc5c0fa9fb5f768a1dd3497ae017e7a0177","fff7f3fde0ddfcc5c0fa9fb5f768a1dd3497ae017e7a017749006a").map(mt);const wv=Bt(_v);var vv=new Array(3).concat("edf8b17fcdbb2c7fb8","ffffcca1dab441b6c4225ea8","ffffcca1dab441b6c42c7fb8253494","ffffccc7e9b47fcdbb41b6c42c7fb8253494","ffffccc7e9b47fcdbb41b6c41d91c0225ea80c2c84","ffffd9edf8b1c7e9b47fcdbb41b6c41d91c0225ea80c2c84","ffffd9edf8b1c7e9b47fcdbb41b6c41d91c0225ea8253494081d58").map(mt);const xv=Bt(vv);var Sv=new Array(3).concat("f7fcb9addd8e31a354","ffffccc2e69978c679238443","ffffccc2e69978c67931a354006837","ffffccd9f0a3addd8e78c67931a354006837","ffffccd9f0a3addd8e78c67941ab5d238443005a32","ffffe5f7fcb9d9f0a3addd8e78c67941ab5d238443005a32","ffffe5f7fcb9d9f0a3addd8e78c67941ab5d238443006837004529").map(mt);const Ev=Bt(Sv);var Tv=new Array(3).concat("fff7bcfec44fd95f0e","ffffd4fed98efe9929cc4c02","ffffd4fed98efe9929d95f0e993404","ffffd4fee391fec44ffe9929d95f0e993404","ffffd4fee391fec44ffe9929ec7014cc4c028c2d04","ffffe5fff7bcfee391fec44ffe9929ec7014cc4c028c2d04","ffffe5fff7bcfee391fec44ffe9929ec7014cc4c02993404662506").map(mt);const Av=Bt(Tv);var Iv=new Array(3).concat("ffeda0feb24cf03b20","ffffb2fecc5cfd8d3ce31a1c","ffffb2fecc5cfd8d3cf03b20bd0026","ffffb2fed976feb24cfd8d3cf03b20bd0026","ffffb2fed976feb24cfd8d3cfc4e2ae31a1cb10026","ffffccffeda0fed976feb24cfd8d3cfc4e2ae31a1cb10026","ffffccffeda0fed976feb24cfd8d3cfc4e2ae31a1cbd0026800026").map(mt);const Nv=Bt(Iv);var Mv=new Array(3).concat("deebf79ecae13182bd","eff3ffbdd7e76baed62171b5","eff3ffbdd7e76baed63182bd08519c","eff3ffc6dbef9ecae16baed63182bd08519c","eff3ffc6dbef9ecae16baed64292c62171b5084594","f7fbffdeebf7c6dbef9ecae16baed64292c62171b5084594","f7fbffdeebf7c6dbef9ecae16baed64292c62171b508519c08306b").map(mt);const Ov=Bt(Mv);var Rv=new Array(3).concat("e5f5e0a1d99b31a354","edf8e9bae4b374c476238b45","edf8e9bae4b374c47631a354006d2c","edf8e9c7e9c0a1d99b74c47631a354006d2c","edf8e9c7e9c0a1d99b74c47641ab5d238b45005a32","f7fcf5e5f5e0c7e9c0a1d99b74c47641ab5d238b45005a32","f7fcf5e5f5e0c7e9c0a1d99b74c47641ab5d238b45006d2c00441b").map(mt);const Dv=Bt(Rv);var Lv=new Array(3).concat("f0f0f0bdbdbd636363","f7f7f7cccccc969696525252","f7f7f7cccccc969696636363252525","f7f7f7d9d9d9bdbdbd969696636363252525","f7f7f7d9d9d9bdbdbd969696737373525252252525","fffffff0f0f0d9d9d9bdbdbd969696737373525252252525","fffffff0f0f0d9d9d9bdbdbd969696737373525252252525000000").map(mt);const Fv=Bt(Lv);var kv=new Array(3).concat("efedf5bcbddc756bb1","f2f0f7cbc9e29e9ac86a51a3","f2f0f7cbc9e29e9ac8756bb154278f","f2f0f7dadaebbcbddc9e9ac8756bb154278f","f2f0f7dadaebbcbddc9e9ac8807dba6a51a34a1486","fcfbfdefedf5dadaebbcbddc9e9ac8807dba6a51a34a1486","fcfbfdefedf5dadaebbcbddc9e9ac8807dba6a51a354278f3f007d").map(mt);const Cv=Bt(kv);var Bv=new Array(3).concat("fee0d2fc9272de2d26","fee5d9fcae91fb6a4acb181d","fee5d9fcae91fb6a4ade2d26a50f15","fee5d9fcbba1fc9272fb6a4ade2d26a50f15","fee5d9fcbba1fc9272fb6a4aef3b2ccb181d99000d","fff5f0fee0d2fcbba1fc9272fb6a4aef3b2ccb181d99000d","fff5f0fee0d2fcbba1fc9272fb6a4aef3b2ccb181da50f1567000d").map(mt);const $v=Bt(Bv);var Uv=new Array(3).concat("fee6cefdae6be6550d","feeddefdbe85fd8d3cd94701","feeddefdbe85fd8d3ce6550da63603","feeddefdd0a2fdae6bfd8d3ce6550da63603","feeddefdd0a2fdae6bfd8d3cf16913d948018c2d04","fff5ebfee6cefdd0a2fdae6bfd8d3cf16913d948018c2d04","fff5ebfee6cefdd0a2fdae6bfd8d3cf16913d94801a636037f2704").map(mt);const Pv=Bt(Uv);function jv(e){return e=Math.max(0,Math.min(1,e)),"rgb("+Math.max(0,Math.min(255,Math.round(-4.54-e*(35.34-e*(2381.73-e*(6402.7-e*(7024.72-e*2710.57)))))))+", "+Math.max(0,Math.min(255,Math.round(32.49+e*(170.73+e*(52.82-e*(131.46-e*(176.58-e*67.37)))))))+", "+Math.max(0,Math.min(255,Math.round(81.24+e*(442.36-e*(2482.43-e*(6167.24-e*(6614.94-e*2475.67)))))))+")"}const Vv=zh(Un(300,.5,0),Un(-240,.5,1));var zv=zh(Un(-100,.75,.35),Un(80,1.5,.8)),Yv=zh(Un(260,.75,.35),Un(80,1.5,.8)),Uo=Un();function Wv(e){(e<0||e>1)&&(e-=Math.floor(e));var t=Math.abs(e-.5);return Uo.h=360*e-100,Uo.s=1.5-1.5*t,Uo.l=.8-.9*t,Uo+""}var Po=Pr(),l8=Math.PI/3,u8=Math.PI*2/3;function Hv(e){var t;return e=(.5-e)*Math.PI,Po.r=255*(t=Math.sin(e))*t,Po.g=255*(t=Math.sin(e+l8))*t,Po.b=255*(t=Math.sin(e+u8))*t,Po+""}function qv(e){return e=Math.max(0,Math.min(1,e)),"rgb("+Math.max(0,Math.min(255,Math.round(34.61+e*(1172.33-e*(10793.56-e*(33300.12-e*(38394.49-e*14825.05)))))))+", "+Math.max(0,Math.min(255,Math.round(23.31+e*(557.33+e*(1225.33-e*(3574.96-e*(1073.77+e*707.56)))))))+", "+Math.max(0,Math.min(255,Math.round(27.2+e*(3211.1-e*(15327.97-e*(27814-e*(22569.18-e*6838.66)))))))+")"}function su(e){var t=e.length;return function(n){return e[Math.max(0,Math.min(t-1,Math.floor(n*t)))]}}const Gv=su(mt("44015444025645045745055946075a46085c460a5d460b5e470d60470e6147106347116447136548146748166848176948186a481a6c481b6d481c6e481d6f481f70482071482173482374482475482576482677482878482979472a7a472c7a472d7b472e7c472f7d46307e46327e46337f463480453581453781453882443983443a83443b84433d84433e85423f854240864241864142874144874045884046883f47883f48893e49893e4a893e4c8a3d4d8a3d4e8a3c4f8a3c508b3b518b3b528b3a538b3a548c39558c39568c38588c38598c375a8c375b8d365c8d365d8d355e8d355f8d34608d34618d33628d33638d32648e32658e31668e31678e31688e30698e306a8e2f6b8e2f6c8e2e6d8e2e6e8e2e6f8e2d708e2d718e2c718e2c728e2c738e2b748e2b758e2a768e2a778e2a788e29798e297a8e297b8e287c8e287d8e277e8e277f8e27808e26818e26828e26828e25838e25848e25858e24868e24878e23888e23898e238a8d228b8d228c8d228d8d218e8d218f8d21908d21918c20928c20928c20938c1f948c1f958b1f968b1f978b1f988b1f998a1f9a8a1e9b8a1e9c891e9d891f9e891f9f881fa0881fa1881fa1871fa28720a38620a48621a58521a68522a78522a88423a98324aa8325ab8225ac8226ad8127ad8128ae8029af7f2ab07f2cb17e2db27d2eb37c2fb47c31b57b32b67a34b67935b77937b87838b9773aba763bbb753dbc743fbc7340bd7242be7144bf7046c06f48c16e4ac16d4cc26c4ec36b50c46a52c56954c56856c66758c7655ac8645cc8635ec96260ca6063cb5f65cb5e67cc5c69cd5b6ccd5a6ece5870cf5773d05675d05477d1537ad1517cd2507fd34e81d34d84d44b86d54989d5488bd6468ed64590d74393d74195d84098d83e9bd93c9dd93ba0da39a2da37a5db36a8db34aadc32addc30b0dd2fb2dd2db5de2bb8de29bade28bddf26c0df25c2df23c5e021c8e020cae11fcde11dd0e11cd2e21bd5e21ad8e219dae319dde318dfe318e2e418e5e419e7e419eae51aece51befe51cf1e51df4e61ef6e620f8e621fbe723fde725"));var Xv=su(mt("00000401000501010601010802010902020b02020d03030f03031204041405041606051806051a07061c08071e0907200a08220b09240c09260d0a290e0b2b100b2d110c2f120d31130d34140e36150e38160f3b180f3d19103f1a10421c10441d11471e114920114b21114e22115024125325125527125829115a2a115c2c115f2d11612f116331116533106734106936106b38106c390f6e3b0f703d0f713f0f72400f74420f75440f764510774710784910784a10794c117a4e117b4f127b51127c52137c54137d56147d57157e59157e5a167e5c167f5d177f5f187f601880621980641a80651a80671b80681c816a1c816b1d816d1d816e1e81701f81721f817320817521817621817822817922827b23827c23827e24828025828125818326818426818627818827818928818b29818c29818e2a81902a81912b81932b80942c80962c80982d80992d809b2e7f9c2e7f9e2f7fa02f7fa1307ea3307ea5317ea6317da8327daa337dab337cad347cae347bb0357bb2357bb3367ab5367ab73779b83779ba3878bc3978bd3977bf3a77c03a76c23b75c43c75c53c74c73d73c83e73ca3e72cc3f71cd4071cf4070d0416fd2426fd3436ed5446dd6456cd8456cd9466bdb476adc4869de4968df4a68e04c67e24d66e34e65e44f64e55064e75263e85362e95462ea5661eb5760ec5860ed5a5fee5b5eef5d5ef05f5ef1605df2625df2645cf3655cf4675cf4695cf56b5cf66c5cf66e5cf7705cf7725cf8745cf8765cf9785df9795df97b5dfa7d5efa7f5efa815ffb835ffb8560fb8761fc8961fc8a62fc8c63fc8e64fc9065fd9266fd9467fd9668fd9869fd9a6afd9b6bfe9d6cfe9f6dfea16efea36ffea571fea772fea973feaa74feac76feae77feb078feb27afeb47bfeb67cfeb77efeb97ffebb81febd82febf84fec185fec287fec488fec68afec88cfeca8dfecc8ffecd90fecf92fed194fed395fed597fed799fed89afdda9cfddc9efddea0fde0a1fde2a3fde3a5fde5a7fde7a9fde9aafdebacfcecaefceeb0fcf0b2fcf2b4fcf4b6fcf6b8fcf7b9fcf9bbfcfbbdfcfdbf")),Kv=su(mt("00000401000501010601010802010a02020c02020e03021004031204031405041706041907051b08051d09061f0a07220b07240c08260d08290e092b10092d110a30120a32140b34150b37160b39180c3c190c3e1b0c411c0c431e0c451f0c48210c4a230c4c240c4f260c51280b53290b552b0b572d0b592f0a5b310a5c320a5e340a5f3609613809623909633b09643d09653e0966400a67420a68440a68450a69470b6a490b6a4a0c6b4c0c6b4d0d6c4f0d6c510e6c520e6d540f6d550f6d57106e59106e5a116e5c126e5d126e5f136e61136e62146e64156e65156e67166e69166e6a176e6c186e6d186e6f196e71196e721a6e741a6e751b6e771c6d781c6d7a1d6d7c1d6d7d1e6d7f1e6c801f6c82206c84206b85216b87216b88226a8a226a8c23698d23698f24699025689225689326679526679727669827669a28659b29649d29649f2a63a02a63a22b62a32c61a52c60a62d60a82e5fa92e5eab2f5ead305dae305cb0315bb1325ab3325ab43359b63458b73557b93556ba3655bc3754bd3853bf3952c03a51c13a50c33b4fc43c4ec63d4dc73e4cc83f4bca404acb4149cc4248ce4347cf4446d04545d24644d34743d44842d54a41d74b3fd84c3ed94d3dda4e3cdb503bdd513ade5238df5337e05536e15635e25734e35933e45a31e55c30e65d2fe75e2ee8602de9612bea632aeb6429eb6628ec6726ed6925ee6a24ef6c23ef6e21f06f20f1711ff1731df2741cf3761bf37819f47918f57b17f57d15f67e14f68013f78212f78410f8850ff8870ef8890cf98b0bf98c0af98e09fa9008fa9207fa9407fb9606fb9706fb9906fb9b06fb9d07fc9f07fca108fca309fca50afca60cfca80dfcaa0ffcac11fcae12fcb014fcb216fcb418fbb61afbb81dfbba1ffbbc21fbbe23fac026fac228fac42afac62df9c72ff9c932f9cb35f8cd37f8cf3af7d13df7d340f6d543f6d746f5d949f5db4cf4dd4ff4df53f4e156f3e35af3e55df2e661f2e865f2ea69f1ec6df1ed71f1ef75f1f179f2f27df2f482f3f586f3f68af4f88ef5f992f6fa96f8fb9af9fc9dfafda1fcffa4")),Qv=su(mt("0d088710078813078916078a19068c1b068d1d068e20068f2206902406912605912805922a05932c05942e05952f059631059733059735049837049938049a3a049a3c049b3e049c3f049c41049d43039e44039e46039f48039f4903a04b03a14c02a14e02a25002a25102a35302a35502a45601a45801a45901a55b01a55c01a65e01a66001a66100a76300a76400a76600a76700a86900a86a00a86c00a86e00a86f00a87100a87201a87401a87501a87701a87801a87a02a87b02a87d03a87e03a88004a88104a78305a78405a78606a68707a68808a68a09a58b0aa58d0ba58e0ca48f0da4910ea3920fa39410a29511a19613a19814a099159f9a169f9c179e9d189d9e199da01a9ca11b9ba21d9aa31e9aa51f99a62098a72197a82296aa2395ab2494ac2694ad2793ae2892b02991b12a90b22b8fb32c8eb42e8db52f8cb6308bb7318ab83289ba3388bb3488bc3587bd3786be3885bf3984c03a83c13b82c23c81c33d80c43e7fc5407ec6417dc7427cc8437bc9447aca457acb4679cc4778cc4977cd4a76ce4b75cf4c74d04d73d14e72d24f71d35171d45270d5536fd5546ed6556dd7566cd8576bd9586ada5a6ada5b69db5c68dc5d67dd5e66de5f65de6164df6263e06363e16462e26561e26660e3685fe4695ee56a5de56b5de66c5ce76e5be76f5ae87059e97158e97257ea7457eb7556eb7655ec7754ed7953ed7a52ee7b51ef7c51ef7e50f07f4ff0804ef1814df1834cf2844bf3854bf3874af48849f48948f58b47f58c46f68d45f68f44f79044f79143f79342f89441f89540f9973ff9983ef99a3efa9b3dfa9c3cfa9e3bfb9f3afba139fba238fca338fca537fca636fca835fca934fdab33fdac33fdae32fdaf31fdb130fdb22ffdb42ffdb52efeb72dfeb82cfeba2cfebb2bfebd2afebe2afec029fdc229fdc328fdc527fdc627fdc827fdca26fdcb26fccd25fcce25fcd025fcd225fbd324fbd524fbd724fad824fada24f9dc24f9dd25f8df25f8e125f7e225f7e425f6e626f6e826f5e926f5eb27f4ed27f3ee27f3f027f2f227f1f426f1f525f0f724f0f921"));function ne(e){return function(){return e}}const Jv=Math.cos,i0=Math.min,bl=Math.sin,te=Math.sqrt,Hm=1e-12,_l=Math.PI,au=2*_l;function Zv(e){let t=3;return e.digits=function(n){if(!arguments.length)return t;if(n==null)t=null;else{const r=Math.floor(n);if(!(r>=0))throw new RangeError(`invalid digits: ${n}`);t=r}return e},()=>new L1(t)}function t2(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function e2(e){this._context=e}e2.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function ho(e){return new e2(e)}function n2(e){return e[0]}function r2(e){return e[1]}function i2(e,t){var n=ne(!0),r=null,i=ho,s=null,a=Zv(o);e=typeof e=="function"?e:e===void 0?n2:ne(e),t=typeof t=="function"?t:t===void 0?r2:ne(t);function o(c){var l,u=(c=t2(c)).length,f,d=!1,h;for(r==null&&(s=i(h=a())),l=0;l<=u;++l)!(l<u&&n(f=c[l],l,c))===d&&((d=!d)?s.lineStart():s.lineEnd()),d&&s.point(+e(f,l,c),+t(f,l,c));if(h)return s=null,h+""||null}return o.x=function(c){return arguments.length?(e=typeof c=="function"?c:ne(+c),o):e},o.y=function(c){return arguments.length?(t=typeof c=="function"?c:ne(+c),o):t},o.defined=function(c){return arguments.length?(n=typeof c=="function"?c:ne(!!c),o):n},o.curve=function(c){return arguments.length?(i=c,r!=null&&(s=i(r)),o):i},o.context=function(c){return arguments.length?(c==null?r=s=null:s=i(r=c),o):r},o}function f8(e,t,n){var r=null,i=ne(!0),s=null,a=ho,o=null,c=Zv(l);e=typeof e=="function"?e:e===void 0?n2:ne(+e),t=typeof t=="function"?t:ne(t===void 0?0:+t),n=typeof n=="function"?n:n===void 0?r2:ne(+n);function l(f){var d,h,p,y=(f=t2(f)).length,g,b=!1,_,E=new Array(y),w=new Array(y);for(s==null&&(o=a(_=c())),d=0;d<=y;++d){if(!(d<y&&i(g=f[d],d,f))===b)if(b=!b)h=d,o.areaStart(),o.lineStart();else{for(o.lineEnd(),o.lineStart(),p=d-1;p>=h;--p)o.point(E[p],w[p]);o.lineEnd(),o.areaEnd()}b&&(E[d]=+e(g,d,f),w[d]=+t(g,d,f),o.point(r?+r(g,d,f):E[d],n?+n(g,d,f):w[d]))}if(_)return o=null,_+""||null}function u(){return i2().defined(i).curve(a).context(s)}return l.x=function(f){return arguments.length?(e=typeof f=="function"?f:ne(+f),r=null,l):e},l.x0=function(f){return arguments.length?(e=typeof f=="function"?f:ne(+f),l):e},l.x1=function(f){return arguments.length?(r=f==null?null:typeof f=="function"?f:ne(+f),l):r},l.y=function(f){return arguments.length?(t=typeof f=="function"?f:ne(+f),n=null,l):t},l.y0=function(f){return arguments.length?(t=typeof f=="function"?f:ne(+f),l):t},l.y1=function(f){return arguments.length?(n=f==null?null:typeof f=="function"?f:ne(+f),l):n},l.lineX0=l.lineY0=function(){return u().x(e).y(t)},l.lineY1=function(){return u().x(e).y(n)},l.lineX1=function(){return u().x(r).y(t)},l.defined=function(f){return arguments.length?(i=typeof f=="function"?f:ne(!!f),l):i},l.curve=function(f){return arguments.length?(a=f,s!=null&&(o=a(s)),l):a},l.context=function(f){return arguments.length?(f==null?s=o=null:o=a(s=f),l):s},l}class s2{constructor(t,n){this._context=t,this._x=n}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(t,n){switch(t=+t,n=+n,this._point){case 0:{this._point=1,this._line?this._context.lineTo(t,n):this._context.moveTo(t,n);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+t)/2,this._y0,this._x0,n,t,n):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+n)/2,t,this._y0,t,n);break}}this._x0=t,this._y0=n}}function d8(e){return new s2(e,!0)}function h8(e){return new s2(e,!1)}const p8=te(3),a2={draw(e,t){const n=te(t+i0(t/28,.75))*.59436,r=n/2,i=r*p8;e.moveTo(0,n),e.lineTo(0,-n),e.moveTo(-i,-r),e.lineTo(i,r),e.moveTo(-i,r),e.lineTo(i,-r)}},Ba={draw(e,t){const n=te(t/_l);e.moveTo(n,0),e.arc(0,0,n,0,au)}},o2={draw(e,t){const n=te(t/5)/2;e.moveTo(-3*n,-n),e.lineTo(-n,-n),e.lineTo(-n,-3*n),e.lineTo(n,-3*n),e.lineTo(n,-n),e.lineTo(3*n,-n),e.lineTo(3*n,n),e.lineTo(n,n),e.lineTo(n,3*n),e.lineTo(-n,3*n),e.lineTo(-n,n),e.lineTo(-3*n,n),e.closePath()}},c2=te(1/3),m8=c2*2,l2={draw(e,t){const n=te(t/m8),r=n*c2;e.moveTo(0,-n),e.lineTo(r,0),e.lineTo(0,n),e.lineTo(-r,0),e.closePath()}},u2={draw(e,t){const n=te(t)*.62625;e.moveTo(0,-n),e.lineTo(n,0),e.lineTo(0,n),e.lineTo(-n,0),e.closePath()}},f2={draw(e,t){const n=te(t-i0(t/7,2))*.87559;e.moveTo(-n,0),e.lineTo(n,0),e.moveTo(0,n),e.lineTo(0,-n)}},d2={draw(e,t){const n=te(t),r=-n/2;e.rect(r,r,n,n)}},h2={draw(e,t){const n=te(t)*.4431;e.moveTo(n,n),e.lineTo(n,-n),e.lineTo(-n,-n),e.lineTo(-n,n),e.closePath()}},y8=.8908130915292852,p2=bl(_l/10)/bl(7*_l/10),g8=bl(au/10)*p2,b8=-Jv(au/10)*p2,m2={draw(e,t){const n=te(t*y8),r=g8*n,i=b8*n;e.moveTo(0,-n),e.lineTo(r,i);for(let s=1;s<5;++s){const a=au*s/5,o=Jv(a),c=bl(a);e.lineTo(c*n,-o*n),e.lineTo(o*r-c*i,c*r+o*i)}e.closePath()}},sf=te(3),y2={draw(e,t){const n=-te(t/(sf*3));e.moveTo(0,n*2),e.lineTo(-sf*n,-n),e.lineTo(sf*n,-n),e.closePath()}},_8=te(3),g2={draw(e,t){const n=te(t)*.6824,r=n/2,i=n*_8/2;e.moveTo(0,-n),e.lineTo(i,r),e.lineTo(-i,r),e.closePath()}},Ye=-.5,We=te(3)/2,Ad=1/te(12),w8=(Ad/2+1)*3,b2={draw(e,t){const n=te(t/w8),r=n/2,i=n*Ad,s=r,a=n*Ad+n,o=-s,c=a;e.moveTo(r,i),e.lineTo(s,a),e.lineTo(o,c),e.lineTo(Ye*r-We*i,We*r+Ye*i),e.lineTo(Ye*s-We*a,We*s+Ye*a),e.lineTo(Ye*o-We*c,We*o+Ye*c),e.lineTo(Ye*r+We*i,Ye*i-We*r),e.lineTo(Ye*s+We*a,Ye*a-We*s),e.lineTo(Ye*o+We*c,Ye*c-We*o),e.closePath()}},_2={draw(e,t){const n=te(t-i0(t/6,1.7))*.6189;e.moveTo(-n,-n),e.lineTo(n,n),e.moveTo(-n,n),e.lineTo(n,-n)}},v8=[Ba,o2,l2,d2,m2,y2,b2],x8=[Ba,f2,_2,g2,a2,h2,u2];function jr(){}function wl(e,t,n){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+n)/6)}function ou(e){this._context=e}ou.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:wl(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:wl(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function S8(e){return new ou(e)}function w2(e){this._context=e}w2.prototype={areaStart:jr,areaEnd:jr,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:wl(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function E8(e){return new w2(e)}function v2(e){this._context=e}v2.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+e)/6,r=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(n,r):this._context.moveTo(n,r);break;case 3:this._point=4;default:wl(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function T8(e){return new v2(e)}function x2(e,t){this._basis=new ou(e),this._beta=t}x2.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var e=this._x,t=this._y,n=e.length-1;if(n>0)for(var r=e[0],i=t[0],s=e[n]-r,a=t[n]-i,o=-1,c;++o<=n;)c=o/n,this._basis.point(this._beta*e[o]+(1-this._beta)*(r+c*s),this._beta*t[o]+(1-this._beta)*(i+c*a));this._x=this._y=null,this._basis.lineEnd()},point:function(e,t){this._x.push(+e),this._y.push(+t)}};const A8=(function e(t){function n(r){return t===1?new ou(r):new x2(r,t)}return n.beta=function(r){return e(+r)},n})(.85);function vl(e,t,n){e._context.bezierCurveTo(e._x1+e._k*(e._x2-e._x0),e._y1+e._k*(e._y2-e._y0),e._x2+e._k*(e._x1-t),e._y2+e._k*(e._y1-n),e._x2,e._y2)}function s0(e,t){this._context=e,this._k=(1-t)/6}s0.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:vl(this,this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2,this._x1=e,this._y1=t;break;case 2:this._point=3;default:vl(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const I8=(function e(t){function n(r){return new s0(r,t)}return n.tension=function(r){return e(+r)},n})(0);function a0(e,t){this._context=e,this._k=(1-t)/6}a0.prototype={areaStart:jr,areaEnd:jr,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3),this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3),this._context.closePath();break}case 3:{this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:vl(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const N8=(function e(t){function n(r){return new a0(r,t)}return n.tension=function(r){return e(+r)},n})(0);function o0(e,t){this._context=e,this._k=(1-t)/6}o0.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:vl(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const M8=(function e(t){function n(r){return new o0(r,t)}return n.tension=function(r){return e(+r)},n})(0);function c0(e,t,n){var r=e._x1,i=e._y1,s=e._x2,a=e._y2;if(e._l01_a>Hm){var o=2*e._l01_2a+3*e._l01_a*e._l12_a+e._l12_2a,c=3*e._l01_a*(e._l01_a+e._l12_a);r=(r*o-e._x0*e._l12_2a+e._x2*e._l01_2a)/c,i=(i*o-e._y0*e._l12_2a+e._y2*e._l01_2a)/c}if(e._l23_a>Hm){var l=2*e._l23_2a+3*e._l23_a*e._l12_a+e._l12_2a,u=3*e._l23_a*(e._l23_a+e._l12_a);s=(s*l+e._x1*e._l23_2a-t*e._l12_2a)/u,a=(a*l+e._y1*e._l23_2a-n*e._l12_2a)/u}e._context.bezierCurveTo(r,i,s,a,e._x2,e._y2)}function S2(e,t){this._context=e,this._alpha=t}S2.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3;default:c0(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const O8=(function e(t){function n(r){return t?new S2(r,t):new s0(r,0)}return n.alpha=function(r){return e(+r)},n})(.5);function E2(e,t){this._context=e,this._alpha=t}E2.prototype={areaStart:jr,areaEnd:jr,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3),this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3),this._context.closePath();break}case 3:{this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}}},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:c0(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const R8=(function e(t){function n(r){return t?new E2(r,t):new a0(r,0)}return n.alpha=function(r){return e(+r)},n})(.5);function T2(e,t){this._context=e,this._alpha=t}T2.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:c0(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const D8=(function e(t){function n(r){return t?new T2(r,t):new o0(r,0)}return n.alpha=function(r){return e(+r)},n})(.5);function A2(e){this._context=e}A2.prototype={areaStart:jr,areaEnd:jr,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function L8(e){return new A2(e)}function qm(e){return e<0?-1:1}function Gm(e,t,n){var r=e._x1-e._x0,i=t-e._x1,s=(e._y1-e._y0)/(r||i<0&&-0),a=(n-e._y1)/(i||r<0&&-0),o=(s*i+a*r)/(r+i);return(qm(s)+qm(a))*Math.min(Math.abs(s),Math.abs(a),.5*Math.abs(o))||0}function Xm(e,t){var n=e._x1-e._x0;return n?(3*(e._y1-e._y0)/n-t)/2:t}function af(e,t,n){var r=e._x0,i=e._y0,s=e._x1,a=e._y1,o=(s-r)/3;e._context.bezierCurveTo(r+o,i+o*t,s-o,a-o*n,s,a)}function xl(e){this._context=e}xl.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:af(this,this._t0,Xm(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var n=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,af(this,Xm(this,n=Gm(this,e,t)),n);break;default:af(this,this._t0,n=Gm(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=n}}};function I2(e){this._context=new N2(e)}(I2.prototype=Object.create(xl.prototype)).point=function(e,t){xl.prototype.point.call(this,t,e)};function N2(e){this._context=e}N2.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,n,r,i,s){this._context.bezierCurveTo(t,e,r,n,s,i)}};function F8(e){return new xl(e)}function k8(e){return new I2(e)}function M2(e){this._context=e}M2.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,n=e.length;if(n)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),n===2)this._context.lineTo(e[1],t[1]);else for(var r=Km(e),i=Km(t),s=0,a=1;a<n;++s,++a)this._context.bezierCurveTo(r[0][s],i[0][s],r[1][s],i[1][s],e[a],t[a]);(this._line||this._line!==0&&n===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function Km(e){var t,n=e.length-1,r,i=new Array(n),s=new Array(n),a=new Array(n);for(i[0]=0,s[0]=2,a[0]=e[0]+2*e[1],t=1;t<n-1;++t)i[t]=1,s[t]=4,a[t]=4*e[t]+2*e[t+1];for(i[n-1]=2,s[n-1]=7,a[n-1]=8*e[n-1]+e[n],t=1;t<n;++t)r=i[t]/s[t-1],s[t]-=r,a[t]-=r*a[t-1];for(i[n-1]=a[n-1]/s[n-1],t=n-2;t>=0;--t)i[t]=(a[t]-i[t+1])/s[t];for(s[n-1]=(e[n]+i[n-1])/2,t=0;t<n-1;++t)s[t]=2*e[t+1]-i[t+1];return[i,s]}function C8(e){return new M2(e)}function cu(e,t){this._context=e,this._t=t}cu.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var n=this._x*(1-this._t)+e*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,t)}break}}this._x=e,this._y=t}};function B8(e){return new cu(e,.5)}function $8(e){return new cu(e,0)}function U8(e){return new cu(e,1)}function fa(e,t,n){this.k=e,this.x=t,this.y=n}fa.prototype={constructor:fa,scale:function(e){return e===1?this:new fa(this.k*e,this.x,this.y)},translate:function(e,t){return e===0&t===0?this:new fa(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};fa.prototype;function Vr(e){return e!=null&&!Number.isNaN(e)}function pn(e,t){return+Vr(t)-+Vr(e)||Ae(e,t)}function Sl(e,t){return+Vr(t)-+Vr(e)||Ja(e,t)}function l0(e){return e!=null&&`${e}`!=""}function O2(e){return isFinite(e)?e:NaN}function po(e){return e>0&&isFinite(e)?e:NaN}function lu(e){return e<0&&isFinite(e)?e:NaN}function P8(e,t){if(e instanceof Date||(e=new Date(+e)),isNaN(e))return typeof t=="function"?t(e):t;const n=e.getUTCHours(),r=e.getUTCMinutes(),i=e.getUTCSeconds(),s=e.getUTCMilliseconds();return`${j8(e.getUTCFullYear())}-${tr(e.getUTCMonth()+1,2)}-${tr(e.getUTCDate(),2)}${n||r||i||s?`T${tr(n,2)}:${tr(r,2)}${i||s?`:${tr(i,2)}${s?`.${tr(s,3)}`:""}`:""}Z`:""}`}function j8(e){return e<0?`-${tr(-e,6)}`:e>9999?`+${tr(e,6)}`:tr(e,4)}function tr(e,t){return`${e}`.padStart(t,"0")}const V8=/^(?:[-+]\d{2})?\d{4}(?:-\d{2}(?:-\d{2})?)?(?:T\d{2}:\d{2}(?::\d{2}(?:\.\d{3})?)?(?:Z|[-+]\d{2}:?\d{2})?)?$/;function R2(e,t){return V8.test(e+="")?new Date(e):typeof t=="function"?t(e):t}function xs(e){if(e==null)return;const t=e[0],n=e[e.length-1];return Ja(t,n)}const Qi=1e3,Dr=Qi*60,Lr=Dr*60,Pn=Lr*24,Sn=Pn*7,ui=Pn*30,Nr=Pn*365,of=[["millisecond",1],["2 milliseconds",2],["5 milliseconds",5],["10 milliseconds",10],["20 milliseconds",20],["50 milliseconds",50],["100 milliseconds",100],["200 milliseconds",200],["500 milliseconds",500],["second",Qi],["5 seconds",5*Qi],["15 seconds",15*Qi],["30 seconds",30*Qi],["minute",Dr],["5 minutes",5*Dr],["15 minutes",15*Dr],["30 minutes",30*Dr],["hour",Lr],["3 hours",3*Lr],["6 hours",6*Lr],["12 hours",12*Lr],["day",Pn],["2 days",2*Pn],["week",Sn],["2 weeks",2*Sn],["month",ui],["3 months",3*ui],["6 months",6*ui],["year",Nr],["2 years",2*Nr],["5 years",5*Nr],["10 years",10*Nr],["20 years",20*Nr],["50 years",50*Nr],["100 years",100*Nr]],u0=new Map([["second",Qi],["minute",Dr],["hour",Lr],["day",Pn],["monday",Sn],["tuesday",Sn],["wednesday",Sn],["thursday",Sn],["friday",Sn],["saturday",Sn],["sunday",Sn],["week",Sn],["month",ui],["year",Nr]]),D2=new Map([["second",ln],["minute",so],["hour",oo],["day",Ti],["monday",ka],["tuesday",Iw],["wednesday",Nw],["thursday",vi],["friday",Mw],["saturday",Ow],["sunday",ws],["week",ws],["month",lo],["year",dn]]),f0=new Map([["second",ln],["minute",ao],["hour",co],["day",nu],["monday",Ca],["tuesday",Rw],["wednesday",Dw],["thursday",xi],["friday",Lw],["saturday",Fw],["sunday",vs],["week",vs],["month",uo],["year",hn]]),mo=Symbol("intervalDuration"),uu=Symbol("intervalType");for(const[e,t]of D2)t[mo]=u0.get(e),t[uu]="time";for(const[e,t]of f0)t[mo]=u0.get(e),t[uu]="utc";const da=[["year",hn,"utc"],["month",uo,"utc"],["day",nu,"utc",6*ui],["hour",co,"utc",3*Pn],["minute",ao,"utc",6*Lr],["second",ln,"utc",30*Dr]],pc=[["year",dn,"time"],["month",lo,"time"],["day",Ti,"time",6*ui],["hour",oo,"time",3*Pn],["minute",so,"time",6*Lr],["second",ln,"time",30*Dr]],z8=[da[0],pc[0],da[1],pc[1],da[2],pc[2],...da.slice(3)];function L2(e){let t=`${e}`.toLowerCase();t.endsWith("s")&&(t=t.slice(0,-1));let n=1;const r=/^(?:(\d+)\s+)/.exec(t);switch(r&&(t=t.slice(r[0].length),n=+r[1]),t){case"quarter":t="month",n*=3;break;case"half":t="month",n*=6;break}let i=f0.get(t);if(!i)throw new Error(`unknown interval: ${e}`);if(n>1&&!i.every)throw new Error(`non-periodic interval: ${t}`);return[t,n]}function F2(e){return k2(L2(e),"time")}function fu(e){return k2(L2(e),"utc")}function k2([e,t],n){let r=(n==="time"?D2:f0).get(e);return t>1&&(r=r.every(t),r[mo]=u0.get(e)*t,r[uu]=n),r}function Qm(e,t){if(!(t>1))return;const n=e[mo];if(!of.some(([,i])=>i===n)||n%Pn===0&&Pn<n&&n<ui)return;const[r]=of[$l(([,i])=>Math.log(i)).center(of,Math.log(n*t))];return(e[uu]==="time"?F2:fu)(r)}function Jm(e,t,n){const r=t==="time"?n0:fo;if(n==null)return r(e==="year"?"%Y":e==="month"?"%Y-%m":e==="day"?"%Y-%m-%d":e==="hour"||e==="minute"?"%Y-%m-%dT%H:%M":e==="second"?"%Y-%m-%dT%H:%M:%S":"%Y-%m-%dT%H:%M:%S.%L");const i=Y8(n);switch(e){case"millisecond":return Bi(r(".%L"),r(":%M:%S"),i);case"second":return Bi(r(":%S"),r("%-I:%M"),i);case"minute":return Bi(r("%-I:%M"),r("%p"),i);case"hour":return Bi(r("%-I %p"),r("%b %-d"),i);case"day":return Bi(r("%-d"),r("%b"),i);case"month":return Bi(r("%b"),r("%Y"),i);case"year":return r("%Y")}throw new Error("unable to format time ticks")}function Y8(e){return e==="left"||e==="right"?(t,n)=>`
${t}
${n}`:e==="top"?(t,n)=>`${n}
${t}`:(t,n)=>`${t}
${n}`}function W8(e){return e==="time"?pc:e==="utc"?da:z8}function H8(e,t,n){const r=je(z6(t,(i,s)=>Math.abs(s-i)));if(r<1e3)return Jm("millisecond","utc",n);for(const[i,s,a,o]of W8(e)){if(r>o||i==="hour"&&!r)break;if(t.every(c=>s.floor(c)>=c))return Jm(i,a,n)}}function Bi(e,t,n){return(r,i,s)=>{const a=e(r,i),o=t(r,i),c=i-xs(s);return i!==c&&s[c]!==void 0&&o===t(s[c],c)?a:n(a,o)}}const d0=Object.getPrototypeOf(Uint8Array),q8=Object.prototype.toString;function Ni(e){return e instanceof Array||e instanceof d0}function C2(e){return e instanceof d0&&!G8(e)}function B2(e){return e?.prototype instanceof d0&&!X8(e)}function G8(e){return e instanceof BigInt64Array||e instanceof BigUint64Array}function X8(e){return e===BigInt64Array||e===BigUint64Array}const $2=Symbol("reindex");function Gt(e,t,n){const r=typeof t;return r==="string"?J2(e)?h0(e.getChild(t),n):Zm(e,U2(t),n):r==="function"?Zm(e,t,n):r==="number"||t instanceof Date||r==="boolean"?Xt(e,or(t),n):typeof t?.transform=="function"?Id(t.transform(e),n):K8(Id(t,n),e?.[$2])}function K8(e,t){return e!=null&&t?b0(e,t):e}function Zm(e,t,n){return Xt(e,B2(n)?(r,i)=>m0(t(r,i)):t,n)}function Id(e,t){return t===void 0?Mi(e):Z2(e)?h0(e,t):e instanceof t?e:t.from(e,B2(t)&&!C2(e)?m0:void 0)}function h0(e,t){return e==null?e:(t===void 0||t===Array)&&pD(e.type)?P2(ty(e)):Id(ty(e),t)}function ty(e){return e.nullCount?e.toJSON():e.toArray()}const mc=[null],U2=e=>t=>{const n=t[e];return n===void 0&&t.type==="Feature"?t.properties?.[e]:n},Si={transform:Sr},Kt={transform:e=>e},Q8=()=>1,J8=()=>!0,de=e=>e==null?e:`${e}`,pe=e=>e==null?e:+e,p0=e=>e?e[0]:void 0,El=e=>e?e[1]:void 0,or=e=>()=>e;function Z8(e){const t=+`${e}`.slice(1)/100;return(n,r)=>hs(n,t,r)}function Dn(e){return C2(e)?e:Xt(e,m0,Float64Array)}function m0(e){return e==null?NaN:Number(e)}function P2(e){return Xt(e,j2)}function j2(e){return e instanceof Date&&!isNaN(e)?e:typeof e=="string"?R2(e):e==null||isNaN(e=Number(e))?void 0:new Date(e)}function mr(e,t){return e===void 0&&(e=t),e===null?[void 0,"none"]:pu(e)?[void 0,e]:[e,void 0]}function me(e,t){return e===void 0&&(e=t),e===null||typeof e=="number"?[void 0,e]:[e,void 0]}function V2(e,t,n){if(e!=null)return bn(e,t,n)}function bn(e,t,n){const r=`${e}`.toLowerCase();if(!n.includes(r))throw new Error(`invalid ${t}: ${e}`);return r}function Ss(e){return J2(e)?e:Mi(e)}function Mi(e){if(e==null||Ni(e))return e;if(Z2(e))return h0(e);if(z2(e))switch(e.type){case"FeatureCollection":return e.features;case"GeometryCollection":return e.geometries;default:return[e]}return Array.from(e)}function z2(e){switch(e?.type){case"FeatureCollection":case"GeometryCollection":case"Feature":case"LineString":case"MultiLineString":case"MultiPoint":case"MultiPolygon":case"Point":case"Polygon":case"Sphere":return!0;default:return!1}}function Xt(e,t,n=Array){return e==null?e:e instanceof n?e.map(t):n.from(e,t)}function $a(e,t=Array){return e instanceof t?e.slice():t.from(e)}function Y2({x:e,x1:t,x2:n}){return e!==void 0||t!==void 0||n!==void 0}function W2({y:e,y1:t,y2:n}){return e!==void 0||t!==void 0||n!==void 0}function y0(e){return Y2(e)||W2(e)||e.interval!==void 0}function xr(e){return e?.toString===q8}function Nd(e){return xr(e)&&(e.type!==void 0||e.domain!==void 0)}function du(e){return xr(e)&&typeof e.transform!="function"}function Es(e){return du(e)&&e.value===void 0&&e.channel===void 0}function H2(e,t,n,r=Kt){return t===void 0&&n===void 0?(t=0,n=e===void 0?r:e):t===void 0?t=e===void 0?0:e:n===void 0&&(n=e===void 0?0:e),[t,n]}function hu(e,t){return e===void 0&&t===void 0?[p0,El]:[e,t]}function g0({z:e,fill:t,stroke:n}={}){return e===void 0&&([e]=mr(t)),e===void 0&&([e]=mr(n)),e}function Ua(e){return Ni(e)?e.length:e?.numRows}function Sr(e){const t=Ua(e),n=new Uint32Array(t);for(let r=0;r<t;++r)n[r]=r;return n}function b0(e,t){return Ni(e)?Xt(t,n=>e[n],e.constructor):Xt(t,n=>e.at(n))}function tD(e,t,n){return e.subarray?e.subarray(t,n):e.slice(t,n)}function cr(e){return e!==null&&typeof e=="object"?e.valueOf():e}function eD(e,t){if(t[e]!==void 0)return t[e];switch(e){case"x1":case"x2":e="x";break;case"y1":case"y2":e="y";break}return t[e]}function Tl(e){let t;return[{transform:()=>t,label:Oi(e)},n=>t=n]}function Kn(e){return e==null?[e]:Tl(e)}function Oi(e,t){return typeof e=="string"?e:e&&e.label!==void 0?e.label:t}function Al(e,t){return{transform(n){const r=e.transform(n),i=t.transform(n);return Re(r)||Re(i)?Xt(r,(s,a)=>new Date((+r[a]+ +i[a])/2)):Xt(r,(s,a)=>(+r[a]+ +i[a])/2,Float64Array)},label:e.label}}function q2(e,t){const n=G2(t?.interval,t?.type);return n?Xt(e,n):e}function G2(e,t){const n=_0(e,t);return n&&(r=>Vr(r)?n.floor(r):r)}function _0(e,t){if(e!=null){if(typeof e=="number")return nD(e);if(typeof e=="string")return(t==="time"?F2:fu)(e);if(typeof e.floor!="function")throw new Error("invalid interval; missing floor method");if(typeof e.offset!="function")throw new Error("invalid interval; missing offset method");return e}}function nD(e){e=+e,0<e&&e<1&&Number.isInteger(1/e)&&(e=-1/e);const t=Math.abs(e);return e<0?{floor:n=>Math.floor(n*t)/t,offset:(n,r=1)=>(n*t+Math.floor(r))/t,range:(n,r)=>Gf(Math.ceil(n*t),r*t).map(i=>i/t)}:{floor:n=>Math.floor(n/t)*t,offset:(n,r=1)=>n+t*Math.floor(r),range:(n,r)=>Gf(Math.ceil(n/t),r/t).map(i=>i*t)}}function Bs(e,t){if(e=_0(e,t),e&&typeof e.range!="function")throw new Error("invalid interval: missing range method");return e}function rD(e,t){if(e=Bs(e,t),e&&typeof e.ceil!="function")throw new Error("invalid interval: missing ceil method");return e}function iD(e){return Ji(e)&&typeof e?.floor=="function"&&e.floor()instanceof Date}function Ji(e){return typeof e?.range=="function"}function yo(e){return e===void 0||du(e)?e:{value:e}}function sD(e){return e==null?null:{transform:t=>Gt(t,e,Float64Array),label:Oi(e)}}function Gr(e){return e&&typeof e[Symbol.iterator]=="function"}function X2(e){for(const t of e)if(t!=null)return typeof t!="object"||t instanceof Date}function ey(e){for(const t of e){if(t==null)continue;const n=typeof t;return n==="string"||n==="boolean"}}function Re(e){for(const t of e)if(t!=null)return t instanceof Date}function aD(e){for(const t of e)if(t!=null)return typeof t=="string"&&isNaN(t)&&R2(t)}function oD(e){for(const t of e)if(t!=null){if(typeof t!="string")return!1;if(t.trim())return!isNaN(t)}}function cD(e){for(const t of e)if(t!=null)return typeof t=="number"}function cf(e,t){let n;for(const r of e)if(r!=null){if(!t(r))return!1;n=!0}return n}const lD=new Set("none,currentcolor,transparent,aliceblue,antiquewhite,aqua,aquamarine,azure,beige,bisque,black,blanchedalmond,blue,blueviolet,brown,burlywood,cadetblue,chartreuse,chocolate,coral,cornflowerblue,cornsilk,crimson,cyan,darkblue,darkcyan,darkgoldenrod,darkgray,darkgreen,darkgrey,darkkhaki,darkmagenta,darkolivegreen,darkorange,darkorchid,darkred,darksalmon,darkseagreen,darkslateblue,darkslategray,darkslategrey,darkturquoise,darkviolet,deeppink,deepskyblue,dimgray,dimgrey,dodgerblue,firebrick,floralwhite,forestgreen,fuchsia,gainsboro,ghostwhite,gold,goldenrod,gray,green,greenyellow,grey,honeydew,hotpink,indianred,indigo,ivory,khaki,lavender,lavenderblush,lawngreen,lemonchiffon,lightblue,lightcoral,lightcyan,lightgoldenrodyellow,lightgray,lightgreen,lightgrey,lightpink,lightsalmon,lightseagreen,lightskyblue,lightslategray,lightslategrey,lightsteelblue,lightyellow,lime,limegreen,linen,magenta,maroon,mediumaquamarine,mediumblue,mediumorchid,mediumpurple,mediumseagreen,mediumslateblue,mediumspringgreen,mediumturquoise,mediumvioletred,midnightblue,mintcream,mistyrose,moccasin,navajowhite,navy,oldlace,olive,olivedrab,orange,orangered,orchid,palegoldenrod,palegreen,paleturquoise,palevioletred,papayawhip,peachpuff,peru,pink,plum,powderblue,purple,rebeccapurple,red,rosybrown,royalblue,saddlebrown,salmon,sandybrown,seagreen,seashell,sienna,silver,skyblue,slateblue,slategray,slategrey,snow,springgreen,steelblue,tan,teal,thistle,tomato,turquoise,violet,wheat,white,whitesmoke,yellow".split(","));function pu(e){return typeof e!="string"?!1:(e=e.toLowerCase().trim(),/^#[0-9a-f]{3,8}$/.test(e)||/^(?:url|var|rgb|rgba|hsl|hsla|hwb|lab|lch|oklab|oklch|color|color-mix)\(.*\)$/.test(e)||lD.has(e))}function uD(e){return typeof e=="number"&&(0<=e&&e<=1||isNaN(e))}function Te(e){return e==null||Pa(e)}function Pa(e){return/^\s*none\s*$/i.test(e)}function fD(e){return/^\s*round\s*$/i.test(e)}function Md(e,t){return V2(e,t,["middle","top-left","top","top-right","right","bottom-right","bottom","bottom-left","left"])}function mu(e="middle"){return Md(e,"frameAnchor")}function dD(e={},...t){let n=e;for(const r of t)for(const i in r)if(n[i]===void 0){const s=r[i];n===e?n={...n,[i]:s}:n[i]=s}return n}function hD(e){console.warn("named iterables are deprecated; please use an object instead");const t=new Set;return Object.fromEntries(Array.from(e,n=>{const{name:r}=n;if(r==null)throw new Error("missing name");const i=`${r}`;if(i==="__proto__")throw new Error(`illegal name: ${i}`);if(t.has(i))throw new Error(`duplicate name: ${i}`);return t.add(i),[r,n]}))}function K2(e){return Gr(e)?hD(e):e}function Q2(e){return e===!0?e="frame":e===!1?e=null:!z2(e)&&e!=null&&(e=bn(e,"clip",["frame","sphere"]),e==="sphere"&&(e={type:"Sphere"})),e}function J2(e){return e&&typeof e.getChild=="function"&&typeof e.toArray=="function"&&e.schema&&Array.isArray(e.schema.fields)}function Z2(e){return e&&typeof e.toArray=="function"&&e.type}function pD(e){return e&&(e.typeId===8||e.typeId===10)&&e.unit===1}const Ln=Symbol("position"),Er=Symbol("color"),go=Symbol("radius"),bo=Symbol("length"),_o=Symbol("opacity"),yu=Symbol("symbol"),tx=Symbol("projection"),Yt=new Map([["x",Ln],["y",Ln],["fx",Ln],["fy",Ln],["r",go],["color",Er],["opacity",_o],["symbol",yu],["length",bo],["projection",tx]]);function mD(e){return e===Ln||e===tx}function yD(e){return e===Ln||e===go||e===bo||e===_o}const gD=Math.sqrt(3),bD=2/gD,_D={draw(e,t){const n=Math.sqrt(t/Math.PI),r=n*bD,i=r/2;e.moveTo(0,r),e.lineTo(n,i),e.lineTo(n,-i),e.lineTo(0,-r),e.lineTo(-n,-i),e.lineTo(-n,i),e.closePath()}},w0=new Map([["asterisk",a2],["circle",Ba],["cross",o2],["diamond",l2],["diamond2",u2],["hexagon",_D],["plus",f2],["square",d2],["square2",h2],["star",m2],["times",_2],["triangle",y2],["triangle2",g2],["wye",b2]]);function v0(e){return e&&typeof e.draw=="function"}function wD(e){return v0(e)?!0:typeof e!="string"?!1:w0.has(e.toLowerCase())}function x0(e){if(e==null||v0(e))return e;const t=w0.get(`${e}`.toLowerCase());if(t)return t;throw new Error(`invalid symbol: ${e}`)}function vD(e){if(e==null||v0(e))return[void 0,e];if(typeof e=="string"){const t=w0.get(`${e}`.toLowerCase());if(t)return[void 0,t]}return[e,void 0]}function gu({filter:e,sort:t,reverse:n,transform:r,initializer:i,...s}={},a){if(r===void 0&&(e!=null&&(r=ex(e)),t!=null&&!Es(t)&&(r=lf(r,S0(t))),n&&(r=lf(r,nx))),a!=null&&i!=null)throw new Error("transforms cannot be applied after initializers");return{...s,...(t===null||Es(t))&&{sort:t},transform:lf(r,a)}}function zr({filter:e,sort:t,reverse:n,initializer:r,...i}={},s){return r===void 0&&(e!=null&&(r=ex(e)),t!=null&&!Es(t)&&(r=uf(r,S0(t))),n&&(r=uf(r,nx))),{...i,...(t===null||Es(t))&&{sort:t},initializer:uf(r,s)}}function lf(e,t){return e==null?t===null?void 0:t:t==null?e===null?void 0:e:function(n,r,i){return{data:n,facets:r}=e.call(this,n,r,i),t.call(this,Ss(n),r,i)}}function uf(e,t){return e==null?t===null?void 0:t:t==null?e===null?void 0:e:function(n,r,i,...s){let a,o,c,l,u,f;return{data:o=n,facets:c=r,channels:a}=e.call(this,n,r,i,...s),{data:u=o,facets:f=c,channels:l}=t.call(this,o,c,{...i,...a},...s),{data:u,facets:f,channels:{...a,...l}}}}function xD(e,t){return(e.initializer!=null?zr:gu)(e,t)}function ex(e){return(t,n)=>{const r=Gt(t,e);return{data:t,facets:n.map(i=>i.filter(s=>r[s]))}}}function nx(e,t){return{data:e,facets:t.map(n=>n.slice().reverse())}}function SD(e,{sort:t,...n}={}){return{...(du(e)&&e.channel!==void 0?zr:xD)(n,S0(e)),sort:Es(t)?t:null}}function S0(e){return(typeof e=="function"&&e.length!==1?ED:TD)(e)}function ED(e){return(t,n)=>{const r=Ni(t)?(i,s)=>e(t[i],t[s]):(i,s)=>e(t.get(i),t.get(s));return{data:t,facets:n.map(i=>i.slice().sort(r))}}}function TD(e){let t,n;({channel:t,value:e,order:n}={...yo(e)});const r=t?.startsWith("-");if(r&&(t=t.slice(1)),n===void 0&&(n=r?Sl:pn),typeof n!="function")switch(`${n}`.toLowerCase()){case"ascending":n=pn;break;case"descending":n=Sl;break;default:throw new Error(`invalid order: ${n}`)}return(i,s,a)=>{let o;if(t===void 0)o=Gt(i,e);else{if(a===void 0)throw new Error("channel sort requires an initializer");if(o=a[t],!o)return{};o=o.value}const c=(l,u)=>n(o[l],o[u]);return{data:i,facets:s.map(l=>l.slice().sort(c))}}}function ff(e,...t){for(const{name:n}of e)if(t.includes(n))return!0;return!1}function AD(e,t,n=rx){const r=Object.entries(e);return t.title!=null&&e.title===void 0&&r.push(["title",LD]),t.href!=null&&e.href===void 0&&r.push(["href",T0]),r.filter(([,i])=>i!==void 0).map(([i,s])=>s===null?ID(i):n(i,s,t))}function rx(e,t,n,r=ix){let i;xr(t)&&"reduce"in t&&(i=t.scale,t=t.reduce);const s=r(e,t,n),[a,o]=Tl(s.label);let c;return{name:e,output:i===void 0?a:{value:a,scale:i},initialize(l){s.initialize(l),c=o([])},scope(l,u){s.scope(l,u)},reduce(l,u){c.push(s.reduce(l,u))}}}function ID(e){return{name:e,initialize(){},scope(){},reduce(){}}}function ix(e,t,n,r=E0){const i=eD(e,n),s=r(t,i);let a,o;return{label:Oi(s===Il?null:i,s.label),initialize(c){a=i===void 0?c:Gt(c,i),s.scope==="data"&&(o=s.reduceIndex(Sr(c),a))},scope(c,l){s.scope===c&&(o=s.reduceIndex(l,a))},reduce(c,l){return s.scope==null?s.reduceIndex(c,a,l):s.reduceIndex(c,a,o,l)}}}function ny(e,t){return t?jl(e,n=>t[n]):[[,e]]}function E0(e,t,n=ND){if(e==null)return n(e);if(typeof e.reduceIndex=="function")return e;if(typeof e.reduce=="function"&&xr(e))return RD(e);if(typeof e=="function")return DD(e);if(/^p\d{2}$/i.test(e))return Qn(Z8(e));switch(`${e}`.toLowerCase()){case"first":return T0;case"last":return FD;case"identity":return sx;case"count":return Il;case"distinct":return kD;case"sum":return t==null?Il:CD;case"proportion":return iy(t,"data");case"proportion-facet":return iy(t,"facet");case"deviation":return Qn(V_);case"min":return Qn(fr);case"min-index":return Qn(B6);case"max":return Qn(je);case"max-index":return Qn(C6);case"mean":return ry(P6);case"median":return ry(qf);case"variance":return Qn(j_);case"mode":return Qn(V6)}return n(e)}function ND(e){throw new Error(`invalid reduce: ${e}`)}function MD(e,t){for(const n in t){const r=t[n];if(r!==void 0&&!e.some(i=>i.name===n))return r}}function OD(e,t,n){if(t){const r=t.output.transform(),i=(s,a)=>pn(r[s],r[a]);e.forEach(s=>s.sort(i))}n&&e.forEach(r=>r.reverse())}function RD(e){return console.warn("deprecated reduce interface; implement reduceIndex instead."),{...e,reduceIndex:e.reduce.bind(e)}}function DD(e){return{reduceIndex(t,n,r){return e(b0(n,t),r)}}}function Qn(e){return{reduceIndex(t,n){return e(t,r=>n[r])}}}function ry(e){return{reduceIndex(t,n){const r=e(t,i=>n[i]);return Re(n)?new Date(r):r}}}const sx={reduceIndex(e,t){return b0(t,e)}},T0={reduceIndex(e,t){return t[e[0]]}},LD={reduceIndex(e,t){const r=zc(rs(e,s=>s.length,s=>t[s]),El),i=r.slice(-5).reverse();if(i.length<r.length){const s=r.slice(0,-4);i[4]=[` ${s.length.toLocaleString("en-US")} more`,$r(s,El)]}return i.map(([s,a])=>`${s} (${a.toLocaleString("en-US")})`).join(`
`)}},FD={reduceIndex(e,t){return t[e[e.length-1]]}},Il={label:"Frequency",reduceIndex(e){return e.length}},kD={label:"Distinct",reduceIndex(e,t){const n=new Pl;for(const r of e)n.add(t[r]);return n.size}},CD=Qn($r);function iy(e,t){return e==null?{scope:t,label:"Frequency",reduceIndex:(n,r,i=1)=>n.length/i}:{scope:t,reduceIndex:(n,r,i=1)=>$r(n,s=>r[s])/i}}const BD={reduceIndex(e,t,{z:n}){return n}};function ja(e,{scale:t,type:n,value:r,filter:i,hint:s,label:a=Oi(r)},o){return s===void 0&&typeof r?.transform=="function"&&(s=r.hint),ox(o,{scale:t,type:n,value:Gt(e,r),label:a,filter:i,hint:s})}function $D(e,t){return Object.fromEntries(Object.entries(e).map(([n,r])=>[n,ja(t,r,n)]))}function ax(e,t){const n=Object.fromEntries(Object.entries(e).map(([r,{scale:i,value:s}])=>{const a=i==null?null:t[i];return[r,a==null?s:Xt(s,a)]}));return n.channels=e,n}function ox(e,t){const{scale:n,value:r}=t;if(n===!0||n==="auto")switch(e){case"fill":case"stroke":case"color":t.scale=n!==!0&&cf(r,pu)?null:"color",t.defaultScale="color";break;case"fillOpacity":case"strokeOpacity":case"opacity":t.scale=n!==!0&&cf(r,uD)?null:"opacity",t.defaultScale="opacity";break;case"symbol":n!==!0&&cf(r,wD)?(t.scale=null,t.value=Xt(r,x0)):t.scale="symbol",t.defaultScale="symbol";break;default:t.scale=Yt.has(e)?e:null;break}else if(n===!1)t.scale=null;else if(n!=null&&!Yt.has(n))throw new Error(`unknown scale: ${n}`);return t}function UD(e,t,n,r,i){const{order:s,reverse:a,reduce:o=!0,limit:c}=i;for(const l in i){if(!Yt.has(l))continue;let{value:u,order:f=s,reverse:d=a,reduce:h=o,limit:p=c}=yo(i[l]);const y=u?.startsWith("-");if(y&&(u=u.slice(1)),f=f===void 0?y!==(u==="width"||u==="height")?lx:cx:VD(f),h==null||h===!1)continue;const g=l==="fx"||l==="fy"?jD(t,r[l]):PD(n,l);if(!g)throw new Error(`missing channel for scale: ${l}`);const b=g.value,[_=0,E=1/0]=Gr(p)?p:p<0?[p]:[0,p];if(u==null)g.domain=()=>{let w=Array.from(new Pl(b));return d&&(w=w.reverse()),(_!==0||E!==1/0)&&(w=w.slice(_,E)),w};else{const w=u==="data"?e:u==="height"?sy(n,"y1","y2"):u==="width"?sy(n,"x1","x2"):Od(n,u,u==="y"?"y2":u==="x"?"x2":void 0),A=E0(h===!0?"max":h,w);g.domain=()=>{let x=O6(Sr(b),T=>A.reduceIndex(T,w),T=>b[T]);return f&&x.sort(f),d&&x.reverse(),(_!==0||E!==1/0)&&(x=x.slice(_,E)),x.map(p0)}}}}function PD(e,t){for(const n in e){const r=e[n];if(r.scale===t)return r}}function jD(e,t){const n=e.original;if(n===e)return t;const r=t.value,i=t.value=[];for(let s=0;s<n.length;++s){const a=r[n[s][0]];for(const o of e[s])i[o]=a}return t}function sy(e,t,n){const r=Od(e,t),i=Od(e,n);return Xt(i,(s,a)=>Math.abs(s-r[a]),Float64Array)}function Od(e,t,n){let r=e[t];if(!r&&n!==void 0&&(r=e[n]),r)return r.value;throw new Error(`missing channel: ${t}`)}function VD(e){if(e==null||typeof e=="function")return e;switch(`${e}`.toLowerCase()){case"ascending":return cx;case"descending":return lx}throw new Error(`invalid order: ${e}`)}function cx([e,t],[n,r]){return pn(t,r)||pn(e,n)}function lx([e,t],[n,r]){return Sl(t,r)||pn(e,n)}function ay(e,t){let n=e[t];if(n){for(;n.source;)n=n.source;return n.source===null?null:n}}const ux=new Map([["accent",ZR],["category10",JR],["dark2",t8],["observable10",e8],["paired",n8],["pastel1",r8],["pastel2",i8],["set1",s8],["set2",a8],["set3",o8],["tableau10",c8]]);function zD(e){return e!=null&&ux.has(`${e}`.toLowerCase())}const oy=new Map([...ux,["brbg",Hn(Ww,Hw)],["prgn",Hn(qw,Gw)],["piyg",Hn(Xw,Kw)],["puor",Hn(Qw,Jw)],["rdbu",Hn(Ed,yl)],["rdgy",Hn(Zw,tv)],["rdylbu",Hn(Td,gl)],["rdylgn",Hn(ev,nv)],["spectral",Hn(rv,iv)],["burd",cy(Ed,yl)],["buylrd",cy(Td,gl)],["blues",ee(Mv,Ov)],["greens",ee(Rv,Dv)],["greys",ee(Lv,Fv)],["oranges",ee(Uv,Pv)],["purples",ee(kv,Cv)],["reds",ee(Bv,$v)],["turbo",qn(qv)],["viridis",qn(Gv)],["magma",qn(Xv)],["inferno",qn(Kv)],["plasma",qn(Qv)],["cividis",qn(jv)],["cubehelix",qn(Vv)],["warm",qn(zv)],["cool",qn(Yv)],["bugn",ee(sv,av)],["bupu",ee(ov,cv)],["gnbu",ee(lv,uv)],["orrd",ee(fv,dv)],["pubu",ee(mv,yv)],["pubugn",ee(hv,pv)],["purd",ee(gv,bv)],["rdpu",ee(_v,wv)],["ylgn",ee(Sv,Ev)],["ylgnbu",ee(vv,xv)],["ylorbr",ee(Tv,Av)],["ylorrd",ee(Iv,Nv)],["rainbow",ly(Wv)],["sinebow",ly(Hv)]]);function ee(e,t){return({length:n})=>n===1?[e[3][1]]:n===2?[e[3][1],e[3][2]]:(n=Math.max(3,Math.floor(n)),n>9?fn(t,n):e[n])}function Hn(e,t){return({length:n})=>n===2?[e[3][0],e[3][2]]:(n=Math.max(3,Math.floor(n)),n>11?fn(t,n):e[n])}function cy(e,t){return({length:n})=>n===2?[e[3][2],e[3][0]]:(n=Math.max(3,Math.floor(n)),n>11?fn(r=>t(1-r),n):e[n].slice().reverse())}function qn(e){return({length:t})=>fn(e,Math.max(2,Math.floor(t)))}function ly(e){return({length:t})=>fn(e,Math.floor(t)+1).slice(0,-1)}function fx(e){const t=`${e}`.toLowerCase();if(!oy.has(t))throw new Error(`unknown ordinal scheme: ${t}`);return oy.get(t)}function bu(e,t){const n=fx(e),r=typeof n=="function"?n({length:t}):n;return r.length!==t?r.slice(0,t):r}function YD(e,t="greys"){const n=new Set,[r,i]=bu(t,2);for(const s of e)if(s!=null)if(s===!0)n.add(i);else if(s===!1)n.add(r);else return;return[...n]}const uy=new Map([["brbg",Hw],["prgn",Gw],["piyg",Kw],["puor",Jw],["rdbu",yl],["rdgy",tv],["rdylbu",gl],["rdylgn",nv],["spectral",iv],["burd",e=>yl(1-e)],["buylrd",e=>gl(1-e)],["blues",Ov],["greens",Dv],["greys",Fv],["purples",Cv],["reds",$v],["oranges",Pv],["turbo",qv],["viridis",Gv],["magma",Xv],["inferno",Kv],["plasma",Qv],["cividis",jv],["cubehelix",Vv],["warm",zv],["cool",Yv],["bugn",av],["bupu",cv],["gnbu",uv],["orrd",dv],["pubugn",pv],["pubu",yv],["purd",bv],["rdpu",wv],["ylgnbu",xv],["ylgn",Ev],["ylorbr",Av],["ylorrd",Nv],["rainbow",Wv],["sinebow",Hv]]);function A0(e){const t=`${e}`.toLowerCase();if(!uy.has(t))throw new Error(`unknown quantitative scheme: ${t}`);return uy.get(t)}const WD=new Set(["brbg","prgn","piyg","puor","rdbu","rdgy","rdylbu","rdylgn","spectral","burd","buylrd"]);function HD(e){return e!=null&&WD.has(`${e}`.toLowerCase())}const dx=e=>t=>e(1-t),df=[0,1],fy=new Map([["number",fe],["rgb",bi],["hsl",hM],["hcl",yM],["lab",pM]]);function hx(e){const t=`${e}`.toLowerCase();if(!fy.has(t))throw new Error(`unknown interpolator: ${t}`);return fy.get(t)}function wo(e,t,n,{type:r,nice:i,clamp:s,zero:a,domain:o=mx(e,n),unknown:c,round:l,scheme:u,interval:f,range:d=Yt.get(e)===go?rL(n,o):Yt.get(e)===bo?iL(n,o):Yt.get(e)===_o?df:void 0,interpolate:h=Yt.get(e)===Er?u==null&&d!==void 0?bi:A0(u!==void 0?u:r==="cyclical"?"rainbow":"turbo"):l?Vh:fe,reverse:p}){if(o=dy(o),f=Bs(f,r),(r==="cyclical"||r==="sequential")&&(r="linear"),typeof h!="function"&&(h=hx(h)),p=!!p,d!==void 0){const y=o.length,g=(d=dy(d)).length;if(y!==g){if(h.length===1)throw new Error("invalid piecewise interpolator");h=Hl(h,d),d=void 0}}if(h.length===1?(p&&(h=dx(h),p=!1),d===void 0&&(d=Float64Array.from(o,(y,g)=>g/(o.length-1)),d.length===2&&(d=df)),t.interpolate((d===df?or:N0)(h))):t.interpolate(h),a){const[y,g]=$e(o);(y>0||g<0)&&(o=$a(o),(xs(o)||1)===Math.sign(y)?o[0]=0:o[o.length-1]=0)}return p&&(o=qc(o)),t.domain(o).unknown(c),i&&(t.nice(qD(i,r)),o=t.domain()),d!==void 0&&t.range(d),s&&t.clamp(s),{type:r,domain:o,range:d,scale:t,interpolate:h,interval:f}}function dy(e){return e=Mi(e),e.length>=2?e:[e[0],e[0]]}function qD(e,t){return e===!0?void 0:typeof e=="number"?e:rD(e,t)}function GD(e,t,n){return wo(e,tu(),t,n)}function XD(e,t,n){return px(e,t,{...n,exponent:.5})}function px(e,t,{exponent:n=1,...r}){return wo(e,Ew().exponent(n),t,{...r,type:"pow"})}function KD(e,t,{base:n=10,domain:r=sL(t),...i}){return wo(e,ww().base(n),t,{...i,domain:r})}function QD(e,t,{constant:n=1,...r}){return wo(e,xw().constant(n),t,r)}function JD(e,t,{range:n,quantiles:r=n===void 0?5:(n=[...n]).length,n:i=r,scheme:s="rdylbu",domain:a=aL(t),unknown:o,interpolate:c,reverse:l}){return n===void 0&&(n=c!==void 0?fn(c,i):Yt.get(e)===Er?bu(s,i):void 0),a.length>0&&(a=Tw(a,n===void 0?{length:i}:n).quantiles()),I0(e,t,{domain:a,range:n,reverse:l,unknown:o})}function ZD(e,t,{range:n,n:r=n===void 0?5:(n=[...n]).length,scheme:i="rdylbu",domain:s=mx(e,t),unknown:a,interpolate:o,reverse:c}){const[l,u]=$e(s);let f;return n===void 0?(f=Na(l,u,r),f[0]<=l&&f.splice(0,1),f[f.length-1]>=u&&f.pop(),r=f.length+1,n=o!==void 0?fn(o,r):Yt.get(e)===Er?bu(i,r):void 0):(f=fn(fe(l,u),r+1).slice(1,-1),l instanceof Date&&(f=f.map(d=>new Date(d)))),xs(Mi(s))<0&&f.reverse(),I0(e,t,{domain:f,range:n,reverse:c,unknown:a})}function I0(e,t,{domain:n=[0],unknown:r,scheme:i="rdylbu",interpolate:s,range:a=s!==void 0?fn(s,n.length+1):Yt.get(e)===Er?bu(i,n.length+1):void 0,reverse:o}){n=Mi(n);const c=xs(n);if(!isNaN(c)&&!tL(n,c))throw new Error(`the ${e} scale has a non-monotonic domain`);return o&&(a=qc(a)),{type:"threshold",scale:Aw(c<0?qc(n):n,a===void 0?[]:a).unknown(r),domain:n,range:a}}function tL(e,t){for(let n=1,r=e.length,i=e[0];n<r;++n){const s=Ja(i,i=e[n]);if(s!==0&&s!==t)return!1}return!0}function eL(e){return{type:"identity",scale:yD(Yt.get(e))?gw():t=>t}}function Va(e,t=O2){return e.length?[fr(e,({value:n})=>n===void 0?n:fr(n,t)),je(e,({value:n})=>n===void 0?n:je(n,t))]:[0,1]}function mx(e,t){const n=Yt.get(e);return(n===go||n===_o||n===bo?nL:Va)(t)}function nL(e){return[0,e.length?je(e,({value:t})=>t===void 0?t:je(t,O2)):1]}function rL(e,t){const n=e.find(({radius:a})=>a!==void 0);if(n!==void 0)return[0,n.radius];const r=hs(e,.5,({value:a})=>a===void 0?NaN:hs(a,.25,po)),i=t.map(a=>3*Math.sqrt(a/r)),s=30/je(i);return s<1?i.map(a=>a*s):i}function iL(e,t){const n=qf(e,({value:s})=>s===void 0?NaN:qf(s,Math.abs)),r=t.map(s=>12*s/n),i=60/je(r);return i<1?r.map(s=>s*i):r}function sL(e){for(const{value:t}of e)if(t!==void 0)for(let n of t){if(n>0)return Va(e,po);if(n<0)return Va(e,lu)}return[1,10]}function aL(e){const t=[];for(const{value:n}of e)if(n!==void 0)for(const r of n)t.push(r);return t}function N0(e){return(t,n)=>r=>e(t+r*(n-t))}let Rd=0,Dd;function oL(){const e=Rd;return Rd=0,Dd=void 0,e}function Fr(e){e!==Dd&&(Dd=e,console.warn(e),++Rd)}function _u(e,t,n,r,{type:i,nice:s,clamp:a,domain:o=Va(r),unknown:c,pivot:l=0,scheme:u,range:f,symmetric:d=!0,interpolate:h=Yt.get(e)===Er?u==null&&f!==void 0?bi:A0(u!==void 0?u:"rdbu"):fe,reverse:p}){l=+l,o=Mi(o);let[y,g]=o;if(o.length>2&&Fr(`Warning: the diverging ${e} scale domain contains extra elements.`),Ja(y,g)<0&&([y,g]=[g,y],p=!p),y=Math.min(y,l),g=Math.max(g,l),typeof h!="function"&&(h=hx(h)),f!==void 0&&(h=h.length===1?N0(h)(...f):Hl(h,f)),p&&(h=dx(h)),d){const b=n.apply(l),_=b-n.apply(y),E=n.apply(g)-b;_<E?y=n.invert(b-E):_>E&&(g=n.invert(b+_))}return t.domain([y,l,g]).unknown(c).interpolator(h),a&&t.clamp(a),s&&t.nice(s),{type:i,domain:[y,g],pivot:l,interpolate:h,scale:t}}function cL(e,t,n){return _u(e,jw(),dL,t,n)}function lL(e,t,n){return yx(e,t,{...n,exponent:.5})}function yx(e,t,{exponent:n=1,...r}){return _u(e,Yw().exponent(n=+n),mL(n),t,{...r,type:"diverging-pow"})}function uL(e,t,{base:n=10,pivot:r=1,domain:i=Va(t,r<0?lu:po),...s}){return _u(e,Vw().base(n=+n),hL,t,{domain:i,pivot:r,...s})}function fL(e,t,{constant:n=1,...r}){return _u(e,zw().constant(n=+n),yL(n),t,r)}const dL={apply(e){return e},invert(e){return e}},hL={apply:Math.log,invert:Math.exp},pL={apply(e){return Math.sign(e)*Math.sqrt(Math.abs(e))},invert(e){return Math.sign(e)*(e*e)}};function mL(e){return e===.5?pL:{apply(t){return Math.sign(t)*Math.pow(Math.abs(t),e)},invert(t){return Math.sign(t)*Math.pow(Math.abs(t),1/e)}}}function yL(e){return{apply(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))},invert(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}}function gx(e,t,n,r){return wo(e,t,n,r)}function gL(e,t,n){return gx(e,KR(),t,n)}function bL(e,t,n){return gx(e,QR(),t,n)}const vo=Symbol("ordinal");function bx(e,t,n,{type:r,interval:i,domain:s,range:a,reverse:o,hint:c}){return i=Bs(i,r),s===void 0&&(s=wx(n,i,e)),(r==="categorical"||r===vo)&&(r="ordinal"),o&&(s=qc(s)),s=t.domain(s).domain(),a!==void 0&&(typeof a=="function"&&(a=a(s)),t.range(a)),{type:r,domain:s,range:a,scale:t,hint:c,interval:i}}function _L(e,t,{type:n,interval:r,domain:i,range:s,scheme:a,unknown:o,...c}){r=Bs(r,n),i===void 0&&(i=wx(t,r,e));let l;if(Yt.get(e)===yu)l=xL(t),s=s===void 0?SL(l):Xt(s,x0);else if(Yt.get(e)===Er&&(s===void 0&&(n==="ordinal"||n===vo)&&(s=YD(i,a),s!==void 0&&(a=void 0)),a===void 0&&s===void 0&&(a=n==="ordinal"?"turbo":"observable10"),a!==void 0))if(s!==void 0){const u=A0(a),f=s[0],d=s[1]-s[0];s=({length:h})=>fn(p=>u(f+d*p),h)}else s=fx(a);if(o===vd)throw new Error(`implicit unknown on ${e} scale is not supported`);return bx(e,t0().unknown(o),t,{...c,type:n,domain:i,range:s,hint:l})}function wL(e,t,{align:n=.5,padding:r=.5,...i}){return _x(mw().align(n).padding(r),t,i,e)}function vL(e,t,{align:n=.5,padding:r=.1,paddingInner:i=r,paddingOuter:s=e==="fx"||e==="fy"?0:r,...a}){return _x(Jl().align(n).paddingInner(i).paddingOuter(s),t,a,e)}function _x(e,t,n,r){let{round:i}=n;return i!==void 0&&e.round(i=!!i),e=bx(r,e,t,n),e.round=i,e}function wx(e,t,n){const r=new Pl;for(const{value:i,domain:s}of e){if(s!==void 0)return s();if(i!==void 0)for(const a of i)r.add(a)}if(t!==void 0){const[i,s]=$e(r).map(t.floor,t);return t.range(i,t.offset(s))}if(r.size>1e4&&Yt.get(n)===Ln)throw new Error(`implicit ordinal domain of ${n} scale has more than 10,000 values`);return zc(r,pn)}function hy(e,t){let n;for(const{hint:r}of e){const i=r?.[t];if(i!==void 0){if(n===void 0)n=i;else if(n!==i)return}}return n}function xL(e){return{fill:hy(e,"fill"),stroke:hy(e,"stroke")}}function SL(e){return Te(e.fill)?x8:v8}function Ld(e,{label:t,inset:n=0,insetTop:r=n,insetRight:i=n,insetBottom:s=n,insetLeft:a=n,round:o,nice:c,clamp:l,zero:u,align:f,padding:d,projection:h,facet:{label:p=t}={},...y}={}){const g={};for(const[b,_]of e){const E=y[b],w=NL(b,_,{round:Yt.get(b)===Ln?o:void 0,nice:c,clamp:l,zero:u,align:f,padding:d,projection:h,...E});if(w){let{label:A=b==="fx"||b==="fy"?p:t,percent:x,transform:T,inset:M,insetTop:R=M!==void 0?M:b==="y"?r:0,insetRight:F=M!==void 0?M:b==="x"?i:0,insetBottom:N=M!==void 0?M:b==="y"?s:0,insetLeft:B=M!==void 0?M:b==="x"?a:0}=E||{};if(T==null)T=void 0;else if(typeof T!="function")throw new Error("invalid scale transform; not a function");w.percent=!!x,w.label=A===void 0?TL(_,w):A,w.transform=T,b==="x"||b==="fx"?(w.insetLeft=+B,w.insetRight=+F):(b==="y"||b==="fy")&&(w.insetTop=+R,w.insetBottom=+N),g[b]=w}}return g}function py(e){const t={},n={scales:t};for(const[r,i]of Object.entries(e)){const{scale:s,type:a,interval:o,label:c}=i;t[r]=LL(i),n[r]=s,s.type=a,o!=null&&(s.interval=o),c!=null&&(s.label=c)}return n}function EL(e,t){const{x:n,y:r,fx:i,fy:s}=e,a=i||s?M0(t):t;i&&my(i,a),s&&yy(s,a);const o=i||s?vx(e,t):t;n&&my(n,o),r&&yy(r,o)}function TL(e=[],t){let n;for(const{label:r}of e)if(r!==void 0){if(n===void 0)n=r;else if(n!==r)return}if(n!==void 0)return!Ri(t)&&t.percent&&(n=`${n} (%)`),{inferred:!0,toString:()=>n}}function AL(e){return Math.sign(xs(e.domain()))*Math.sign(xs(e.range()))}function M0(e){const{marginTop:t,marginRight:n,marginBottom:r,marginLeft:i,width:s,height:a,facet:{marginTop:o,marginRight:c,marginBottom:l,marginLeft:u}}=e;return{marginTop:Math.max(t,o),marginRight:Math.max(n,c),marginBottom:Math.max(r,l),marginLeft:Math.max(i,u),width:s,height:a}}function vx({fx:e,fy:t},n){const{marginTop:r,marginRight:i,marginBottom:s,marginLeft:a,width:o,height:c}=M0(n);return{marginTop:r,marginRight:i,marginBottom:s,marginLeft:a,width:e?e.scale.bandwidth()+a+i:o,height:t?t.scale.bandwidth()+r+s:c,facet:{width:o,height:c}}}function my(e,t){if(e.range===void 0){const{insetLeft:n,insetRight:r}=e,{width:i,marginLeft:s=0,marginRight:a=0}=t,o=s+n,c=i-a-r;e.range=[o,Math.max(o,c)],Ri(e)||(e.range=Sx(e)),e.scale.range(e.range)}xx(e)}function yy(e,t){if(e.range===void 0){const{insetTop:n,insetBottom:r}=e,{height:i,marginTop:s=0,marginBottom:a=0}=t,o=s+n,c=i-a-r;e.range=[Math.max(o,c),o],Ri(e)?e.range.reverse():e.range=Sx(e),e.scale.range(e.range)}xx(e)}function xx(e){e.round===void 0&&OL(e)&&IL(e)<=30&&e.scale.round(!0)}function IL({scale:e}){const t=e.domain().length,[n,r]=e.range(),i=e.paddingInner?e.paddingInner():1,s=e.paddingOuter?e.paddingOuter():e.padding(),a=t-i,o=Math.abs(r-n)/Math.max(1,a+s*2);return(o-Math.floor(o))*a}function Sx(e){const t=e.scale.domain().length+Ex(e);if(!(t>2))return e.range;const[n,r]=e.range;return Array.from({length:t},(i,s)=>n+s/(t-1)*(r-n))}function NL(e,t=[],n={}){const r=ML(e,t,n);if(n.type===void 0&&n.domain===void 0&&n.range===void 0&&n.interval==null&&e!=="fx"&&e!=="fy"&&Ri({type:r})){const i=t.map(({value:s})=>s).filter(s=>s!==void 0);i.some(Re)?Fr(`Warning: some data associated with the ${e} scale are dates. Dates are typically associated with a "utc" or "time" scale rather than a "${$i(r)}" scale. If you are using a bar mark, you probably want a rect mark with the interval option instead; if you are using a group transform, you probably want a bin transform instead. If you want to treat this data as ordinal, you can specify the interval of the ${e} scale (e.g., d3.utcDay), or you can suppress this warning by setting the type of the ${e} scale to "${$i(r)}".`):i.some(aD)?Fr(`Warning: some data associated with the ${e} scale are strings that appear to be dates (e.g., YYYY-MM-DD). If these strings represent dates, you should parse them to Date objects. Dates are typically associated with a "utc" or "time" scale rather than a "${$i(r)}" scale. If you are using a bar mark, you probably want a rect mark with the interval option instead; if you are using a group transform, you probably want a bin transform instead. If you want to treat this data as ordinal, you can suppress this warning by setting the type of the ${e} scale to "${$i(r)}".`):i.some(oD)&&Fr(`Warning: some data associated with the ${e} scale are strings that appear to be numbers. If these strings represent numbers, you should parse or coerce them to numbers. Numbers are typically associated with a "linear" scale rather than a "${$i(r)}" scale. If you want to treat this data as ordinal, you can specify the interval of the ${e} scale (e.g., 1 for integers), or you can suppress this warning by setting the type of the ${e} scale to "${$i(r)}".`)}switch(n.type=r,r){case"diverging":case"diverging-sqrt":case"diverging-pow":case"diverging-log":case"diverging-symlog":case"cyclical":case"sequential":case"linear":case"sqrt":case"threshold":case"quantile":case"pow":case"log":case"symlog":n=jo(t,n,Dn);break;case"identity":switch(Yt.get(e)){case Ln:n=jo(t,n,Dn);break;case yu:n=jo(t,n,RL);break}break;case"utc":case"time":n=jo(t,n,P2);break}switch(r){case"diverging":return cL(e,t,n);case"diverging-sqrt":return lL(e,t,n);case"diverging-pow":return yx(e,t,n);case"diverging-log":return uL(e,t,n);case"diverging-symlog":return fL(e,t,n);case"categorical":case"ordinal":case vo:return _L(e,t,n);case"cyclical":case"sequential":case"linear":return GD(e,t,n);case"sqrt":return XD(e,t,n);case"threshold":return I0(e,t,n);case"quantile":return JD(e,t,n);case"quantize":return ZD(e,t,n);case"pow":return px(e,t,n);case"log":return KD(e,t,n);case"symlog":return QD(e,t,n);case"utc":return bL(e,t,n);case"time":return gL(e,t,n);case"point":return wL(e,t,n);case"band":return vL(e,t,n);case"identity":return eL(e);case void 0:return;default:throw new Error(`unknown scale type: ${r}`)}}function $i(e){return typeof e=="symbol"?e.description:e}function gy(e){return typeof e=="string"?`${e}`.toLowerCase():e}const by={toString:()=>"projection"};function ML(e,t,{type:n,domain:r,range:i,scheme:s,pivot:a,projection:o}){if(n=gy(n),e==="fx"||e==="fy")return"band";(e==="x"||e==="y")&&o!=null&&(n=by);for(const u of t){const f=gy(u.type);if(f!==void 0){if(n===void 0)n=f;else if(n!==f)throw new Error(`scale incompatible with channel: ${n} !== ${f}`)}}if(n===by)return;if(n!==void 0)return n;if(r===void 0&&!t.some(({value:u})=>u!==void 0))return;const c=Yt.get(e);if(c===go)return"sqrt";if(c===_o||c===bo)return"linear";if(c===yu)return"ordinal";const l=(r??i)?.length;if(l<2||l>2)return hf(c);if(r!==void 0){if(ey(r))return hf(c);if(Re(r))return"utc"}else{const u=t.map(({value:f})=>f).filter(f=>f!==void 0);if(u.some(ey))return hf(c);if(u.some(Re))return"utc"}if(c===Er){if(a!=null||HD(s))return"diverging";if(zD(s))return"categorical"}return"linear"}function hf(e){switch(e){case Ln:return"point";case Er:return vo;default:return"ordinal"}}function Ri({type:e}){return e==="ordinal"||e==="point"||e==="band"||e===vo}function Ex({type:e}){return e==="threshold"}function OL({type:e}){return e==="point"||e==="band"}function jn(e){if(e===void 0)return!0;const t=e.domain(),n=e(t[0]);for(let r=1,i=t.length;r<i;++r)if(e(t[r])-n)return!1;return!0}function jo(e,{domain:t,...n},r){for(const i of e)i.value!==void 0&&(t===void 0&&(t=i.value?.domain),i.value=r(i.value));return{domain:t===void 0?t:r(t),...n}}function RL(e){return Xt(e,x0)}function DL(e){return t=>{if(!Yt.has(t=`${t}`))throw new Error(`unknown scale: ${t}`);return e[t]}}function LL({scale:e,type:t,domain:n,range:r,interpolate:i,interval:s,transform:a,percent:o,pivot:c}){if(t==="identity")return{type:"identity",apply:u=>u,invert:u=>u};const l=e.unknown?e.unknown():void 0;return{type:t,domain:$a(n),...r!==void 0&&{range:$a(r)},...a!==void 0&&{transform:a},...o&&{percent:o},...l!==void 0&&{unknown:l},...s!==void 0&&{interval:s},...i!==void 0&&{interpolate:i},...e.clamp&&{clamp:e.clamp()},...c!==void 0&&{pivot:c,symmetric:!1},...e.base&&{base:e.base()},...e.exponent&&{exponent:e.exponent()},...e.constant&&{constant:e.constant()},...e.align&&{align:e.align(),round:e.round()},...e.padding&&(e.paddingInner?{paddingInner:e.paddingInner(),paddingOuter:e.paddingOuter()}:{padding:e.padding()}),...e.bandwidth&&{bandwidth:e.bandwidth(),step:e.step()},apply:u=>e(u),...e.invert&&{invert:u=>e.invert(u)}}}function FL(e,t){const{fx:n,fy:r}=Ld(e,t),i=n?.scale.domain(),s=r?.scale.domain();return i&&s?N6(i,s).map(([a,o],c)=>({x:a,y:o,i:c})):i?i.map((a,o)=>({x:a,i:o})):s?s.map((a,o)=>({y:a,i:o})):void 0}function kL(e,{x:t,y:n}){return t&&=Fd(t),n&&=Fd(n),e.filter(t&&n?r=>t.has(r.x)&&n.has(r.y):t?r=>t.has(r.x):r=>n.has(r.y)).sort(t&&n?(r,i)=>t.get(r.x)-t.get(i.x)||n.get(r.y)-n.get(i.y):t?(r,i)=>t.get(r.x)-t.get(i.x):(r,i)=>n.get(r.y)-n.get(i.y))}function O0(e,{fx:t,fy:n}){const r=Sr(e),i=t?.value,s=n?.value;return t&&n?rs(r,a=>(a.fx=i[a[0]],a.fy=s[a[0]],a),a=>i[a],a=>s[a]):t?rs(r,a=>(a.fx=i[a[0]],a),a=>i[a]):rs(r,a=>(a.fy=s[a[0]],a),a=>s[a])}function CL(e,t,{marginTop:n,marginLeft:r}){const i=e?({x:a})=>e(a)-r:()=>0,s=t?({y:a})=>t(a)-n:()=>0;return function(a){this.tagName==="svg"?(this.setAttribute("x",i(a)),this.setAttribute("y",s(a))):this.setAttribute("transform",`translate(${i(a)},${s(a)})`)}}function BL(e){const t=[],n=new Uint32Array($r(e,r=>r.length));for(const r of e){let i=0;for(const s of e)r!==s&&(n.set(s,i),i+=s.length);t.push(n.slice(0,i))}return t}const $L=new Map([["top",pf],["right",gf],["bottom",mf],["left",yf],["top-left",Vo(pf,yf)],["top-right",Vo(pf,gf)],["bottom-left",Vo(mf,yf)],["bottom-right",Vo(mf,gf)],["top-empty",jL],["right-empty",YL],["bottom-empty",VL],["left-empty",zL],["empty",WL]]);function UL(e){if(e==null)return null;const t=$L.get(`${e}`.toLowerCase());if(t)return t;throw new Error(`invalid facet anchor: ${e}`)}const _y=new WeakMap;function Fd(e){let t=_y.get(e);return t||_y.set(e,t=new mi(Xt(e,(n,r)=>[n,r]))),t}function Xr(e,t){return Fd(e).get(t)}function PL(e,t,n){return t=cr(t),n=cr(n),e.find(r=>Object.is(cr(r.x),t)&&Object.is(cr(r.y),n))}function wu(e,t,n){return PL(e,t,n)?.empty}function pf(e,{y:t},{y:n}){return t?Xr(t,n)===0:!0}function mf(e,{y:t},{y:n}){return t?Xr(t,n)===t.length-1:!0}function yf(e,{x:t},{x:n}){return t?Xr(t,n)===0:!0}function gf(e,{x:t},{x:n}){return t?Xr(t,n)===t.length-1:!0}function jL(e,{y:t},{x:n,y:r,empty:i}){if(i)return!1;if(!t)return;const s=Xr(t,r);if(s>0)return wu(e,n,t[s-1])}function VL(e,{y:t},{x:n,y:r,empty:i}){if(i)return!1;if(!t)return;const s=Xr(t,r);if(s<t.length-1)return wu(e,n,t[s+1])}function zL(e,{x:t},{x:n,y:r,empty:i}){if(i)return!1;if(!t)return;const s=Xr(t,n);if(s>0)return wu(e,t[s-1],r)}function YL(e,{x:t},{x:n,y:r,empty:i}){if(i)return!1;if(!t)return;const s=Xr(t,n);if(s<t.length-1)return wu(e,t[s+1],r)}function WL(e,t,{empty:n}){return n}function Vo(e,t){return function(){return e.apply(null,arguments)&&t.apply(null,arguments)}}function bf(e,{channels:{fx:t,fy:n},groups:r}){return t&&n?e.map(({x:i,y:s})=>r.get(i)?.get(s)??[]):t?e.map(({x:i})=>r.get(i)??[]):e.map(({y:i})=>r.get(i)??[])}const Tx=Math.PI,Gn=2*Tx,_f=.618;function HL({projection:e,inset:t=0,insetTop:n=t,insetRight:r=t,insetBottom:i=t,insetLeft:s=t}={},a){if(e==null)return;if(typeof e.stream=="function")return e;let o,c,l="frame";if(xr(e)){let A;if({type:e,domain:c,inset:A,insetTop:n=A!==void 0?A:n,insetRight:r=A!==void 0?A:r,insetBottom:i=A!==void 0?A:i,insetLeft:s=A!==void 0?A:s,clip:l=l,...o}=e,e==null)return}typeof e!="function"&&({type:e}=kd(e));const{width:u,height:f,marginLeft:d,marginRight:h,marginTop:p,marginBottom:y}=a,g=u-d-h-s-r,b=f-p-y-n-i;if(e=e?.({width:g,height:b,clip:l,...o}),e==null)return;l=qL(l,d,p,u-h,f-y);let _=d+s,E=p+n,w;if(c!=null){const[[A,x],[T,M]]=Kh(e).bounds(c),R=Math.min(g/(T-A),b/(M-x));R>0?(_-=(R*(A+T)-g)/2,E-=(R*(x+M)-b)/2,w=fl({point(F,N){this.stream.point(F*R+_,N*R+E)}})):Fr("Warning: the projection could not be fit to the specified domain; using the default scale.")}return w??=_===0&&E===0?Ax():fl({point(A,x){this.stream.point(A+_,x+E)}}),{stream:A=>e.stream(w.stream(l(A)))}}function kd(e){switch(`${e}`.toLowerCase()){case"albers-usa":return an(g4,.7463,.4673);case"albers":return zo(iw,.7463,.4673);case"azimuthal-equal-area":return an(b4,4,4);case"azimuthal-equidistant":return an(_4,Gn,Gn);case"conic-conformal":return zo(x4,Gn,Gn);case"conic-equal-area":return zo(dl,6.1702,2.9781);case"conic-equidistant":return zo(T4,7.312,3.6282);case"equal-earth":return an(I4,5.4133,2.6347);case"equirectangular":return an(S4,Gn,Tx);case"gnomonic":return an(N4,3.4641,3.4641);case"identity":return{type:Ax};case"reflect-y":return{type:GL};case"mercator":return an(w4,Gn,Gn);case"orthographic":return an(M4,2,2);case"stereographic":return an(O4,2,2);case"transverse-mercator":return an(R4,Gn,Gn);default:throw new Error(`unknown projection type: ${e}`)}}function qL(e,t,n,r,i){if(e===!1||e==null||typeof e=="number")return s=>s;switch(e===!0&&(e="frame"),`${e}`.toLowerCase()){case"frame":return V1(t,n,r,i);default:throw new Error(`unknown projection clip type: ${e}`)}}function an(e,t,n){return{type:({width:r,height:i,rotate:s,precision:a=.15,clip:o})=>{const c=e();return a!=null&&c.precision?.(a),s!=null&&c.rotate?.(s),typeof o=="number"&&c.clipAngle?.(o),r!=null&&(c.scale(Math.min(r/t,i/n)),c.translate([r/2,i/2])),c},aspectRatio:n/t}}function zo(e,t,n){const{type:r,aspectRatio:i}=an(e,t,n);return{type:s=>{const{parallels:a,domain:o,width:c,height:l}=s,u=r(s);return a!=null&&(u.parallels(a),o===void 0&&c!=null&&u.fitSize([c,l],{type:"Sphere"})),u},aspectRatio:i}}const Ax=or({stream:e=>e}),GL=or(fl({point(e,t){this.stream.point(e,-t)}}));function XL(e,t,n,r){const i=n[e],s=n[t],a=i.length,o=n[e]=new Float64Array(a).fill(NaN),c=n[t]=new Float64Array(a).fill(NaN);let l;const u=r.stream({point(f,d){o[l]=f,c[l]=d}});for(l=0;l<a;++l)u.point(i[l],s[l])}function KL({projection:e}={}){return e==null?!1:typeof e.stream=="function"?!0:(xr(e)&&(e=e.type),e!=null)}function QL(e){if(typeof e?.stream=="function")return _f;if(xr(e)){let t,n;if({domain:t,type:e,...n}=e,t!=null&&e!=null){const r=typeof e=="string"?kd(e).type:e,[[i,s],[a,o]]=Kh(r({...n,width:100,height:100})).bounds(t),c=(o-s)/(a-i);return c&&isFinite(c)?c<.2?.2:c>5?5:c:_f}}if(e!=null){if(typeof e!="function"){const{aspectRatio:t}=kd(e);if(t)return t}return _f}}function JL(e){const t=[],n=[],r={scale:"x",value:t},i={scale:"y",value:n},s={point(a,o){t.push(a),n.push(o)},lineStart(){},lineEnd(){},polygonStart(){},polygonEnd(){},sphere(){}};for(const a of e.value)ri(a,s);return[r,i]}function ZL({x:e,y:t}){if(e||t)return e??=n=>n,t??=n=>n,fl({point(n,r){this.stream.point(e(n),t(r))}})}function R0(e={}){const{document:t=typeof window<"u"?window.document:void 0,clip:n}=e;return{document:t,clip:Q2(n)}}function Ht(e,{document:t}){return oi(zl(e).call(t.documentElement))}const Cd=Symbol("unset");function vu(e){return(e.length===1?t5:e5)(e)}function t5(e){let t,n=Cd;return r=>(Object.is(n,r)||(n=r,t=e(r)),t)}function e5(e){let t,n;return(...r)=>((n?.length!==r.length||n.some((i,s)=>!Object.is(i,r[s])))&&(n=r,t=e(...r)),t)}const n5=vu(e=>new Intl.NumberFormat(e));vu((e,t)=>new Intl.DateTimeFormat(e,{timeZone:"UTC",...t&&{month:t}}));vu((e,t)=>new Intl.DateTimeFormat(e,{timeZone:"UTC",...t&&{weekday:t}}));function r5(e="en-US"){const t=n5(e);return n=>n!=null&&!isNaN(n)?t.format(n):void 0}function i5(e){return P8(e,"Invalid Date")}function s5(e="en-US"){const t=r5(e);return n=>(n instanceof Date?i5:typeof n=="number"?t:de)(n)}const Ts=s5(),Ue=(typeof window<"u"?window.devicePixelRatio>1:typeof it>"u")?0:.5;let a5=0,o5=0;function Ix(){return`plot-clip-${++a5}`}function c5(){return`plot-pattern-${++o5}`}function l5(e,{title:t,href:n,ariaLabel:r,ariaDescription:i,ariaHidden:s,target:a,fill:o,fillOpacity:c,stroke:l,strokeWidth:u,strokeOpacity:f,strokeLinejoin:d,strokeLinecap:h,strokeMiterlimit:p,strokeDasharray:y,strokeDashoffset:g,opacity:b,mixBlendMode:_,imageFilter:E,paintOrder:w,pointerEvents:A,shapeRendering:x,channels:T},{ariaLabel:M,fill:R="currentColor",fillOpacity:F,stroke:N="none",strokeOpacity:B,strokeWidth:W,strokeLinecap:D,strokeLinejoin:S,strokeMiterlimit:I,paintOrder:O}){R===null&&(o=null,c=null),N===null&&(l=null,f=null),Te(R)?!Te(N)&&(!Te(o)||T?.fill)&&(N="none"):Te(N)&&(!Te(l)||T?.stroke)&&(R="none");const[C,L]=mr(o,R),[$,j]=me(c,F),[Y,V]=mr(l,N),[K,ot]=me(f,B),[yt,H]=me(b);Pa(V)||(u===void 0&&(u=W),h===void 0&&(h=D),d===void 0&&(d=S),p===void 0&&!fD(d)&&(p=I),!Pa(L)&&w===void 0&&(w=O));const[ct,U]=me(u);return R!==null&&(e.fill=ae(L,"currentColor"),e.fillOpacity=Gs(j,1)),N!==null&&(e.stroke=ae(V,"none"),e.strokeWidth=Gs(U,1),e.strokeOpacity=Gs(ot,1),e.strokeLinejoin=ae(d,"miter"),e.strokeLinecap=ae(h,"butt"),e.strokeMiterlimit=Gs(p,4),e.strokeDasharray=ae(y,"none"),e.strokeDashoffset=ae(g,"0")),e.target=de(a),e.ariaLabel=de(M),e.ariaDescription=de(i),e.ariaHidden=de(s),e.opacity=Gs(H,1),e.mixBlendMode=ae(_,"normal"),e.imageFilter=ae(E,"none"),e.paintOrder=ae(w,"normal"),e.pointerEvents=ae(A,"auto"),e.shapeRendering=ae(x,"auto"),{title:{value:t,optional:!0,filter:null},href:{value:n,optional:!0,filter:null},ariaLabel:{value:r,optional:!0,filter:null},fill:{value:C,scale:"auto",optional:!0},fillOpacity:{value:$,scale:"auto",optional:!0},stroke:{value:Y,scale:"auto",optional:!0},strokeOpacity:{value:K,scale:"auto",optional:!0},strokeWidth:{value:ct,optional:!0},opacity:{value:yt,scale:"auto",optional:!0}}}function u5(e,t){t&&e.filter(n=>l0(t[n])).append("title").call(d5,t)}function f5(e,t){t&&e.filter(([n])=>l0(t[n])).append("title").call(h5,t)}function d5(e,t){t&&e.text(n=>Ts(t[n]))}function h5(e,t){t&&e.text(([n])=>Ts(t[n]))}function De(e,{target:t,tip:n},{ariaLabel:r,title:i,fill:s,fillOpacity:a,stroke:o,strokeOpacity:c,strokeWidth:l,opacity:u,href:f}){r&&ht(e,"aria-label",d=>r[d]),s&&ht(e,"fill",d=>s[d]),a&&ht(e,"fill-opacity",d=>a[d]),o&&ht(e,"stroke",d=>o[d]),c&&ht(e,"stroke-opacity",d=>c[d]),l&&ht(e,"stroke-width",d=>l[d]),u&&ht(e,"opacity",d=>u[d]),f&&Ox(e,d=>f[d],t),n||u5(e,i)}function Nx(e,{target:t,tip:n},{ariaLabel:r,title:i,fill:s,fillOpacity:a,stroke:o,strokeOpacity:c,strokeWidth:l,opacity:u,href:f}){r&&ht(e,"aria-label",([d])=>r[d]),s&&ht(e,"fill",([d])=>s[d]),a&&ht(e,"fill-opacity",([d])=>a[d]),o&&ht(e,"stroke",([d])=>o[d]),c&&ht(e,"stroke-opacity",([d])=>c[d]),l&&ht(e,"stroke-width",([d])=>l[d]),u&&ht(e,"opacity",([d])=>u[d]),f&&Ox(e,([d])=>f[d],t),n||f5(e,i)}function p5({ariaLabel:e,title:t,fill:n,fillOpacity:r,stroke:i,strokeOpacity:s,strokeWidth:a,opacity:o,href:c},{tip:l}){return[e,l?void 0:t,n,r,i,s,a,o,c].filter(u=>u!==void 0)}function m5(e,t,n){const r=jl(e,i=>t[i]);return n===void 0&&r.size>1+e.length>>1&&Fr("Warning: the implicit z channel has high cardinality. This may occur when the fill or stroke channel is associated with quantitative data rather than ordinal or categorical data. You can suppress this warning by setting the z option explicitly; if this data represents a single series, set z to null."),r.values()}function*Mx(e,t,n,r){const{z:i}=n,{z:s}=r,a=p5(r,n),o=[...t,...a];for(const c of s?m5(e,s,i):[e]){let l,u;t:for(const f of c){for(const d of o)if(!Vr(d[f])){u&&u.push(-1);continue t}if(l===void 0){u&&(yield u),l=a.map(d=>cr(d[f])),u=[f];continue}u.push(f);for(let d=0;d<a.length;++d)if(cr(a[d][f])!==l[d]){yield u,l=a.map(p=>cr(p[f])),u=[f];continue t}}u&&(yield u)}}function y5(e,t,n,r){let i;const{clip:s=r.clip}=t;s==="frame"?(e=Ht("svg:g",r).each(function(){this.appendChild(e.node()),e.node=()=>this}),i=b5(r,n)):s&&(i=w5(s,r)),ht(e,"aria-label",t.ariaLabel),ht(e,"aria-description",t.ariaDescription),ht(e,"aria-hidden",t.ariaHidden),ht(e,"clip-path",i)}function g5(e){const t=new WeakMap;return(n,r)=>{let i=t.get(n);if(!i){const s=Ix();oi(n.ownerSVGElement).append("clipPath").attr("id",s).call(e,n,r),t.set(n,i=`url(#${s})`)}return i}}const b5=g5((e,t,n)=>{const{width:r,height:i,marginLeft:s,marginRight:a,marginTop:o,marginBottom:c}=n;e.append("rect").attr("x",s).attr("y",o).attr("width",r-a-s).attr("height",i-o-c)}),wy=new WeakMap,_5={type:"Sphere"};function w5(e,t){let n,r;if((n=wy.get(t))||wy.set(t,n=new WeakMap),e.type==="Sphere"&&(e=_5),!(r=n.get(e))){const i=Ix();oi(t.ownerSVGElement).append("clipPath").attr("id",i).append("path").attr("d",t.path()(e)),n.set(e,r=`url(#${i})`)}return r}function Fe(e,t,n,r){y5(e,t,n,r),ht(e,"class",t.className),ht(e,"fill",t.fill),ht(e,"fill-opacity",t.fillOpacity),ht(e,"stroke",t.stroke),ht(e,"stroke-width",t.strokeWidth),ht(e,"stroke-opacity",t.strokeOpacity),ht(e,"stroke-linejoin",t.strokeLinejoin),ht(e,"stroke-linecap",t.strokeLinecap),ht(e,"stroke-miterlimit",t.strokeMiterlimit),ht(e,"stroke-dasharray",t.strokeDasharray),ht(e,"stroke-dashoffset",t.strokeDashoffset),ht(e,"shape-rendering",t.shapeRendering),ht(e,"filter",t.imageFilter),ht(e,"paint-order",t.paintOrder);const{pointerEvents:i=r.pointerSticky===!1?"none":void 0}=t;ht(e,"pointer-events",i)}function ge(e,t){v5(e,"mix-blend-mode",t.mixBlendMode),ht(e,"opacity",t.opacity)}function Ox(e,t,n){e.each(function(r){const i=t(r);if(i!=null){const s=this.ownerDocument.createElementNS(Ur.svg,"a");s.setAttribute("fill","inherit"),s.setAttributeNS(Ur.xlink,"href",i),n!=null&&s.setAttribute("target",n),this.parentNode.insertBefore(s,this).appendChild(this)}})}function ht(e,t,n){n!=null&&e.attr(t,n)}function v5(e,t,n){n!=null&&e.style(t,n)}function ke(e,t,{x:n,y:r},i=Ue,s=Ue){i+=t.dx,s+=t.dy,n?.bandwidth&&(i+=n.bandwidth()/2),r?.bandwidth&&(s+=r.bandwidth()/2),(i||s)&&e.attr("transform",`translate(${i},${s})`)}function ae(e,t){if((e=de(e))!==t)return e}function Gs(e,t){if((e=pe(e))!==t)return e}const x5=/^-?([_a-z]|[\240-\377]|\\[0-9a-f]{1,6}(\r\n|[ \t\r\n\f])?|\\[^\r\n\f0-9a-f])([_a-z0-9-]|[\240-\377]|\\[0-9a-f]{1,6}(\r\n|[ \t\r\n\f])?|\\[^\r\n\f0-9a-f])*$/i;function D0(e){if(e===void 0)return"plot-d6a7b5";if(e=`${e}`,!x5.test(e))throw new Error(`invalid class name: ${e}`);return e}function L0(e,t){if(typeof t=="string")e.property("style",t);else if(t!=null)for(const n of e)Object.assign(n.style,t)}function xo({frameAnchor:e},{width:t,height:n,marginTop:r,marginRight:i,marginBottom:s,marginLeft:a}){return[/left$/.test(e)?a:/right$/.test(e)?t-i:(a+t-i)/2,/^top/.test(e)?r:/^bottom/.test(e)?n-s:(r+n-s)/2]}class be{constructor(t,n={},r={},i){const{facet:s="auto",facetAnchor:a,fx:o,fy:c,sort:l,dx:u=0,dy:f=0,margin:d=0,marginTop:h=d,marginRight:p=d,marginBottom:y=d,marginLeft:g=d,className:b,clip:_=i?.clip,channels:E,tip:w,render:A}=r;if(this.data=t,this.sort=Es(l)?l:null,this.initializer=zr(r).initializer,this.transform=this.initializer?r.transform:gu(r).transform,s===null||s===!1?this.facet=null:(this.facet=bn(s===!0?"include":s,"facet",["auto","include","exclude","super"]),this.fx=t===mc&&typeof o=="string"?[o]:o,this.fy=t===mc&&typeof c=="string"?[c]:c),this.facetAnchor=UL(a),n=K2(n),E!==void 0&&(n={...S5(E),...n}),i!==void 0&&(n={...l5(this,r,i),...n}),this.channels=Object.fromEntries(Object.entries(n).map(([x,T])=>{if(du(T.value)){const{value:M,label:R=T.label,scale:F=T.scale}=T.value;T={...T,label:R,scale:F,value:M}}if(t===mc&&typeof T.value=="string"){const{value:M}=T;T={...T,value:[M]}}return[x,T]}).filter(([x,{value:T,optional:M}])=>{if(T!=null)return!0;if(M)return!1;throw new Error(`missing channel value: ${x}`)})),this.dx=+u,this.dy=+f,this.marginTop=+h,this.marginRight=+p,this.marginBottom=+y,this.marginLeft=+g,this.clip=Q2(_),this.tip=E5(w),this.className=de(b),this.facet==="super"){if(o||c)throw new Error("super-faceting cannot use fx or fy");for(const x in this.channels){const{scale:T}=n[x];if(!(T!=="x"&&T!=="y"))throw new Error("super-faceting cannot use x or y")}}A!=null&&(this.render=F0(A,this.render))}initialize(t,n,r){let i=Ss(this.data);t===void 0&&i!=null&&(t=[Sr(i)]);const s=t;this.transform!=null&&({facets:t,data:i}=this.transform(i,t,r),i=Ss(i)),t!==void 0&&(t.original=s);const a=$D(this.channels,i);return this.sort!=null&&UD(i,t,a,n,this.sort),{data:i,facets:t,channels:a}}filter(t,n,r){for(const i in n){const{filter:s=Vr}=n[i];if(s!==null){const a=r[i];t=t.filter(o=>s(a[o]))}}return t}project(t,n,r){for(const i in t)if(t[i].scale==="x"&&/^x|x$/.test(i)){const s=i.replace(/^x|x$/,"y");s in t&&t[s].scale==="y"&&XL(i,s,n,r.projection)}}scale(t,n,r){const i=ax(t,n);return r.projection&&this.project(t,i,r),i}}function Rx(...e){return e.plot=be.prototype.plot,e}function F0(e,t){if(e==null)return t===null?void 0:t;if(t==null)return e===null?void 0:e;if(typeof e!="function")throw new TypeError(`invalid render transform: ${e}`);if(typeof t!="function")throw new TypeError(`invalid render transform: ${t}`);return function(n,r,i,s,a,o){return e.call(this,n,r,i,s,a,(c,l,u,f,d)=>t.call(this,c,l,u,f,d,o))}}function S5(e){return Object.fromEntries(Object.entries(K2(e)).map(([t,n])=>(n=typeof n=="string"?{value:n,label:t}:yo(n),n.filter===void 0&&n.scale==null&&(n={...n,filter:null}),[t,n])))}function E5(e){return e===!0?"xy":e===!1||e==null?null:typeof e=="string"?bn(e,"tip",["x","y","xy"]):e}function So(e,t){return e?.tip===!0?{...e,tip:t}:xr(e?.tip)&&e.tip.pointer===void 0?{...e,tip:{...e.tip,pointer:t}}:e}function T5(e,t,n={}){let r=.5-Ue,i=.5+Ue,s=.5+Ue,a=.5-Ue;for(const{marginTop:y,marginRight:g,marginBottom:b,marginLeft:_}of t)y>r&&(r=y),g>i&&(i=g),b>s&&(s=b),_>a&&(a=_);let{margin:o,marginTop:c=o!==void 0?o:r,marginRight:l=o!==void 0?o:i,marginBottom:u=o!==void 0?o:s,marginLeft:f=o!==void 0?o:a}=n;c=+c,l=+l,u=+u,f=+f;let{width:d=640,height:h=A5(e,n,{width:d,marginTopDefault:r,marginRightDefault:i,marginBottomDefault:s,marginLeftDefault:a})+Math.max(0,c-r+u-s)}=n;d=+d,h=+h;const p={width:d,height:h,marginTop:c,marginRight:l,marginBottom:u,marginLeft:f};if(e.fx||e.fy){let{margin:y,marginTop:g=y!==void 0?y:c,marginRight:b=y!==void 0?y:l,marginBottom:_=y!==void 0?y:u,marginLeft:E=y!==void 0?y:f}=n.facet??{};g=+g,b=+b,_=+_,E=+E,p.facet={marginTop:g,marginRight:b,marginBottom:_,marginLeft:E}}return p}function A5({x:e,y:t,fy:n,fx:r},{projection:i,aspectRatio:s},{width:a,marginTopDefault:o,marginRightDefault:c,marginBottomDefault:l,marginLeftDefault:u}){const f=n&&n.scale.domain().length||1,d=QL(i);if(d){const p=r?r.scale.domain().length:1,y=(1.1*f-.1)/(1.1*p-.1)*d,g=Math.max(.1,Math.min(10,y));return Math.round((a-u-c)*g+o+l)}const h=t?Ri(t)?t.scale.domain().length||1:Math.max(7,17/f):1;if(s!=null){if(s=+s,!(isFinite(s)&&s>0))throw new Error(`invalid aspectRatio: ${s}`);const p=vy("y",t)/(vy("x",e)*s),y=r?r.scale.bandwidth():1,g=n?n.scale.bandwidth():1,b=y*(a-u-c)-e.insetLeft-e.insetRight;return(p*b+t.insetTop+t.insetBottom)/g+o+l}return!!(t||n)*Math.max(1,Math.min(60,h*f))*20+!!r*30+60}function vy(e,t){if(!t)throw new Error(`aspectRatio requires ${e} scale`);const{type:n,domain:r}=t;let i;switch(n){case"linear":case"utc":case"time":i=Number;break;case"pow":{const o=t.scale.exponent();i=c=>Math.pow(c,o);break}case"log":i=Math.log;break;case"point":case"band":return r.length;default:throw new Error(`unsupported ${e} scale for aspectRatio: ${n}`)}const[s,a]=$e(r);return Math.abs(i(a)-i(s))}const xy=new WeakMap;function k0(e,t,{x:n,y:r,px:i,py:s,maxRadius:a=40,channels:o,render:c,...l}={}){return a=+a,i!=null&&(n??=null,o={...o,px:{value:i,scale:"x"}}),s!=null&&(r??=null,o={...o,py:{value:s,scale:"y"}}),{x:n,y:r,channels:o,...l,render:F0(function(u,f,d,h,p,y){p={...p,pointerSticky:!1};const g=p.ownerSVGElement,{data:b}=p.getMarkState(this);let _=xy.get(g);_||xy.set(g,_={sticky:!1,roots:[],renders:[]});let E=_.renders.push(V)-1;const{x:w,y:A,fx:x,fy:T}=f;let M=x?x(u.fx)-h.marginLeft:0,R=T?T(u.fy)-h.marginTop:0;w?.bandwidth&&(M+=w.bandwidth()/2),A?.bandwidth&&(R+=A.bandwidth()/2);const F=u.fi!=null;let N;if(F){let H=_.facetStates;H||(_.facetStates=H=new Map),N=H.get(this),N||H.set(this,N=new Map)}const[B,W]=xo(this,h),{px:D,py:S}=d,I=D?H=>D[H]:Fx(d,B),O=S?H=>S[H]:kx(d,W);let C,L,$,j;function Y(H,ct){if(F)if(j&&(j=cancelAnimationFrame(j)),H==null)N.delete(u.fi);else{N.set(u.fi,ct),j=requestAnimationFrame(()=>{j=null;for(const[U,z]of N)if(z<ct||z===ct&&U<u.fi){H=null;break}V(H)});return}V(H)}function V(H){if(C===H&&$===_.sticky)return;C=H,$=p.pointerSticky=_.sticky;const ct=C==null?[]:[C];F&&(ct.fx=u.fx,ct.fy=u.fy,ct.fi=u.fi);const U=y(ct,f,d,h,p);if(L){if(F){const z=L.parentNode,G=L.getAttribute("transform"),k=U.getAttribute("transform");G?U.setAttribute("transform",G):U.removeAttribute("transform"),k?z.setAttribute("transform",k):z.removeAttribute("transform"),U.removeAttribute("aria-label"),U.removeAttribute("aria-description"),U.removeAttribute("aria-hidden")}L.replaceWith(U)}if(_.roots[E]=L=U,!(C==null&&N?.size>1)){const z=C==null?null:Ni(b)?b[C]:b.get(C);p.dispatchValue(z)}return U}function K(H){if(_.sticky||H.pointerType==="mouse"&&H.buttons===1)return;let[ct,U]=kN(H);ct-=M,U-=R;const z=ct<h.marginLeft||ct>h.width-h.marginRight?1:e,G=U<h.marginTop||U>h.height-h.marginBottom?1:t;let k=null,xt=a*a;for(const lt of u){const Ot=z*(I(lt)-ct),Pt=G*(O(lt)-U),le=Ot*Ot+Pt*Pt;le<=xt&&(k=lt,xt=le)}if(k!=null&&(e!==1||t!==1)){const lt=I(k)-ct,Ot=O(k)-U;xt=lt*lt+Ot*Ot}Y(k,xt)}function ot(H){H.pointerType==="mouse"&&C!=null&&(_.sticky&&_.roots.some(ct=>ct?.contains(H.target))||(_.sticky?(_.sticky=!1,_.renders.forEach(ct=>ct(null))):(_.sticky=!0,V(C)),H.stopImmediatePropagation()))}function yt(H){H.pointerType==="mouse"&&(_.sticky||Y(null))}return g.addEventListener("pointerenter",K),g.addEventListener("pointermove",K),g.addEventListener("pointerdown",ot),g.addEventListener("pointerleave",yt),V(null)},c)}}function Dx(e){return k0(1,1,e)}function Lx(e){return k0(1,.01,e)}function Sy(e){return k0(.01,1,e)}function Fx({x1:e,x2:t,x:n=e},r){return e&&t?i=>(e[i]+t[i])/2:n?i=>n[i]:()=>r}function kx({y1:e,y2:t,y:n=e},r){return e&&t?i=>(e[i]+t[i])/2:n?i=>n[i]:()=>r}function Cx(e){return Ri(e)&&e.interval===void 0?void 0:"tabular-nums"}function I5(e,t){let{label:n=e.label,tickSize:r=6,width:i=240,height:s=44+r,marginTop:a=18,marginRight:o=0,marginBottom:c=16+r,marginLeft:l=0,style:u,ticks:f=(i-l-o)/64,tickFormat:d,fontVariant:h=Cx(e),round:p=!0,opacity:y,className:g}=t;const b=R0(t);g=D0(g),y=me(y)[1],d===null&&(d=()=>null);const _=Ht("svg",b).attr("class",`${g}-ramp`).attr("font-family","system-ui, sans-serif").attr("font-size",10).attr("width",i).attr("height",s).attr("viewBox",`0 0 ${i} ${s}`).call(B=>B.append("style").text(`:where(.${g}-ramp) {
  display: block;
  height: auto;
  height: intrinsic;
  max-width: 100%;
  overflow: visible;
}
:where(.${g}-ramp text) {
  white-space: pre;
}`)).call(L0,u);let E=B=>B.selectAll(".tick line").attr("y1",a+c-s),w;const A=p?(B,W)=>B.rangeRound(W):(B,W)=>B.range(W),{type:x,domain:T,range:M,interpolate:R,scale:F,pivot:N}=e;if(R){const B=M===void 0?R:Hl(R.length===1?N0(R):R,M);w=A(F.copy(),fn(fe(l,i-o),Math.min(T.length+(N!==void 0),M===void 0?1/0:M.length)));const W=256,D=b.document.createElement("canvas");D.width=W,D.height=1;const S=D.getContext("2d");for(let I=0,O=W-1;I<W;++I)S.fillStyle=B(I/O),S.fillRect(I,0,1,1);_.append("image").attr("opacity",y).attr("x",l).attr("y",a).attr("width",i-l-o).attr("height",s-a-c).attr("preserveAspectRatio","none").attr("xlink:href",D.toDataURL())}else if(x==="threshold"){const B=T,W=d===void 0?D=>D:typeof d=="string"?ks(d):d;w=A(tu().domain([-1,M.length-1]),[l,i-o]),_.append("g").attr("fill-opacity",y).selectAll().data(M).enter().append("rect").attr("x",(D,S)=>w(S-1)).attr("y",a).attr("width",(D,S)=>w(S)-w(S-1)).attr("height",s-a-c).attr("fill",D=>D),f=Xt(B,(D,S)=>S),d=D=>W(B[D],D)}else w=A(Jl().domain(T),[l,i-o]),_.append("g").attr("fill-opacity",y).selectAll().data(T).enter().append("rect").attr("x",w).attr("y",a).attr("width",Math.max(0,w.bandwidth()-1)).attr("height",s-a-c).attr("fill",F),E=()=>{};return _.append("g").attr("transform",`translate(0,${s-c})`).call(J6(w).ticks(Array.isArray(f)?null:f,typeof d=="string"?d:void 0).tickFormat(typeof d=="function"?d:void 0).tickSize(r).tickValues(Array.isArray(f)?f:null)).attr("font-size",null).attr("font-family",null).attr("font-variant",ae(h,"normal")).call(E).call(B=>B.select(".domain").remove()),n!==void 0&&_.append("text").attr("x",l).attr("y",a-6).attr("fill","currentColor").attr("font-weight","bold").text(n),_.node()}const Bx=Math.PI/180;function xu(e,{marker:t,markerStart:n=t,markerMid:r=t,markerEnd:i=t}={}){e.markerStart=wf(n),e.markerMid=wf(r),e.markerEnd=wf(i)}function wf(e){if(e==null||e===!1)return null;if(e===!0)return Ty;if(typeof e=="function")return e;switch(`${e}`.toLowerCase()){case"none":return null;case"arrow":return Ey("auto");case"arrow-reverse":return Ey("auto-start-reverse");case"dot":return N5;case"circle":case"circle-fill":return Ty;case"circle-stroke":return M5;case"tick":return vf("auto");case"tick-x":return vf(90);case"tick-y":return vf(0)}throw new Error(`invalid marker: ${e}`)}function Ey(e){return(t,n)=>Ht("svg:marker",n).attr("viewBox","-5 -5 10 10").attr("markerWidth",6.67).attr("markerHeight",6.67).attr("orient",e).attr("fill","none").attr("stroke",t).attr("stroke-width",1.5).attr("stroke-linecap","round").attr("stroke-linejoin","round").call(r=>r.append("path").attr("d","M-1.5,-3l3,3l-3,3")).node()}function N5(e,t){return Ht("svg:marker",t).attr("viewBox","-5 -5 10 10").attr("markerWidth",6.67).attr("markerHeight",6.67).attr("fill",e).attr("stroke","none").call(n=>n.append("circle").attr("r",2.5)).node()}function Ty(e,t){return Ht("svg:marker",t).attr("viewBox","-5 -5 10 10").attr("markerWidth",6.67).attr("markerHeight",6.67).attr("fill",e).attr("stroke","var(--plot-background)").attr("stroke-width",1.5).call(n=>n.append("circle").attr("r",3)).node()}function M5(e,t){return Ht("svg:marker",t).attr("viewBox","-5 -5 10 10").attr("markerWidth",6.67).attr("markerHeight",6.67).attr("fill","var(--plot-background)").attr("stroke",e).attr("stroke-width",1.5).call(n=>n.append("circle").attr("r",3)).node()}function vf(e){return(t,n)=>Ht("svg:marker",n).attr("viewBox","-3 -3 6 6").attr("markerWidth",6).attr("markerHeight",6).attr("orient",e).attr("stroke",t).call(r=>r.append("path").attr("d","M0,-3v6")).node()}let O5=0;function C0(e,t,{stroke:n},r){return Ux(e,t,n&&(i=>n[i]),null,r)}function R5(e,t,{stroke:n,z:r},i){return Ux(e,t,n&&(([s])=>n[s]),r,i)}const Bd=1,$x=2;function D5(e,t){const n=new Uint8Array(t.length),r=e.data().filter(s=>s.length>1),i=r.length;for(let s=0,a=Cd;s<i;++s){const o=r[s];if(o.length>1){const c=o[0];a!==(a=cr(t[c]))&&(n[c]|=Bd)}}for(let s=i-1,a=Cd;s>=0;--s){const o=r[s];if(o.length>1){const c=o[0];a!==(a=cr(t[c]))&&(n[c]|=$x)}}return([s])=>n[s]}function Ux(e,{markerStart:t,markerMid:n,markerEnd:r,stroke:i},s=()=>i,a,o){if(!t&&!n&&!r)return;const c=new Map,l=a&&D5(e,a);function u(f,d,h){return function(p){if(h&&!h(p))return;const y=s(p);let g=c.get(d);g||c.set(d,g=new Map);let b=g.get(y);if(!b){const _=this.parentNode.insertBefore(d(y,o),this),E=`plot-marker-${++O5}`;_.setAttribute("id",E),g.set(y,b=`url(#${E})`)}this.setAttribute(f,b)}}t&&e.each(u("marker-start",t,l&&(f=>l(f)&Bd))),n&&l&&e.each(u("marker-start",n,f=>!(l(f)&Bd))),n&&e.each(u("marker-mid",n)),r&&e.each(u("marker-end",r,l&&(f=>l(f)&$x)))}function Su({inset:e,insetLeft:t,insetRight:n,...r}={}){return[t,n]=Px(e,t,n),{inset:e,insetLeft:t,insetRight:n,...r}}function B0({inset:e,insetTop:t,insetBottom:n,...r}={}){return[t,n]=Px(e,t,n),{inset:e,insetTop:t,insetBottom:n,...r}}function Px(e,t,n){return e===void 0&&t===void 0&&n===void 0?Ue?[1,0]:[.5,.5]:[t,n]}function jx(e,{interval:t}){return e={...yo(e)},e.interval=_0(e.interval===void 0?t:e.interval),e}function Eu(e,t,n,r){const{[e]:i,[`${e}1`]:s,[`${e}2`]:a}=n,{value:o,interval:c}=jx(i,n);if(o==null||c==null&&!r)return n;const l=Oi(i);if(c==null){let h;const p={transform:y=>h||(h=Gt(y,o)),label:l};return{...n,[e]:void 0,[`${e}1`]:s===void 0?p:s,[`${e}2`]:a===void 0&&!(s===a&&r)?p:a}}let u,f;function d(h){return f!==void 0&&h===u?f:f=Xt(Gt(u=h,o),p=>c.floor(p))}return t({...n,[e]:void 0,[`${e}1`]:s===void 0?{transform:d,label:l}:s,[`${e}2`]:a===void 0?{transform:h=>d(h).map(p=>c.offset(p)),label:l}:a})}function Vx(e,t,n){const{[e]:r}=n,{value:i,interval:s}=jx(r,n);return i==null||s==null?n:t({...n,[e]:{label:Oi(r),transform:a=>{const o=Xt(Gt(a,i),l=>s.floor(l)),c=o.map(l=>s.offset(l));return o.map(Re(o)?(l,u)=>l==null||isNaN(l=+l)||(u=c[u],u==null)||isNaN(u=+u)?void 0:new Date((l+u)/2):(l,u)=>l==null||(u=c[u],u==null)?NaN:(+l+ +u)/2)}}})}function L5(e={}){return Eu("x",Su,e,!0)}function F5(e={}){return Eu("y",B0,e,!0)}function zx(e={}){return Eu("x",Su,e)}function $0(e={}){return Eu("y",B0,e)}function k5(e={}){return Vx("x",Su,e)}function C5(e={}){return Vx("y",B0,e)}const Yx={ariaLabel:"rule",fill:null,stroke:"currentColor"};class B5 extends be{constructor(t,n={}){const{x:r,y1:i,y2:s,inset:a=0,insetTop:o=a,insetBottom:c=a}=n;super(t,{x:{value:r,scale:"x",optional:!0},y1:{value:i,scale:"y",optional:!0},y2:{value:s,scale:"y",optional:!0}},So(n,"x"),Yx),this.insetTop=pe(o),this.insetBottom=pe(c),xu(this,n)}render(t,n,r,i,s){const{x:a,y:o}=n,{x:c,y1:l,y2:u}=r,{width:f,height:d,marginTop:h,marginRight:p,marginLeft:y,marginBottom:g}=i,{insetTop:b,insetBottom:_}=this;return Ht("svg:g",s).call(Fe,this,i,s).call(ke,this,{x:c&&a},Ue,0).call(E=>E.selectAll().data(t).enter().append("line").call(ge,this).attr("x1",c?w=>c[w]:(y+f-p)/2).attr("x2",c?w=>c[w]:(y+f-p)/2).attr("y1",l&&!jn(o)?w=>l[w]+b:h+b).attr("y2",u&&!jn(o)?o.bandwidth?w=>u[w]+o.bandwidth()-_:w=>u[w]-_:d-g-_).call(De,this,r).call(C0,this,r,s)).node()}}class $5 extends be{constructor(t,n={}){const{x1:r,x2:i,y:s,inset:a=0,insetRight:o=a,insetLeft:c=a}=n;super(t,{y:{value:s,scale:"y",optional:!0},x1:{value:r,scale:"x",optional:!0},x2:{value:i,scale:"x",optional:!0}},So(n,"y"),Yx),this.insetRight=pe(o),this.insetLeft=pe(c),xu(this,n)}render(t,n,r,i,s){const{x:a,y:o}=n,{y:c,x1:l,x2:u}=r,{width:f,height:d,marginTop:h,marginRight:p,marginLeft:y,marginBottom:g}=i,{insetLeft:b,insetRight:_}=this;return Ht("svg:g",s).call(Fe,this,i,s).call(ke,this,{y:c&&o},0,Ue).call(E=>E.selectAll().data(t).enter().append("line").call(ge,this).attr("x1",l&&!jn(a)?w=>l[w]+b:y+b).attr("x2",u&&!jn(a)?a.bandwidth?w=>u[w]+a.bandwidth()-_:w=>u[w]-_:f-p-_).attr("y1",c?w=>c[w]:(h+d-g)/2).attr("y2",c?w=>c[w]:(h+d-g)/2).call(De,this,r).call(C0,this,r,s)).node()}}function Wx(e,t){let{x:n=Kt,y:r,y1:i,y2:s,...a}=$0(t);return[i,s]=Hx(r,i,s),new B5(e,{...a,x:n,y1:i,y2:s})}function U0(e,t){let{y:n=Kt,x:r,x1:i,x2:s,...a}=zx(t);return[i,s]=Hx(r,i,s),new $5(e,{...a,y:n,x1:i,x2:s})}function Hx(e,t,n){if(e==null){if(t===void 0){if(n!==void 0)return[0,n]}else if(n===void 0)return[0,t]}else{if(t===void 0)return n===void 0?[0,e]:[e,n];if(n===void 0)return[e,t]}return[t,n]}function Tu(e,...t){let n=t.length;for(let r=0,i=!0;r<n;++r)typeof t[r]!="function"&&(i&&(e=e.slice(),i=!1),e.splice(r,2,e[r]+t[r]+e[r+1]),t.splice(r,1),--r,--n);return r=>{let i=e[0];for(let s=0;s<n;++s)i+=t[s](r)+e[s+1];return i}}const U5={ariaLabel:"text",strokeLinejoin:"round",strokeWidth:3,paintOrder:"stroke"},qx="";class P0 extends be{constructor(t,n={}){const{x:r,y:i,text:s=Gr(t)&&X2(t)?Kt:Si,frameAnchor:a,textAnchor:o=/right$/i.test(a)?"end":/left$/i.test(a)?"start":"middle",lineAnchor:c=/^top/i.test(a)?"top":/^bottom/i.test(a)?"bottom":"middle",lineHeight:l=1,lineWidth:u=1/0,textOverflow:f,monospace:d,fontFamily:h=d?"ui-monospace, monospace":void 0,fontSize:p,fontStyle:y,fontVariant:g,fontWeight:b,rotate:_}=n,[E,w]=me(_,0),[A,x]=W5(p);if(super(t,{x:{value:r,scale:"x",optional:!0},y:{value:i,scale:"y",optional:!0},fontSize:{value:A,optional:!0},rotate:{value:sD(E),optional:!0},text:{value:s,filter:l0,optional:!0}},n,U5),this.rotate=w,this.textAnchor=ae(o,"middle"),this.lineAnchor=bn(c,"lineAnchor",["top","middle","bottom"]),this.lineHeight=+l,this.lineWidth=+u,this.textOverflow=Gx(f),this.monospace=!!d,this.fontFamily=de(h),this.fontSize=x,this.fontStyle=de(y),this.fontVariant=de(g),this.fontWeight=de(b),this.frameAnchor=mu(a),!(this.lineWidth>=0))throw new Error(`invalid lineWidth: ${u}`);this.splitLines=Kx(this),this.clipLine=Qx(this)}render(t,n,r,i,s){const{x:a,y:o}=n,{x:c,y:l,rotate:u,text:f,title:d,fontSize:h}=r,{rotate:p}=this,[y,g]=xo(this,i);return Ht("svg:g",s).call(Fe,this,i,s).call(Xx,this,f,i).call(ke,this,{x:c&&a,y:l&&o}).call(b=>b.selectAll().data(t).enter().append("text").call(ge,this).call(P5,this,f,d).attr("transform",Tu`translate(${c?_=>c[_]:y},${l?_=>l[_]:g})${u?_=>` rotate(${u[_]})`:p?` rotate(${p})`:""}`).call(ht,"font-size",h&&(_=>h[_])).call(De,this,r)).node()}}function Gx(e){return e==null?null:bn(e,"textOverflow",["clip","ellipsis","clip-start","clip-end","ellipsis-start","ellipsis-middle","ellipsis-end"]).replace(/^(clip|ellipsis)$/,"$1-end")}function P5(e,t,n,r){if(!n)return;const{lineAnchor:i,lineHeight:s,textOverflow:a,splitLines:o,clipLine:c}=t;e.each(function(l){const u=o(Ts(n[l])??"").map(c),f=u.length,d=i==="top"?.71:i==="bottom"?1-f:(164-f*100)/200;if(f>1){let h=0;for(let p=0;p<f;++p){if(++h,!u[p])continue;const y=this.ownerDocument.createElementNS(Ur.svg,"tspan");y.setAttribute("x",0),p===h-1?y.setAttribute("y",`${(d+p)*s}em`):y.setAttribute("dy",`${h*s}em`),y.textContent=u[p],this.appendChild(y),h=0}}else d&&this.setAttribute("y",`${d*s}em`),this.textContent=u[0];if(a&&!r&&u[0]!==n[l]){const h=this.ownerDocument.createElementNS(Ur.svg,"title");h.textContent=n[l],this.appendChild(h)}})}function yr(e,{x:t,y:n,...r}={}){return r.frameAnchor===void 0&&([t,n]=hu(t,n)),new P0(e,{...r,x:t,y:n})}function j5(e,{x:t=Kt,...n}={}){return new P0(e,C5({...n,x:t}))}function V5(e,{y:t=Kt,...n}={}){return new P0(e,k5({...n,y:t}))}function Xx(e,t,n){ht(e,"text-anchor",t.textAnchor),ht(e,"font-family",t.fontFamily),ht(e,"font-size",t.fontSize),ht(e,"font-style",t.fontStyle),ht(e,"font-variant",t.fontVariant===void 0?z5(n):t.fontVariant),ht(e,"font-weight",t.fontWeight)}function z5(e){return e&&(cD(e)||Re(e))?"tabular-nums":void 0}const Y5=new Set(["inherit","initial","revert","unset","xx-small","x-small","small","medium","large","x-large","xx-large","xxx-large","larger","smaller"]);function W5(e){return e==null||typeof e=="number"?[void 0,e]:typeof e!="string"?[e,void 0]:(e=e.trim().toLowerCase(),Y5.has(e)||/^[+-]?\d*\.?\d+(e[+-]?\d+)?(\w*|%)$/.test(e)?[void 0,e]:[e,void 0])}function H5(e,t,n){const r=[];let i,s=0;for(const[a,o,c]of q5(e)){if(i===void 0&&(i=a),s>i&&n(e,i,o)>t&&(r.push(e.slice(i,s)+(e[s-1]===qx?"-":"")),i=a),c){r.push(e.slice(i,o)),i=void 0;continue}s=o}return r}function*q5(e){let t=0,n=0;const r=e.length;for(;n<r;){let i=1;switch(e[n]){case qx:case"-":++n,yield[t,n,!1],t=n;break;case" ":for(yield[t,n,!1];e[++n]===" ";);t=n;break;case"\r":e[n+1]===`
`&&++i;case`
`:yield[t,n,!0],n+=i,t=n;break;default:++n;break}}yield[t,n,!0]}const Ay={a:56,b:63,c:57,d:63,e:58,f:37,g:62,h:60,i:26,j:26,k:55,l:26,m:88,n:60,o:60,p:62,q:62,r:39,s:54,t:38,u:60,v:55,w:79,x:54,y:55,z:55,A:69,B:67,C:73,D:74,E:61,F:58,G:76,H:75,I:28,J:55,K:67,L:58,M:89,N:75,O:78,P:65,Q:78,R:67,S:65,T:65,U:75,V:69,W:98,X:69,Y:67,Z:67,0:64,1:48,2:62,3:64,4:66,5:63,6:65,7:58,8:65,9:65," ":29,"!":32,'"':49,"'":31,"(":39,")":39,",":31,"-":48,".":31,"/":32,":":31,";":31,"?":52,"":31,"":31,"":47,"":47,"":82};function j0(e,t=0,n=e.length){let r=0;for(let i=t;i<n;i=$s(e,i))r+=Ay[e[i]]??(Zx(e,i)?120:Ay.e);return r}function V0(e,t=0,n=e.length){let r=0;for(let i=t;i<n;i=$s(e,i))r+=Zx(e,i)?126:63;return r}function Kx({monospace:e,lineWidth:t,textOverflow:n}){if(n!=null||t==1/0)return s=>s.split(/\r\n?|\n/g);const r=e?V0:j0,i=t*100;return s=>H5(s,i,r)}function Qx({monospace:e,lineWidth:t,textOverflow:n}){if(n==null||t==1/0)return s=>s;const r=e?V0:j0,i=t*100;switch(n){case"clip-start":return s=>Ny(s,i,r,"");case"clip-end":return s=>Iy(s,i,r,"");case"ellipsis-start":return s=>Ny(s,i,r,as);case"ellipsis-middle":return s=>G5(s,i,r,as);case"ellipsis-end":return s=>Iy(s,i,r,as)}}const as="";function As(e,t,n,r){const i=[];let s=0;for(let a=0,o=0,c=e.length;a<c;a=o){o=$s(e,a);const l=n(e,a,o);if(s+l>t){for(s+=r;s>t&&a>0;)o=a,a=i.pop(),s-=n(e,a,o);return[a,t-s]}s+=l,i.push(a)}return[-1,0]}function Iy(e,t,n,r){e=e.trim();const i=n(r),[s]=As(e,t,n,i);return s<0?e:e.slice(0,s).trimEnd()+r}function G5(e,t,n,r){e=e.trim();const i=n(e);if(i<=t)return e;const s=n(r)/2,[a,o]=As(e,t/2,n,s),[c]=As(e,i-t/2-o+s,n,-s);return c<0?r:e.slice(0,a).trimEnd()+r+e.slice($s(e,c)).trimStart()}function Ny(e,t,n,r){e=e.trim();const i=n(e);if(i<=t)return e;const s=n(r),[a]=As(e,i-t+s,n,-s);return a<0?r:r+e.slice($s(e,a)).trimStart()}const $d=/[\p{Combining_Mark}\p{Emoji_Modifier}]+/uy,My=/\p{Extended_Pictographic}/uy;function $s(e,t){return t+=X5(e,t)?2:1,Q5(e,t)&&(t=$d.lastIndex),K5(e,t)?$s(e,t+1):t}function Jx(e,t){return e.charCodeAt(t)<128}function X5(e,t){const n=e.charCodeAt(t);if(n>=55296&&n<56320){const r=e.charCodeAt(t+1);return r>=56320&&r<57344}return!1}function K5(e,t){return e.charCodeAt(t)===8205}function Q5(e,t){return Jx(e,t)?!1:($d.lastIndex=t,$d.test(e))}function Zx(e,t){return Jx(e,t)?!1:(My.lastIndex=t,My.test(e))}const J5={ariaLabel:"vector",fill:"none",stroke:"currentColor",strokeWidth:1.5,strokeLinejoin:"round",strokeLinecap:"round"},tS=3.5,Z5=tS*5,eS={draw(e,t,n){const r=t*n/Z5;e.moveTo(0,0),e.lineTo(0,-t),e.moveTo(-r,r-t),e.lineTo(0,-t),e.lineTo(r,r-t)}},tF={draw(e,t,n){e.moveTo(-n,0),e.lineTo(0,-t),e.lineTo(n,0)}},eF=new Map([["arrow",eS],["spike",tF]]);function nF(e){return e&&typeof e.draw=="function"}function rF(e){if(nF(e))return e;const t=eF.get(`${e}`.toLowerCase());if(t)return t;throw new Error(`invalid shape: ${e}`)}class nS extends be{constructor(t,n={}){const{x:r,y:i,r:s=tS,length:a,rotate:o,shape:c=eS,anchor:l="middle",frameAnchor:u}=n,[f,d]=me(a,12),[h,p]=me(o,0);super(t,{x:{value:r,scale:"x",optional:!0},y:{value:i,scale:"y",optional:!0},length:{value:f,scale:"length",optional:!0},rotate:{value:h,optional:!0}},n,J5),this.r=+s,this.length=d,this.rotate=p,this.shape=rF(c),this.anchor=bn(l,"anchor",["start","middle","end"]),this.frameAnchor=mu(u)}render(t,n,r,i,s){const{x:a,y:o}=n,{x:c,y:l,length:u,rotate:f}=r,{length:d,rotate:h,anchor:p,shape:y,r:g}=this,[b,_]=xo(this,i);return Ht("svg:g",s).call(Fe,this,i,s).call(ke,this,{x:c&&a,y:l&&o}).call(E=>E.selectAll().data(t).enter().append("path").call(ge,this).attr("transform",Tu`translate(${c?w=>c[w]:b},${l?w=>l[w]:_})${f?w=>` rotate(${f[w]})`:h?` rotate(${h})`:""}${p==="start"?"":p==="end"?u?w=>` translate(0,${u[w]})`:` translate(0,${d})`:u?w=>` translate(0,${u[w]/2})`:` translate(0,${d/2})`}`).attr("d",u?w=>{const A=Rr();return y.draw(A,u[w],g),A}:(()=>{const w=Rr();return y.draw(w,d,g),w})()).call(De,this,r)).node()}}function iF(e,t={}){const{x:n=Kt,...r}=t;return new nS(e,{...r,x:n})}function sF(e,t={}){const{y:n=Kt,...r}=t;return new nS(e,{...r,y:n})}function Kr(e,t){return arguments.length<2&&!Gr(e)&&(t=e,e=null),t===void 0&&(t={}),[e,t]}function Au({anchor:e}={},t){return e===void 0?t[0]:bn(e,"anchor",t)}function rS(e){return Au(e,["left","right"])}function iS(e){return Au(e,["right","left"])}function sS(e){return Au(e,["bottom","top"])}function aS(e){return Au(e,["top","bottom"])}function oS(){const[e,t]=Kr(...arguments);return lS("y",rS(t),e,t)}function aF(){const[e,t]=Kr(...arguments);return lS("fy",iS(t),e,t)}function cS(){const[e,t]=Kr(...arguments);return uS("x",sS(t),e,t)}function oF(){const[e,t]=Kr(...arguments);return uS("fx",aS(t),e,t)}function lS(e,t,n,{color:r="currentColor",opacity:i=1,stroke:s=r,strokeOpacity:a=i,strokeWidth:o=1,fill:c=r,fillOpacity:l=i,textAnchor:u,textStroke:f,textStrokeOpacity:d,textStrokeWidth:h,tickSize:p=e==="y"?6:0,tickPadding:y,tickRotate:g,x:b,margin:_,marginTop:E=_===void 0?20:_,marginRight:w=_===void 0?t==="right"?40:0:_,marginBottom:A=_===void 0?20:_,marginLeft:x=_===void 0?t==="left"?40:0:_,label:T,labelAnchor:M,labelArrow:R,labelOffset:F,ariaLabel:N=`${e}-axis`,...B}){return p=pe(p),y=pe(y),g=pe(g),M!==void 0&&(M=bn(M,"labelAnchor",["center","top","bottom"])),R=bS(R),Rx(p&&!Te(s)?cF(e,t,n,{stroke:s,strokeOpacity:a,strokeWidth:o,tickSize:p,tickPadding:y,tickRotate:g,x:b,ariaLabel:N,...B}):null,Te(c)?null:uF(e,t,n,{fill:c,fillOpacity:l,stroke:f,strokeOpacity:d,strokeWidth:h,textAnchor:u,tickSize:p,tickPadding:y,tickRotate:g,x:b,marginTop:E,marginRight:w,marginBottom:A,marginLeft:x,ariaLabel:N,...B}),!Te(c)&&T!==null?yr([],pS({fill:c,fillOpacity:l,...B},function(W,D,S,I,O){const C=I[e],{marginTop:L,marginRight:$,marginBottom:j,marginLeft:Y}=e==="y"&&O.inset||O,V=M??(C.bandwidth?"center":"top"),K=F??(t==="right"?$:Y)-3;return V==="center"?(this.textAnchor=void 0,this.lineAnchor=t==="right"?"bottom":"top",this.frameAnchor=t,this.rotate=-90):(this.textAnchor=t==="right"?"end":"start",this.lineAnchor=V,this.frameAnchor=`${V}-${t}`,this.rotate=0),this.dy=V==="top"?3-L:V==="bottom"?j-3:0,this.dx=t==="right"?K:-K,this.ariaLabel=`${N} label`,{facets:[[0]],channels:{text:{value:[gS(e,C,{anchor:t,label:T,labelAnchor:V,labelArrow:R})]}}}})):null)}function uS(e,t,n,{color:r="currentColor",opacity:i=1,stroke:s=r,strokeOpacity:a=i,strokeWidth:o=1,fill:c=r,fillOpacity:l=i,textAnchor:u,textStroke:f,textStrokeOpacity:d,textStrokeWidth:h,tickSize:p=e==="x"?6:0,tickPadding:y,tickRotate:g,y:b,margin:_,marginTop:E=_===void 0?t==="top"?30:0:_,marginRight:w=_===void 0?20:_,marginBottom:A=_===void 0?t==="bottom"?30:0:_,marginLeft:x=_===void 0?20:_,label:T,labelAnchor:M,labelArrow:R,labelOffset:F,ariaLabel:N=`${e}-axis`,...B}){return p=pe(p),y=pe(y),g=pe(g),M!==void 0&&(M=bn(M,"labelAnchor",["center","left","right"])),R=bS(R),Rx(p&&!Te(s)?lF(e,t,n,{stroke:s,strokeOpacity:a,strokeWidth:o,tickSize:p,tickPadding:y,tickRotate:g,y:b,ariaLabel:N,...B}):null,Te(c)?null:fF(e,t,n,{fill:c,fillOpacity:l,stroke:f,strokeOpacity:d,strokeWidth:h,textAnchor:u,tickSize:p,tickPadding:y,tickRotate:g,y:b,marginTop:E,marginRight:w,marginBottom:A,marginLeft:x,ariaLabel:N,...B}),!Te(c)&&T!==null?yr([],pS({fill:c,fillOpacity:l,...B},function(W,D,S,I,O){const C=I[e],{marginTop:L,marginRight:$,marginBottom:j,marginLeft:Y}=e==="x"&&O.inset||O,V=M??(C.bandwidth?"center":"right"),K=F??(t==="top"?L:j)-3;return V==="center"?(this.frameAnchor=t,this.textAnchor=void 0):(this.frameAnchor=`${t}-${V}`,this.textAnchor=V==="right"?"end":"start"),this.lineAnchor=t,this.dy=t==="top"?-K:K,this.dx=V==="right"?$-3:V==="left"?3-Y:0,this.ariaLabel=`${N} label`,{facets:[[0]],channels:{text:{value:[gS(e,C,{anchor:t,label:T,labelAnchor:V,labelArrow:R})]}}}})):null)}function cF(e,t,n,{strokeWidth:r=1,strokeLinecap:i=null,strokeLinejoin:s=null,facetAnchor:a=t+(e==="y"?"-empty":""),frameAnchor:o=t,tickSize:c,inset:l=0,insetLeft:u=l,insetRight:f=l,dx:d=0,y:h=e==="y"?void 0:null,ariaLabel:p,...y}){return Us(sF,e,n,{ariaLabel:`${p} tick`,ariaHidden:!0},{strokeWidth:r,strokeLinecap:i,strokeLinejoin:s,facetAnchor:a,frameAnchor:o,y:h,...y,dx:t==="left"?+d-Ue+ +u:+d+Ue-f,anchor:"start",length:c,shape:t==="left"?_F:wF})}function lF(e,t,n,{strokeWidth:r=1,strokeLinecap:i=null,strokeLinejoin:s=null,facetAnchor:a=t+(e==="x"?"-empty":""),frameAnchor:o=t,tickSize:c,inset:l=0,insetTop:u=l,insetBottom:f=l,dy:d=0,x:h=e==="x"?void 0:null,ariaLabel:p,...y}){return Us(iF,e,n,{ariaLabel:`${p} tick`,ariaHidden:!0},{strokeWidth:r,strokeLinejoin:s,strokeLinecap:i,facetAnchor:a,frameAnchor:o,x:h,...y,dy:t==="bottom"?+d-Ue-f:+d+Ue+ +u,anchor:"start",length:c,shape:t==="bottom"?gF:bF})}function uF(e,t,n,{facetAnchor:r=t+(e==="y"?"-empty":""),frameAnchor:i=t,tickSize:s,tickRotate:a=0,tickPadding:o=Math.max(3,9-s)+(Math.abs(a)>60?4*Math.cos(a*Bx):0),text:c,textAnchor:l=Math.abs(a)>60?"middle":t==="left"?"end":"start",lineAnchor:u=a>60?"top":a<-60?"bottom":"middle",fontVariant:f,inset:d=0,insetLeft:h=d,insetRight:p=d,dx:y=0,ariaLabel:g,y:b=e==="y"?void 0:null,..._}){return Us(V5,e,n,{ariaLabel:`${g} tick label`},{facetAnchor:r,frameAnchor:i,text:c,textAnchor:l,lineAnchor:u,fontVariant:f,rotate:a,y:b,..._,dx:t==="left"?+y-s-o+ +h:+y+ +s+ +o-p},function(E,w,A,x,T){f===void 0&&(this.fontVariant=yS(E)),c===void 0&&(T.text=mS(E,w,A,x,t))})}function fF(e,t,n,{facetAnchor:r=t+(e==="x"?"-empty":""),frameAnchor:i=t,tickSize:s,tickRotate:a=0,tickPadding:o=Math.max(3,9-s)+(Math.abs(a)>=10?4*Math.cos(a*Bx):0),text:c,textAnchor:l=Math.abs(a)>=10?a<0^t==="bottom"?"start":"end":"middle",lineAnchor:u=Math.abs(a)>=10?"middle":t==="bottom"?"top":"bottom",fontVariant:f,inset:d=0,insetTop:h=d,insetBottom:p=d,dy:y=0,x:g=e==="x"?void 0:null,ariaLabel:b,..._}){return Us(j5,e,n,{ariaLabel:`${b} tick label`},{facetAnchor:r,frameAnchor:i,text:c===void 0?null:c,textAnchor:l,lineAnchor:u,fontVariant:f,rotate:a,x:g,..._,dy:t==="bottom"?+y+ +s+ +o-p:+y-s-o+ +h},function(E,w,A,x,T){f===void 0&&(this.fontVariant=yS(E)),c===void 0&&(T.text=mS(E,w,A,x,t))})}function dF(){const[e,t]=Kr(...arguments);return fS("y",rS(t),e,t)}function hF(){const[e,t]=Kr(...arguments);return fS("fy",iS(t),e,t)}function pF(){const[e,t]=Kr(...arguments);return dS("x",sS(t),e,t)}function mF(){const[e,t]=Kr(...arguments);return dS("fx",aS(t),e,t)}function fS(e,t,n,{y:r=e==="y"?void 0:null,x:i=null,x1:s=t==="left"?i:null,x2:a=t==="right"?i:null,ariaLabel:o=`${e}-grid`,ariaHidden:c=!0,...l}){return Us(U0,e,n,{ariaLabel:o,ariaHidden:c},{y:r,x1:s,x2:a,...hS(l)})}function dS(e,t,n,{x:r=e==="x"?void 0:null,y:i=null,y1:s=t==="top"?i:null,y2:a=t==="bottom"?i:null,ariaLabel:o=`${e}-grid`,ariaHidden:c=!0,...l}){return Us(Wx,e,n,{ariaLabel:o,ariaHidden:c},{x:r,y1:s,y2:a,...hS(l)})}function hS({color:e="currentColor",opacity:t=.1,stroke:n=e,strokeOpacity:r=t,strokeWidth:i=1,...s}){return{stroke:n,strokeOpacity:r,strokeWidth:i,...s}}function pS({fill:e,fillOpacity:t,fontFamily:n,fontSize:r,fontStyle:i,fontVariant:s,fontWeight:a,monospace:o,pointerEvents:c,shapeRendering:l,clip:u=!1},f){return[,e]=mr(e),[,t]=me(t),{facet:"super",x:null,y:null,fill:e,fillOpacity:t,fontFamily:n,fontSize:r,fontStyle:i,fontVariant:s,fontWeight:a,monospace:o,pointerEvents:c,shapeRendering:l,clip:u,initializer:f}}function Us(e,t,n,r,i,s){let a;function o(u,f,d,h,p,y){const g=u==null&&(t==="fx"||t==="fy"),{[t]:b}=h;if(!b)throw new Error(`missing scale: ${t}`);const _=b.domain();let{interval:E,ticks:w,tickFormat:A,tickSpacing:x=t==="x"?80:35}=i;if(typeof w=="string"&&_S(b)&&(E=w,w=void 0),w===void 0&&(w=Bs(E,b.type)??yF(b,x)),u==null){if(Gr(w))u=Mi(w);else if(Ji(w))u=xf(w,...$e(_));else if(b.interval){let M=b.interval;if(b.ticks){const[R,F]=$e(_),N=(F-R)/M[mo];M=Qm(M,N/w)??M,u=xf(M,R,F)}else{u=_;const R=u.length;M=Qm(M,R/w)??M,M!==b.interval&&(u=xf(M,...$e(u)))}if(M===b.interval){const R=Math.round(u.length/w);R>1&&(u=u.filter((F,N)=>N%R===0))}}else b.ticks?u=b.ticks(w):u=_;if(!b.ticks&&u.length&&u!==_){const M=new Pl(_);u=u.filter(R=>M.has(R)),u.length||Fr(`Warning: the ${t}-axis ticks appear to not align with the scale domain, resulting in no ticks. Try different ticks?`)}t==="y"||t==="x"?f=[Sr(u)]:a[t]={scale:t,value:Kt}}s?.call(this,b,u,w,A,a);const T=Object.fromEntries(Object.entries(a).map(([M,R])=>[M,{...R,value:Gt(u,R.value)}]));return g&&(f=y.filterFacets(u,T)),{data:u,facets:f,channels:T}}const c=zr(i).initializer,l=e(n,zr({...i,initializer:o},c));return n==null?(a=l.channels,l.channels={}):a={},r!==void 0&&Object.assign(l,r),l.clip===void 0&&(l.clip=!1),l}function yF(e,t){const[n,r]=$e(e.range());return(r-n)/t}function mS(e,t,n,r,i){return{value:z0(e,t,n,r,i)}}function z0(e,t,n,r,i){return typeof r=="function"&&!(e.type==="log"&&e.tickFormat)?r:r===void 0&&t&&Re(t)?H8(e.type,t,i)??Ts:e.tickFormat?e.tickFormat(typeof n=="number"?n:null,r):typeof r=="string"&&e.domain().length>0?(Re(e.domain())?fo:ks)(r):r===void 0?Ts:or(r)}function xf(e,t,n){return e.range(t,e.offset(e.floor(n)))}const gF={draw(e,t){e.moveTo(0,0),e.lineTo(0,t)}},bF={draw(e,t){e.moveTo(0,0),e.lineTo(0,-t)}},_F={draw(e,t){e.moveTo(0,0),e.lineTo(-t,0)}},wF={draw(e,t){e.moveTo(0,0),e.lineTo(t,0)}};function yS(e){return e.bandwidth&&!e.interval?void 0:"tabular-nums"}function gS(e,t,{anchor:n,label:r=t.label,labelAnchor:i,labelArrow:s}={}){if(!(r==null||r.inferred&&_S(t)&&/^(date|time|year)$/i.test(r))){if(r=String(r),s==="auto"&&(s=(!t.bandwidth||t.interval)&&!/[]/.test(r)),!s)return r;if(s===!0){const a=AL(t);a&&(s=/x$/.test(e)||i==="center"?/x$/.test(e)===a<0?"left":"right":a<0?"up":"down")}switch(s){case"left":return` ${r}`;case"right":return`${r} `;case"up":return n==="right"?`${r} `:` ${r}`;case"down":return n==="right"?`${r} `:` ${r}`}return r}}function bS(e="auto"){return Te(e)?!1:typeof e=="boolean"?e:bn(e,"labelArrow",["auto","up","right","down","left"])}function _S(e){return Re(e.domain())}function Oy(e,t){if(t==null)return t;const n=e(t);if(!n)throw new Error(`scale not found: ${t}`);return n}function vF(e,{opacity:t,...n}={}){if(!Ri(e)&&!Ex(e))throw new Error(`swatches legend requires ordinal or threshold color scale (not ${e.type})`);return wS(e,n,(r,i,s,a)=>r.append("svg").attr("width",s).attr("height",a).attr("fill",i.scale).attr("fill-opacity",me(t)[1]).append("rect").attr("width","100%").attr("height","100%"))}function xF(e,{fill:t=e.hint?.fill!==void 0?e.hint.fill:"none",fillOpacity:n=1,stroke:r=e.hint?.stroke!==void 0?e.hint.stroke:Te(t)?"currentColor":"none",strokeOpacity:i=1,strokeWidth:s=1.5,r:a=4.5,...o}={},c){const[l,u]=mr(t),[f,d]=mr(r),h=Oy(c,l),p=Oy(c,f),y=a*a*Math.PI;return n=me(n)[1],i=me(i)[1],s=me(s)[1],wS(e,o,(g,b,_,E)=>g.append("svg").attr("viewBox","-8 -8 16 16").attr("width",_).attr("height",E).attr("fill",l==="color"?w=>h.scale(w):u).attr("fill-opacity",n).attr("stroke",f==="color"?w=>p.scale(w):d).attr("stroke-opacity",i).attr("stroke-width",s).append("path").attr("d",w=>{const A=Rr();return e.scale(w).draw(A,y),A}))}function wS(e,t={},n){let{columns:r,tickFormat:i,fontVariant:s=Cx(e),swatchSize:a=15,swatchWidth:o=a,swatchHeight:c=a,marginLeft:l=0,className:u,style:f,width:d}=t;const h=R0(t);u=D0(u),i=z0(e.scale,e.domain,void 0,i);const p=Ht("div",h).attr("class",`${u}-swatches ${u}-swatches-${r!=null?"columns":"wrap"}`);let y;return r!=null?(y=`:where(.${u}-swatches-columns .${u}-swatch) {
  display: flex;
  align-items: center;
  break-inside: avoid;
  padding-bottom: 1px;
}
:where(.${u}-swatches-columns .${u}-swatch::before) {
  flex-shrink: 0;
}
:where(.${u}-swatches-columns .${u}-swatch-label) {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}`,p.style("columns",r).selectAll().data(e.domain).enter().append("div").attr("class",`${u}-swatch`).call(n,e,o,c).call(g=>g.append("div").attr("class",`${u}-swatch-label`).attr("title",i).text(i))):(y=`:where(.${u}-swatches-wrap) {
  display: flex;
  align-items: center;
  min-height: 33px;
  flex-wrap: wrap;
}
:where(.${u}-swatches-wrap .${u}-swatch) {
  display: inline-flex;
  align-items: center;
  margin-right: 1em;
}`,p.selectAll().data(e.domain).enter().append("span").attr("class",`${u}-swatch`).call(n,e,o,c).append(function(){return this.ownerDocument.createTextNode(i.apply(this,arguments))})),p.call(g=>g.insert("style","*").text(`:where(.${u}-swatches) {
  font-family: system-ui, sans-serif;
  font-size: 10px;
  margin-bottom: 0.5em;
}
:where(.${u}-swatch > svg) {
  margin-right: 0.5em;
  overflow: visible;
}
${y}`)).style("margin-left",l?`${+l}px`:null).style("width",d===void 0?null:`${+d}px`).style("font-variant",ae(s,"normal")).call(L0,f).node()}const Ud=new Map([["symbol",xF],["color",xS],["opacity",EF]]);function SF(e,t,n={}){return(r,i)=>{if(!Ud.has(r))throw new Error(`unknown legend type: ${r}`);if(r in e)return Ud.get(r)(e[r],vS(t,n[r],i),s=>e[s])}}function vS({className:e,...t},{label:n,ticks:r,tickFormat:i}={},s){return dD(s,{className:e,...t},{label:n,ticks:r,tickFormat:i})}function xS(e,{legend:t=!0,...n}){if(t===!0&&(t=e.type==="ordinal"?"swatches":"ramp"),e.domain!==void 0)switch(`${t}`.toLowerCase()){case"swatches":return vF(e,n);case"ramp":return I5(e,n);default:throw new Error(`unknown legend type: ${t}`)}}function EF({type:e,interpolate:t,...n},{legend:r=!0,color:i=Pr(0,0,0),...s}){if(!t)throw new Error(`${e} opacity scales are not supported`);if(r===!0&&(r="ramp"),`${r}`.toLowerCase()!=="ramp")throw new Error(`${r} opacity legends are not supported`);return xS({type:e,...n,interpolate:TF(i)},{legend:r,...s})}function TF(e){const{r:t,g:n,b:r}=Pr(e)||Pr(0,0,0);return i=>`rgba(${t},${n},${r},${i})`}function AF(e,t,n){const r=[];for(const[i,s]of Ud){const a=n[i];if(a?.legend&&i in e){const o=s(e[i],vS(t,e[i],a),c=>e[c]);o!=null&&r.push(o)}}return r}function IF(e={},t="x"){return Y2(e)?e:{...e,[t]:Kt}}function Y0(e={},t="y"){return W2(e)?e:{...e,[t]:Kt}}function NF(e,t){if(t.length===1)return{data:e,facets:t};const n=Ua(e),r=new Uint8Array(n);let i=0;for(const o of t)for(const c of o)r[c]&&++i,r[c]=1;if(i===0)return{data:e,facets:t};e=$a(e);const s=e[$2]=new Uint32Array(n+i);t=t.map(o=>$a(o,Uint32Array));let a=n;r.fill(0);for(const o of t)for(let c=0,l=o.length;c<l;++c){const u=o[c];r[u]?(o[c]=a,e[a]=e[u],s[a]=u,++a):s[u]=u,r[u]=1}return{data:e,facets:t}}function MF(e={},t={}){arguments.length===1&&([e,t]=SS(e));const{y1:n,y:r=n,x:i,...s}=t,[a,o,c,l]=ES(r,i,"y","x",e,s);return{...a,y1:n,y:o,x1:c,x2:l,x:Al(c,l)}}function OF(e={},t={}){arguments.length===1&&([e,t]=SS(e));const{x1:n,x:r=n,y:i,...s}=t,[a,o,c,l]=ES(r,i,"x","y",e,s);return{...a,x1:n,x:o,y1:c,y2:l,y:Al(c,l)}}function RF({x:e,x1:t,x2:n,...r}={}){return r=So(r,"y"),t===void 0&&n===void 0?MF({x:e,...r}):([t,n]=H2(e,t,n),{...r,x1:t,x2:n})}function W0({y:e,y1:t,y2:n,...r}={}){return r=So(r,"x"),t===void 0&&n===void 0?OF({y:e,...r}):([t,n]=H2(e,t,n),{...r,y1:t,y2:n})}function SS(e){const{offset:t,order:n,reverse:r,...i}=e;return[{offset:t,order:n,reverse:r},i]}const DF={length:!0};function ES(e,t=Q8,n,r,{offset:i,order:s,reverse:a},o){if(t===null)throw new Error(`stack requires ${r}`);const c=g0(o),[l,u]=Kn(e),[f,d]=Tl(t),[h,p]=Tl(t);return f.hint=h.hint=DF,i=LF(i),s=CF(s,i,r),[gu(o,(y,g,b)=>{({data:y,facets:g}=NF(y,g));const _=e==null?void 0:u(q2(Gt(y,e),b?.[n])),E=Gt(y,t,Float64Array),w=Gt(y,c),A=s&&s(y,_,E,w),x=Ua(y),T=d(new Float64Array(x)),M=p(new Float64Array(x)),R=[];for(const F of g){const N=_?Array.from(jl(F,B=>_[B]).values()):[F];if(A)for(const B of N)B.sort(A);for(const B of N){let W=0,D=0;a&&B.reverse();for(const S of B){const I=E[S];I<0?W=M[S]=(T[S]=W)+I:I>0?D=M[S]=(T[S]=D)+I:M[S]=T[S]=D}}R.push(N)}return i&&i(R,T,M,w),{data:y,facets:g}}),l,f,h]}function LF(e){if(e!=null){if(typeof e=="function")return e;switch(`${e}`.toLowerCase()){case"expand":case"normalize":return FF;case"center":case"silhouette":return kF;case"wiggle":return AS}throw new Error(`unknown offset: ${e}`)}}function TS(e,t){let n=0,r=0;for(const i of e){const s=t[i];s<n&&(n=s),s>r&&(r=s)}return[n,r]}function FF(e,t,n){for(const r of e)for(const i of r){const[s,a]=TS(i,n);for(const o of i){const c=1/(a-s||1);t[o]=c*(t[o]-s),n[o]=c*(n[o]-s)}}}function kF(e,t,n){for(const r of e){for(const i of r){const[s,a]=TS(i,n);for(const o of i){const c=(a+s)/2;t[o]-=c,n[o]-=c}}IS(r,t,n)}NS(e,t,n)}function AS(e,t,n,r){for(const i of e){const s=new mi;let a=0;for(const o of i){let c=-1;const l=o.map(h=>Math.abs(n[h]-t[h])),u=o.map(h=>{c=r?r[h]:++c;const p=n[h]-t[h],y=s.has(c)?p-s.get(c):0;return s.set(c,p),y}),f=[0,...M6(u)];for(const h of o)t[h]+=a,n[h]+=a;const d=$r(l);d&&(a-=$r(l,(h,p)=>(u[p]/2+f[p])*h)/d)}IS(i,t,n)}NS(e,t,n)}function IS(e,t,n){const r=fr(e,i=>fr(i,s=>t[s]));for(const i of e)for(const s of i)t[s]-=r,n[s]-=r}function NS(e,t,n){const r=e.length;if(r===1)return;const i=e.map(o=>o.flat()),s=i.map(o=>(fr(o,c=>t[c])+je(o,c=>n[c]))/2),a=fr(s);for(let o=0;o<r;o++){const c=a-s[o];for(const l of i[o])t[l]+=c,n[l]+=c}}function CF(e,t,n){if(e===void 0&&t===AS)return Ry(pn);if(e!=null){if(typeof e=="string"){const r=e.startsWith("-"),i=r?Sl:pn;switch((r?e.slice(1):e).toLowerCase()){case"value":case n:return BF(i);case"z":return $F(i);case"sum":return UF(i);case"appearance":return PF(i);case"inside-out":return Ry(i)}return Dy(U2(e))}if(typeof e=="function")return(e.length===1?Dy:jF)(e);if(Ni(e))return VF(e);throw new Error(`invalid order: ${e}`)}}function BF(e){return(t,n,r)=>(i,s)=>e(r[i],r[s])}function $F(e){return(t,n,r,i)=>(s,a)=>e(i[s],i[a])}function UF(e){return Iu(e,(t,n,r,i)=>kh(Sr(t),s=>$r(s,a=>r[a]),s=>i[s]))}function PF(e){return Iu(e,(t,n,r,i)=>kh(Sr(t),s=>n[G_(s,a=>r[a])],s=>i[s]))}function Ry(e){return Iu(e,(t,n,r,i)=>{const s=Sr(t),a=kh(s,f=>n[G_(f,d=>r[d])],f=>i[f]),o=rs(s,f=>$r(f,d=>r[d]),f=>i[f]),c=[],l=[];let u=0;for(const f of a)u<0?(u+=o.get(f),c.push(f)):(u-=o.get(f),l.push(f));return l.reverse().concat(c)})}function Dy(e){return t=>{const n=Gt(t,e);return(r,i)=>pn(n[r],n[i])}}function jF(e){return t=>Ni(t)?(n,r)=>e(t[n],t[r]):(n,r)=>e(t.get(n),t.get(r))}function VF(e){return Iu(pn,()=>e)}function Iu(e,t){return(n,r,i,s)=>{if(!s)throw new Error("missing channel: z");const a=new mi(t(n,r,i,s).map((o,c)=>[o,c]));return(o,c)=>e(a.get(s[o]),a.get(s[c]))}}const zF={ariaLabel:"rect"};class YF extends be{constructor(t,n={}){const{x1:r,y1:i,x2:s,y2:a}=n;super(t,{x1:{value:r,scale:"x",type:r!=null&&s==null?"band":void 0,optional:!0},y1:{value:i,scale:"y",type:i!=null&&a==null?"band":void 0,optional:!0},x2:{value:s,scale:"x",optional:!0},y2:{value:a,scale:"y",optional:!0}},n,zF),H0(this,n),q0(this,n)}render(t,n,r,i,s){const{x:a,y:o}=n;let{x1:c,y1:l,x2:u,y2:f}=r;const{marginTop:d,marginRight:h,marginBottom:p,marginLeft:y,width:g,height:b}=i,{projection:_}=s,{insetTop:E,insetRight:w,insetBottom:A,insetLeft:x}=this,{rx:T,ry:M,rx1y1:R,rx1y2:F,rx2y1:N,rx2y2:B}=this;(c||u)&&!_&&jn(a)&&(c=u=null),(l||f)&&!_&&jn(o)&&(l=f=null);const W=a?.bandwidth?a.bandwidth():0,D=o?.bandwidth?o.bandwidth():0;return Ht("svg:g",s).call(Fe,this,i,s).call(ke,this,{},0,0).call(S=>S.selectAll().data(t).enter().call(R||F||N||B?I=>I.append("path").call(ge,this).call(G0,c&&u?O=>c[O]+(u[O]<c[O]?-w:x):c?O=>c[O]+x:y+x,l&&f?O=>l[O]+(f[O]<l[O]?-A:E):l?O=>l[O]+E:d+E,c&&u?O=>u[O]-(u[O]<c[O]?-x:w):c?O=>c[O]+W-w:g-h-w,l&&f?O=>f[O]-(f[O]<l[O]?-E:A):l?O=>l[O]+D-A:b-p-A,this).call(De,this,r):I=>I.append("rect").call(ge,this).attr("x",c?u?O=>Math.min(c[O],u[O])+x:O=>c[O]+x:y+x).attr("y",l?f?O=>Math.min(l[O],f[O])+E:O=>l[O]+E:d+E).attr("width",c?u?O=>Math.max(0,Math.abs(u[O]-c[O])+W-x-w):W-x-w:g-h-y-w-x).attr("height",l?f?O=>Math.max(0,Math.abs(l[O]-f[O])+D-E-A):D-E-A:b-d-p-E-A).call(ht,"rx",T).call(ht,"ry",M).call(De,this,r))).node()}}function H0(e,{inset:t=0,insetTop:n=t,insetRight:r=t,insetBottom:i=t,insetLeft:s=t}={}){e.insetTop=pe(n),e.insetRight=pe(r),e.insetBottom=pe(i),e.insetLeft=pe(s)}function q0(e,{r:t,rx:n,ry:r,rx1:i=t,ry1:s=t,rx2:a=t,ry2:o=t,rx1y1:c=i!==void 0?+i:s!==void 0?+s:0,rx1y2:l=i!==void 0?+i:o!==void 0?+o:0,rx2y1:u=a!==void 0?+a:s!==void 0?+s:0,rx2y2:f=a!==void 0?+a:o!==void 0?+o:0}={}){c||l||u||f?(e.rx1y1=c,e.rx1y2=l,e.rx2y1=u,e.rx2y2=f):(e.rx=ae(n,"auto"),e.ry=ae(r,"auto"))}function G0(e,t,n,r,i,s){const{rx1y1:a,rx1y2:o,rx2y1:c,rx2y2:l}=s;typeof t!="function"&&(t=or(t)),typeof n!="function"&&(n=or(n)),typeof r!="function"&&(r=or(r)),typeof i!="function"&&(i=or(i));const u=Math.max(Math.abs(a+c),Math.abs(o+l)),f=Math.max(Math.abs(a+o),Math.abs(c+l));e.attr("d",d=>{const h=t(d),p=n(d),y=r(d),g=i(d),b=h>y,_=p>g,E=b?y:h,w=b?h:y,A=_?g:p,x=_?p:g,T=Math.min(1,(w-E)/u,(x-A)/f),M=T*(b?_?l:c:_?o:a),R=T*(b?_?o:a:_?l:c),F=T*(b?_?a:o:_?c:l),N=T*(b?_?c:l:_?a:o);return`M${E},${A+Wo(M,N)}A${M},${M} 0 0 ${M<0?0:1} ${E+Yo(M,N)},${A}H${w-Yo(R,F)}A${R},${R} 0 0 ${R<0?0:1} ${w},${A+Wo(R,F)}V${x-Wo(F,R)}A${F},${F} 0 0 ${F<0?0:1} ${w-Yo(F,R)},${x}H${E+Yo(N,M)}A${N},${N} 0 0 ${N<0?0:1} ${E},${x-Wo(N,M)}Z`})}function Yo(e,t){return t<0?e:Math.abs(e)}function Wo(e,t){return t<0?Math.abs(e):e}function WF(e,t){return new YF(e,L5(F5(t)))}const HF={ariaLabel:"frame",fill:"none",stroke:"currentColor",clip:!1},qF={ariaLabel:"frame",fill:null,stroke:"currentColor",strokeLinecap:"square",clip:!1};class GF extends be{constructor(t={}){const{anchor:n=null}=t;super(mc,void 0,t,n==null?HF:qF),this.anchor=V2(n,"anchor",["top","right","bottom","left"]),H0(this,t),n||q0(this,t)}render(t,n,r,i,s){const{marginTop:a,marginRight:o,marginBottom:c,marginLeft:l,width:u,height:f}=i,{anchor:d,insetTop:h,insetRight:p,insetBottom:y,insetLeft:g}=this,{rx:b,ry:_,rx1y1:E,rx1y2:w,rx2y1:A,rx2y2:x}=this,T=l+g,M=u-o-p,R=a+h,F=f-c-y;return Ht(d?"svg:line":E||w||A||x?"svg:path":"svg:rect",s).datum(0).call(Fe,this,i,s).call(ge,this).call(De,this,r).call(ke,this,{}).call(d==="left"?N=>N.attr("x1",T).attr("x2",T).attr("y1",R).attr("y2",F):d==="right"?N=>N.attr("x1",M).attr("x2",M).attr("y1",R).attr("y2",F):d==="top"?N=>N.attr("x1",T).attr("x2",M).attr("y1",R).attr("y2",R):d==="bottom"?N=>N.attr("x1",T).attr("x2",M).attr("y1",F).attr("y2",F):E||w||A||x?N=>N.call(G0,T,R,M,F,this):N=>N.attr("x",T).attr("y",R).attr("width",M-T).attr("height",F-R).attr("rx",b).attr("ry",_)).node()}}function XF(e){return new GF(e)}const Sf={ariaLabel:"tip",fill:"var(--plot-background)",stroke:"currentColor"},KF=new Set(["geometry","href","src","ariaLabel","scales"]);class QF extends be{constructor(t,n={}){n.tip&&(n={...n,tip:!1}),n.title===void 0&&Gr(t)&&X2(t)&&(n={...n,title:Kt});const{x:r,y:i,x1:s,x2:a,y1:o,y2:c,anchor:l,preferredAnchor:u="bottom",monospace:f,fontFamily:d=f?"ui-monospace, monospace":void 0,fontSize:h,fontStyle:p,fontVariant:y,fontWeight:g,lineHeight:b=1,lineWidth:_=20,frameAnchor:E,format:w,textAnchor:A="start",textOverflow:x,textPadding:T=8,title:M,pointerSize:R=12,pathFilter:F="drop-shadow(0 3px 4px rgba(0,0,0,0.2))"}=n;super(t,{x:{value:s!=null&&a!=null?null:r,scale:"x",optional:!0},y:{value:o!=null&&c!=null?null:i,scale:"y",optional:!0},x1:{value:s,scale:"x",optional:a==null},y1:{value:o,scale:"y",optional:c==null},x2:{value:a,scale:"x",optional:s==null},y2:{value:c,scale:"y",optional:o==null},title:{value:M,optional:!0}},n,Sf),this.anchor=Md(l,"anchor"),this.preferredAnchor=Md(u,"preferredAnchor"),this.frameAnchor=mu(E),this.textAnchor=ae(A,"middle"),this.textPadding=+T,this.pointerSize=+R,this.pathFilter=de(F),this.lineHeight=+b,this.lineWidth=+_,this.textOverflow=Gx(x),this.monospace=!!f,this.fontFamily=de(d),this.fontSize=pe(h),this.fontStyle=de(p),this.fontVariant=de(y),this.fontWeight=de(g);for(const N in Sf)N in this.channels&&(this[N]=Sf[N]);this.splitLines=Kx(this),this.clipLine=Qx(this),this.format=typeof w=="string"||typeof w=="function"?{title:w}:{...w}}render(t,n,r,i,s){const a=this,{x:o,y:c,fx:l,fy:u}=n,{ownerSVGElement:f,document:d}=s,{anchor:h,monospace:p,lineHeight:y,lineWidth:g}=this,{textPadding:b,pointerSize:_,pathFilter:E}=this,{marginTop:w,marginLeft:A}=i,{x1:x,y1:T,x2:M,y2:R,x:F=x??M,y:N=T??R}=r,B=l?l(t.fx)-A:0,W=u?u(t.fy)-w:0,[D,S]=xo(this,i),I=Fx(r,D),O=kx(r,S),C=p?V0:j0,L=C(as);let $,j;"title"in r?($=Ly.call(this,{title:r.channels.title},n),j=ek):($=Ly.call(this,r.channels,n),j=nk);const Y=Ht("svg:g",s).call(Fe,this,i,s).call(Xx,this).call(ke,this,{x:F&&o,y:N&&c}).call(ot=>ot.selectAll().data(t).enter().append("g").attr("transform",yt=>`translate(${Math.round(I(yt))},${Math.round(O(yt))})`).call(ge,this).call(yt=>yt.append("path").attr("filter",E)).call(yt=>yt.append("text").each(function(H){const ct=oi(this);this.setAttribute("fill","currentColor"),this.setAttribute("fill-opacity",1),this.setAttribute("stroke","none");const U=j.call(a,H,t,$,n,r);if(typeof U=="string")for(const z of a.splitLines(U))V(ct,{value:a.clipLine(z)});else{const z=new Set;for(const G of U){const{label:k=""}=G;k&&z.has(k)||(z.add(k),V(ct,G))}}})));function V(ot,{label:yt,value:H,color:ct,opacity:U}){yt??="",H??="";const z=ct!=null||U!=null;let G,k=g*100;const[xt]=As(yt,k,C,L);if(xt>=0)yt=yt.slice(0,xt).trimEnd()+as,G=H.trim(),H="";else{(yt||!H&&!z)&&(H=" "+H);const[Ot]=As(H,k-C(yt),C,L);Ot>=0&&(G=H.trim(),H=H.slice(0,Ot).trimEnd()+as)}const lt=ot.append("tspan").attr("x",0).attr("dy",`${y}em`).text("");yt&&lt.append("tspan").attr("font-weight","bold").text(yt),H&&lt.append(()=>d.createTextNode(H)),z&&lt.append("tspan").text(" ").attr("fill",ct).attr("fill-opacity",U).style("user-select","none"),G&&lt.append("title").text(G)}function K(){const{width:ot,height:yt}=i.facet??i;Y.selectChildren().each(function(H){let{x:ct,width:U,height:z}=this.getBBox();U=Math.round(U),z=Math.round(z);let G=h;if(G===void 0){const lt=I(H)+B,Ot=O(H)+W,Pt=lt+U+_+b*2<ot,le=lt-U-_-b*2>0,Tr=Ot+z+_+b*2<yt,Qr=Ot-z-_-b*2>0;G=Pt&&le?Tr&&Qr?a.preferredAnchor:Qr?"bottom":"top":Tr&&Qr?Pt?"left":"right":(Pt||le)&&(Tr||Qr)?`${Qr?"bottom":"top"}-${Pt?"left":"right"}`:a.preferredAnchor}const k=this.firstChild,xt=this.lastChild;if(k.setAttribute("d",tk(G,_,b,U,z)),ct)for(const lt of xt.childNodes)lt.setAttribute("x",-ct);xt.setAttribute("y",`${+JF(G,xt.childNodes.length,y).toFixed(6)}em`),xt.setAttribute("transform",`translate(${ZF(G,_,b,U,z)})`)}),Y.attr("visibility",null)}return t.length&&(Y.attr("visibility","hidden"),f.isConnected?Promise.resolve().then(K):typeof requestAnimationFrame<"u"&&requestAnimationFrame(K)),Y.node()}}function MS(e,{x:t,y:n,...r}={}){return r.frameAnchor===void 0&&([t,n]=hu(t,n)),new QF(e,{...r,x:t,y:n})}function JF(e,t,n){return/^top(?:-|$)/.test(e)?.94-n:-.29-t*n}function ZF(e,t,n,r,i){switch(e){case"middle":return[-r/2,i/2];case"top-left":return[n,t+n];case"top":return[-r/2,t/2+n];case"top-right":return[-r-n,t+n];case"right":return[-t/2-r-n,i/2];case"bottom-left":return[n,-t-n];case"bottom":return[-r/2,-t/2-n];case"bottom-right":return[-r-n,-t-n];case"left":return[n+t/2,i/2]}}function tk(e,t,n,r,i){const s=r+n*2,a=i+n*2;switch(e){case"middle":return`M${-s/2},${-a/2}h${s}v${a}h${-s}z`;case"top-left":return`M0,0l${t},${t}h${s-t}v${a}h${-s}z`;case"top":return`M0,0l${t/2},${t/2}h${(s-t)/2}v${a}h${-s}v${-a}h${(s-t)/2}z`;case"top-right":return`M0,0l${-t},${t}h${t-s}v${a}h${s}z`;case"right":return`M0,0l${-t/2},${-t/2}v${t/2-a/2}h${-s}v${a}h${s}v${t/2-a/2}z`;case"bottom-left":return`M0,0l${t},${-t}h${s-t}v${-a}h${-s}z`;case"bottom":return`M0,0l${t/2},${-t/2}h${(s-t)/2}v${-a}h${-s}v${a}h${(s-t)/2}z`;case"bottom-right":return`M0,0l${-t},${-t}h${t-s}v${-a}h${s}z`;case"left":return`M0,0l${t/2},${-t/2}v${t/2-a/2}h${s}v${a}h${-s}v${t/2-a/2}z`}}function Ly(e,t){const n={};let r=this.format;r=Fy(r,e,"x"),r=Fy(r,e,"y"),this.format=r;for(const i in r){const s=r[i];if(!(s===null||s===!1))if(i==="fx"||i==="fy")n[i]=!0;else{const a=ay(e,i);a&&(n[i]=a)}}for(const i in e){if(i in n||i in r||KF.has(i)||(i==="x"||i==="y")&&e.geometry)continue;const s=ay(e,i);if(s){if(s.scale==null&&s.defaultScale==="color")continue;n[i]=s}}this.facet&&(t.fx&&!("fx"in r)&&(n.fx=!0),t.fy&&!("fy"in r)&&(n.fy=!0));for(const i in n){const s=this.format[i];if(typeof s=="string"){const a=n[i]?.value??t[i]?.domain()??[];this.format[i]=(Re(a)?fo:ks)(s)}else if(s===void 0||s===!0){const a=t[i];this.format[i]=a?.bandwidth?z0(a,a.domain()):Ts}}return n}function Fy(e,t,n){if(!(n in e))return e;const r=`${n}1`,i=`${n}2`;if((r in e||!(r in t))&&(i in e||!(i in t)))return e;const s=Object.entries(e),a=e[n];return s.splice(s.findIndex(([o])=>o===n)+1,0,[r,a],[i,a]),Object.fromEntries(s)}function ek(e,t,{title:n}){return this.format.title(n.value[e],e)}function*nk(e,t,n,r,i){for(const s in n){if(s==="fx"||s==="fy"){yield{label:Nl(r,n,s),value:this.format[s](t[s],e)};continue}if(s==="x1"&&"x2"in n||s==="y1"&&"y2"in n)continue;const a=n[s];if(s==="x2"&&"x1"in n)yield{label:Cy(r,n,"x"),value:ky(this.format.x2,n.x1,a,e)};else if(s==="y2"&&"y1"in n)yield{label:Cy(r,n,"y"),value:ky(this.format.y2,n.y1,a,e)};else{const o=a.value[e],c=a.scale;if(!Vr(o)&&c==null)continue;yield{label:Nl(r,n,s),value:this.format[s](o,e),color:c==="color"?i[s][e]:null,opacity:c==="opacity"?i[s][e]:null}}}}function ky(e,t,n,r){return n.hint?.length?`${e(n.value[r]-t.value[r],r)}`:`${e(t.value[r],r)}${e(n.value[r],r)}`}function Cy(e,t,n){const r=Nl(e,t,`${n}1`,n),i=Nl(e,t,`${n}2`,n);return r===i?r:`${r}${i}`}function Nl(e,t,n,r=n){const i=t[n],s=e[i?.scale??n];return String(s?.label??i?.label??r)}function mn(e={}){const{facet:t,style:n,title:r,subtitle:i,caption:s,ariaLabel:a,ariaDescription:o}=e,c=D0(e.className),l=e.marks===void 0?[]:$y(e.marks);l.push(...lk(l));const u=ok(t,e),f=new Map;for(const L of l){const $=Uy(L,u,e);$&&f.set(L,$)}const d=new Map;u&&Xs(d,[u],e),Xs(d,f,e);const h=$y(uk(l,d,e));for(const L of h){const $=Uy(L,u,e);$&&f.set(L,$)}l.unshift(...h);let p=FL(d,e);if(p!==void 0){const L=u?bf(p,u):void 0;for(const j of l){if(j.facet===null||j.facet==="super")continue;const Y=f.get(j);Y!==void 0&&(Y.facetsIndex=j.fx!=null||j.fy!=null?bf(p,Y):L)}const $=new Set;for(const{facetsIndex:j}of f.values())j?.forEach((Y,V)=>{Y?.length>0&&$.add(V)});p.forEach(0<$.size&&$.size<p.length?(j,Y)=>j.empty=!$.has(Y):j=>j.empty=!1);for(const j of l)if(j.facet==="exclude"){const Y=f.get(j);Y!==void 0&&(Y.facetsIndex=BL(Y.facetsIndex))}}for(const L of Yt.keys())Nd(e[L])&&L!=="fx"&&L!=="fy"&&d.set(L,[]);const y=new Map;for(const L of l){if(y.has(L))throw new Error("duplicate mark; each mark must be unique");const{facetsIndex:$,channels:j}=f.get(L)??{},{data:Y,facets:V,channels:K}=L.initialize($,j,e);X0(K,e),y.set(L,{data:Y,facets:V,channels:K})}const g=Ld(Xs(d,y,e),e),b=T5(g,l,e);EL(g,b);const _=py(g),{fx:E,fy:w}=_,A=E||w?vx(g,b):b,x=E||w?gk(_,b):b,T=R0(e),M=T.document,R=zl("svg").call(M.documentElement);let F=R;T.ownerSVGElement=R,T.className=c,T.projection=HL(e,A),T.path=function(){return Kh(this.projection??ZL(_))},T.filterFacets=(L,$)=>bf(p,{channels:$,groups:O0(L,$)}),T.getMarkState=L=>{const $=y.get(L),j=f.get(L);return{...$,channels:{...$.channels,...j?.channels}}},T.dispatchValue=L=>{F.value!==L&&(F.value=L,F.dispatchEvent(new T.document.defaultView.Event("input",{bubbles:!0})))};const N=new Set;for(const[L,$]of y)if(L.initializer!=null){const j=L.facet==="super"?x:A,Y=L.initializer($.data,$.facets,$.channels,_,j,T);if(Y.data!==void 0&&($.data=Y.data),Y.facets!==void 0&&($.facets=Y.facets),Y.channels!==void 0){const{fx:V,fy:K,...ot}=Y.channels;ak(ot),Object.assign($.channels,ot);for(const yt of Object.values(ot)){const{scale:H}=yt;H!=null&&!mD(Yt.get(H))&&(OS(yt,e),N.add(H))}(V!=null||K!=null)&&f.set(L,!0)}}if(N.size){const L=new Map;Xs(L,y,e,V=>N.has(V)),Xs(d,y,e,V=>N.has(V));const $=yk(Ld(L,e),g),{scales:j,...Y}=py($);Object.assign(g,$),Object.assign(_,Y),Object.assign(_.scales,j)}let B,W;p!==void 0&&(B={x:E?.domain(),y:w?.domain()},p=kL(p,B),W=CL(E,w,b));for(const[L,$]of y)$.values=L.scale($.channels,_,T);const{width:D,height:S}=b;oi(R).attr("class",c).attr("fill","currentColor").attr("font-family","system-ui, sans-serif").attr("font-size",10).attr("text-anchor","middle").attr("width",D).attr("height",S).attr("viewBox",`0 0 ${D} ${S}`).attr("aria-label",a).attr("aria-description",o).call(L=>L.append("style").text(`:where(.${c}) {
  --plot-background: white;
  display: block;
  height: auto;
  height: intrinsic;
  max-width: 100%;
}
:where(.${c} text),
:where(.${c} tspan) {
  white-space: pre;
}`)).call(L0,n);for(const L of l){const{channels:$,values:j,facets:Y}=y.get(L);if(p===void 0||L.facet==="super"){let V=null;if(Y&&(V=Y[0],V=L.filter(V,$,j),V.length===0))continue;const K=L.render(V,_,j,x,T);if(K==null)continue;R.appendChild(K)}else{let V;for(const K of p){if(!(L.facetAnchor?.(p,B,K)??!K.empty))continue;let ot=null;if(Y){const H=f.has(L);if(ot=Y[H?K.i:0],ot=L.filter(ot,$,j),ot.length===0)continue;!H&&ot===Y[0]&&(ot=tD(ot)),ot.fx=K.x,ot.fy=K.y,ot.fi=K.i}const yt=L.render(ot,_,j,A,T);if(yt!=null){(V??=oi(R).append("g")).append(()=>yt).datum(K);for(const H of["aria-label","aria-description","aria-hidden","transform"])yt.hasAttribute(H)&&(V.attr(H,yt.getAttribute(H)),yt.removeAttribute(H))}}V?.selectChildren().each(W)}}const I=AF(g,T,e),{figure:O=r!=null||i!=null||s!=null||I.length>0}=e;O&&(F=M.createElement("figure"),F.className=`${c}-figure`,F.style.maxWidth="initial",r!=null&&F.append(By(M,r,"h2")),i!=null&&F.append(By(M,i,"h3")),F.append(...I,R),s!=null&&F.append(rk(M,s)),"value"in R&&(F.value=R.value,delete R.value)),F.scale=DL(_.scales),F.legend=SF(g,T,e);const C=oL();return C>0&&oi(R).append("text").attr("x",D).attr("y",20).attr("dy","-1em").attr("text-anchor","end").attr("font-family","initial").text("").append("title").text(`${C.toLocaleString("en-US")} warning${C===1?"":"s"}. Please check the console.`),F}function By(e,t,n){if(t.ownerDocument)return t;const r=e.createElement(n);return r.append(t),r}function rk(e,t){const n=e.createElement("figcaption");return n.append(t),n}function $y(e){return e.flat(1/0).filter(t=>t!=null).map(ik)}function ik(e){return typeof e.render=="function"?e:new sk(e)}class sk extends be{constructor(t){if(typeof t!="function")throw new TypeError("invalid mark; missing render function");super(),this.render=t}render(){}}function X0(e,t){for(const n in e)OS(e[n],t);return e}function OS(e,t){const{scale:n,transform:r=!0}=e;if(n==null||!r)return;const{type:i,percent:s,interval:a,transform:o=s?c=>c==null?NaN:c*100:G2(a,i)}=t[n]??{};o!=null&&(e.value=Xt(e.value,o),e.transform=!1)}function ak(e){for(const t in e)ox(t,e[t])}function Xs(e,t,n,r=J8){for(const{channels:i}of t.values())for(const s in i){const a=i[s],{scale:o}=a;if(o!=null&&r(o))if(o==="projection"){if(!KL(n)){const c=n.x?.domain===void 0,l=n.y?.domain===void 0;if(c||l){const[u,f]=JL(a);c&&Ef(e,"x",u),l&&Ef(e,"y",f)}}}else Ef(e,o,a)}return e}function Ef(e,t,n){const r=e.get(t);r!==void 0?r.push(n):e.set(t,[n])}function ok(e,t){if(e==null)return;const{x:n,y:r}=e;if(n==null&&r==null)return;const i=Ss(e.data);if(i==null)throw new Error("missing facet data");const s={};n!=null&&(s.fx=ja(i,{value:n,scale:"fx"})),r!=null&&(s.fy=ja(i,{value:r,scale:"fy"})),X0(s,t);const a=O0(i,s);return{channels:s,groups:a,data:e.data}}function Uy(e,t,n){if(e.facet===null||e.facet==="super")return;const{fx:r,fy:i}=e;if(r!=null||i!=null){const c=Ss(e.data??r??i);if(c===void 0)throw new Error(`missing facet data in ${e.ariaLabel}`);if(c===null)return;const l={};return r!=null&&(l.fx=ja(c,{value:r,scale:"fx"})),i!=null&&(l.fy=ja(c,{value:i,scale:"fy"})),X0(l,n),{channels:l,groups:O0(c,l)}}if(t===void 0)return;const{channels:s,groups:a,data:o}=t;if(e.facet!=="auto"||e.data===o)return{channels:s,groups:a};o.length>0&&(a.size>1||a.size===1&&s.fx&&s.fy&&[...a][0][1].size>1)&&Ua(Ss(e.data))===Ua(o)&&Fr(`Warning: the ${e.ariaLabel} mark appears to use faceted data, but isnt faceted. The mark data has the same length as the facet data and the mark facet option is "auto", but the mark data and facet data are distinct. If this mark should be faceted, set the mark facet option to true; otherwise, suppress this warning by setting the mark facet option to false.`)}function ck(e,t={}){return zr({...t,x:null,y:null},(n,r,i,s,a,o)=>o.getMarkState(e))}function lk(e){const t=[];for(const n of e){let r=n.tip;if(r){r===!0?r={}:typeof r=="string"&&(r={pointer:r});let{pointer:i,preferredAnchor:s}=r;i=/^x$/i.test(i)?Lx:/^y$/i.test(i)?Sy:Dx,r=i(ck(n,r)),r.title=null,s===void 0&&(r.preferredAnchor=i===Sy?"left":"bottom");const a=MS(n.data,r);a.facet=n.facet,a.facetAnchor=n.facetAnchor,t.push(a)}}return t}function uk(e,t,n){let{projection:r,x:i={},y:s={},fx:a={},fy:o={},axis:c,grid:l,facet:u={},facet:{axis:f=c,grid:d}=u,x:{axis:h=c,grid:p=h===null?null:l}=i,y:{axis:y=c,grid:g=y===null?null:l}=s,fx:{axis:b=f,grid:_=b===null?null:d}=a,fy:{axis:E=f,grid:w=E===null?null:d}=o}=n;(r||!Nd(i)&&!Py("x",e))&&(h=p=null),(r||!Nd(s)&&!Py("y",e))&&(y=g=null),t.has("fx")||(b=_=null),t.has("fy")||(E=w=null),h===void 0&&(h=!Go(e,"x")),y===void 0&&(y=!Go(e,"y")),b===void 0&&(b=!Go(e,"fx")),E===void 0&&(E=!Go(e,"fy")),h===!0&&(h="bottom"),y===!0&&(y="left"),b===!0&&(b=h==="top"||h===null?"bottom":"top"),E===!0&&(E=y==="right"||y===null?"left":"right");const A=[];return qo(A,w,hF,o),Ho(A,E,aF,"right","left",u,o),qo(A,_,mF,a),Ho(A,b,oF,"top","bottom",u,a),qo(A,g,dF,s),Ho(A,y,oS,"left","right",n,s),qo(A,p,pF,i),Ho(A,h,cS,"bottom","top",n,i),A}function Ho(e,t,n,r,i,s,a){if(!t)return;const o=fk(t);a=dk(o?r:t,s,a);const{line:c}=a;(n===oS||n===cS)&&c&&!Pa(c)&&e.push(XF(hk(a))),e.push(n(a)),o&&e.push(n({...a,anchor:i,label:null}))}function qo(e,t,n,r){!t||Pa(t)||e.push(n(pk(t,r)))}function fk(e){return/^\s*both\s*$/i.test(e)}function dk(e,t,{line:n=t.line,ticks:r,tickSize:i,tickSpacing:s,tickPadding:a,tickFormat:o,tickRotate:c,fontVariant:l,ariaLabel:u,ariaDescription:f,label:d=t.label,labelAnchor:h,labelArrow:p=t.labelArrow,labelOffset:y}){return{anchor:e,line:n,ticks:r,tickSize:i,tickSpacing:s,tickPadding:a,tickFormat:o,tickRotate:c,fontVariant:l,ariaLabel:u,ariaDescription:f,label:d,labelAnchor:h,labelArrow:p,labelOffset:y}}function hk(e){const{anchor:t,line:n}=e;return{anchor:t,facetAnchor:t+"-empty",stroke:n===!0?void 0:n}}function pk(e,{stroke:t=pu(e)?e:void 0,ticks:n=mk(e)?e:void 0,tickSpacing:r,ariaLabel:i,ariaDescription:s}){return{stroke:t,ticks:n,tickSpacing:r,ariaLabel:i,ariaDescription:s}}function mk(e){switch(typeof e){case"number":return!0;case"string":return!pu(e)}return Gr(e)||typeof e?.range=="function"}function Go(e,t){const n=`${t}-axis `;return e.some(r=>r.ariaLabel?.startsWith(n))}function Py(e,t){for(const n of t)for(const r in n.channels){const{scale:i}=n.channels[r];if(i===e||i==="projection")return!0}return!1}function yk(e,t){for(const n in e){const r=e[n],i=t[n];r.label===void 0&&i&&(r.label=i.label)}return e}function gk({fx:e,fy:t},n){const{marginTop:r,marginRight:i,marginBottom:s,marginLeft:a,width:o,height:c}=M0(n),l=e&&jy(e),u=t&&jy(t);return{marginTop:t?u[0]:r,marginRight:e?o-l[1]:i,marginBottom:t?c-u[1]:s,marginLeft:e?l[0]:a,inset:{marginTop:n.marginTop,marginRight:n.marginRight,marginBottom:n.marginBottom,marginLeft:n.marginLeft},width:o,height:c}}function jy(e){const t=e.domain();if(t.length===0)return[0,e.bandwidth()];let n=e(t[0]),r=e(t[t.length-1]);return r<n&&([n,r]=[r,n]),[n,r+e.bandwidth()]}const bk=new Map([["basis",S8],["basis-closed",E8],["basis-open",T8],["bundle",A8],["bump-x",d8],["bump-y",h8],["cardinal",I8],["cardinal-closed",N8],["cardinal-open",M8],["catmull-rom",O8],["catmull-rom-closed",R8],["catmull-rom-open",D8],["linear",ho],["linear-closed",L8],["monotone-x",F8],["monotone-y",k8],["natural",C8],["step",B8],["step-after",U8],["step-before",$8]]);function RS(e=ho,t){if(typeof e=="function")return e;const n=bk.get(`${e}`.toLowerCase());if(!n)throw new Error(`unknown curve: ${e}`);if(t!==void 0){if("beta"in n)return n.beta(t);if("tension"in n)return n.tension(t);if("alpha"in n)return n.alpha(t)}return n}function DS(e=Is,t){return typeof e!="function"&&`${e}`.toLowerCase()==="auto"?Is:RS(e,t)}function Is(e){return ho(e)}function _k(e={y:"count"},t={}){[e,t]=xk(e,t);const{x:n,y:r}=t;return vk(Sk(n,t,Kt),null,null,r,e,Su(t))}function wk(e,t,n={}){if(n?.interval==null)return n;const{reduce:r=T0}=n,i={filter:null};return n[t]!=null&&(i[t]=r),n[`${t}1`]!=null&&(i[`${t}1`]=r),n[`${t}2`]!=null&&(i[`${t}2`]=r),e(i,n)}function LS(e={}){return wk(_k,"y",So(e,"x"))}function vk(e,t,n,r,{data:i=sx,filter:s=Il,sort:a,reverse:o,...c}={},l={}){e=Vy(e),t=Vy(t),c=Tk(c,l),i=CS(i,Kt),a=a==null?void 0:FS("sort",a,l),s=s==null?void 0:kS("filter",s,l),r!=null&&ff(c,"y","y1","y2")&&(r=null);const[u,f]=Kn(e),[d,h]=Kn(e),[p,y]=Kn(t),[g,b]=Kn(t),[_,E]=r!=null?[r,"y"]:[],[w,A]=Kn(_),{x,y:T,z:M,fill:R,stroke:F,x1:N,x2:B,y1:W,y2:D,domain:S,cumulative:I,thresholds:O,interval:C,...L}=l,[$,j]=Kn(M),[Y]=mr(R),[V]=mr(F),[K,ot]=Kn(Y),[yt,H]=Kn(V);return{..."z"in l&&{z:$||M},..."fill"in l&&{fill:K||R},..."stroke"in l&&{stroke:yt||F},...gu(L,(ct,U,z)=>{const G=q2(Gt(ct,_),z?.[E]),k=Gt(ct,M),xt=Gt(ct,Y),lt=Gt(ct,V),Ot=MD(c,{z:k,fill:xt,stroke:lt}),Pt=[],le=[],Tr=G&&A([]),Qr=k&&j([]),GS=xt&&ot([]),XS=lt&&H([]),J0=e&&f([]),KS=e&&h([]),Z0=t&&y([]),QS=t&&b([]),JS=Nk(e,t,ct);let ZS=0;for(const Di of c)Di.initialize(ct);a&&a.initialize(ct),s&&s.initialize(ct);for(const Di of U){const tp=[];for(const Li of c)Li.scope("facet",Di);a&&a.scope("facet",Di),s&&s.scope("facet",Di);for(const[Li,tE]of ny(Di,Ot))for(const[eE,Eo]of ny(tE,G))for(const[_n,Yn]of JS(Eo))if(Ot&&(Yn.z=Li),!(s&&!s.reduce(_n,Yn))){tp.push(ZS++),le.push(i.reduceIndex(_n,ct,Yn)),G&&Tr.push(eE),k&&Qr.push(Ot===k?Li:k[(_n.length>0?_n:Eo)[0]]),xt&&GS.push(Ot===xt?Li:xt[(_n.length>0?_n:Eo)[0]]),lt&&XS.push(Ot===lt?Li:lt[(_n.length>0?_n:Eo)[0]]),J0&&(J0.push(Yn.x1),KS.push(Yn.x2)),Z0&&(Z0.push(Yn.y1),QS.push(Yn.y2));for(const nE of c)nE.reduce(_n,Yn);a&&a.reduce(_n,Yn)}Pt.push(tp)}return OD(Pt,a,o),{data:le,facets:Pt}}),...!ff(c,"x")&&(u?{x1:u,x2:d,x:Al(u,d)}:{x,x1:N,x2:B}),...!ff(c,"y")&&(p?{y1:p,y2:g,y:Al(p,g)}:{y:T,y1:W,y2:D}),...w&&{[E]:w},...Object.fromEntries(c.map(({name:ct,output:U})=>[ct,U]))}}function xk({cumulative:e,domain:t,thresholds:n,interval:r,...i},s){return[i,{cumulative:e,domain:t,thresholds:n,interval:r,...s}]}function Sk(e,{cumulative:t,domain:n,thresholds:r,interval:i},s){return e={...yo(e)},e.domain===void 0&&(e.domain=n),e.cumulative===void 0&&(e.cumulative=t),e.thresholds===void 0&&(e.thresholds=r),e.interval===void 0&&(e.interval=i),e.value===void 0&&(e.value=s),e.thresholds=Ek(e.thresholds,e.interval),e}function Vy(e){if(e==null)return;const{value:t,cumulative:n,domain:r=$e,thresholds:i}=e,s=a=>{let o=Gt(a,t),c;if(Re(o)||Ik(i)){o=Xt(o,j2,Float64Array);let[u,f]=typeof r=="function"?r(o):r,d=typeof i=="function"&&!Ji(i)?i(o,u,f):i;typeof d=="number"&&(d=Cw(u,f,d)),Ji(d)&&(r===$e&&(u=d.floor(u),f=d.offset(d.floor(f))),d=d.range(u,d.offset(f))),c=d}else{o=Dn(o);let[u,f]=typeof r=="function"?r(o):r,d=typeof i=="function"&&!Ji(i)?i(o,u,f):i;if(typeof d=="number")if(r===$e){let h=Hc(u,f,d);if(isFinite(h))if(h>0){let p=Math.round(u/h),y=Math.round(f/h);p*h<=u||--p,y*h>f||++y;let g=y-p+1;d=new Float64Array(g);for(let b=0;b<g;++b)d[b]=(p+b)*h}else if(h<0){h=-h;let p=Math.round(u*h),y=Math.round(f*h);p/h<=u||--p,y/h>f||++y;let g=y-p+1;d=new Float64Array(g);for(let b=0;b<g;++b)d[b]=(p+b)/h}else d=[u];else d=[u]}else d=Na(u,f,d);else Ji(d)&&(r===$e&&(u=d.floor(u),f=d.offset(d.floor(f))),d=d.range(u,d.offset(f)));c=d}const l=[];if(c.length===1)l.push([c[0],c[0]]);else for(let u=1;u<c.length;++u)l.push([c[u-1],c[u]]);return l.bin=(n<0?Ok:n>0?Mk:K0)(l,c,o),l};return s.label=Oi(t),s}function Ek(e,t,n=zy){if(e===void 0)return t===void 0?n:Bs(t);if(typeof e=="string"){switch(e.toLowerCase()){case"freedman-diaconis":return U6;case"scott":return X_;case"sturges":return k6;case"auto":return zy}return fu(e)}return e}function Tk(e,t){return AD(e,t,FS)}function FS(e,t,n){return rx(e,t,n,kS)}function kS(e,t,n){return ix(e,t,n,CS)}function CS(e,t){return E0(e,t,Ak)}function Ak(e){switch(`${e}`.toLowerCase()){case"x":return Rk;case"x1":return Lk;case"x2":return Fk;case"y":return Dk;case"y1":return kk;case"y2":return Ck;case"z":return BD}throw new Error(`invalid bin reduce: ${e}`)}function zy(e,t,n){return Math.min(200,X_(e,t,n))}function Ik(e){return iD(e)||Gr(e)&&Re(e)}function Nk(e,t,n){const r=e?.(n),i=t?.(n);return r&&i?function*(s){const a=r.bin(s);for(const[o,[c,l]]of r.entries()){const u=i.bin(a[o]);for(const[f,[d,h]]of i.entries())yield[u[f],{data:n,x1:c,y1:d,x2:l,y2:h}]}}:r?function*(s){const a=r.bin(s);for(const[o,[c,l]]of r.entries())yield[a[o],{data:n,x1:c,x2:l}]}:function*(s){const a=i.bin(s);for(const[o,[c,l]]of i.entries())yield[a[o],{data:n,y1:c,y2:l}]}}function K0(e,t,n){return t=Dn(t),r=>{const i=e.map(()=>[]);for(const s of r)i[Ul(t,n[s])-1]?.push(s);return i}}function Mk(e,t,n){const r=K0(e,t,n);return i=>{const s=r(i);for(let a=1,o=s.length;a<o;++a){const c=s[a-1],l=s[a];for(const u of c)l.push(u)}return s}}function Ok(e,t,n){const r=K0(e,t,n);return i=>{const s=r(i);for(let a=s.length-2;a>=0;--a){const o=s[a+1],c=s[a];for(const l of o)c.push(l)}return s}}function BS(e,t){const n=(+e+ +t)/2;return e instanceof Date?new Date(n):n}const Rk={reduceIndex(e,t,{x1:n,x2:r}){return BS(n,r)}},Dk={reduceIndex(e,t,{y1:n,y2:r}){return BS(n,r)}},Lk={reduceIndex(e,t,{x1:n}){return n}},Fk={reduceIndex(e,t,{x2:n}){return n}},kk={reduceIndex(e,t,{y1:n}){return n}},Ck={reduceIndex(e,t,{y2:n}){return n}},Bk={ariaLabel:"area",strokeWidth:1,strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:1};class $S extends be{constructor(t,n={}){const{x1:r,y1:i,x2:s,y2:a,z:o,curve:c,tension:l}=n;super(t,{x1:{value:r,scale:"x"},y1:{value:i,scale:"y"},x2:{value:s,scale:"x",optional:!0},y2:{value:a,scale:"y",optional:!0},z:{value:g0(n),optional:!0}},n,Bk),this.z=o,this.curve=RS(c,l)}filter(t){return t}render(t,n,r,i,s){const{x1:a,y1:o,x2:c=a,y2:l=o}=r;return Ht("svg:g",s).call(Fe,this,i,s).call(ke,this,n,0,0).call(u=>u.selectAll().data(Mx(t,[a,o,c,l],this,r)).enter().append("path").call(ge,this).call(Nx,this,r).attr("d",f8().curve(this.curve).defined(f=>f>=0).x0(f=>a[f]).y0(f=>o[f]).x1(f=>c[f]).y1(f=>l[f]))).node()}}function US(e,t){return t===void 0?$k(e,{x:p0,y:El}):new $S(e,t)}function $k(e,t){const{x:n=Si,...r}=LS(t);return new $S(e,W0(Y0({...r,x1:n,x2:void 0},n===Si?"y2":"y")))}const Uk={ariaLabel:"link",fill:"none",stroke:"currentColor",strokeMiterlimit:1};class Pk extends be{constructor(t,n={}){const{x1:r,y1:i,x2:s,y2:a,curve:o,tension:c}=n;super(t,{x1:{value:r,scale:"x"},y1:{value:i,scale:"y"},x2:{value:s,scale:"x",optional:!0},y2:{value:a,scale:"y",optional:!0}},n,Uk),this.curve=DS(o,c),xu(this,n)}project(t,n,r){this.curve!==Is&&super.project(t,n,r)}render(t,n,r,i,s){const{x1:a,y1:o,x2:c=a,y2:l=o}=r,{curve:u}=this;return Ht("svg:g",s).call(Fe,this,i,s).call(ke,this,n).call(f=>f.selectAll().data(t).enter().append("path").call(ge,this).attr("d",u===Is&&s.projection?jk(s.path(),a,o,c,l):d=>{const h=Rr(),p=u(h);return p.lineStart(),p.point(a[d],o[d]),p.point(c[d],l[d]),p.lineEnd(),h}).call(De,this,r).call(C0,this,r,s)).node()}}function jk(e,t,n,r,i){return t=Dn(t),n=Dn(n),r=Dn(r),i=Dn(i),s=>e({type:"LineString",coordinates:[[t[s],n[s]],[r[s],i[s]]]})}function Vk(e,{x:t,x1:n,x2:r,y:i,y1:s,y2:a,...o}={}){return[n,r]=Yy(t,n,r),[s,a]=Yy(i,s,a),new Pk(e,{...o,x1:n,x2:r,y1:s,y2:a})}function Yy(e,t,n){if(e===void 0){if(t===void 0){if(n!==void 0)return[n]}else if(n===void 0)return[t]}else{if(t===void 0)return n===void 0?[e]:[e,n];if(n===void 0)return[e,t]}return[t,n]}const zk={ariaLabel:"bar"};class PS extends be{constructor(t,n,r={},i=zk){super(t,n,r,i),H0(this,r),q0(this,r)}render(t,n,r,i,s){const{rx:a,ry:o,rx1y1:c,rx1y2:l,rx2y1:u,rx2y2:f}=this,d=this._x(n,r,i),h=this._y(n,r,i),p=this._width(n,r,i),y=this._height(n,r,i);return Ht("svg:g",s).call(Fe,this,i,s).call(this._transform,this,n).call(g=>g.selectAll().data(t).enter().call(c||l||u||f?b=>b.append("path").call(ge,this).call(G0,d,h,Wy(d,p),Wy(h,y),this).call(De,this,r):b=>b.append("rect").call(ge,this).attr("x",d).attr("width",p).attr("y",h).attr("height",y).call(ht,"rx",a).call(ht,"ry",o).call(De,this,r))).node()}_x(t,{x:n},{marginLeft:r}){const{insetLeft:i}=this;return n?s=>n[s]+i:r+i}_y(t,{y:n},{marginTop:r}){const{insetTop:i}=this;return n?s=>n[s]+i:r+i}_width({x:t},{x:n},{marginRight:r,marginLeft:i,width:s}){const{insetLeft:a,insetRight:o}=this,c=n&&t?t.bandwidth():s-r-i;return Math.max(0,c-a-o)}_height({y:t},{y:n},{marginTop:r,marginBottom:i,height:s}){const{insetTop:a,insetBottom:o}=this,c=n&&t?t.bandwidth():s-r-i;return Math.max(0,c-a-o)}}function Wy(e,t){return typeof e=="function"&&typeof t=="function"?n=>e(n)+t(n):typeof e=="function"?n=>e(n)+t:typeof t=="function"?n=>e+t(n):e+t}class Yk extends PS{constructor(t,n={},r){const{x1:i,x2:s,y:a}=n;super(t,{x1:{value:i,scale:"x"},x2:{value:s,scale:"x"},y:{value:a,scale:"y",type:"band",optional:!0}},n,r)}_transform(t,n,{x:r}){t.call(ke,n,{x:r},0,0)}_x({x:t},{x1:n,x2:r},{marginLeft:i}){const{insetLeft:s}=this;return jn(t)?i+s:a=>Math.min(n[a],r[a])+s}_width({x:t},{x1:n,x2:r},{marginRight:i,marginLeft:s,width:a}){const{insetLeft:o,insetRight:c}=this;return jn(t)?a-i-s-o-c:l=>Math.max(0,Math.abs(r[l]-n[l])-o-c)}}class jS extends PS{constructor(t,n={},r){const{x:i,y1:s,y2:a}=n;super(t,{y1:{value:s,scale:"y"},y2:{value:a,scale:"y"},x:{value:i,scale:"x",type:"band",optional:!0}},n,r)}_transform(t,n,{y:r}){t.call(ke,n,{y:r},0,0)}_y({y:t},{y1:n,y2:r},{marginTop:i}){const{insetTop:s}=this;return jn(t)?i+s:a=>Math.min(n[a],r[a])+s}_height({y:t},{y1:n,y2:r},{marginTop:i,marginBottom:s,height:a}){const{insetTop:o,insetBottom:c}=this;return jn(t)?a-i-s-o-c:l=>Math.max(0,Math.abs(r[l]-n[l])-o-c)}}function VS(e,t={}){return y0(t)||(t={...t,y:Si,x2:Kt}),new Yk(e,RF(zx(IF(t))))}function Wk(e,t={}){return y0(t)||(t={...t,x:Si,y2:Kt}),new jS(e,W0($0(Y0(t))))}const Hk={ariaLabel:"dot",fill:"none",stroke:"currentColor",strokeWidth:1.5};function zS(e){return e.sort===void 0&&e.reverse===void 0?SD({channel:"-r"},e):e}class qk extends be{constructor(t,n={}){const{x:r,y:i,r:s,rotate:a,symbol:o=Ba,frameAnchor:c}=n,[l,u]=me(a,0),[f,d]=vD(o),[h,p]=me(s,f==null?3:4.5);super(t,{x:{value:r,scale:"x",optional:!0},y:{value:i,scale:"y",optional:!0},r:{value:h,scale:"r",filter:po,optional:!0},rotate:{value:l,optional:!0},symbol:{value:f,scale:"auto",optional:!0}},zS(n),Hk),this.r=p,this.rotate=u,this.symbol=d,this.frameAnchor=mu(c);const{channels:y}=this,{symbol:g}=y;if(g){const{fill:b,stroke:_}=y;g.hint={fill:b?b.value===g.value?"color":"currentColor":this.fill??"currentColor",stroke:_?_.value===g.value?"color":"currentColor":this.stroke??"none"}}}render(t,n,r,i,s){const{x:a,y:o}=n,{x:c,y:l,r:u,rotate:f,symbol:d}=r,{r:h,rotate:p,symbol:y}=this,[g,b]=xo(this,i),_=y===Ba,E=u?void 0:h*h*Math.PI;return lu(h)&&(t=[]),Ht("svg:g",s).call(Fe,this,i,s).call(ke,this,{x:c&&a,y:l&&o}).call(w=>w.selectAll().data(t).enter().append(_?"circle":"path").call(ge,this).call(_?A=>{A.attr("cx",c?x=>c[x]:g).attr("cy",l?x=>l[x]:b).attr("r",u?x=>u[x]:h)}:A=>{A.attr("transform",Tu`translate(${c?x=>c[x]:g},${l?x=>l[x]:b})${f?x=>` rotate(${f[x]})`:p?` rotate(${p})`:""}`).attr("d",u&&d?x=>{const T=Rr();return d[x].draw(T,u[x]*u[x]*Math.PI),T}:u?x=>{const T=Rr();return y.draw(T,u[x]*u[x]*Math.PI),T}:d?x=>{const T=Rr();return d[x].draw(T,E),T}:(()=>{const x=Rr();return y.draw(x,E),x})())}).call(De,this,r)).node()}}function YS(e,{x:t,y:n,...r}={}){return r.frameAnchor===void 0&&([t,n]=hu(t,n)),new qk(e,{...r,x:t,y:n})}const Gk={ariaLabel:"line",fill:"none",stroke:"currentColor",strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:1};class WS extends be{constructor(t,n={}){const{x:r,y:i,z:s,curve:a,tension:o}=n;super(t,{x:{value:r,scale:"x"},y:{value:i,scale:"y"},z:{value:g0(n),optional:!0}},n,Gk),this.z=s,this.curve=DS(a,o),xu(this,n)}filter(t){return t}project(t,n,r){this.curve!==Is&&super.project(t,n,r)}render(t,n,r,i,s){const{x:a,y:o}=r,{curve:c}=this;return Ht("svg:g",s).call(Fe,this,i,s).call(ke,this,n).call(l=>l.selectAll().data(Mx(t,[a,o],this,r)).enter().append("path").call(ge,this).call(Nx,this,r).call(R5,this,r,s).attr("d",c===Is&&s.projection?Xk(s.path(),a,o):i2().curve(c).defined(u=>u>=0).x(u=>a[u]).y(u=>o[u]))).node()}}function Xk(e,t,n){return t=Dn(t),n=Dn(n),r=>{let i=[];const s=[i];for(const a of r)a===-1?(i=[],s.push(i)):i.push([t[a],n[a]]);return e({type:"MultiLineString",coordinates:s})}}function Kk(e,{x:t,y:n,...r}={}){return[t,n]=hu(t,n),new WS(e,{...r,x:t,y:n})}function Qk(e,{x:t=Si,y:n=Kt,...r}={}){return new WS(e,LS({...r,x:t,y:n}))}function Jk({geometry:e=Kt,...t}={}){const n=vu(r=>Gt(r,e));return zr({...t,x:null,y:null,geometry:{transform:n}},(r,i,s,a,o,c)=>{const l=n(r),u=l.length,f=new Float64Array(u),d=new Float64Array(u),{centroid:h}=c.path();for(let p=0;p<u;++p)[f[p],d[p]]=h(l[p]);return{data:r,facets:i,channels:{x:{value:f,scale:null,source:null},y:{value:d,scale:null,source:null}}}})}const Zk={ariaLabel:"geo",fill:"none",stroke:"currentColor",strokeWidth:1,strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:1};class tC extends be{constructor(t,n={}){const[r,i]=me(n.r,3);super(t,{x:{value:n.tip?n.x:null,scale:"x",optional:!0},y:{value:n.tip?n.y:null,scale:"y",optional:!0},r:{value:r,scale:"r",filter:po,optional:!0},geometry:{value:n.geometry,scale:"projection"}},zS(n),Zk),this.r=i}render(t,n,r,i,s){const{geometry:a,r:o}=r,c=s.path(),{r:l}=this;return lu(l)?t=[]:l!==void 0&&c.pointRadius(l),Ht("svg:g",s).call(Fe,this,i,s).call(ke,this,n).call(u=>{u.selectAll().data(t).enter().append("path").call(ge,this).attr("d",o?f=>c.pointRadius(o[f])(a[f]):f=>c(a[f])).call(De,this,r)}).node()}}function eC(e,t={}){return t.tip&&t.x===void 0&&t.y===void 0?t=Jk(t):t.geometry===void 0&&(t={...t,geometry:Kt}),new tC(e,t)}const nC={ariaLabel:"waffle"};class rC extends jS{constructor(t,{unit:n=1,gap:r=1,round:i,multiple:s,...a}={}){super(t,iC("y",a),nC),this.unit=Math.max(0,n),this.gap=+r,this.round=cC(i),this.multiple=lC(s)}}function iC(e,t){const r=`${e}1`,i=`${e}2`;return zr(sC(t),function(s,a,o,c,l){const{round:u,unit:f}=this,d=o[r].value,h=o[i].value,p=ax({..."x"in o&&{x:o.x},[r]:o[r],[i]:o[i]},c),y=this._width(c,p,l),g=this._x(c,p,l),b=f*uC(c.scales[e]),{multiple:_=Math.max(1,Math.floor(Math.sqrt(y/b)))}=this,E=Math.min(y/_,b*_),w=b*_,A=(y-_*E)/2,x=typeof g=="function"?I=>g(I)+A:g+A,T=c[e](0),M=([I,O])=>[I*E,-O*w],R=typeof x=="function"?I=>x(I)-y/2:()=>x,[F,N]=[0,1],B=h.length,W=new Array(B),D=new Float64Array(B),S=new Float64Array(B);for(let I=0;I<B;++I){W[I]=Q0(u(d[I]/f),u(h[I]/f),_).map(M);const O=W[I].pop();D[I]=O[F]+R(I),S[I]=O[N]+T}return{channels:{polygon:{value:W,source:null,filter:null},cx:{value:[E,x],source:null,filter:null},[`c${e}`]:{value:[w,T],source:null,filter:null},x:{value:D,scale:null,source:null},[r]:{value:S,scale:null,source:o[r]},[i]:{value:S,scale:null,source:o[i]}}}})}function sC({render:e,...t}){return{...t,render:F0(e,function(n,r,i,s,a){const{gap:o,rx:c,ry:l}=this,{channels:u,ariaLabel:f,href:d,title:h,...p}=i,{document:y}=a,g=u.polygon.value,[b,_]=u.cx.value,[E,w]=u.cy.value,A=c5(),x=y.createElementNS(Ur.svg,"pattern");x.setAttribute("width",b),x.setAttribute("height",E),x.setAttribute("patternUnits","userSpaceOnUse");const T=x.appendChild(y.createElementNS(Ur.svg,"rect"));return T.setAttribute("x",o/2),T.setAttribute("y",o/2),T.setAttribute("width",b-o),T.setAttribute("height",E-o),c!=null&&T.setAttribute("rx",c),l!=null&&T.setAttribute("ry",l),Ht("svg:g",a).call(Fe,this,s,a).call(this._transform,this,r).call(M=>M.selectAll().data(n).enter().append(()=>x.cloneNode(!0)).attr("id",R=>`${A}-${R}`).select("rect").call(ge,this).call(De,this,p)).call(M=>M.selectAll().data(n).enter().append("path").attr("transform",Tu`translate(${_},${w})`).attr("d",R=>`M${g[R].join("L")}Z`).attr("fill",R=>`url(#${A}-${R})`).attr("stroke",this.stroke==null?null:"none").call(De,this,{ariaLabel:f,href:d,title:h})).node()})}}function Q0(e,t,n){if(t<e)return Q0(t,e,n);if(e<0)return aC(e,t,n,Math.ceil(-Math.min(e,t)/n));const r=Math.floor(e%n),i=Math.ceil(e%n),s=Math.floor(t%n),a=Math.ceil(t%n),o=Math.floor(e/n),c=Math.ceil(e/n),l=Math.floor(t/n),u=Math.ceil(t/n),f=[];return u>c&&f.push([0,c]),f.push([r,c],[r,o+e%1],[i,o+e%1]),e%n>n-1||(f.push([i,o]),l>o&&f.push([n,o])),l>o&&f.push([n,l]),f.push([a,l],[a,l+t%1],[s,l+t%1]),t%n<1||(f.push([s,u]),u>c&&f.push([0,u])),f.push(oC(e,t,n)),f}function aC(e,t,n,r){return Q0(e+r*n,t+r*n,n).map(([i,s])=>[i,s-r])}function oC(e,t,n){const r=Math.floor(t/n)-Math.floor(e/n);return r===0?Tf(e,t,n):r===1?Math.floor(t%n)>Math.ceil(e%n)?[(Math.floor(t%n)+Math.ceil(e%n))/2,Math.floor(t/n)]:t%n>n-e%n?Tf(t-t%n,t,n):Tf(e,n*Math.ceil(e/n),n):[n/2,(Math.round(e/n)+Math.round(t/n))/2]}function Tf(e,t,n){const r=Math.floor(t)-Math.floor(e);return r===0?[Math.floor(e%n)+.5,Math.floor(e/n)+(e+t)/2%1]:r===1?t%1-e%1>.5?[Math.ceil(e%n),Math.floor(t/n)+(e%1+t%1)/2]:t%1>1-e%1?[Math.floor(t%n)+.5,Math.floor(t/n)+t%1/2]:[Math.floor(e%n)+.5,Math.floor(e/n)+(1+e%1)/2]:[Math.ceil(e%n)+Math.ceil(Math.floor(t)-Math.ceil(e))/2,Math.floor(e/n)+(t>=1+e?.5:(e+t)/2%1)]}function cC(e){if(e===void 0||e===!1)return Number;if(e===!0)return Math.round;if(typeof e!="function")throw new Error(`invalid round: ${e}`);return e}function lC(e){return e===void 0?void 0:Math.max(1,Math.floor(e))}function uC({domain:e,range:t}){return Hy(t)/Hy(e)}function Hy(e){const[t,n]=$e(e);return n-t}function qy(e,{tip:t,...n}={}){return y0(n)||(n={...n,x:Si,y2:Kt}),new rC(e,{tip:fC(t),...W0($0(Y0(n)))})}function fC(e){return e===!0?{maxRadius:1/0}:xr(e)&&e.maxRadius===void 0?{...e,maxRadius:1/0}:void 0}be.prototype.plot=function({marks:e=[],...t}={}){return mn({...t,marks:[...e,this]})};function Yr(e){if(e===void 0)return"undefined";const n=BigInt(e)/1000n,r=n/(3600n*24n),i=n%(3600n*24n)/3600n,s=n%3600n/60n,a=n%60n,o=[];return r>0n&&o.push(`${r}d`),(i>0n||r>0n)&&o.push(`${i}h`),(s>0n||i>0n||r>0n)&&o.push(`${s}m`),o.push(`${a}s`),o.join(" ")}function dC(e){return e.toLocaleDateString(void 0,{month:"long",year:"numeric"})}function hC(e,t,n=!1){const r=t||je(e,i=>i.ms_played)||100;return mn({title:"Stream duration per month",x:{type:"band",label:null,transform:fu("month").floor},y:{grid:!0,label:null,tickFormat:Yr,domain:[0,r]},color:{scheme:n?"warm":"viridis"},style:{background:"transparent"},marginLeft:100,marks:[U0([0]),Wk(e,{x:"ts",y:"ms_played",fill:"ts",channels:{count_streams:"count_streams"},tip:{format:{y:Yr,x:dC,count_streams:!0}}})]})}async function Wt(e){const{conn:t}=await Qa();return(await t.query(e)).toArray().map(i=>i.toJSON())}function Ps({query:e,buildPlot:t}){const[n,r]=P.useState(),{effectiveTheme:i}=P.useContext(Pd),s=P.useRef(null);return P.useEffect(()=>{(async()=>{const o=await Wt(e);r(o)})()},[e]),P.useEffect(()=>{if(!n)return;const a=t(n,i==="dark");return s.current&&s.current.appendChild(a),()=>{a.remove()}},[n,t,i]),m.jsx("div",{ref:s,className:"group p-6 my-4 bg-white dark:bg-slate-900/80 backdrop-blur-md rounded-2xl border border-gray-300/60 dark:border-slate-700/50 text-gray-900 dark:text-gray-100 transition-all duration-300 hover:shadow-glass-lg hover:scale-[1.01] animate-fade-in"})}function pC({year:e,maxValue:t}){const n=P.useCallback((r,i)=>hC(r,t,i),[t]);return m.jsx(Ps,{query:w6(e),buildPlot:n})}function mC(e){return`
SELECT
    hour::INT AS hour,
    COALESCE(count_streams, 0)::INT AS count_streams,
    COALESCE(ms_played, 0)::INT AS ms_played
FROM (SELECT UNNEST(RANGE(24)) AS hour)
LEFT JOIN (
    SELECT
        HOUR(ts::DATETIME) AS hour,
        COUNT(*) AS count_streams,
        SUM(ms_played) AS ms_played
    FROM ${q}
    ${e?`WHERE YEAR(ts::DATETIME) = ${e}`:""}
    GROUP BY HOUR(ts::DATETIME)
) USING(hour)
ORDER BY hour
`}function yC(e,t,n=!1){const r=mw(new Set(Gt(e,"hour")),[180,-180]).padding(.5).align(1),i=t||je(e,a=>a.count_streams)||100,s=tu().domain([i,0]).range([.5,0]);return mn({title:"Number of streams per hour",projection:{type:"azimuthal-equidistant",rotate:[0,-90],domain:ym().center([0,90]).radius(.625)()},style:{background:"transparent"},marks:[eC([.5,.4,.3,.2,.1],{geometry:a=>ym().center([0,90]).radius(a)(),stroke:n?"white":"black",fill:n?"white":"black",strokeOpacity:n?.2:.3,fillOpacity:n?.02:.03,strokeWidth:.5}),Vk(r.domain(),{x1:r,y1:90-.57,x2:0,y2:90,stroke:"white",strokeOpacity:n?.3:.5,strokeWidth:2.5}),yr(r.domain(),{x:r,y:90-.57,text:a=>`${String(a).padStart(2,"0")}`,lineWidth:5,className:"stream-per-hour-hours-text"}),US(e,{x1:({hour:a})=>r(a),y1:({count_streams:a})=>90-s(a),x2:0,y2:90,fill:!0,stroke:!0,curve:"cardinal-closed",fillOpacity:.3}),YS(e,{x:({hour:a})=>r(a),y:({count_streams:a})=>90-s(a),fill:!0,stroke:"white",className:"stream-per-hour-points"}),yr(e,Dx({x:({hour:a})=>r(a),y:({count_streams:a})=>90-s(a),text:a=>`${a.count_streams.toLocaleString()} stream(s) for ${Yr(a.ms_played)}`,textAnchor:"start",dx:4,fill:"currentColor",stroke:n?"black":"white",maxRadius:10}))]})}function gC({year:e,maxValue:t}){const n=P.useCallback((r,i)=>yC(r,t,i),[t]);return m.jsx(Ps,{query:mC(e),buildPlot:n})}function bC(){return`
WITH dates AS (
  SELECT DISTINCT ts::DATE as date FROM ${q}
),
groups AS (
  SELECT
    date,
    date - INTERVAL '1' DAY * (ROW_NUMBER() OVER (ORDER BY date)) AS grp
  FROM dates
)
SELECT
  MIN(date) AS start_ts,
  MAX(date) AS end_ts,
  COUNT(*)::INTEGER AS streaks
FROM groups
GROUP BY grp
ORDER BY streaks DESC
LIMIT 1
`}function _C(){return`
WITH dates AS (
  SELECT DISTINCT ts::DATE as date FROM ${q}
),
groups AS (
  SELECT
    date,
    date - INTERVAL '1' DAY * (ROW_NUMBER() OVER (ORDER BY date)) AS grp
  FROM dates
)
SELECT
  MIN(date) AS start_ts,
  MAX(date) AS end_ts,
  COUNT(*)::INTEGER AS streaks
FROM groups
GROUP BY grp
ORDER BY end_ts DESC
LIMIT 1
`}const wC=P.memo(function({data:t}){if(t.length===0)return null;const n=t[0],r=new Date(n.start_ts).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}),i=new Date(n.end_ts).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"});return m.jsxs("div",{className:"flex flex-col md:flex-row items-center gap-6",children:[m.jsx("div",{className:"text-3xl md:text-4xl flex-shrink-0 animate-bounce-slow",children:""}),m.jsxs("div",{className:"flex-1 text-center md:text-left",children:[m.jsx("div",{className:"text-sm font-bold text-purple-600 dark:text-purple-400 uppercase tracking-wider mb-2",children:"Top streak"}),m.jsx("div",{className:"text-3xl md:text-6xl font-bold text-gray-900 dark:text-white break-words text-balance",children:n.streaks}),m.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-300",children:"days in a row"}),m.jsxs("div",{className:"text-xs text-gray-600 dark:text-gray-400 mt-1 italic",children:["From ",r," to ",i]})]})]})});function vC(){const[e,t]=P.useState(),[n,r]=P.useState(),[i,s]=P.useState(!1);P.useEffect(()=>{(async()=>{const l=await Wt(bC());t(l);const u=await Wt(_C());r(u)})()},[]);const a=()=>s(c=>!c),o=i?n:e;return o?o.length===0?m.jsx(m.Fragment,{}):m.jsxs("div",{className:"group flex-1 p-6 bg-white dark:bg-slate-900/80 backdrop-blur-md rounded-2xl border border-gray-300/60 dark:border-slate-700/50 text-gray-900 dark:text-gray-100 transition-all duration-300 shadow-glass hover:shadow-glass-lg hover:scale-[1.01] animate-fade-in",children:[m.jsx("button",{onClick:a,className:"absolute top-2 right-2 px-3 py-1.5 text-xs font-medium text-gray-600 dark:text-gray-300 bg-gray-100 dark:bg-slate-800/80 backdrop-blur-sm rounded-full hover:bg-brand-purple/20 hover:text-brand-purple dark:hover:bg-brand-purple/20 dark:hover:text-brand-purple transition-all duration-300 border border-gray-300/50 dark:border-slate-700/50","aria-label":i?"Show top streak":"Show current streak",children:i?" Current":" Top"}),m.jsx(wC,{data:o})]}):m.jsx(m.Fragment,{})}function xC(e){return`
WITH ranked_streams AS (
  SELECT
    YEAR(ts::DATETIME)::INT AS year,
    ROW_NUMBER() OVER (PARTITION BY track_uri ORDER BY ts::DATETIME) AS rank_all_time,
    ROW_NUMBER() OVER (PARTITION BY track_uri, YEAR(ts::DATETIME) ORDER BY ts::DATETIME) AS rank_per_year,
    MIN(YEAR(ts::DATETIME)::INT) OVER (PARTITION BY track_uri) as first_year
  FROM ${q}
)
UNPIVOT (
  SELECT
    year,
    SUM(CASE WHEN rank_all_time = 1 THEN 1 ELSE 0 END)::INT AS new_unique,
    SUM(CASE WHEN first_year = year AND rank_all_time != 1 THEN 1 ELSE 0 END)::INT AS new_repeat,
    SUM(CASE WHEN first_year < year AND rank_per_year = 1 THEN 1 ELSE 0 END)::INT AS old_unique,
    SUM(CASE WHEN first_year < year AND rank_per_year != 1 THEN 1 ELSE 0 END)::INT AS old_repeat
  FROM ranked_streams
  ${e?`WHERE ranked_streams.year = ${e}`:""}
  GROUP BY year
)
ON COLUMNS(* EXCLUDE (year))
INTO
  NAME type
  VALUE count_streams
`}function SC(e){let t=1,n=1;e.length>0&&(t=e.reduce((a,o)=>a+o.count_streams,0)),n=Math.max(1,10**(String(t).length-3));const r={new_unique:{main:"New Tracks",sub:"First Listen"},new_repeat:{main:"New Tracks",sub:"Repeats"},old_unique:{main:"Old Tracks",sub:"First Listen"},old_repeat:{main:"Old Tracks",sub:"Repeats"}},i=e.map(a=>({...a,main_category:r[a.type]?.main||a.type,sub_category:r[a.type]?.sub||a.type})),s=Object.values(i.reduce((a,o)=>(a[o.main_category]||(a[o.main_category]={main_category:o.main_category,count_streams:0}),a[o.main_category].count_streams+=o.count_streams,a),{}));return mn({title:"Distribution of streams",subtitle:`Each circle represents ${n.toLocaleString()} streams`,axis:null,marginTop:20,marginBottom:70,color:{legend:!0,domain:["First Listen","Repeats"]},marks:[qy({length:1},{y:t,fillOpacity:.4,rx:"100%",unit:n}),qy(i,{fx:"main_category",y:"count_streams",fill:"sub_category",tip:!0,rx:"100%",unit:n,sort:{fx:"y",reduce:"sum",reverse:!0}}),yr(s,{fx:"main_category",text:a=>(a.count_streams/t).toLocaleString("en-US",{style:"percent"})+" "+a.main_category,frameAnchor:"bottom",lineAnchor:"top",dy:10,fill:"currentColor",fontSize:24,fontWeight:"bold"})]})}function EC({year:e}){const t=P.useCallback(SC,[]);return m.jsx(Ps,{query:xC(e),buildPlot:t})}function Gy(){return`
SELECT
  COUNT(*)::INTEGER AS count_streams,
  SUM(ms_played)::DOUBLE AS ms_played
FROM ${q}
`}const TC=P.memo(function({data:t}){if(t.length===0)return null;const n=Yr(t[0].ms_played).split(" ")[0],r=t[0].count_streams;return m.jsxs("div",{className:"flex flex-col md:flex-row items-center gap-6",children:[m.jsx("div",{className:"text-3xl md:text-4xl flex-shrink-0 animate-bounce-slow",children:""}),m.jsxs("div",{className:"flex-1 text-center md:text-left",children:[m.jsx("div",{className:"text-sm font-bold text-purple-600 dark:text-purple-400 uppercase tracking-wider mb-2",children:"Total streams"}),m.jsx("div",{className:"text-3xl md:text-6xl font-bold text-gray-900 dark:text-white break-words text-balance",children:n}),m.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-300",children:"played duration"}),m.jsxs("div",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1 italic",children:["For ",r," streams"]})]})]})});function AC(){const[e,t]=P.useState();return P.useEffect(()=>{(async()=>{const r=await Wt(Gy());t(r)})()},[Gy]),e?m.jsx("div",{className:"group flex-1 p-6 bg-white dark:bg-slate-900/80 backdrop-blur-md rounded-2xl border border-gray-300/60 dark:border-slate-700/50 text-gray-900 dark:text-gray-100 transition-all duration-300 shadow-glass hover:shadow-glass-lg hover:scale-[1.01] animate-fade-in",children:m.jsx(TC,{data:e})}):m.jsx(m.Fragment,{})}function IC(){return`
SELECT
  master_metadata_album_artist_name AS artist_name,
  COUNT(*)::DOUBLE AS count_streams,
  SUM(ms_played)::DOUBLE AS ms_played
FROM ${q}
WHERE master_metadata_album_artist_name IS NOT NULL
GROUP BY
  master_metadata_album_artist_name
ORDER BY
  count_streams DESC
LIMIT 1
`}function NC(){return`
SELECT
  master_metadata_album_artist_name AS artist_name,
  COUNT(*)::DOUBLE AS count_streams,
  SUM(ms_played)::DOUBLE AS ms_played
FROM ${q}
WHERE master_metadata_album_artist_name IS NOT NULL
GROUP BY
  master_metadata_album_artist_name
ORDER BY
  ms_played DESC
LIMIT 1
`}const MC=P.memo(function({data:t}){if(t.length===0)return null;const n=t[0],r=Yr(n.ms_played).split(" ")[0];return m.jsxs("div",{className:"flex flex-col md:flex-row items-center gap-6",children:[m.jsx("div",{className:"text-3xl md:text-4xl flex-shrink-0 animate-bounce-slow",children:""}),m.jsxs("div",{className:"flex-1 text-center md:text-left",children:[m.jsx("div",{className:"text-sm font-bold text-purple-600 dark:text-purple-400 uppercase tracking-wider mb-2",children:"Top artist"}),m.jsx("div",{className:"text-2xl md:text-4xl font-bold text-gray-900 dark:text-white break-words text-balance",children:n.artist_name}),m.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-300",children:"most played artist"}),m.jsxs("div",{className:"text-xs text-gray-600 dark:text-gray-400 mt-1 italic",children:["With ",n.count_streams," streams, i.e."," ",r]})]})]})});function OC(){const[e,t]=P.useState(),[n,r]=P.useState(),[i,s]=P.useState(!1);P.useEffect(()=>{(async()=>{const l=await Wt(IC());t(l);const u=await Wt(NC());r(u)})()},[]);const a=()=>s(c=>!c),o=i?n:e;return o?m.jsxs("div",{className:"group flex-1 p-6 h-full bg-white dark:bg-slate-900/80 backdrop-blur-md rounded-2xl border border-gray-300/60 dark:border-slate-700/50 text-gray-900 dark:text-gray-100 transition-all duration-300 shadow-glass hover:shadow-glass-lg hover:scale-[1.01] animate-fade-in",children:[m.jsx("button",{onClick:a,className:"absolute top-2 right-2 px-3 py-1.5 text-xs font-medium text-gray-600 dark:text-gray-300 bg-gray-100 dark:bg-slate-800/80 backdrop-blur-sm rounded-full hover:bg-brand-purple/20 hover:text-brand-purple dark:hover:bg-brand-purple/20 dark:hover:text-brand-purple transition-all duration-300 border border-gray-300/50 dark:border-slate-700/50","aria-label":i?"Show by duration":"Show by count",children:i?" Count":" Duration"}),m.jsx(MC,{data:o})]}):m.jsx(m.Fragment,{})}function HS({value:e,onChange:t,min:n,max:r,step:i}){const[s,a]=P.useState(0),o=P.useRef(null);return P.useEffect(()=>{if(o.current){const c=(e-n)/(r-n),l=20,f=o.current.offsetWidth-l;a(l/2+c*f)}},[e,n,r]),m.jsxs("div",{className:"w-full relative space-y-4 my-8 px-2",children:[m.jsxs("div",{className:"relative",children:[m.jsx("div",{className:"absolute -top-12 px-4 py-2 text-base font-bold text-white bg-gradient-brand rounded-xl shadow-glow transition-all duration-300",style:{left:`${s}px`,transform:"translateX(-50%)"},children:e}),m.jsx("input",{ref:o,type:"range",min:n,max:r,step:i,value:e,onChange:c=>t(Number(c.target.value)),className:"w-full h-2 bg-gray-200 dark:bg-slate-700 rounded-full appearance-none cursor-pointer slider-thumb transition-all duration-200",style:{background:`linear-gradient(to right, 
                            rgba(139, 92, 246, 0.8) 0%, 
                            rgba(59, 130, 246, 0.8) ${(e-n)/(r-n)*100}%, 
                            rgb(229, 231, 235) ${(e-n)/(r-n)*100}%, 
                            rgb(229, 231, 235) 100%)`}})]}),m.jsxs("div",{className:"flex justify-between text-sm font-medium text-gray-600 dark:text-gray-400",children:[m.jsx("span",{className:"px-2 py-1 bg-gray-100 dark:bg-slate-800 rounded-lg",children:n}),m.jsx("span",{className:"px-2 py-1 bg-gray-100 dark:bg-slate-800 rounded-lg",children:r})]})]})}const qS=`
WITH monthly_aggregates AS (
    SELECT SUM(ms_played) AS monthly_duration FROM ${q} GROUP BY YEAR(ts::DATE), MONTH(ts::DATE)
),
hourly_aggregates AS (
    SELECT COUNT(*) AS count_hourly_stream FROM ${q} GROUP BY YEAR(ts::DATE), HOUR(ts::DATETIME)
)
SELECT
    MIN(ts::DATETIME) AS min_datetime,
    MAX(ts::DATETIME) AS max_datetime,
    (SELECT MAX(count_hourly_stream) FROM hourly_aggregates) AS max_count_hourly_stream,
    (SELECT MAX(monthly_duration) FROM monthly_aggregates) AS max_monthly_duration
FROM ${q};
`;function RC(e){return`
SELECT
  master_metadata_track_name AS track_name,
  master_metadata_album_artist_name AS artist_name,
  COUNT(*)::DOUBLE AS count_streams,
  SUM(ms_played)::DOUBLE AS ms_played
FROM ${q}
${e?`WHERE YEAR(ts:: DATETIME) = ${e}`:""}
GROUP BY track_uri, master_metadata_track_name, master_metadata_album_artist_name
ORDER BY count_streams DESC, ms_played DESC
LIMIT 10
`}function DC(e,t=!1){if(e.length===0)return mn();const n=e.map(r=>`${r.track_name}  ${r.artist_name}`);return mn({title:"Top Tracks",color:{scheme:t?"warm":"viridis"},style:{background:"transparent"},width:700,height:400,marginLeft:160,x:{label:null,ticks:[]},y:{label:null,domain:n},marks:[VS(e.map(r=>({name:`${r.track_name}  ${r.artist_name}`,count:r.count_streams,duration:Yr(r.ms_played)})),{x:"count",y:"name",fill:"count",channels:{duration:"duration"},tip:{format:{duration:!0}}}),yr(e.map(r=>({name:`${r.track_name}  ${r.artist_name}`,count:Number(r.count_streams),label:Number(r.count_streams).toString()})),{x:"count",y:"name",text:"label",dx:5,dy:0,fill:t?"#f1f1f1":"#1f1f1f",textAnchor:"start",fontSize:12})]})}function LC({year:e}){const t=P.useCallback((n,r)=>DC(n,r),[]);return m.jsx(Ps,{query:RC(e),buildPlot:t})}function FC(e){return`
SELECT
  master_metadata_album_artist_name AS artist_name,
  COUNT(*)::DOUBLE AS count_streams,
  SUM(ms_played)::DOUBLE AS ms_played
FROM ${q}
${e?`WHERE YEAR(ts:: DATETIME) = ${e}`:""}
GROUP BY master_metadata_album_artist_name
ORDER BY count_streams DESC
LIMIT 10
`}function kC(e,t=!1){if(e.length===0)return mn();const n=[...e.map(r=>r.artist_name,"Note")];return mn({title:"Top Artists",subtitle:" This chart is for informational purposes only. The data only includes artist names, and multiple artists may share the same name.",color:{scheme:t?"warm":"viridis"},style:{background:"transparent"},width:700,height:420,marginLeft:160,x:{label:null,ticks:[]},y:{label:null,domain:n},marks:[VS(e.map(r=>({name:r.artist_name,count:r.count_streams,duration:Yr(r.ms_played)})),{x:"count",y:"name",fill:"count",channels:{duration:"duration"},tip:{format:{duration:!0}}}),yr(e.map(r=>({name:r.artist_name,count:Number(r.count_streams),label:Number(r.count_streams).toString()})),{x:"count",y:"name",text:"label",dx:5,dy:0,fill:t?"#f1f1f1":"#1f1f1f",textAnchor:"start",fontSize:12})]})}function CC({year:e}){return m.jsx(Ps,{query:FC(e),buildPlot:kC})}function BC(){return`SELECT day, 1 as played from (SELECT DISTINCT ts::DATE::TEXT as day FROM ${q})`}var yc={exports:{}},$C=yc.exports,Xy;function UC(){return Xy||(Xy=1,(function(e,t){(function(n,r){e.exports=r()})($C,(function(){var n=1e3,r=6e4,i=36e5,s="millisecond",a="second",o="minute",c="hour",l="day",u="week",f="month",d="quarter",h="year",p="date",y="Invalid Date",g=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,b=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,_={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(D){var S=["th","st","nd","rd"],I=D%100;return"["+D+(S[(I-20)%10]||S[I]||S[0])+"]"}},E=function(D,S,I){var O=String(D);return!O||O.length>=S?D:""+Array(S+1-O.length).join(I)+D},w={s:E,z:function(D){var S=-D.utcOffset(),I=Math.abs(S),O=Math.floor(I/60),C=I%60;return(S<=0?"+":"-")+E(O,2,"0")+":"+E(C,2,"0")},m:function D(S,I){if(S.date()<I.date())return-D(I,S);var O=12*(I.year()-S.year())+(I.month()-S.month()),C=S.clone().add(O,f),L=I-C<0,$=S.clone().add(O+(L?-1:1),f);return+(-(O+(I-C)/(L?C-$:$-C))||0)},a:function(D){return D<0?Math.ceil(D)||0:Math.floor(D)},p:function(D){return{M:f,y:h,w:u,d:l,D:p,h:c,m:o,s:a,ms:s,Q:d}[D]||String(D||"").toLowerCase().replace(/s$/,"")},u:function(D){return D===void 0}},A="en",x={};x[A]=_;var T="$isDayjsObject",M=function(D){return D instanceof B||!(!D||!D[T])},R=function D(S,I,O){var C;if(!S)return A;if(typeof S=="string"){var L=S.toLowerCase();x[L]&&(C=L),I&&(x[L]=I,C=L);var $=S.split("-");if(!C&&$.length>1)return D($[0])}else{var j=S.name;x[j]=S,C=j}return!O&&C&&(A=C),C||!O&&A},F=function(D,S){if(M(D))return D.clone();var I=typeof S=="object"?S:{};return I.date=D,I.args=arguments,new B(I)},N=w;N.l=R,N.i=M,N.w=function(D,S){return F(D,{locale:S.$L,utc:S.$u,x:S.$x,$offset:S.$offset})};var B=(function(){function D(I){this.$L=R(I.locale,null,!0),this.parse(I),this.$x=this.$x||I.x||{},this[T]=!0}var S=D.prototype;return S.parse=function(I){this.$d=(function(O){var C=O.date,L=O.utc;if(C===null)return new Date(NaN);if(N.u(C))return new Date;if(C instanceof Date)return new Date(C);if(typeof C=="string"&&!/Z$/i.test(C)){var $=C.match(g);if($){var j=$[2]-1||0,Y=($[7]||"0").substring(0,3);return L?new Date(Date.UTC($[1],j,$[3]||1,$[4]||0,$[5]||0,$[6]||0,Y)):new Date($[1],j,$[3]||1,$[4]||0,$[5]||0,$[6]||0,Y)}}return new Date(C)})(I),this.init()},S.init=function(){var I=this.$d;this.$y=I.getFullYear(),this.$M=I.getMonth(),this.$D=I.getDate(),this.$W=I.getDay(),this.$H=I.getHours(),this.$m=I.getMinutes(),this.$s=I.getSeconds(),this.$ms=I.getMilliseconds()},S.$utils=function(){return N},S.isValid=function(){return this.$d.toString()!==y},S.isSame=function(I,O){var C=F(I);return this.startOf(O)<=C&&C<=this.endOf(O)},S.isAfter=function(I,O){return F(I)<this.startOf(O)},S.isBefore=function(I,O){return this.endOf(O)<F(I)},S.$g=function(I,O,C){return N.u(I)?this[O]:this.set(C,I)},S.unix=function(){return Math.floor(this.valueOf()/1e3)},S.valueOf=function(){return this.$d.getTime()},S.startOf=function(I,O){var C=this,L=!!N.u(O)||O,$=N.p(I),j=function(U,z){var G=N.w(C.$u?Date.UTC(C.$y,z,U):new Date(C.$y,z,U),C);return L?G:G.endOf(l)},Y=function(U,z){return N.w(C.toDate()[U].apply(C.toDate("s"),(L?[0,0,0,0]:[23,59,59,999]).slice(z)),C)},V=this.$W,K=this.$M,ot=this.$D,yt="set"+(this.$u?"UTC":"");switch($){case h:return L?j(1,0):j(31,11);case f:return L?j(1,K):j(0,K+1);case u:var H=this.$locale().weekStart||0,ct=(V<H?V+7:V)-H;return j(L?ot-ct:ot+(6-ct),K);case l:case p:return Y(yt+"Hours",0);case c:return Y(yt+"Minutes",1);case o:return Y(yt+"Seconds",2);case a:return Y(yt+"Milliseconds",3);default:return this.clone()}},S.endOf=function(I){return this.startOf(I,!1)},S.$set=function(I,O){var C,L=N.p(I),$="set"+(this.$u?"UTC":""),j=(C={},C[l]=$+"Date",C[p]=$+"Date",C[f]=$+"Month",C[h]=$+"FullYear",C[c]=$+"Hours",C[o]=$+"Minutes",C[a]=$+"Seconds",C[s]=$+"Milliseconds",C)[L],Y=L===l?this.$D+(O-this.$W):O;if(L===f||L===h){var V=this.clone().set(p,1);V.$d[j](Y),V.init(),this.$d=V.set(p,Math.min(this.$D,V.daysInMonth())).$d}else j&&this.$d[j](Y);return this.init(),this},S.set=function(I,O){return this.clone().$set(I,O)},S.get=function(I){return this[N.p(I)]()},S.add=function(I,O){var C,L=this;I=Number(I);var $=N.p(O),j=function(K){var ot=F(L);return N.w(ot.date(ot.date()+Math.round(K*I)),L)};if($===f)return this.set(f,this.$M+I);if($===h)return this.set(h,this.$y+I);if($===l)return j(1);if($===u)return j(7);var Y=(C={},C[o]=r,C[c]=i,C[a]=n,C)[$]||1,V=this.$d.getTime()+I*Y;return N.w(V,this)},S.subtract=function(I,O){return this.add(-1*I,O)},S.format=function(I){var O=this,C=this.$locale();if(!this.isValid())return C.invalidDate||y;var L=I||"YYYY-MM-DDTHH:mm:ssZ",$=N.z(this),j=this.$H,Y=this.$m,V=this.$M,K=C.weekdays,ot=C.months,yt=C.meridiem,H=function(z,G,k,xt){return z&&(z[G]||z(O,L))||k[G].slice(0,xt)},ct=function(z){return N.s(j%12||12,z,"0")},U=yt||function(z,G,k){var xt=z<12?"AM":"PM";return k?xt.toLowerCase():xt};return L.replace(b,(function(z,G){return G||(function(k){switch(k){case"YY":return String(O.$y).slice(-2);case"YYYY":return N.s(O.$y,4,"0");case"M":return V+1;case"MM":return N.s(V+1,2,"0");case"MMM":return H(C.monthsShort,V,ot,3);case"MMMM":return H(ot,V);case"D":return O.$D;case"DD":return N.s(O.$D,2,"0");case"d":return String(O.$W);case"dd":return H(C.weekdaysMin,O.$W,K,2);case"ddd":return H(C.weekdaysShort,O.$W,K,3);case"dddd":return K[O.$W];case"H":return String(j);case"HH":return N.s(j,2,"0");case"h":return ct(1);case"hh":return ct(2);case"a":return U(j,Y,!0);case"A":return U(j,Y,!1);case"m":return String(Y);case"mm":return N.s(Y,2,"0");case"s":return String(O.$s);case"ss":return N.s(O.$s,2,"0");case"SSS":return N.s(O.$ms,3,"0");case"Z":return $}return null})(z)||$.replace(":","")}))},S.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},S.diff=function(I,O,C){var L,$=this,j=N.p(O),Y=F(I),V=(Y.utcOffset()-this.utcOffset())*r,K=this-Y,ot=function(){return N.m($,Y)};switch(j){case h:L=ot()/12;break;case f:L=ot();break;case d:L=ot()/3;break;case u:L=(K-V)/6048e5;break;case l:L=(K-V)/864e5;break;case c:L=K/i;break;case o:L=K/r;break;case a:L=K/n;break;default:L=K}return C?L:N.a(L)},S.daysInMonth=function(){return this.endOf(f).$D},S.$locale=function(){return x[this.$L]},S.locale=function(I,O){if(!I)return this.$L;var C=this.clone(),L=R(I,O,!0);return L&&(C.$L=L),C},S.clone=function(){return N.w(this.$d,this)},S.toDate=function(){return new Date(this.valueOf())},S.toJSON=function(){return this.isValid()?this.toISOString():null},S.toISOString=function(){return this.$d.toISOString()},S.toString=function(){return this.$d.toUTCString()},D})(),W=B.prototype;return F.prototype=W,[["$ms",s],["$s",a],["$m",o],["$H",c],["$W",l],["$M",f],["$y",h],["$D",p]].forEach((function(D){W[D[1]]=function(S){return this.$g(S,D[0],D[1])}})),F.extend=function(D,S){return D.$i||(D(S,B,F),D.$i=!0),F},F.locale=R,F.isDayjs=M,F.unix=function(D){return F(1e3*D)},F.en=x[A],F.Ls=x,F.p={},F}))})(yc)),yc.exports}var PC=UC();const Xo=rE(PC);function jC({data:e}){const t=P.useRef(null),[n,r]=P.useState(0),i=365,s=ep.useMemo(()=>{if(!e||e.length===0)return[];const l=Array.from(new Set(e.map(g=>Xo(g.day).format("YYYY-MM-DD")))).sort(),u=Xo(l[0]),f=Xo(l[l.length-1]),d=[];let h=u;for(;h.isBefore(f)||h.isSame(f);)d.push(h.format("YYYY-MM-DD")),h=h.add(1,"day");const p=d.map(g=>({day:g,played:l.includes(g)?1:0}));let y=0;return p.map(({day:g,played:b})=>(b===1?y+=1:y=0,{day:g,streak:y}))},[e]),a=ep.useMemo(()=>s.length===0?0:Math.max(...s.map(l=>l.streak)),[s]),o=Math.max(0,s.length-i),c=s.slice(n,n+i);return P.useEffect(()=>{if(!t.current||c.length===0)return;const l=t.current.clientWidth,u=300,f=c.map(h=>({...h,date:new Date(h.day)}));t.current.innerHTML="";const d=mn({width:l,height:u,y:{label:"Streak",zero:!0,nice:!0,grid:!0,domain:[0,a]},x:{label:"Date",tickFormat:h=>Xo(h).format("MM-DD"),nice:!0,type:"time"},marks:[US(f,{x1:"date",y1:"streak",curve:"monotone-x",fill:"#6366f1",fillOpacity:.3,stroke:"#4f46e5",strokeWidth:1}),Kk(f,{x:h=>h.date,y:h=>h.streak,curve:"monotone-x",stroke:"#4f46e5",strokeWidth:2,tip:!0})]});t.current.appendChild(d)},[c]),m.jsxs("div",{style:{width:"100%"},children:[m.jsx("div",{ref:t}),s.length>i&&m.jsx("input",{type:"range",min:0,max:o,value:n,onChange:l=>r(Number(l.target.value)),style:{width:"100%",marginTop:8},"aria-label":"Zoom timeline slider"})]})}function VC(){const[e,t]=P.useState();return P.useEffect(()=>{(async()=>{const r=await Wt(BC());t(r)})()},[]),e?m.jsx("div",{className:"group p-6 my-4 bg-white dark:bg-slate-900/80 backdrop-blur-md rounded-2xl border border-gray-300/60 dark:border-slate-700/50 text-gray-900 dark:text-gray-100 transition-all duration-300 hover:shadow-glass-lg hover:scale-[1.01] animate-fade-in",children:m.jsx(jC,{data:e})}):m.jsx(m.Fragment,{})}function zC(){return`
WITH artist_yearly_play_counts AS (
    SELECT
        YEAR(ts::DATETIME)::INT AS year,
        master_metadata_album_artist_name AS artist,
        COUNT(*)::INT AS play_count
    FROM ${q}
    WHERE master_metadata_album_artist_name IS NOT NULL
    GROUP BY year, artist
),
artist_total_play_counts AS (
    SELECT
        artist,
        SUM(play_count)::INT AS total_play_count
    FROM artist_yearly_play_counts
    GROUP BY artist
),
top_10_global_artists AS (
    SELECT
        artist
    FROM artist_total_play_counts
    ORDER BY total_play_count DESC
    LIMIT 10
),
yearly_ranks AS (
    SELECT
        year,
        artist,
        play_count,
        ROW_NUMBER() OVER (PARTITION BY year ORDER BY play_count DESC)::INT AS rank
    FROM artist_yearly_play_counts
)
SELECT
    yr.year,
    yr.artist,
    yr.rank,
    yr.play_count
FROM yearly_ranks yr
JOIN top_10_global_artists t10 ON yr.artist = t10.artist
ORDER BY yr.year, yr.rank
`}function YC({data:e}){const t=P.useRef(null);return P.useEffect(()=>{if(!e||e.length===0||!t.current)return;const n=[...e].sort((c,l)=>c.artist!==l.artist?c.artist.localeCompare(l.artist):c.year-l.year),i=[...Array.from(new Set(n.map(c=>c.artist))).map(c=>{const l=n.filter(u=>u.artist===c);return l[l.length-1]})].sort((c,l)=>c.rank-l.rank),s=i.filter((c,l)=>l%2===0),a=i.filter((c,l)=>l%2===1),o=mn({title:"Global Top 10 Artists Evolution",width:1200,height:700,marginLeft:60,marginRight:200,style:{background:"transparent",fontSize:"12px"},y:{label:"Rank",type:"log",reverse:!0,grid:!0},x:{label:"Year",tickFormat:"d"},color:{legend:!1},marks:[Qk(n,{x:"year",y:"rank",stroke:"artist",strokeWidth:2.5}),YS(n,{x:"year",y:"rank",fill:"artist",r:4}),yr(s,{x:"year",y:"rank",text:"artist",fill:"artist",dx:10,dy:-8,textAnchor:"start",fontSize:11,fontWeight:"bold"}),yr(a,{x:"year",y:"rank",text:"artist",fill:"artist",dx:10,dy:8,textAnchor:"start",fontSize:11,fontWeight:"bold"}),MS(n,Lx({x:"year",y:"rank",title:c=>`${c.artist}
Rank: ${c.rank}
Year: ${c.year}`}))]});return t.current.append(o),()=>o.remove()},[e]),m.jsx("div",{ref:t})}function WC(){const[e,t]=P.useState([]);return P.useEffect(()=>{(async()=>{const r=await Wt(zC());t(r)})()},[]),e.length===0?null:m.jsx("div",{className:"group p-6 my-4 bg-white dark:bg-slate-900/80 backdrop-blur-md rounded-2xl border border-gray-300/60 dark:border-slate-700/50 text-gray-900 dark:text-gray-100 transition-all duration-300 hover:shadow-glass-lg hover:scale-[1.01] animate-fade-in",children:m.jsx(YC,{data:e})})}function HC(e){return`
SELECT
  DAYOFWEEK(ts::DATE)::INTEGER AS dayOfWeek,
  HOUR(ts::DATETIME)::INTEGER AS hour,
  COUNT(*)::DOUBLE AS count_streams
FROM ${q}
${e?`WHERE YEAR(ts:: DATETIME) = ${e}`:""}
GROUP BY DAYOFWEEK(ts::DATE), HOUR(ts::DATETIME)
ORDER BY 1, 2
`}function qC(e,t=!1){const n=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];return mn({title:"Stream per hour and day of week",width:800,height:400,marginLeft:70,marginBottom:50,x:{label:"Time of day ",domain:[...Array(24).keys()],tickFormat:r=>`${r}h`},y:{label:"Day of week ",domain:[1,2,3,4,5,6,0],tickFormat:r=>n[r],reverse:!1},color:{type:"linear",label:"Number of streams",scheme:t?"warm":"cool"},marks:[WF(e,{x:"hour",y:"dayOfWeek",fill:"count_streams",tip:{format:{x:r=>`${r}h`,y:r=>n[r-1],fill:r=>`${r} streams`}}}),Wx([...Array(24).keys()],{stroke:"#fff",strokeOpacity:.2}),U0([0,1,2,3,4,5,6],{stroke:"#fff",strokeOpacity:.2})]})}function GC({year:e}){const t=P.useCallback((n,r)=>qC(n,r),[]);return m.jsx(Ps,{query:HC(e),buildPlot:t})}const XC=1e3,Ky=20;function KC(){const[e,t]=P.useState("SELECT 42 AS answer;\n-- tips: use `show tables` to show tables"),[n,r]=P.useState(),[i,s]=P.useState(),[a,o]=P.useState(!1),[c,l]=P.useState([]),u=P.useCallback(async()=>{o(!0),s(void 0);try{const{conn:f}=await Qa(),d=await f.query(e);if(!d)throw new Error("No result.");r({columns:d.schema.fields.map(h=>h.name),rows:d.toArray().map(h=>Object.values(h).map(String)).slice(0,XC),totalRows:d.numRows}),l(h=>[e,...h.filter(p=>p!==e).slice(0,Ky-1)])}catch(f){r(void 0),s(f instanceof Error?f.message:"Unknown error")}finally{o(!1)}},[e]);return m.jsxs("div",{className:"group p-6 my-4 bg-white dark:bg-slate-900/80 backdrop-blur-md rounded-2xl border border-gray-300/60 dark:border-slate-700/50 text-gray-900 dark:text-gray-100",children:[m.jsx("h3",{className:"text-lg font-semibold mb-3 flex items-center gap-2",children:" DuckDB Shell"}),m.jsxs("form",{onSubmit:f=>{f.preventDefault(),u()},children:[m.jsx("textarea",{value:e,placeholder:"Write your SQL query here",onChange:f=>t(f.target.value),rows:4,className:"bg-gray-200 dark:bg-slate-700/50 rounded-lg text-sm font-mono w-full"}),m.jsx("div",{className:"grid grid-cols-3",children:m.jsx("button",{type:"submit",disabled:a,className:"col-start-2 mt-2 bg-brand-purple rounded-lg text-gray-100 px-4 py-2",children:"Run query"})})]}),a&&m.jsx("p",{className:"mt-2 italic font-mono",children:"Run in progress"}),i&&m.jsxs("div",{className:"mt-4 rounded border border-red-600 bg-red-100 p-2 font-mono text-red-900",children:["SQL Error: ",i]}),n&&m.jsxs("section",{className:"mt-4",children:[m.jsxs("p",{className:"mb-2 text-sm",children:[n.rows.length," / ",n.totalRows," rows displayed"]}),m.jsx("div",{className:"max-h-[400px] overflow-auto rounded border border-gray-600 font-mono",children:m.jsxs("table",{className:"min-w-full border-collapse",children:[m.jsx("thead",{className:"sticky top-0 bg-gray-100 dark:bg-slate-800",children:m.jsx("tr",{children:n.columns.map(f=>m.jsx("th",{className:"border border-gray-600 px-2 py-1 text-left text-sm font-semibold",children:f},f))})}),m.jsx("tbody",{children:n.rows.map((f,d)=>m.jsx("tr",{className:"odd:bg-gray-50 dark:odd:bg-slate-800/50",children:f.map((h,p)=>m.jsx("td",{className:"whitespace-nowrap border border-gray-600 px-2 py-1 text-sm",children:h},p))},d))})]})})]}),c.length>0&&m.jsxs("div",{className:"mt-4 border-t pt-2",children:[m.jsxs("h4",{className:"mb-2",children:["Query history (max ",Ky,")"]}),m.jsx("ul",{className:"font-mono text-sm",children:c.map((f,d)=>m.jsx("li",{children:m.jsx("button",{onClick:()=>t(f),children:f.length>80?f.slice(0,80)+"":f})},d))})]})]})}function QC(){const[e,t]=P.useState(2006),[n,r]=P.useState();return P.useEffect(()=>{(async()=>{const s=await Wt(qS);r(s[0]||void 0)})()},[]),P.useEffect(()=>{n&&t(new Date(Number(n.max_datetime)).getFullYear())},[n]),m.jsxs(m.Fragment,{children:[m.jsxs("div",{className:"flex flex-col md:flex-row gap-4 items-stretch",children:[m.jsx(vC,{}),m.jsx(AC,{}),m.jsx(OC,{})]}),n&&m.jsxs(m.Fragment,{children:[m.jsx(HS,{value:e,onChange:t,min:new Date(Number(n.min_datetime)).getFullYear(),max:new Date(Number(n.max_datetime)).getFullYear(),step:1}),m.jsx(pC,{year:e,maxValue:n.max_monthly_duration}),m.jsx(gC,{year:e,maxValue:Number(n.max_count_hourly_stream)}),m.jsx(EC,{year:e}),m.jsx(LC,{year:e}),m.jsx(CC,{year:e})]}),m.jsxs("section",{className:"p-6 mt-12 border rounded-2xl border border-gray-300/60 dark:border-slate-700/50 shadow-lg",children:[m.jsxs("div",{className:"relative mb-12",children:[m.jsx("div",{className:"border-t border-gray-300"}),m.jsx("span",{className:"absolute left-1/2 -translate-x-1/2 -top-3 bg-white px-3 py-1 text-sm font-medium rounded-full border",children:" Work in Progress"})]}),m.jsx("p",{className:"mb-4 text-gray-900 dark:text-gray-100",children:"Experimental section: the graphs below are currently under development and may contain errors."}),m.jsx(VC,{}),m.jsx(WC,{}),m.jsx(GC,{year:e})]}),m.jsx(KC,{})]})}function JC(e){return`
    WITH artist_streams AS (
      SELECT
        master_metadata_album_artist_name AS artist,
        COUNT(*) AS stream_count
      FROM ${q}
      WHERE master_metadata_album_artist_name IS NOT NULL
      AND YEAR(ts::DATE) = ${e}
      GROUP BY master_metadata_album_artist_name
    ),
    ranked_artists AS (
      SELECT
        artist,
        stream_count,
        ROW_NUMBER() OVER (ORDER BY stream_count DESC) AS rank
      FROM artist_streams
    ),
    total_streams AS (
      SELECT COUNT(*) AS total FROM ${q} WHERE YEAR(ts::DATE) = ${e}
    )
    SELECT
      COALESCE((SELECT SUM(stream_count) FROM ranked_artists WHERE rank <= 5)::DOUBLE / (SELECT total FROM total_streams)::DOUBLE * 100, 0) AS top5_pct,
      COALESCE((SELECT SUM(stream_count) FROM ranked_artists WHERE rank <= 10)::DOUBLE / (SELECT total FROM total_streams)::DOUBLE * 100, 0) AS top10_pct,
      COALESCE((SELECT SUM(stream_count) FROM ranked_artists WHERE rank <= 20)::DOUBLE / (SELECT total FROM total_streams)::DOUBLE * 100, 0) AS top20_pct
  `}const ZC=({data:e})=>{const{top5_pct:t,top10_pct:n,top20_pct:r}=e,i=s=>m.jsx("div",{className:"w-full bg-gray-200 dark:bg-slate-700/50 rounded-full h-3 mb-1 overflow-hidden",children:m.jsx("div",{className:"bg-brand-blue h-3 rounded",style:{width:`${Math.min(Math.max(s,0),100)}%`}})});return m.jsxs("div",{className:"group p-6 bg-white dark:bg-slate-900/80 backdrop-blur-md rounded-2xl border border-gray-300/60 dark:border-slate-700/50 text-gray-900 dark:text-gray-100 transition-all duration-300 hover:shadow-glass-lg hover:scale-[1.01] animate-fade-in",children:[m.jsx("h3",{className:"text-lg font-semibold mb-3 flex items-center gap-2",children:" Concentration Score"}),m.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400 mb-4",children:"Share of listening time for your top artists"}),m.jsxs("ul",{className:"space-y-3",role:"list",children:[m.jsxs("li",{role:"listitem",children:[m.jsxs("div",{className:"flex justify-between text-xs font-medium mb-1.5",children:[m.jsx("span",{children:"Top 5"}),m.jsxs("span",{className:"text-brand-blue",children:[t.toFixed(1),"%"]})]}),i(t)]}),m.jsxs("li",{role:"listitem",children:[m.jsxs("div",{className:"flex justify-between text-xs font-medium mb-1.5",children:[m.jsx("span",{children:"Top 10"}),m.jsxs("span",{className:"text-brand-blue",children:[n.toFixed(1),"%"]})]}),i(n)]}),m.jsxs("li",{role:"listitem",children:[m.jsxs("div",{className:"flex justify-between text-xs font-medium mb-1.5",children:[m.jsx("span",{children:"Top 20"}),m.jsxs("span",{className:"text-brand-blue",children:[r.toFixed(1),"%"]})]}),i(r)]})]})]})};function tB({year:e}){const[t,n]=P.useState(null);return P.useEffect(()=>{(async()=>{const i=JC(e),s=await Wt(i);s&&s.length>0&&n(s[0])})()},[e]),t?m.jsx(ZC,{data:t}):null}function eB(e){return`
  SELECT
    SUM(CASE WHEN HOUR(ts:: TIMESTAMP) >= 6 AND HOUR(ts:: TIMESTAMP) < 12 THEN 1 ELSE 0 END)::DOUBLE AS morning,
    SUM(CASE WHEN HOUR(ts:: TIMESTAMP) >= 12 AND HOUR(ts:: TIMESTAMP) < 18 THEN 1 ELSE 0 END)::DOUBLE AS afternoon,
    SUM(CASE WHEN HOUR(ts:: TIMESTAMP) >= 18 AND HOUR(ts:: TIMESTAMP) < 22 THEN 1 ELSE 0 END)::DOUBLE AS evening,
    SUM(CASE WHEN HOUR(ts:: TIMESTAMP) >= 22 OR HOUR(ts:: TIMESTAMP) < 6 THEN 1 ELSE 0 END)::DOUBLE AS night,
    COUNT(*)::DOUBLE AS total
  FROM ${q}
  WHERE YEAR(ts::DATE) = ${e}
  `}const nB=({data:e})=>{const{morning:t,afternoon:n,evening:r,night:i,total:s}=e,a=c=>s?c/s*100:0,o=c=>m.jsx("div",{className:"w-full bg-gray-200 dark:bg-slate-700/50 rounded-full h-2 mb-1 overflow-hidden",children:m.jsx("div",{className:"bg-brand-purple h-2 rounded-full",style:{width:`${Math.min(Math.max(c,0),100)}%`}})});return m.jsxs("div",{className:"group p-6 bg-white dark:bg-slate-900/80 backdrop-blur-md rounded-2xl border border-gray-300/60 dark:border-slate-700/50 text-gray-900 dark:text-gray-100 transition-all duration-300 hover:shadow-glass-lg hover:scale-[1.01] animate-fade-in",children:[m.jsx("h3",{className:"text-lg font-semibold mb-3 flex items-center gap-2",children:" Listening Rhythm"}),m.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400 mb-4",children:"Share of listening time per time of day"}),m.jsxs("ul",{className:"space-y-2",role:"list",children:[m.jsxs("li",{role:"listitem",children:[m.jsxs("div",{className:"flex justify-between text-xs font-medium mb-1.5",children:[m.jsx("span",{children:"Morning (611h)"}),m.jsxs("span",{className:"text-brand-purple",children:[a(t).toFixed(1),"%"]})]}),o(a(t))]}),m.jsxs("li",{role:"listitem",children:[m.jsxs("div",{className:"flex justify-between text-xs font-medium mb-1.5",children:[m.jsx("span",{children:"Afternoon (1217h)"}),m.jsxs("span",{className:"text-brand-purple",children:[a(n).toFixed(1),"%"]})]}),o(a(n))]}),m.jsxs("li",{role:"listitem",children:[m.jsxs("div",{className:"flex justify-between text-xs font-medium mb-1.5",children:[m.jsx("span",{children:"Evening (1821h)"}),m.jsxs("span",{className:"text-brand-purple",children:[a(r).toFixed(1),"%"]})]}),o(a(r))]}),m.jsxs("li",{role:"listitem",children:[m.jsxs("div",{className:"flex justify-between text-xs font-medium mb-1.5",children:[m.jsx("span",{children:"Night (225h)"}),m.jsxs("span",{className:"text-brand-purple",children:[a(i).toFixed(1),"%"]})]}),o(a(i))]})]})]})};function rB({year:e}){const[t,n]=P.useState(null);return P.useEffect(()=>{(async()=>{const i=eB(e),s=await Wt(i);s&&s.length>0&&n(s[0])})()},[e]),t?m.jsx(nB,{data:t}):null}function iB(e){return`
    WITH
    max_date AS (
      SELECT MIN(ts) AS max_date
      FROM (
        SELECT MAX(ts::DATE) as ts FROM ${q}
        UNION
        (SELECT '${e}-12-31'::DATE as ts)
      )
    ),
    selected_tracks AS (
      SELECT * FROM ${q}
      WHERE YEAR(ts::DATE) = ${e}
    ),
    date_range AS (
      SELECT 
        COUNT(*) AS total_days
      FROM generate_series('${e}-01-01'::DATE, (SELECT max_date FROM max_date), INTERVAL 1 DAY) AS t(d)
    ),
    listening_days_count AS (
      SELECT COUNT(DISTINCT ts::DATE) AS days_with_streams
      FROM selected_tracks
    ),
    listening_days AS (
      (SELECT DISTINCT ts::DATE AS day FROM selected_tracks)
      UNION
      (select '${e}-01-01'::DATE - 1 as day)
      UNION
      (select max_date + 1 as day from max_date)
    ),
    gaps AS (
      SELECT DATE_DIFF('day', LAG(day) OVER (ORDER BY day), day) -1 AS gap
      FROM listening_days
    ),
    max_gap AS (
      SELECT MAX(gap) AS longest_pause_days
      FROM gaps
    )
    SELECT 
      days_with_streams::DOUBLE as days_with_streams,
      total_days::DOUBLE as total_days,
      COALESCE(longest_pause_days, 0)::DOUBLE AS longest_pause_days
    FROM listening_days_count, date_range, max_gap;
  `}function sB(e){return e>=70?{label:"Constant",color:"text-green-600 dark:text-green-400",strokeColor:"stroke-green-500",emoji:""}:e>=30?{label:"Regular",color:"text-yellow-600 dark:text-yellow-400",strokeColor:"stroke-yellow-500",emoji:""}:{label:"Occasional",color:"text-gray-600 dark:text-gray-400",strokeColor:"stroke-gray-500",emoji:""}}const aB=({data:e})=>{const{days_with_streams:t,total_days:n,longest_pause_days:r}=e,i=t/n*100,{label:s,color:a,strokeColor:o,emoji:c}=sB(i),l=120,u=10,f=(l-u)/2,d=2*Math.PI*f,h=d-i/100*d;return m.jsxs("div",{className:"group p-6 bg-white dark:bg-slate-900/80 backdrop-blur-md rounded-2xl border border-gray-300/60 dark:border-slate-700/50 text-gray-900 dark:text-gray-100 transition-all duration-300 hover:shadow-glass-lg hover:scale-[1.01] animate-fade-in flex flex-col h-full relative",children:[m.jsx("h3",{className:"text-lg font-semibold mb-3 flex items-center gap-2",children:" Listening Regularity"}),m.jsx("div",{className:`text-2xl font-bold ${a}`,children:s}),m.jsxs("div",{className:"text-sm text-gray-600 dark:text-gray-400 mb-4",children:[m.jsx("span",{className:"font-bold text-gray-900 dark:text-gray-100 text-base",children:t})," ","/ ",n," days"]}),m.jsx("div",{className:"flex-1 flex items-center justify-center mb-4",children:m.jsxs("div",{className:"relative",children:[m.jsxs("svg",{width:l,height:l,className:"transform -rotate-90",children:[m.jsx("circle",{cx:l/2,cy:l/2,r:f,fill:"none",stroke:"currentColor",strokeWidth:u,className:"text-gray-200 dark:text-gray-700"}),m.jsx("circle",{cx:l/2,cy:l/2,r:f,fill:"none",strokeWidth:u,strokeDasharray:d,strokeDashoffset:h,strokeLinecap:"round",className:`${o} transition-all duration-500`})]}),m.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center",children:[m.jsx("div",{className:"text-2xl mb-1",children:c}),m.jsxs("div",{className:`text-xl font-bold ${a}`,children:[i.toFixed(0),"%"]})]})]})}),m.jsxs("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:["Longest pause:"," ",m.jsxs("span",{className:"font-medium text-gray-700 dark:text-gray-300",children:[r,"d"]})]})]})};function oB({year:e}){const[t,n]=P.useState(null);return P.useEffect(()=>{(async()=>{const i=iB(e),s=await Wt(i);s&&s.length>0&&n(s[0])})()},[e]),t?m.jsx(aB,{data:t}):null}function cB(e){return`
    SELECT
      SUM(CASE WHEN MONTH(ts::DATE) IN (12, 1, 2) THEN 1 ELSE 0 END)::DOUBLE AS winter,
      SUM(CASE WHEN MONTH(ts::DATE) IN (3, 4, 5) THEN 1 ELSE 0 END)::DOUBLE AS spring,
      SUM(CASE WHEN MONTH(ts::DATE) IN (6, 7, 8) THEN 1 ELSE 0 END)::DOUBLE AS summer,
      SUM(CASE WHEN MONTH(ts::DATE) IN (9, 10, 11) THEN 1 ELSE 0 END)::DOUBLE AS fall,
      COUNT(*)::DOUBLE AS total
    FROM ${q}
    WHERE YEAR(ts::DATE) = ${e}
  `}const lB=({data:e})=>{const{winter:t,spring:n,summer:r,fall:i,total:s}=e,a=l=>s?l/s*100:0,o=[{name:"Winter ",value:t,color:"bg-blue-400"},{name:"Spring ",value:n,color:"bg-green-400"},{name:"Summer ",value:r,color:"bg-yellow-400"},{name:"Fall ",value:i,color:"bg-orange-400"}],c=o.reduce((l,u)=>l.value>u.value?l:u);return m.jsxs("div",{className:"group p-6 bg-white dark:bg-slate-900/80 backdrop-blur-md rounded-2xl border border-gray-300/60 dark:border-slate-700/50 text-gray-900 dark:text-gray-100 transition-all duration-300 hover:shadow-glass-lg hover:scale-[1.01] animate-fade-in",children:[m.jsx("h3",{className:"text-lg font-semibold mb-3 flex items-center gap-2",children:" Seasonal patterns"}),m.jsxs("div",{className:"text-sm text-gray-600 dark:text-gray-400 mb-4",children:["Your favorite season:"," ",m.jsx("span",{className:"font-medium text-gray-900 dark:text-gray-100",children:c.name.split(" ")[0]})]}),m.jsx("ul",{className:"space-y-3",role:"list",children:o.map(l=>m.jsxs("li",{role:"listitem",children:[m.jsxs("div",{className:"flex justify-between text-xs mb-1",children:[m.jsx("span",{children:l.name}),m.jsxs("span",{children:[a(l.value).toFixed(1),"%"]})]}),m.jsx("div",{className:"w-full bg-gray-200 dark:bg-slate-700/50 rounded-full h-2",children:m.jsx("div",{className:`${l.color} h-2 rounded-full`,style:{width:`${a(l.value)}%`}})})]},l.name))})]})};function uB({year:e}){const[t,n]=P.useState(null);return P.useEffect(()=>{(async()=>{const i=cB(e),s=await Wt(i);s&&s.length>0&&n(s[0])})()},[e]),t?m.jsx(lB,{data:t}):null}function fB(){return`
    SELECT
      YEAR(ts::DATE)::INTEGER as year,
      COUNT(*)::DOUBLE as streams,
      SUM(ms_played)::DOUBLE as ms_played
    FROM ${q}
    GROUP BY YEAR(ts::DATE)
    ORDER BY YEAR(ts::DATE)
  `}const dB=({data:e,year:t})=>{if(e.length===0)return null;const n=Math.max(...e.map(a=>a.streams)),r=e.find(a=>a.year===t),i=e.reduce((a,o)=>a+o.streams,0),s=Math.min(...e.map(a=>a.year));return m.jsxs("div",{className:"group p-6 bg-white dark:bg-slate-900/80 backdrop-blur-md rounded-2xl border border-gray-300/60 dark:border-slate-700/50 text-gray-900 dark:text-gray-100 transition-all duration-300 hover:shadow-glass-lg hover:scale-[1.01] animate-fade-in flex flex-col justify-between h-full",children:[m.jsx("h3",{className:"text-lg font-semibold mb-3 flex items-center gap-2",children:" Evolution"}),m.jsx("div",{className:"flex items-end gap-1 h-24 mt-4 mb-2",children:e.map(a=>{const o=a.streams/n*100;return m.jsxs("div",{className:"flex-1 bg-brand-blue dark:bg-brand-blue rounded-t relative group",style:{height:`${o}%`},children:[m.jsx("div",{className:`absolute bottom-0 left-0 right-0 bg-brand-blue rounded-t transition-all duration-300 ${a.year===t?"bg-brand-purple":""}`,style:{height:"100%"}}),m.jsxs("div",{className:"opacity-0 group-hover:opacity-100 absolute bottom-full left-1/2 -translate-x-1/2 mb-1 bg-black text-white text-xs px-2 py-1 rounded pointer-events-none whitespace-nowrap z-10",children:[a.year,m.jsx("br",{})," ",a.streams.toLocaleString()," streams",m.jsx("br",{})," (",Yr(a.ms_played),")"]})]},a.year)})}),m.jsxs("div",{className:"flex justify-between text-xs text-gray-600 dark:text-gray-400 px-1",children:[m.jsx("span",{children:s}),m.jsx("span",{children:Math.max(...e.map(a=>a.year))})]}),m.jsxs("ul",{className:"mt-4 pt-4 border-t border-gray-100 dark:border-gray-700",role:"list",children:[m.jsxs("li",{className:"flex justify-between items-center",role:"listitem",children:[m.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Total streams"}),m.jsx("span",{className:"font-bold",children:i.toLocaleString()})]}),r&&m.jsxs("li",{className:"flex justify-between items-center mt-1",role:"listitem",children:[m.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"This year"}),m.jsx("span",{className:"font-bold text-brand-purple dark:text-brand-purple",children:r.streams.toLocaleString()})]})]})]})};function hB({year:e}){const[t,n]=P.useState([]);return P.useEffect(()=>{(async()=>{const i=fB(),s=await Wt(i);n(s)})()},[e]),t.length===0?null:m.jsx(dB,{data:t,year:e})}function pB(e){return`
    WITH artist_first_listen AS (
      SELECT
        master_metadata_album_artist_name,
        MIN(YEAR(ts::DATE)) AS first_year
      FROM ${q}
      WHERE master_metadata_album_artist_name IS NOT NULL
      GROUP BY master_metadata_album_artist_name
    ),
    streams_classified AS (
      SELECT
        master_metadata_album_artist_name AS artist,
        CASE 
          WHEN first_year = ${e} THEN 'new'
          ELSE 'old'
        END AS category
      FROM ${q}
      JOIN artist_first_listen USING(master_metadata_album_artist_name)
      WHERE YEAR(ts::DATE) = ${e}
        AND master_metadata_album_artist_name IS NOT NULL
    )
    SELECT
      COUNT(*) FILTER (WHERE category = 'new')::DOUBLE AS new_artists_streams,
      COUNT(*) FILTER (WHERE category = 'old')::DOUBLE AS old_artists_streams,
      COUNT(DISTINCT CASE WHEN category = 'new' THEN artist END)::DOUBLE AS new_artists_count,
      COUNT(*)::DOUBLE AS total
    FROM streams_classified
  `}const mB=({data:e})=>{const{new_artists_streams:t,old_artists_streams:n,new_artists_count:r,total:i}=e,s=i?t/i*100:0,a=i?n/i*100:0;return m.jsxs("div",{className:"group p-6 bg-white dark:bg-slate-900/80 backdrop-blur-md rounded-2xl border border-gray-300/60 dark:border-slate-700/50 text-gray-900 dark:text-gray-100 transition-all duration-300 hover:shadow-glass-lg hover:scale-[1.01] animate-fade-in",children:[m.jsx("h3",{className:"text-lg font-semibold mb-3 flex items-center gap-2",children:" New vs Old"}),m.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400 mb-4",children:"Streams this year"}),m.jsx("div",{className:"flex items-center gap-4 mb-4 text-xs text-gray-600 dark:text-gray-400",children:m.jsxs("div",{role:"list",className:"flex-1 text-center contents",children:[m.jsxs("div",{role:"listitem",className:"flex-1 text-center",children:[m.jsxs("div",{className:"text-2xl font-bold text-brand-purple",children:[s.toFixed(0),"%"]}),m.jsx("div",{children:"Dcouvertes"})]}),m.jsx("div",{className:"text-2xl",role:"separator",children:"|"}),m.jsxs("div",{role:"listitem",className:"flex-1 text-center",children:[m.jsxs("div",{className:"text-2xl font-bold text-brand-blue",children:[a.toFixed(0),"%"]}),m.jsx("div",{children:"Favorites"})]})]})}),m.jsxs("div",{className:"w-full bg-gray-200 dark:bg-slate-700/50 rounded-full h-3 mb-1 overflow-hidden flex",children:[m.jsx("div",{className:"bg-brand-purple h-full",style:{width:`${s}%`}}),m.jsx("div",{className:"bg-brand-blue h-full",style:{width:`${a}%`}})]}),m.jsxs("div",{className:"mt-4 text-xs text-center text-gray-600 dark:text-gray-400",children:[m.jsx("span",{className:"font-medium text-gray-900 dark:text-gray-100",children:r.toLocaleString()})," ","new artists discovered this year! "]})]})};function yB({year:e}){const[t,n]=P.useState(null);return P.useEffect(()=>{(async()=>{const i=pB(e),s=await Wt(i);s&&s.length>0&&n(s[0])})()},[e]),t?m.jsx(mB,{data:t}):null}function gB(e){return`
  SELECT
    COUNT(*) FILTER (WHERE reason_end = 'trackdone')::DOUBLE AS complete_listens,
    COUNT(*) FILTER (WHERE reason_end IN ('fwdbtn', 'click-row', 'clickrow'))::DOUBLE AS skipped_listens
  FROM ${q}
  WHERE YEAR(ts::DATE) = ${e}
  `}function bB(e){return e<50?{classification:"Impatient",emoji:"",message:"You skip often!"}:e>75?{classification:"Patient",emoji:"",message:"You savor every note!"}:{classification:"Normal",emoji:"",message:"You have an equilibrated listening."}}const _B=({data:e})=>{const{complete_listens:t,skipped_listens:n}=e,r=t/(t+n)*100,{classification:i,emoji:s,message:a}=bB(r);return m.jsxs("div",{className:"group p-6 bg-white dark:bg-slate-900/80 backdrop-blur-md rounded-2xl border border-gray-300/60 dark:border-slate-700/50 text-gray-900 dark:text-gray-100 transition-all duration-300 hover:shadow-glass-lg hover:scale-[1.01] animate-fade-in",children:[m.jsx("h3",{className:"text-lg font-semibold mb-3 flex items-center gap-2",children:" Listening Patience"}),m.jsxs("div",{className:"flex items-center justify-between mb-4",children:[m.jsxs("div",{children:[m.jsxs("div",{className:"text-2xl font-bold",children:[r.toFixed(1),"%"]}),m.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Full listens"})]}),m.jsx("div",{className:"text-4xl",children:s})]}),m.jsx("div",{className:"w-full bg-gray-200 dark:bg-slate-700/50 rounded-full h-3 overflow-hidden mb-2",children:m.jsx("div",{className:"bg-green-500 h-full transition-all duration-300",style:{width:`${r}%`}})}),m.jsxs("ul",{className:"flex justify-between text-xs text-gray-600 dark:text-gray-400 mb-3",role:"list",children:[m.jsxs("li",{role:"listitem",children:["Skippped (",n.toLocaleString(),")"]}),m.jsxs("li",{role:"listitem",children:["Completed (",t.toLocaleString(),")"]})]}),m.jsxs("div",{className:"text-sm text-center font-medium text-gray-800 dark:text-gray-200 bg-gray-200 dark:bg-slate-700/50 p-2 rounded-lg",children:[i," : ",a]})]})};function wB({year:e}){const[t,n]=P.useState(null);return P.useEffect(()=>{(async()=>{const i=gB(e),s=await Wt(i);s&&s.length>0&&n(s[0])})()},[e]),t?m.jsx(_B,{data:t}):null}function vB(e){return`
    WITH ordered_streams AS (
      SELECT
        track_uri,
        master_metadata_track_name,
        ts,
        LAG(track_uri) OVER (ORDER BY ts) AS prev_track
      FROM ${q}
      WHERE track_uri IS NOT NULL
      AND YEAR(ts::DATE) = ${e}
    ),
    repeat_groups AS (
      SELECT
        track_uri,
        master_metadata_track_name,
        ts,
        CASE WHEN track_uri = prev_track THEN 0 ELSE 1 END AS is_new_group
      FROM ordered_streams
    ),
    group_ids AS (
      SELECT
        *,
        SUM(is_new_group) OVER (ORDER BY ts) AS group_id
      FROM repeat_groups
    ),
    group_sizes AS (
      SELECT
        group_id,
        track_uri,
        master_metadata_track_name,
        COUNT(*) AS repeat_count
      FROM group_ids
      GROUP BY group_id, track_uri, master_metadata_track_name
      HAVING COUNT(*) > 1
    )
    SELECT
      COUNT(*)::DOUBLE AS total_repeat_sequences,
      COALESCE(MAX(repeat_count)::DOUBLE, 0) AS max_consecutive,
      COALESCE((SELECT master_metadata_track_name FROM group_sizes ORDER BY repeat_count DESC LIMIT 1), '') AS most_repeated_track,
      COALESCE(AVG(repeat_count)::DOUBLE, 0) AS avg_repeat_length
    FROM group_sizes
  `}function xB(e){return e>50?{classification:"Obsessive",emoji:""}:e<10?{classification:"Variated",emoji:""}:{classification:"Moderate",emoji:""}}const SB=({data:e})=>{const{total_repeat_sequences:t,max_consecutive:n,most_repeated_track:r,avg_repeat_length:i}=e,{classification:s,emoji:a}=xB(t);if(t!==0)return m.jsxs("div",{className:"group p-6 bg-white dark:bg-slate-900/80 backdrop-blur-md rounded-2xl border border-gray-300/60 dark:border-slate-700/50 text-gray-900 dark:text-gray-100 transition-all duration-300 hover:shadow-glass-lg hover:scale-[1.01] animate-fade-in",children:[m.jsx("h3",{className:"text-lg font-semibold mb-3 flex items-center gap-2",children:" Repeat Behavior"}),m.jsxs("div",{className:"flex items-center justify-between mb-4",children:[m.jsxs("div",{children:[m.jsx("div",{className:"text-2xl font-bold",children:s}),m.jsx("div",{className:"text-xs text-gray-600 dark:text-gray-400",children:"Your style"})]}),m.jsx("div",{className:"text-4xl",children:a})]}),m.jsxs("div",{className:"space-y-3",children:[m.jsxs("div",{className:"bg-gray-200 dark:bg-slate-700/50 p-3 rounded-lg",children:[m.jsx("div",{className:"text-xs text-gray-600 dark:text-gray-400 mb-1",children:"Repeat Record"}),m.jsxs("div",{className:"font-medium text-brand-purple dark:text-brand-purple line-clamp-1",children:['"',r,'"']}),m.jsxs("div",{className:"text-sm font-bold mt-1",children:[n," times in a row "]})]}),m.jsxs("ul",{className:"mb-1",role:"list",children:[m.jsxs("li",{className:"flex justify-between items-center text-sm",role:"listitem",children:[m.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Repeated sequences"}),m.jsx("span",{className:"font-bold",children:t})]}),m.jsxs("li",{className:"flex justify-between items-center text-sm",role:"listitem",children:[m.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Repeat average"}),m.jsxs("span",{className:"font-bold",children:[i.toFixed(1)," times"]})]})]})]})]})};function EB({year:e}){const[t,n]=P.useState(void 0);return P.useEffect(()=>{(async()=>{const i=vB(e),s=await Wt(i);s&&s.length>0&&n(s[0])})()},[e]),t?m.jsx(SB,{data:t}):null}function TB(){return`
    SELECT
      'morning_favorite' as factType,
      master_metadata_album_artist_name as mainText,
      COUNT(*) as value,
      'streams' as unit,
      'between 6am and 12pm' as context
    FROM ${q}
    WHERE
      (HOUR(ts::DATETIME) >= 6 AND HOUR(ts::DATETIME) < 12)
      AND master_metadata_album_artist_name IS NOT NULL
    GROUP BY master_metadata_album_artist_name
    ORDER BY value DESC
    LIMIT 1
    `}function AB(){return`
    SELECT
      'afternoon_favorite' as factType,
      master_metadata_album_artist_name as mainText,
      COUNT(*) as value,
      'streams' as unit,
      'between 12pm and 6pm' as context
    FROM ${q}
    WHERE
      (HOUR(ts::DATETIME) >= 12 AND HOUR(ts::DATETIME) < 18)
      AND master_metadata_album_artist_name IS NOT NULL
    GROUP BY master_metadata_album_artist_name
    ORDER BY value DESC
    LIMIT 1
  `}function IB(){return`
    SELECT
      'evening_favorite' as factType,
      master_metadata_album_artist_name as mainText,
      COUNT(*) as value,
      'streams' as unit,
      'between 6pm and 0am' as context
    FROM ${q}
    WHERE
      (HOUR(ts::DATETIME) >= 18 AND HOUR(ts::DATETIME) < 24)
      AND master_metadata_album_artist_name IS NOT NULL
    GROUP BY master_metadata_album_artist_name
    ORDER BY value DESC
    LIMIT 1
  `}function NB(){return`
    SELECT
      'night_favorite' as factType,
      master_metadata_album_artist_name as mainText,
      COUNT(*) as value,
      'streams' as unit,
      'between 0am and 6am' as context
    FROM ${q}
    WHERE
      (HOUR(ts::DATETIME) >= 24 OR HOUR(ts::DATETIME) < 6)
      AND master_metadata_album_artist_name IS NOT NULL
    GROUP BY master_metadata_album_artist_name
    ORDER BY value DESC
    LIMIT 1
  `}function MB(){return`
    SELECT
      'weekend_favorite' as factType,
      master_metadata_album_artist_name as mainText,
      COUNT(*) as value,
      'streams' as unit,
      'during the weekend' as context
    FROM ${q}
    WHERE
      (DAYOFWEEK(ts::DATE) IN (0, 6)
      OR (DAYOFWEEK(ts::DATE) IN (5, 6) AND HOUR(ts::DATETIME) >= 18))
      AND master_metadata_album_artist_name IS NOT NULL
    GROUP BY master_metadata_album_artist_name
    ORDER BY value DESC
    LIMIT 1
  `}function OB(){return`
    WITH
    recent_date AS (
      SELECT MAX(ts::DATE) as max_date FROM ${q}
    ),
    recent_artists AS (
      SELECT
        master_metadata_album_artist_name as artist,
        MIN(ts::DATE) as last_listen
      FROM ${q}, recent_date
      WHERE
        ts::DATE >= max_date - INTERVAL 90 DAY
        AND master_metadata_album_artist_name IS NOT NULL
      GROUP BY master_metadata_album_artist_name
    ),
    threshold AS (
      SELECT
        approx_quantile(total_streams, 0.5) AS limit_streams
      FROM (
        SELECT COUNT(*) AS total_streams FROM ${q}
        GROUP BY master_metadata_album_artist_name
      )
    ),
    previous_listens AS (
      SELECT
        master_metadata_album_artist_name as artist,
        MAX(ts::DATE) as previous_listen
      FROM ${q}, recent_date
      WHERE
        master_metadata_album_artist_name IS NOT NULL
        AND ts::DATE < max_date - INTERVAL 90 DAY
        AND master_metadata_album_artist_name IN (SELECT artist FROM recent_artists)
      GROUP BY master_metadata_album_artist_name
      HAVING COUNT(*) > (SELECT limit_streams FROM threshold)
    ),
    artist_gaps AS (
      SELECT
        artist,
        last_listen,
        previous_listen,
        DATE_DIFF('day', previous_listen, last_listen) as gap
      FROM recent_artists
      JOIN previous_listens USING (artist)
      ORDER BY gap DESC
      LIMIT 20
    )
    SELECT
      'nostalgic_return' as factType,
      artist as mainText,
      gap::INTEGER as value,
      'days' as unit,
      'days since last listen (' || previous_listen || ' - ' || last_listen || ')' as context
    FROM artist_gaps
    USING SAMPLE 1
  `}function RB(){return`
    WITH
    recent_date AS (
      SELECT MAX(ts::DATE) AS max_date
      FROM ${q}
    ),
    recent_artists AS (
      SELECT DISTINCT master_metadata_album_artist_name AS artist
      FROM ${q}, recent_date
      WHERE master_metadata_album_artist_name IS NOT NULL
        AND ts::DATE >= max_date - INTERVAL 90 DAY
    ),
    forgotten AS (
      SELECT
        master_metadata_album_artist_name AS artist,
        ts::DATE AS listen_date
      FROM ${q}, recent_date
      WHERE master_metadata_album_artist_name IS NOT NULL
        AND ts::DATE < max_date - INTERVAL 90 DAY
        AND master_metadata_album_artist_name NOT IN (SELECT artist FROM recent_artists)
    ),
    counts AS (
      SELECT artist, COUNT(*) AS total_streams
      FROM forgotten
      GROUP BY artist
    ),
    threshold AS (
      SELECT approx_quantile(total_streams, 0.995) AS limit_streams
      FROM counts
    ),
    artist_stats AS (
      SELECT
        artist,
        COUNT(*) AS total_streams,
        MAX(listen_date) AS last_listen
      FROM forgotten
      GROUP BY artist
      HAVING COUNT(*) >= (SELECT limit_streams FROM threshold)
      ORDER BY MAX(listen_date)
      LIMIT 20
    )
    SELECT
      'forgotten_artist' AS factType,
      artist AS mainText,
      DATE_DIFF('day', last_listen, (SELECT max_date FROM recent_date))::INTEGER AS value,
      'days' AS unit,
      'without listening to artist with more than ' || (select limit_streams from threshold) || ' streams' AS context
    FROM artist_stats
    USING SAMPLE 1
  `}function DB(){return`
    WITH
    threshold AS (
      SELECT approx_quantile(total_streams, 0.995) AS limit_streams
      FROM (
        SELECT COUNT(*) AS total_streams FROM ${q}
        GROUP BY master_metadata_album_artist_name
      )
    ),
    artist_counts AS (
      SELECT
        master_metadata_album_artist_name,
        COUNT(*) FILTER (WHERE reason_end = 'trackdone') AS completed_count,
        COUNT(*) FILTER (WHERE reason_end IN ('fwdbtn', 'click-row', 'clickrow')) AS skipped_count,
        COUNT(*) AS total_events
      FROM ${q}
      WHERE master_metadata_album_artist_name IS NOT NULL
      GROUP BY master_metadata_album_artist_name
      HAVING COUNT(*) >= (SELECT limit_streams FROM threshold)
    ),
    artist_loyalty AS (
      SELECT
        master_metadata_album_artist_name,
        completed_count,
        skipped_count,
        total_events,
        completed_count::DOUBLE PRECISION / NULLIF(total_events, 0) AS loyalty_ratio
      FROM artist_counts
    )
    SELECT
      'absolute_loyalty' AS factType,
      master_metadata_album_artist_name AS mainText,
      (loyalty_ratio * 100)::INTEGER AS value,
      '%' AS unit,
      'of your completed (' || completed_count || ') vs skipped (' || skipped_count || ')' AS context
    FROM artist_loyalty
    ORDER BY value DESC
    LIMIT 1;
  `}function LB(){return`
    SELECT
      'subscribed_artist' as factType,
      master_metadata_album_artist_name as mainText,
      COUNT(DISTINCT strftime(ts::DATE, '%Y-%m'))::INTEGER as value,
      'months' as unit,
      'of presence' as context
    FROM ${q}
    WHERE master_metadata_album_artist_name IS NOT NULL
    GROUP BY master_metadata_album_artist_name
    ORDER BY value DESC
    LIMIT 1
  `}function FB(){return`
    WITH
    recent_date AS (
      SELECT MAX(ts::DATE) as max_date FROM ${q}
    ),
    threshold AS (
      SELECT approx_quantile(total_streams, 0.99) AS limit_streams
      FROM (
        SELECT COUNT(*) AS total_streams FROM ${q}
        GROUP BY master_metadata_album_artist_name
      )
    ),
    recent_artists AS (
      SELECT DISTINCT master_metadata_album_artist_name AS artist
      FROM ${q}, recent_date
      WHERE
        master_metadata_album_artist_name IS NOT NULL
        AND ts::DATE >= max_date - INTERVAL 90 DAY
    ),
    artist_years AS (
      SELECT
        master_metadata_album_artist_name,
        MIN(YEAR(ts::DATE)) as first_year
      FROM ${q}
      WHERE
        master_metadata_album_artist_name IN (SELECT artist FROM recent_artists)
      GROUP BY master_metadata_album_artist_name
      HAVING COUNT(*) >= (SELECT limit_streams FROM threshold)
      ORDER BY first_year
      LIMIT 20
    )
    SELECT
      'musical_anniversary' as factType,
      master_metadata_album_artist_name as mainText,
      YEAR(max_date) - first_year as value,
      'years' as unit,
      'with you' as context
    FROM artist_years, recent_date
    USING SAMPLE 1
  `}function kB(){return`
    SELECT
      'first_artist' as factType,
      master_metadata_album_artist_name as mainText,
      MIN(YEAR(ts::DATE)) as value,
      'Do you still listen to it?' as context
    FROM ${q}
    WHERE master_metadata_album_artist_name IS NOT NULL
    GROUP BY master_metadata_album_artist_name
    ORDER BY value ASC
    LIMIT 1
  `}function CB(){return`
    WITH
    track_streams AS (
      SELECT
        master_metadata_album_artist_name AS artist_name,
        master_metadata_track_name AS track_name,
        COUNT(*) AS track_count,
        SUM(COUNT(*)) OVER(PARTITION BY master_metadata_album_artist_name) AS total_streams
      FROM ${q}
      WHERE
        master_metadata_album_artist_name IS NOT NULL
        AND master_metadata_track_name IS NOT NULL
      GROUP BY master_metadata_album_artist_name, master_metadata_track_name
    ),
    track_stats AS (
      SELECT
        artist_name,
        track_name,
        CAST((track_count::DOUBLE / total_streams::DOUBLE * 100) AS INT) AS percentage
      FROM track_streams
      ORDER BY percentage DESC, total_streams DESC
      LIMIT 20
    )
    SELECT
      'one_hit_wonder' AS factType,
      track_name as mainText,
      percentage AS value,
      '%' as unit,
      'of total streams of ' || artist_name AS context
    FROM track_stats
    USING SAMPLE 1
  `}function BB(){return`
    SELECT
        'variety_day' as factType,
        CAST(ts::DATE AS VARCHAR) as mainText,
        COUNT(DISTINCT master_metadata_album_artist_name)::INTEGER as value,
        'different artists' as unit,
        'record of diversity in one day' as context
    FROM ${q}
    GROUP BY ts::DATE
    ORDER BY value DESC
    LIMIT 1
  `}function $B(){return`
    WITH
    hour_streams AS (
      SELECT
        HOUR(ts::DATETIME) as hour,
        COUNT(*) as stream_count,
        COUNT(*)::DOUBLE / (SELECT COUNT(*) FROM ${q})::DOUBLE * 100 as pct
      FROM ${q}
      GROUP BY HOUR(ts::DATETIME)
    )
    SELECT
      'peak_hour' as factType,
      CAST(hour AS VARCHAR) || 'h' as mainText,
      CAST(pct AS INT) as value,
      '%' as unit,
      'of total streams' as context
    FROM hour_streams
    ORDER BY stream_count DESC
    LIMIT 1
  `}function UB(){return`
    SELECT
      'binge_listener' as factType,
      CAST(ts::DATE AS VARCHAR) as mainText,
      (SUM(ms_played) / 3600000.0)::INTEGER as value,
      'hours of listening' as unit,
      'your record of listening time in one day' as context
    FROM ${q}
    GROUP BY ts::DATE
    ORDER BY SUM(ms_played) DESC
    LIMIT 1
  `}function PB(){return`
    WITH
    recent_date AS (
      SELECT MAX(ts::DATE) as max_date FROM ${q}
    )
    SELECT
      'current_obsession' as factType,
      master_metadata_track_name as mainText,
      COUNT(*)::INTEGER as value,
      'streams' as unit,
      'in the last 30 days' as context
    FROM ${q}, recent_date
    WHERE ts::DATE >= max_date - INTERVAL 30 DAY
      AND master_metadata_track_name IS NOT NULL
    GROUP BY master_metadata_track_name
    ORDER BY value DESC
    LIMIT 1
  `}function jB(){return`
    WITH
    recent_date AS (
      SELECT MAX(ts::DATE) as max_date FROM ${q}
    ),
    artist_first_listen AS (
      SELECT
        master_metadata_album_artist_name,
        MIN(ts::DATE) as first_listen
      FROM ${q}
      WHERE master_metadata_album_artist_name IS NOT NULL
      GROUP BY master_metadata_album_artist_name
    )
    SELECT
      'recent_discovery' as factType,
      master_metadata_album_artist_name as mainText,
      COUNT(*)::INTEGER as value,
      'streams' as unit,
      'discovered during the last 3 months' as context
    FROM ${q}
    JOIN artist_first_listen USING(master_metadata_album_artist_name)
    WHERE first_listen >= (select max_date - INTERVAL 90 DAY from recent_date)
      AND master_metadata_album_artist_name IS NOT NULL
    GROUP BY master_metadata_album_artist_name
    ORDER BY value DESC
    LIMIT 1
  `}function VB(){return`
    WITH
    ordered_streams AS (
      SELECT
        master_metadata_album_artist_name,
        ts,
        LAG(master_metadata_album_artist_name) OVER (ORDER BY ts) AS prev_artist
      FROM ${q}
      WHERE master_metadata_album_artist_name IS NOT NULL
    ),
    group_ids AS (
      SELECT
        master_metadata_album_artist_name,
        ts,
        SUM(CASE WHEN master_metadata_album_artist_name = prev_artist THEN 0 ELSE 1 END) OVER (ORDER BY ts) AS group_id
      FROM ordered_streams
    ),
    group_sizes AS (
      SELECT
        master_metadata_album_artist_name,
        COUNT(*) AS stream_count,
        MIN(ts::DATE) as date
      FROM group_ids
      GROUP BY group_id, master_metadata_album_artist_name
    )
    SELECT
      'marathon' as factType,
      master_metadata_album_artist_name as mainText,
      stream_count::DOUBLE as value,
      'streams in a row' as unit,
      'on ' || CAST(date AS VARCHAR) as context
    FROM group_sizes
    ORDER BY stream_count DESC
    LIMIT 1
  `}function zB(){return`
    WITH
    daily_streams AS (
      SELECT DISTINCT ts::DATE as stream_date
      FROM ${q}
      ORDER BY ts::DATE
    ),
    date_diffs AS (
      SELECT
        stream_date,
        LAG(stream_date) OVER (ORDER BY stream_date) as prev_date,
        DATE_DIFF('day', LAG(stream_date) OVER (ORDER BY stream_date), stream_date) as day_diff
      FROM daily_streams
    ),
    streak_groups AS (
      SELECT
        stream_date,
        SUM(CASE WHEN day_diff = 1 OR day_diff IS NULL THEN 0 ELSE 1 END) OVER (ORDER BY stream_date) as streak_id
      FROM date_diffs
    ),
    streak_lengths AS (
      SELECT
        streak_id,
        COUNT(*) as streak_length,
        MIN(stream_date) as start_date,
        MAX(stream_date) as end_date
      FROM streak_groups
      GROUP BY streak_id
    )
    SELECT
      'unbeatable_streak' as factType,
      CAST(start_date AS VARCHAR) || ' - ' || CAST(end_date AS VARCHAR) as mainText,
      streak_length::INTEGER as value,
      'days in a row' as unit,
      'your longest streak' as context
    FROM streak_lengths
    ORDER BY streak_length DESC
    LIMIT 1
  `}function YB(){return`
    SELECT
      'track_proposition' as factType,
      master_metadata_track_name as mainText,
      'by ' || master_metadata_album_artist_name as value
    FROM ${q}
    WHERE master_metadata_track_name IS NOT NULL
    USING SAMPLE 1
  `}const WB=e=>{switch(e){case"morning_favorite":return{title:" Musical Breakfast",emoji:""};case"afternoon_favorite":return{title:" Afternoon Boost",emoji:""};case"evening_favorite":return{title:" Calm Return",emoji:""};case"night_favorite":return{title:" Musical Insomnia",emoji:""};case"night_champion":return{title:" Night Champion",emoji:""};case"weekend_favorite":return{title:" Weekend Vibes",emoji:""};case"peak_hour":return{title:" Peak Hour",emoji:""};case"favorite_weekday":return{title:" Favorite Day",emoji:""};case"absolute_loyalty":return{title:" Absolute Loyalty",emoji:""};case"subscribed_artist":return{title:" Monthly Subscription",emoji:""};case"nostalgic_return":return{title:" Nostalgic Return",emoji:""};case"forgotten_artist":return{title:" Forgotten Artist",emoji:""};case"binge_listener":return{title:" Binge Listener",emoji:""};case"unbeatable_streak":return{title:" Unbeatable Streak",emoji:""};case"variety_day":return{title:" Variety Day",emoji:""};case"one_hit_wonder":return{title:" One-Hit Wonder",emoji:""};case"marathon":return{title:" Marathon",emoji:""};case"recent_discovery":return{title:" Recent Discovery",emoji:""};case"current_obsession":return{title:" Current Obsession",emoji:""};case"musical_anniversary":return{title:" Musical Anniversary",emoji:""};case"first_artist":return{title:" The Very First",emoji:"1"};case"track_proposition":return{title:" Listening Proposition",emoji:""};default:return{title:" Fun Fact",emoji:""}}},HB=({fact:e,onRefresh:t,isLoading:n})=>{const{factType:r,mainText:i,value:s,unit:a,context:o}=e,{title:c,emoji:l}=WB(r),u=typeof s=="number"?s.toLocaleString():s;return m.jsxs("div",{className:"col-span-1 md:col-span-2 lg:col-span-3 p-6 bg-gradient-to-br from-purple-50 to-blue-50 dark:from-gray-900 dark:to-dark-900 rounded-2xl shadow border border-purple-100 dark:border-gray-700 relative overflow-hidden group transition-all duration-300 shadow-glass hover:shadow-glass-lg hover:scale-[1.01] animate-fade-in",children:[m.jsx("div",{className:"absolute top-0 right-0 p-4 transition-opacity",children:m.jsx("button",{onClick:t,disabled:n,className:"p-2 rounded-full shadow hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors",title:"New fact",children:m.jsx("span",{className:`block text-xl ${n?"animate-spin":""}`,children:""})})}),m.jsxs("div",{className:"flex flex-col md:flex-row items-center gap-6",children:[m.jsx("div",{className:"text-6xl md:text-8xl flex-shrink-0 animate-bounce-slow",children:l}),m.jsxs("div",{className:"flex-1 text-center md:text-left",children:[m.jsx("div",{className:"text-sm font-bold text-purple-600 dark:text-purple-400 uppercase tracking-wider mb-2",children:c}),m.jsx("div",{className:"text-2xl md:text-4xl font-bold text-gray-900 dark:text-white mb-2 break-words text-balance",children:i}),m.jsxs("div",{className:"text-lg text-gray-600 dark:text-gray-300",children:[m.jsxs("span",{className:"font-bold text-blue-600 dark:text-blue-400",children:[u,a==="%"?a:void 0]})," ",a!=="%"?a:void 0]}),o&&m.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1 italic",children:o})]})]})]})},Af=[AB,IB,NB,TB,VB,CB,MB,DB,OB,BB,UB,PB,kB,jB,$B,LB,FB,zB,RB,YB];function qB(){const[e,t]=P.useState(null),[n,r]=P.useState(!1),i=P.useCallback(async()=>{r(!0);try{for(let s=0;s<3;s++){const a=Af[Math.floor(Math.random()*Af.length)],o=await Wt(a());if(o&&o.length>0){if(e&&o[0].factType===e.factType&&Af.length>1)continue;t(o[0]);break}}}catch(s){console.error("Error loading fun fact:",s)}finally{r(!1)}},[e]);return P.useEffect(()=>{i()},[]),e?m.jsx(HB,{fact:e,onRefresh:i,isLoading:n}):null}function GB(e){return`
    WITH 
    selected_streams AS (
      SELECT * FROM ${q} WHERE YEAR(ts::date) = ${e}
    ),
    normalized_platforms AS (
      SELECT
        CASE
          WHEN LOWER(platform) LIKE 'android%' AND LOWER(platform) NOT LIKE '%tv%' THEN 'Android OS'
          WHEN LOWER(platform) LIKE '%android_tv%' OR LOWER(platform) LIKE '%android tv%' THEN 'Android TV'
          WHEN LOWER(platform) LIKE '%google cast%' OR LOWER(platform) LIKE '%chromecast%' THEN 'Chromecast'
          WHEN LOWER(platform) LIKE 'ios%' OR LOWER(platform) LIKE '%partner ios%' THEN 'iOS'
          WHEN LOWER(platform) LIKE 'osx%' OR LOWER(platform) LIKE 'os x%' THEN 'MacOS'
          WHEN LOWER(platform) LIKE 'sonos_%' OR LOWER(platform) LIKE '%partner sonos%' THEN 'Sonos'
          WHEN LOWER(platform) LIKE '%webos_tv%' OR LOWER(platform) LIKE '%webos tv%' THEN 'WebOS TV'
          WHEN LOWER(platform) LIKE 'webplayer%' OR LOWER(platform) LIKE 'web_player%' OR LOWER(platform) LIKE '%spotify web_player%' THEN 'WebPlayer'
          WHEN LOWER(platform) LIKE 'windows%' THEN 'Windows'
          ELSE 'Others'
        END as platform
      FROM selected_streams
      WHERE platform IS NOT NULL
    ),
    platform_counts AS (
      SELECT
        platform,
        COUNT(*) as stream_count,
        COUNT(*)::DOUBLE / (SELECT COUNT(*) FROM selected_streams WHERE platform IS NOT NULL)::DOUBLE * 100 as pct
      FROM normalized_platforms
      GROUP BY platform
    ),
    top_platforms AS (
      SELECT
        platform,
        stream_count,
        pct,
        ROW_NUMBER() OVER (ORDER BY stream_count DESC, platform DESC) as rank
      FROM platform_counts
      WHERE platform != 'Others'
    ),
    other_platforms AS (
      SELECT
        'Others' as platform,
        SUM(stream_count) as stream_count,
        SUM(pct) as pct
      FROM (
        SELECT * FROM top_platforms WHERE rank > 3
        UNION ALL
        SELECT platform, stream_count, pct, 999 as rank FROM platform_counts WHERE platform = 'Others'
      )
    )
    SELECT
      platform,
      stream_count::DOUBLE as stream_count,
      pct
    FROM (
      SELECT platform, stream_count, pct FROM top_platforms WHERE rank <= 3
      UNION ALL
      SELECT platform, stream_count, pct FROM other_platforms WHERE stream_count > 0
    )
    ORDER BY 
      CASE WHEN platform = 'Others' THEN 1 ELSE 0 END,
      stream_count DESC,
      platform DESC
  `}const XB=({data:e})=>{if(e.length===0)return null;const t=e[0];return m.jsxs("div",{className:"group p-6 bg-white dark:bg-slate-900/80 backdrop-blur-md rounded-2xl border border-gray-300/60 dark:border-slate-700/50 text-gray-900 dark:text-gray-100 transition-all duration-300 hover:shadow-glass-lg hover:scale-[1.01] animate-fade-in",children:[m.jsx("h3",{className:"text-lg font-semibold mb-3 flex items-center gap-2",children:" Listening Devices"}),m.jsxs("div",{className:"mb-4",children:[m.jsx("div",{className:"text-2xl font-bold text-brand-purple",children:t.platform}),m.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400 ",children:"Main platform"})]}),m.jsx("ul",{className:"space-y-3",role:"list",children:e.map(n=>m.jsxs("li",{role:"listitem",children:[m.jsxs("div",{className:"flex justify-between text-xs mb-1",children:[m.jsx("span",{className:"font-medium",children:n.platform}),m.jsxs("span",{className:"text-gray-600 dark:text-gray-400",children:[n.stream_count.toLocaleString()," (",n.pct.toFixed(1),"%)"]})]}),m.jsx("div",{className:"w-full bg-gray-200 dark:bg-slate-700/50 h-2 rounded-full",children:m.jsx("div",{className:"bg-brand-purple h-2 rounded-full",style:{width:`${n.pct}%`}})})]},n.platform))})]})};function KB({year:e}){const[t,n]=P.useState([]);return P.useEffect(()=>{(async()=>{const i=GB(e),s=await Wt(i);n(s)})()},[e]),t.length===0?null:m.jsx(XB,{data:t})}function QB(e){return`
    SELECT
      COUNT(DISTINCT master_metadata_album_artist_name)::DOUBLE AS unique_artists,
      COUNT(*)::DOUBLE AS total_streams,
      (COUNT(*)::DOUBLE / COUNT(DISTINCT master_metadata_album_artist_name)::DOUBLE) AS avg_streams_per_artist
    FROM ${q}
    WHERE master_metadata_album_artist_name IS NOT NULL
    AND YEAR(ts::DATE) = ${e}
  `}const JB=({data:e})=>{const{unique_artists:t,total_streams:n,avg_streams_per_artist:r}=e,s=(o=>o>=50?{label:"Loyal",color:"text-purple-600 dark:text-purple-400",barColor:"bg-purple-500",emoji:""}:o>=25?{label:"Balanced",color:"text-blue-600 dark:text-blue-400",barColor:"bg-blue-500",emoji:""}:{label:"Explorer",color:"text-green-600 dark:text-green-400",barColor:"bg-green-500",emoji:""})(r),a=Math.min(r/100*100,100);return m.jsxs("div",{className:"group p-6 bg-white dark:bg-slate-900/80 backdrop-blur-md rounded-2xl border border-gray-300/60 dark:border-slate-700/50 text-gray-900 dark:text-gray-100 transition-all duration-300 hover:shadow-glass-lg hover:scale-[1.01] animate-fade-in",children:[m.jsx("h3",{className:"text-lg font-semibold mb-3 flex items-center gap-2",children:" Loyalty vs Discovery"}),m.jsxs("div",{className:"flex items-center justify-between mb-4",children:[m.jsxs("div",{children:[m.jsx("div",{className:`text-2xl font-bold ${s.color}`,children:s.label}),m.jsxs("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:[r.toFixed(1)," streams/artist (average)"]})]}),m.jsx("div",{className:"text-4xl",children:s.emoji})]}),m.jsx("div",{className:"w-full bg-gray-200 dark:bg-slate-700/50 rounded-full h-3 mb-3 overflow-hidden",children:m.jsx("div",{className:`${s.barColor} h-3 rounded-full`,style:{width:`${a}%`}})}),m.jsx("div",{className:"flex items-center gap-4 mb-4 text-xs text-gray-600 dark:text-gray-400",children:m.jsxs("div",{role:"list",className:"flex-1 text-center contents",children:[m.jsxs("div",{role:"listitem",className:"flex-1 text-center",children:[m.jsx("div",{className:`text-2xl font-bold ${s.color}`,children:t.toLocaleString()}),m.jsx("div",{children:"Artists"})]}),m.jsx("div",{className:"text-2xl",role:"separator",children:"|"}),m.jsxs("div",{role:"listitem",className:"flex-1 text-center",children:[m.jsx("div",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100",children:n.toLocaleString()}),m.jsx("div",{children:"Streams"})]})]})})]})};function ZB({year:e}){const[t,n]=P.useState(null);return P.useEffect(()=>{(async()=>{const i=QB(e),s=await Wt(i);s&&s.length>0&&n(s[0])})()},[e]),t?m.jsx(JB,{data:t}):null}function t7(e){return`
    WITH 
    selected_streams AS (
      SELECT * FROM ${q} WHERE YEAR(ts::date) = ${e}
    ),
    day_streams AS (
      SELECT
        DAYNAME(ts::DATE) as day_name,
        COUNT(*) as stream_count,
        COUNT(*)::DOUBLE / (SELECT COUNT(*) FROM selected_streams)::DOUBLE * 100 as pct
      FROM selected_streams
      GROUP BY DAYNAME(ts::DATE)
    )
    SELECT
      day_name,
      stream_count::DOUBLE as stream_count,
      pct
    FROM day_streams
    ORDER BY 
      CASE day_name
        WHEN 'Monday' THEN 1
        WHEN 'Tuesday' THEN 2
        WHEN 'Wednesday' THEN 3
        WHEN 'Thursday' THEN 4
        WHEN 'Friday' THEN 5
        WHEN 'Saturday' THEN 6
        WHEN 'Sunday' THEN 7
      END
  `}const e7={Monday:"Mon",Tuesday:"Tue",Wednesday:"Wed",Thursday:"Thu",Friday:"Fri",Saturday:"Sat",Sunday:"Sun"},n7=({data:e})=>{if(!e||e.length===0)return null;const t=e.reduce((r,i)=>i.pct>r.pct?i:r,e[0]),n=Math.max(...e.map(r=>r.pct));return m.jsxs("div",{className:"group p-6 bg-white dark:bg-slate-900/80 backdrop-blur-md rounded-2xl border border-gray-300/60 dark:border-slate-700/50 text-gray-900 dark:text-gray-100 transition-all duration-300 hover:shadow-glass-lg hover:scale-[1.01] animate-fade-in",children:[m.jsx("h3",{className:"text-lg font-semibold mb-3 flex items-center",children:" Favorite Weekday"}),m.jsxs("div",{className:"mb-4",children:[m.jsx("div",{className:"text-2xl font-bold text-orange-400",children:t.day_name}),m.jsxs("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:[t.stream_count.toLocaleString()," streams"]})]}),m.jsx("div",{className:"grid grid-cols-7 gap-1",children:e.map(r=>{const i=r.day_name===t.day_name,s=r.pct/n*100;return m.jsxs("div",{className:"flex flex-col items-center gap-1",children:[m.jsx("div",{className:"text-[10px] font-medium text-gray-600 dark:text-gray-400",children:e7[r.day_name]}),m.jsx("div",{className:"w-full h-16 bg-gray-200 dark:bg-slate-700/50 rounded-sm flex items-end overflow-hidden",children:m.jsx("div",{className:`w-full rounded-sm transition-all duration-300 ${i?"bg-orange-400":"bg-yellow-400"}`,style:{height:`${s}%`}})}),m.jsxs("div",{className:"text-[9px] text-gray-600 dark:text-gray-400",children:[r.pct.toFixed(0),"%"]})]},r.day_name)})})]})};function r7({year:e}){const[t,n]=P.useState([]);return P.useEffect(()=>{(async()=>{const i=t7(e),s=await Wt(i);n(s)})()},[e]),t.length===0?null:m.jsx(n7,{data:t})}function i7(){const[e,t]=P.useState(new Date().getFullYear()),[n,r]=P.useState(2006),[i,s]=P.useState(new Date().getFullYear());return P.useEffect(()=>{(async()=>{const o=await Wt(qS);o.length!==0&&(r(new Date(Number(o[0].min_datetime)).getFullYear()),s(new Date(Number(o[0].max_datetime)).getFullYear()),t(new Date(Number(o[0].max_datetime)).getFullYear()))})()},[]),m.jsxs(m.Fragment,{children:[m.jsx("div",{className:"mt-4",children:m.jsx(qB,{})}),m.jsx(HS,{value:e,min:n,max:i,step:1,onChange:t}),m.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[m.jsx(tB,{year:e}),m.jsx(ZB,{year:e}),m.jsx(rB,{year:e}),m.jsx(oB,{year:e}),m.jsx("div",{className:"md:col-span-2",children:m.jsx(hB,{year:e})}),m.jsx(uB,{year:e}),m.jsx(yB,{year:e}),m.jsx(wB,{year:e}),m.jsx(EB,{year:e}),m.jsx(KB,{year:e}),m.jsx(r7,{year:e})]})]})}function s7(){const[e,t]=P.useState("simple");return m.jsxs("div",{className:"py-8 animate-slide-up",children:[m.jsxs("div",{className:"relative mb-8 bg-gray-100 dark:bg-slate-800/50 backdrop-blur-md p-1.5 rounded-2xl shadow-lg border border-gray-300/60 dark:border-slate-700/50 max-w-md mx-auto",children:[m.jsx("div",{className:`absolute top-1.5 left-1.5 h-[calc(100%-0.75rem)] w-[calc(50%-0.375rem)] bg-gradient-brand rounded-xl shadow-glow transition-transform duration-300 ease-out ${e==="detailed"?"translate-x-full":"translate-x-0"}`}),m.jsxs("div",{className:"relative flex gap-1",role:"tablist",children:[m.jsx("button",{role:"tab","aria-selected":e==="simple",onClick:()=>t("simple"),className:`relative z-10 flex-1 px-6 py-3 text-base font-semibold rounded-xl transition-all duration-300 ${e==="simple"?"text-white":"text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200"}`,children:" Simple View"}),m.jsx("button",{role:"tab","aria-selected":e==="detailed",onClick:()=>t("detailed"),className:`relative z-10 flex-1 px-6 py-3 text-base font-semibold rounded-xl transition-all duration-300 ${e==="detailed"?"text-white":"text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200"}`,children:" Detailed View"})]})]}),m.jsx("div",{className:"min-h-screen",children:e==="detailed"?m.jsx(QC,{}):m.jsx(i7,{})})]})}function a7({initialDb:e=null,initialIsDataDropped:t=!1,initialIsDataReady:n=!1}){const[r,i]=P.useState(e),[s,a]=P.useState(t),[o,c]=P.useState(n),{isDemoReady:l,handleDemoButtonClick:u,demoJsonUrl:f}=b6();P.useEffect(()=>{(async()=>{const p=await Qa();i(p)})()},[]);async function d(h){if(h){c(!1),a(!0);try{await h6(h),c(!0)}catch(p){console.error("Failed to upload files:",p),c(!1),a(!1)}}}return r?m.jsxs(m.Fragment,{children:[(!s||o)&&m.jsxs("div",{className:"flex flex-col md:flex-row gap-4 items-stretch",children:[m.jsx("div",{className:"flex-grow transition-all duration-300",children:m.jsx(d6,{handleValidatedFiles:d})}),m.jsxs("div",{className:"flex flex-col justify-center gap-4",children:[m.jsx(y6,{label:"?",tooltip:"How do I get my data?"}),f&&m.jsx(m6,{label:"",tooltip:"Load demo data",handleClick:u})]})]}),s&&!o&&m.jsx(p6,{}),(o||l)&&m.jsx(s7,{})]}):m.jsx(m.Fragment,{children:m.jsx("p",{className:"dark:text-white",children:"Initializing the database engine (DuckDB-WASM)..."})})}const o7={system:{icon:"M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z",label:e=>`System (${e})`},dark:{icon:"M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z",label:()=>"Dark"},light:{icon:"M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z",label:()=>"Light"}},c7=({path:e})=>m.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:m.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:e})}),l7=e=>{const t=Ko.indexOf(e);return Ko[(t+1)%Ko.length]};function u7(){const{theme:e,setTheme:t,effectiveTheme:n}=P.useContext(Pd),r=o7[e],i=r.label(n);return m.jsx("button",{onClick:()=>t(l7(e)),className:"flex items-center gap-2 px-4 py-2 rounded-lg bg-gray-100 dark:bg-slate-800/50 backdrop-blur-md p-1.5 rounded-2xl shadow-lg border border-gray-300/60 dark:border-slate-700/50 max-w-md mx-auto text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200 transition-colors duration-200","aria-label":`Current theme: ${i}. Click to change theme.`,title:i,children:m.jsx(c7,{path:r.icon})})}function S7(){return m.jsx(uE,{children:m.jsxs("div",{className:"min-h-screen bg-gray-50 dark:bg-slate-950 relative transition-colors duration-300",children:[m.jsx("div",{className:"absolute top-6 right-6 z-50",children:m.jsx(u7,{})}),m.jsx("div",{className:"flex items-center justify-center min-h-screen px-4 relative z-10",children:m.jsxs("div",{className:"max-w-4xl w-full mx-auto py-12",children:[m.jsx("h1",{className:"text-4xl md:text-5xl font-bold text-center mb-8 animate-fade-in",children:m.jsx("a",{href:"/tracksy",className:"bg-gradient-brand bg-clip-text text-transparent hover:opacity-80 transition-opacity drop-shadow-sm",children:"Tracksy"})}),m.jsx(a7,{})]})})]})})}export{S7 as App};
